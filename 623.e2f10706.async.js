!(function(){var X1=Object.defineProperty,Z1=Object.defineProperties;var J1=Object.getOwnPropertyDescriptors;var VT=Object.getOwnPropertySymbols;var d1=Object.prototype.hasOwnProperty,f1=Object.prototype.propertyIsEnumerable;var jT=Math.pow,h1=($,ie,f)=>ie in $?X1($,ie,{enumerable:!0,configurable:!0,writable:!0,value:f}):$[ie]=f,hi=($,ie)=>{for(var f in ie||(ie={}))d1.call(ie,f)&&h1($,f,ie[f]);if(VT)for(var f of VT(ie))f1.call(ie,f)&&h1($,f,ie[f]);return $},Gl=($,ie)=>Z1($,J1(ie));var Xu=($,ie)=>{var f={};for(var C in $)d1.call($,C)&&ie.indexOf(C)<0&&(f[C]=$[C]);if($!=null&&VT)for(var C of VT($))ie.indexOf(C)<0&&f1.call($,C)&&(f[C]=$[C]);return f};(self.webpackChunk_sakura_flutter_handsontable_vue3=self.webpackChunk_sakura_flutter_handsontable_vue3||[]).push([[623],{9950:function($,ie,f){var C=f(60059);function _(B){if(Array.isArray(B))return C(B)}$.exports=_,$.exports.__esModule=!0,$.exports.default=$.exports},20545:function($){function ie(f){if(typeof Symbol!="undefined"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}$.exports=ie,$.exports.__esModule=!0,$.exports.default=$.exports},59177:function($){function ie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}$.exports=ie,$.exports.__esModule=!0,$.exports.default=$.exports},17273:function($){function ie(f){if(f==null)throw new TypeError("Cannot destructure "+f)}$.exports=ie,$.exports.__esModule=!0,$.exports.default=$.exports},6083:function($,ie,f){var C=f(9950),_=f(20545),B=f(83612),K=f(59177);function k(Q){return C(Q)||_(Q)||B(Q)||K()}$.exports=k,$.exports.__esModule=!0,$.exports.default=$.exports},30613:function($,ie,f){"use strict";f.d(ie,{pL:function(){return ve},sZ:function(){return q}});var C=f(6803),_=f(88692),B=f(44307);function K(pe,Se,Ee){return(Se=N(Se))in pe?Object.defineProperty(pe,Se,{value:Ee,enumerable:!0,configurable:!0,writable:!0}):pe[Se]=Ee,pe}function k(pe,Se){var Ee=Object.keys(pe);if(Object.getOwnPropertySymbols){var He=Object.getOwnPropertySymbols(pe);Se&&(He=He.filter(function(Fe){return Object.getOwnPropertyDescriptor(pe,Fe).enumerable})),Ee.push.apply(Ee,He)}return Ee}function Q(pe){for(var Se=1;Se<arguments.length;Se++){var Ee=arguments[Se]!=null?arguments[Se]:{};Se%2?k(Object(Ee),!0).forEach(function(He){K(pe,He,Ee[He])}):Object.getOwnPropertyDescriptors?Object.defineProperties(pe,Object.getOwnPropertyDescriptors(Ee)):k(Object(Ee)).forEach(function(He){Object.defineProperty(pe,He,Object.getOwnPropertyDescriptor(Ee,He))})}return pe}function X(pe,Se){if(typeof pe!="object"||!pe)return pe;var Ee=pe[Symbol.toPrimitive];if(Ee!==void 0){var He=Ee.call(pe,Se);if(typeof He!="object")return He;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Se==="string"?String:Number)(pe)}function N(pe){var Se=X(pe,"string");return typeof Se=="symbol"?Se:Se+""}function ce(pe){"@babel/helpers - typeof";return ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Se){return typeof Se}:function(Se){return Se&&typeof Symbol=="function"&&Se.constructor===Symbol&&Se!==Symbol.prototype?"symbol":typeof Se},ce(pe)}var Y=Symbol("unassigned"),Z="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function ee(pe,Se){return Object.prototype.hasOwnProperty.call(pe,Se)}function le(pe){var Se=B.ZP.hooks.getRegistered(),Ee={};Object.assign(Ee,B.ZP.DefaultSettings);for(var He in Ee)Ee[He]={default:Y};for(var Fe=0;Fe<Se.length;Fe++)Ee[Se[Fe]]={default:Y};return Ee.settings={default:Y},pe==="HotTable"&&(Ee.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),Ee}function J(pe){var Se={},Ee=pe.settings;if(Ee!==Y)for(var He in Ee)ee(Ee,He)&&Ee[He]!==Y&&(Se[He]=Ee[He]);for(var Fe in pe)ee(pe,Fe)&&Fe!=="settings"&&pe[Fe]!==Y&&(Se[Fe]=pe[Fe]);return Se}function W(pe,Se){var Ee=J(pe),He=pe.settings?pe.settings:Ee,Fe=pe.settings?Ee:null,et={};for(var Oe in He)ee(He,Oe)&&He[Oe]!==void 0&&(!(Se&&Oe!=="data")||!I(Se[Oe],He[Oe]))&&(et[Oe]=He[Oe]);for(var ct in Fe)ee(Fe,ct)&&ct!=="id"&&ct!=="settings"&&Fe[ct]!==void 0&&(!(Se&&ct!=="data")||!I(Se[ct],Fe[ct]))&&(et[ct]=Fe[ct]);return et}function I(pe,Se){var Ee=function(Fe){var et=function(){var Oe=new WeakSet;return function(ct,ze){if(ce(ze)==="object"&&ze!==null){if(Oe.has(ze))return;Oe.add(ze)}return ze}}();return JSON.stringify(Fe,et)};return typeof pe=="function"&&typeof Se=="function"?pe.toString()===Se.toString():ce(pe)!==ce(Se)?!1:Ee(pe)===Ee(Se)}var V="15.3.0",q=(0,C.aZ)({name:"HotTable",props:le("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(Se){var Ee=W(Se,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||Ee===void 0||(Ee.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete Ee.data),Object.keys(Ee).length?this.hotInstance.updateSettings(Ee):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Z),null)},set hotInstance(Se){this.__hotInstance=Se}}},methods:{hotInit:function(){var Se=W(this.$props);Se.columns=this.columnSettings?this.columnSettings:Se.columns,this.hotInstance=(0,_.Xl)(new B.ZP.Core(this.$el,Se)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var Se=this;if(this.hotInstance){var Ee=this.hotInstance.getSourceData(),He=[],Fe=[],et=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),Oe=this.hotInstance.isColumnModificationAllowed(),ct=0;if(Ee&&Ee.length!==et&&Ee.length<et)for(var ze=Ee.length;ze<et;ze++)He.push(ze);if(Oe){var dt;if(ct=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),Ee&&Ee[0]&&((dt=Ee[0])===null||dt===void 0?void 0:dt.length)!==ct&&Ee[0].length<ct)for(var It=Ee[0].length;It<ct;It++)Fe.push(It)}this.hotInstance.batch(function(){He.length>0?Se.hotInstance.rowIndexMapper.removeIndexes(He):Se.hotInstance.rowIndexMapper.insertIndexes(et-1,Ee.length-et),Oe&&Ee.length!==0&&(Fe.length>0?Se.hotInstance.columnIndexMapper.removeIndexes(Fe):Se.hotInstance.columnIndexMapper.insertIndexes(ct-1,Ee[0].length-ct))})}},getColumnSettings:function(){var Se=Array.from(this.columnsCache.values());return Se.length?Se:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:V}),de=["id"];function ue(pe,Se,Ee,He,Fe,et){return(0,C.wg)(),(0,C.iD)("div",{id:pe.id},[(0,C.WI)(pe.$slots,"default")],8,de)}q.render=ue,q.__file="src/HotTable.vue";var ve=(0,C.aZ)({name:"HotColumn",props:le("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var Se=J(this.$props),Ee=Q({},Se);Se.renderer&&(Ee.renderer=Se.renderer),Se.editor&&(Ee.editor=Se.editor),this.columnsCache.set(this,Ee)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});ve.__file="src/HotColumn.vue"},76183:function($,ie,f){"use strict";f.r(ie)},20474:function($,ie,f){"use strict";f.r(ie)},88692:function($,ie,f){"use strict";f.d(ie,{$y:function(){return Ps},AH:function(){return ya},B:function(){return k},BK:function(){return fr},BX:function(){return zi},Bj:function(){return K},EB:function(){return X},ER:function(){return xn},Fl:function(){return bl},IU:function(){return Rr},Jd:function(){return Oe},OT:function(){return Vn},PG:function(){return sr},PQ:function(){return tn},SU:function(){return $t},Tn:function(){return _n},Um:function(){return Gt},Vh:function(){return Eo},WL:function(){return Er},X$:function(){return Ft},X3:function(){return Hr},XB:function(){return Qe},XI:function(){return Lr},Xl:function(){return bo},YL:function(){return Kn},YP:function(){return ls},YS:function(){return $r},ZM:function(){return fi},cE:function(){return Ee},dq:function(){return Pr},fw:function(){return dr},iH:function(){return gi},j:function(){return rt},lk:function(){return ze},nZ:function(){return Q},oR:function(){return xt},qj:function(){return Ke},qq:function(){return Z},sT:function(){return He},yT:function(){return ur},zF:function(){return ka}});var C=f(42281);function _(se,...O){console.warn(`[Vue warn] ${se}`,...O)}let B;class K{constructor(O=!1){this.detached=O,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=B,!O&&B&&(this.index=(B.scopes||(B.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let O,x;if(this.scopes)for(O=0,x=this.scopes.length;O<x;O++)this.scopes[O].pause();for(O=0,x=this.effects.length;O<x;O++)this.effects[O].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let O,x;if(this.scopes)for(O=0,x=this.scopes.length;O<x;O++)this.scopes[O].resume();for(O=0,x=this.effects.length;O<x;O++)this.effects[O].resume()}}run(O){if(this._active){const x=B;try{return B=this,O()}finally{B=x}}}on(){++this._on===1&&(this.prevScope=B,B=this)}off(){this._on>0&&--this._on===0&&(B=this.prevScope,this.prevScope=void 0)}stop(O){if(this._active){this._active=!1;let x,re;for(x=0,re=this.effects.length;x<re;x++)this.effects[x].stop();for(this.effects.length=0,x=0,re=this.cleanups.length;x<re;x++)this.cleanups[x]();if(this.cleanups.length=0,this.scopes){for(x=0,re=this.scopes.length;x<re;x++)this.scopes[x].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!O){const he=this.parent.scopes.pop();he&&he!==this&&(this.parent.scopes[this.index]=he,he.index=this.index)}this.parent=void 0}}}function k(se){return new K(se)}function Q(){return B}function X(se,O=!1){B&&B.cleanups.push(se)}let N;const ce={ACTIVE:1,1:"ACTIVE",RUNNING:2,2:"RUNNING",TRACKING:4,4:"TRACKING",NOTIFIED:8,8:"NOTIFIED",DIRTY:16,16:"DIRTY",ALLOW_RECURSE:32,32:"ALLOW_RECURSE",PAUSED:64,64:"PAUSED",EVALUATED:128,128:"EVALUATED"},Y=new WeakSet;class Z{constructor(O){this.fn=O,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,B&&B.active&&B.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Y.has(this)&&(Y.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||W(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,It(this),q(this);const O=N,x=Fe;N=this,Fe=!0;try{return this.fn()}finally{de(this),N=O,Fe=x,this.flags&=-3}}stop(){if(this.flags&1){for(let O=this.deps;O;O=O.nextDep)pe(O);this.deps=this.depsTail=void 0,It(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Y.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ue(this)&&this.run()}get dirty(){return ue(this)}}let ee=0,le,J;function W(se,O=!1){if(se.flags|=8,O){se.next=J,J=se;return}se.next=le,le=se}function I(){ee++}function V(){if(--ee>0)return;if(J){let O=J;for(J=void 0;O;){const x=O.next;O.next=void 0,O.flags&=-9,O=x}}let se;for(;le;){let O=le;for(le=void 0;O;){const x=O.next;if(O.next=void 0,O.flags&=-9,O.flags&1)try{O.trigger()}catch(re){se||(se=re)}O=x}}if(se)throw se}function q(se){for(let O=se.deps;O;O=O.nextDep)O.version=-1,O.prevActiveLink=O.dep.activeLink,O.dep.activeLink=O}function de(se){let O,x=se.depsTail,re=x;for(;re;){const he=re.prevDep;re.version===-1?(re===x&&(x=he),pe(re),Se(re)):O=re,re.dep.activeLink=re.prevActiveLink,re.prevActiveLink=void 0,re=he}se.deps=O,se.depsTail=x}function ue(se){for(let O=se.deps;O;O=O.nextDep)if(O.dep.version!==O.version||O.dep.computed&&(ve(O.dep.computed)||O.dep.version!==O.version))return!0;return!!se._dirty}function ve(se){if(se.flags&4&&!(se.flags&16)||(se.flags&=-17,se.globalVersion===Sn)||(se.globalVersion=Sn,!se.isSSR&&se.flags&128&&(!se.deps&&!se._dirty||!ue(se))))return;se.flags|=2;const O=se.dep,x=N,re=Fe;N=se,Fe=!0;try{q(se);const he=se.fn(se._value);(O.version===0||(0,C.aU)(he,se._value))&&(se.flags|=128,se._value=he,O.version++)}catch(he){throw O.version++,he}finally{N=x,Fe=re,de(se),se.flags&=-3}}function pe(se,O=!1){const{dep:x,prevSub:re,nextSub:he}=se;if(re&&(re.nextSub=he,se.prevSub=void 0),he&&(he.prevSub=re,se.nextSub=void 0),x.subs===se&&(x.subs=re,!re&&x.computed)){x.computed.flags&=-5;for(let Me=x.computed.deps;Me;Me=Me.nextDep)pe(Me,!0)}!O&&!--x.sc&&x.map&&x.map.delete(x.key)}function Se(se){const{prevDep:O,nextDep:x}=se;O&&(O.nextDep=x,se.prevDep=void 0),x&&(x.prevDep=O,se.nextDep=void 0)}function Ee(se,O){se.effect instanceof Z&&(se=se.effect.fn);const x=new Z(se);O&&(0,C.l7)(x,O);try{x.run()}catch(he){throw x.stop(),he}const re=x.run.bind(x);return re.effect=x,re}function He(se){se.effect.stop()}let Fe=!0;const et=[];function Oe(){et.push(Fe),Fe=!1}function ct(){et.push(Fe),Fe=!0}function ze(){const se=et.pop();Fe=se===void 0?!0:se}function dt(se,O=!1){N instanceof Z&&(N.cleanup=se)}function It(se){const{cleanup:O}=se;if(se.cleanup=void 0,O){const x=N;N=void 0;try{O()}finally{N=x}}}let Sn=0;class jt{constructor(O,x){this.sub=O,this.dep=x,this.version=x.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ye{constructor(O){this.computed=O,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(O){if(!N||!Fe||N===this.computed)return;let x=this.activeLink;if(x===void 0||x.sub!==N)x=this.activeLink=new jt(N,this),N.deps?(x.prevDep=N.depsTail,N.depsTail.nextDep=x,N.depsTail=x):N.deps=N.depsTail=x,Be(x);else if(x.version===-1&&(x.version=this.version,x.nextDep)){const re=x.nextDep;re.prevDep=x.prevDep,x.prevDep&&(x.prevDep.nextDep=re),x.prevDep=N.depsTail,x.nextDep=void 0,N.depsTail.nextDep=x,N.depsTail=x,N.deps===x&&(N.deps=re)}return x}trigger(O){this.version++,Sn++,this.notify(O)}notify(O){I();try{for(let x=this.subs;x;x=x.prevSub)x.sub.notify()&&x.sub.dep.notify()}finally{V()}}}function Be(se){if(se.dep.sc++,se.sub.flags&4){const O=se.dep.computed;if(O&&!se.dep.subs){O.flags|=20;for(let re=O.deps;re;re=re.nextDep)Be(re)}const x=se.dep.subs;x!==se&&(se.prevSub=x,x&&(x.nextSub=se)),se.dep.subs=se}}const hn=new WeakMap,Je=Symbol(""),mt=Symbol(""),Ae=Symbol("");function rt(se,O,x){if(Fe&&N){let re=hn.get(se);re||hn.set(se,re=new Map);let he=re.get(x);he||(re.set(x,he=new Ye),he.map=re,he.key=x),he.track()}}function Ft(se,O,x,re,he,Me){const Xe=hn.get(se);if(!Xe){Sn++;return}const nt=Tt=>{Tt&&Tt.trigger()};if(I(),O==="clear")Xe.forEach(nt);else{const Tt=(0,C.kJ)(se),En=Tt&&(0,C.S0)(x);if(Tt&&x==="length"){const Tn=Number(re);Xe.forEach((pn,vr)=>{(vr==="length"||vr===Ae||!(0,C.yk)(vr)&&vr>=Tn)&&nt(pn)})}else switch((x!==void 0||Xe.has(void 0))&&nt(Xe.get(x)),En&&nt(Xe.get(Ae)),O){case"add":Tt?En&&nt(Xe.get("length")):(nt(Xe.get(Je)),(0,C._N)(se)&&nt(Xe.get(mt)));break;case"delete":Tt||(nt(Xe.get(Je)),(0,C._N)(se)&&nt(Xe.get(mt)));break;case"set":(0,C._N)(se)&&nt(Xe.get(Je));break}}V()}function zt(se,O){const x=hn.get(se);return x&&x.get(O)}function Et(se){const O=Rr(se);return O===se?O:(rt(O,"iterate",Ae),ur(se)?O:O.map(Kn))}function Qe(se){return rt(se=Rr(se),"iterate",Ae),se}const an={__proto__:null,[Symbol.iterator](){return Mt(this,Symbol.iterator,Kn)},concat(...se){return Et(this).concat(...se.map(O=>(0,C.kJ)(O)?Et(O):O))},entries(){return Mt(this,"entries",se=>(se[1]=Kn(se[1]),se))},every(se,O){return bn(this,"every",se,O,void 0,arguments)},filter(se,O){return bn(this,"filter",se,O,x=>x.map(Kn),arguments)},find(se,O){return bn(this,"find",se,O,Kn,arguments)},findIndex(se,O){return bn(this,"findIndex",se,O,void 0,arguments)},findLast(se,O){return bn(this,"findLast",se,O,Kn,arguments)},findLastIndex(se,O){return bn(this,"findLastIndex",se,O,void 0,arguments)},forEach(se,O){return bn(this,"forEach",se,O,void 0,arguments)},includes(...se){return br(this,"includes",se)},indexOf(...se){return br(this,"indexOf",se)},join(se){return Et(this).join(se)},lastIndexOf(...se){return br(this,"lastIndexOf",se)},map(se,O){return bn(this,"map",se,O,void 0,arguments)},pop(){return qr(this,"pop")},push(...se){return qr(this,"push",se)},reduce(se,...O){return mr(this,"reduce",se,O)},reduceRight(se,...O){return mr(this,"reduceRight",se,O)},shift(){return qr(this,"shift")},some(se,O){return bn(this,"some",se,O,void 0,arguments)},splice(...se){return qr(this,"splice",se)},toReversed(){return Et(this).toReversed()},toSorted(se){return Et(this).toSorted(se)},toSpliced(...se){return Et(this).toSpliced(...se)},unshift(...se){return qr(this,"unshift",se)},values(){return Mt(this,"values",Kn)}};function Mt(se,O,x){const re=Qe(se),he=re[O]();return re!==se&&!ur(se)&&(he._next=he.next,he.next=()=>{const Me=he._next();return Me.value&&(Me.value=x(Me.value)),Me}),he}const Cn=Array.prototype;function bn(se,O,x,re,he,Me){const Xe=Qe(se),nt=Xe!==se&&!ur(se),Tt=Xe[O];if(Tt!==Cn[O]){const pn=Tt.apply(se,Me);return nt?Kn(pn):pn}let En=x;Xe!==se&&(nt?En=function(pn,vr){return x.call(this,Kn(pn),vr,se)}:x.length>2&&(En=function(pn,vr){return x.call(this,pn,vr,se)}));const Tn=Tt.call(Xe,En,re);return nt&&he?he(Tn):Tn}function mr(se,O,x,re){const he=Qe(se);let Me=x;return he!==se&&(ur(se)?x.length>3&&(Me=function(Xe,nt,Tt){return x.call(this,Xe,nt,Tt,se)}):Me=function(Xe,nt,Tt){return x.call(this,Xe,Kn(nt),Tt,se)}),he[O](Me,...re)}function br(se,O,x){const re=Rr(se);rt(re,"iterate",Ae);const he=re[O](...x);return(he===-1||he===!1)&&Hr(x[0])?(x[0]=Rr(x[0]),re[O](...x)):he}function qr(se,O,x=[]){Oe(),I();const re=Rr(se)[O].apply(se,x);return V(),ze(),re}const ir=(0,C.fY)("__proto__,__v_isRef,__isVue"),Qn=new Set(Object.getOwnPropertyNames(Symbol).filter(se=>se!=="arguments"&&se!=="caller").map(se=>Symbol[se]).filter(C.yk));function kr(se){(0,C.yk)(se)||(se=String(se));const O=Rr(this);return rt(O,"has",se),O.hasOwnProperty(se)}class mn{constructor(O=!1,x=!1){this._isReadonly=O,this._isShallow=x}get(O,x,re){if(x==="__v_skip")return O.__v_skip;const he=this._isReadonly,Me=this._isShallow;if(x==="__v_isReactive")return!he;if(x==="__v_isReadonly")return he;if(x==="__v_isShallow")return Me;if(x==="__v_raw")return re===(he?Me?Te:as:Me?js:Mr).get(O)||Object.getPrototypeOf(O)===Object.getPrototypeOf(re)?O:void 0;const Xe=(0,C.kJ)(O);if(!he){let Tt;if(Xe&&(Tt=an[x]))return Tt;if(x==="hasOwnProperty")return kr}const nt=Reflect.get(O,x,Pr(O)?O:re);return((0,C.yk)(x)?Qn.has(x):ir(x))||(he||rt(O,"get",x),Me)?nt:Pr(nt)?Xe&&(0,C.S0)(x)?nt:nt.value:(0,C.Kn)(nt)?he?Vn(nt):Ke(nt):nt}}class Rs extends mn{constructor(O=!1){super(!1,O)}set(O,x,re,he){let Me=O[x];if(!this._isShallow){const Tt=Ps(Me);if(!ur(re)&&!Ps(re)&&(Me=Rr(Me),re=Rr(re)),!(0,C.kJ)(O)&&Pr(Me)&&!Pr(re))return Tt?!1:(Me.value=re,!0)}const Xe=(0,C.kJ)(O)&&(0,C.S0)(x)?Number(x)<O.length:(0,C.RI)(O,x),nt=Reflect.set(O,x,re,Pr(O)?O:he);return O===Rr(he)&&(Xe?(0,C.aU)(re,Me)&&Ft(O,"set",x,re,Me):Ft(O,"add",x,re)),nt}deleteProperty(O,x){const re=(0,C.RI)(O,x),he=O[x],Me=Reflect.deleteProperty(O,x);return Me&&re&&Ft(O,"delete",x,void 0,he),Me}has(O,x){const re=Reflect.has(O,x);return(!(0,C.yk)(x)||!Qn.has(x))&&rt(O,"has",x),re}ownKeys(O){return rt(O,"iterate",(0,C.kJ)(O)?"length":Je),Reflect.ownKeys(O)}}class Mi extends mn{constructor(O=!1){super(!0,O)}set(O,x){return!0}deleteProperty(O,x){return!0}}const _o=new Rs,Hn=new Mi,Oi=new Rs(!0),pr=new Mi(!0),Vs=se=>se,Qi=se=>Reflect.getPrototypeOf(se);function Ln(se,O,x){return function(...re){const he=this.__v_raw,Me=Rr(he),Xe=(0,C._N)(Me),nt=se==="entries"||se===Symbol.iterator&&Xe,Tt=se==="keys"&&Xe,En=he[se](...re),Tn=x?Vs:O?zi:Kn;return!O&&rt(Me,"iterate",Tt?mt:Je),{next(){const{value:pn,done:vr}=En.next();return vr?{value:pn,done:vr}:{value:nt?[Tn(pn[0]),Tn(pn[1])]:Tn(pn),done:vr}},[Symbol.iterator](){return this}}}}function yn(se){return function(...O){return se==="delete"?!1:se==="clear"?void 0:this}}function qi(se,O){const x={get(he){const Me=this.__v_raw,Xe=Rr(Me),nt=Rr(he);se||((0,C.aU)(he,nt)&&rt(Xe,"get",he),rt(Xe,"get",nt));const{has:Tt}=Qi(Xe),En=O?Vs:se?zi:Kn;if(Tt.call(Xe,he))return En(Me.get(he));if(Tt.call(Xe,nt))return En(Me.get(nt));Me!==Xe&&Me.get(he)},get size(){const he=this.__v_raw;return!se&&rt(Rr(he),"iterate",Je),Reflect.get(he,"size",he)},has(he){const Me=this.__v_raw,Xe=Rr(Me),nt=Rr(he);return se||((0,C.aU)(he,nt)&&rt(Xe,"has",he),rt(Xe,"has",nt)),he===nt?Me.has(he):Me.has(he)||Me.has(nt)},forEach(he,Me){const Xe=this,nt=Xe.__v_raw,Tt=Rr(nt),En=O?Vs:se?zi:Kn;return!se&&rt(Tt,"iterate",Je),nt.forEach((Tn,pn)=>he.call(Me,En(Tn),En(pn),Xe))}};return(0,C.l7)(x,se?{add:yn("add"),set:yn("set"),delete:yn("delete"),clear:yn("clear")}:{add(he){!O&&!ur(he)&&!Ps(he)&&(he=Rr(he));const Me=Rr(this);return Qi(Me).has.call(Me,he)||(Me.add(he),Ft(Me,"add",he,he)),this},set(he,Me){!O&&!ur(Me)&&!Ps(Me)&&(Me=Rr(Me));const Xe=Rr(this),{has:nt,get:Tt}=Qi(Xe);let En=nt.call(Xe,he);En||(he=Rr(he),En=nt.call(Xe,he));const Tn=Tt.call(Xe,he);return Xe.set(he,Me),En?(0,C.aU)(Me,Tn)&&Ft(Xe,"set",he,Me,Tn):Ft(Xe,"add",he,Me),this},delete(he){const Me=Rr(this),{has:Xe,get:nt}=Qi(Me);let Tt=Xe.call(Me,he);Tt||(he=Rr(he),Tt=Xe.call(Me,he));const En=nt?nt.call(Me,he):void 0,Tn=Me.delete(he);return Tt&&Ft(Me,"delete",he,void 0,En),Tn},clear(){const he=Rr(this),Me=he.size!==0,Xe=void 0,nt=he.clear();return Me&&Ft(he,"clear",void 0,void 0,Xe),nt}}),["keys","values","entries",Symbol.iterator].forEach(he=>{x[he]=Ln(he,se,O)}),x}function In(se,O){const x=qi(se,O);return(re,he,Me)=>he==="__v_isReactive"?!se:he==="__v_isReadonly"?se:he==="__v_raw"?re:Reflect.get((0,C.RI)(x,he)&&he in re?x:re,he,Me)}const un={get:In(!1,!1)},Xn={get:In(!1,!0)},en={get:In(!0,!1)},Vr={get:In(!0,!0)};function di(se,O,x){const re=Rr(x);if(re!==x&&O.call(se,re)){const he=toRawType(se);_(`Reactive ${he} contains both the raw and reactive versions of the same object${he==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const Mr=new WeakMap,js=new WeakMap,as=new WeakMap,Te=new WeakMap;function tt(se){switch(se){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function St(se){return se.__v_skip||!Object.isExtensible(se)?0:tt((0,C.W7)(se))}function Ke(se){return Ps(se)?se:Ur(se,!1,_o,un,Mr)}function Gt(se){return Ur(se,!1,Oi,Xn,js)}function Vn(se){return Ur(se,!0,Hn,en,as)}function $r(se){return Ur(se,!0,pr,Vr,Te)}function Ur(se,O,x,re,he){if(!(0,C.Kn)(se)||se.__v_raw&&!(O&&se.__v_isReactive))return se;const Me=St(se);if(Me===0)return se;const Xe=he.get(se);if(Xe)return Xe;const nt=new Proxy(se,Me===2?re:x);return he.set(se,nt),nt}function sr(se){return Ps(se)?sr(se.__v_raw):!!(se&&se.__v_isReactive)}function Ps(se){return!!(se&&se.__v_isReadonly)}function ur(se){return!!(se&&se.__v_isShallow)}function Hr(se){return se?!!se.__v_raw:!1}function Rr(se){const O=se&&se.__v_raw;return O?Rr(O):se}function bo(se){return!(0,C.RI)(se,"__v_skip")&&Object.isExtensible(se)&&(0,C.Nj)(se,"__v_skip",!0),se}const Kn=se=>(0,C.Kn)(se)?Ke(se):se,zi=se=>(0,C.Kn)(se)?Vn(se):se;function Pr(se){return se?se.__v_isRef===!0:!1}function gi(se){return ps(se,!1)}function Lr(se){return ps(se,!0)}function ps(se,O){return Pr(se)?se:new Ue(se,O)}class Ue{constructor(O,x){this.dep=new Ye,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=x?O:Rr(O),this._value=x?O:Kn(O),this.__v_isShallow=x}get value(){return this.dep.track(),this._value}set value(O){const x=this._rawValue,re=this.__v_isShallow||ur(O)||Ps(O);O=re?O:Rr(O),(0,C.aU)(O,x)&&(this._rawValue=O,this._value=re?O:Kn(O),this.dep.trigger())}}function xt(se){se.dep&&se.dep.trigger()}function $t(se){return Pr(se)?se.value:se}function _n(se){return(0,C.mf)(se)?se():$t(se)}const Xr={get:(se,O,x)=>O==="__v_raw"?se:$t(Reflect.get(se,O,x)),set:(se,O,x,re)=>{const he=se[O];return Pr(he)&&!Pr(x)?(he.value=x,!0):Reflect.set(se,O,x,re)}};function Er(se){return sr(se)?se:new Proxy(se,Xr)}class Di{constructor(O){this.__v_isRef=!0,this._value=void 0;const x=this.dep=new Ye,{get:re,set:he}=O(x.track.bind(x),x.trigger.bind(x));this._get=re,this._set=he}get value(){return this._value=this._get()}set value(O){this._set(O)}}function fi(se){return new Di(se)}function fr(se){const O=(0,C.kJ)(se)?new Array(se.length):{};for(const x in se)O[x]=Wn(se,x);return O}class tl{constructor(O,x,re){this._object=O,this._key=x,this._defaultValue=re,this.__v_isRef=!0,this._value=void 0}get value(){const O=this._object[this._key];return this._value=O===void 0?this._defaultValue:O}set value(O){this._object[this._key]=O}get dep(){return zt(Rr(this._object),this._key)}}class li{constructor(O){this._getter=O,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Eo(se,O,x){return Pr(se)?se:(0,C.mf)(se)?new li(se):(0,C.Kn)(se)&&arguments.length>1?Wn(se,O,x):gi(se)}function Wn(se,O,x){const re=se[O];return Pr(re)?re:new tl(se,O,x)}class vs{constructor(O,x,re){this.fn=O,this.setter=x,this._value=void 0,this.dep=new Ye(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Sn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!x,this.isSSR=re}notify(){if(this.flags|=16,!(this.flags&8)&&N!==this)return W(this,!0),!0}get value(){const O=this.dep.track();return ve(this),O&&(O.version=this.dep.version),this._value}set value(O){this.setter&&this.setter(O)}}function bl(se,O,x=!1){let re,he;return(0,C.mf)(se)?re=se:(re=se.get,he=se.set),new vs(re,he,x)}const xn={GET:"get",HAS:"has",ITERATE:"iterate"},tn={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Ko={SKIP:"__v_skip",IS_REACTIVE:"__v_isReactive",IS_READONLY:"__v_isReadonly",IS_SHALLOW:"__v_isShallow",RAW:"__v_raw",IS_REF:"__v_isRef"},nl={WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP"},lo={},xs=new WeakMap;let Yi;function ya(){return Yi}function ka(se,O=!1,x=Yi){if(x){let re=xs.get(x);re||xs.set(x,re=[]),re.push(se)}}function ls(se,O,x=C.kT){const{immediate:re,deep:he,once:Me,scheduler:Xe,augmentJob:nt,call:Tt}=x,En=Yn=>{(x.onWarn||_)("Invalid watch source: ",Yn,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},Tn=Yn=>he?Yn:ur(Yn)||he===!1||he===0?dr(Yn,1):dr(Yn);let pn,vr,Cr,Cs,Gi=!1,As=!1;if(Pr(se)?(vr=()=>se.value,Gi=ur(se)):sr(se)?(vr=()=>Tn(se),Gi=!0):(0,C.kJ)(se)?(As=!0,Gi=se.some(Yn=>sr(Yn)||ur(Yn)),vr=()=>se.map(Yn=>{if(Pr(Yn))return Yn.value;if(sr(Yn))return Tn(Yn);if((0,C.mf)(Yn))return Tt?Tt(Yn,2):Yn()})):(0,C.mf)(se)?O?vr=Tt?()=>Tt(se,2):se:vr=()=>{if(Cr){Oe();try{Cr()}finally{ze()}}const Yn=Yi;Yi=pn;try{return Tt?Tt(se,3,[Cs]):se(Cs)}finally{Yi=Yn}}:vr=C.dG,O&&he){const Yn=vr,Us=he===!0?1/0:he;vr=()=>dr(Yn(),Us)}const Ro=Q(),Ns=()=>{pn.stop(),Ro&&Ro.active&&(0,C.Od)(Ro.effects,pn)};if(Me&&O){const Yn=O;O=(...Us)=>{Yn(...Us),Ns()}}let fe=As?new Array(se.length).fill(lo):lo;const Do=Yn=>{if(!(!(pn.flags&1)||!pn.dirty&&!Yn))if(O){const Us=pn.run();if(he||Gi||(As?Us.some((To,qs)=>(0,C.aU)(To,fe[qs])):(0,C.aU)(Us,fe))){Cr&&Cr();const To=Yi;Yi=pn;try{const qs=[Us,fe===lo?void 0:As&&fe[0]===lo?[]:fe,Cs];fe=Us,Tt?Tt(O,3,qs):O(...qs)}finally{Yi=To}}}else pn.run()};return nt&&nt(Do),pn=new Z(vr),pn.scheduler=Xe?()=>Xe(Do,!1):Do,Cs=Yn=>ka(Yn,!1,pn),Cr=pn.onStop=()=>{const Yn=xs.get(pn);if(Yn){if(Tt)Tt(Yn,4);else for(const Us of Yn)Us();xs.delete(pn)}},O?re?Do(!0):fe=pn.run():Xe?Xe(Do.bind(null,!0),!0):pn.run(),Ns.pause=pn.pause.bind(pn),Ns.resume=pn.resume.bind(pn),Ns.stop=Ns,Ns}function dr(se,O=1/0,x){if(O<=0||!(0,C.Kn)(se)||se.__v_skip||(x=x||new Set,x.has(se)))return se;if(x.add(se),O--,Pr(se))dr(se.value,O,x);else if((0,C.kJ)(se))for(let re=0;re<se.length;re++)dr(se[re],O,x);else if((0,C.DM)(se)||(0,C._N)(se))se.forEach(re=>{dr(re,O,x)});else if((0,C.PO)(se)){for(const re in se)dr(se[re],O,x);for(const re of Object.getOwnPropertySymbols(se))Object.prototype.propertyIsEnumerable.call(se,re)&&dr(se[re],O,x)}return se}},6803:function($,ie,f){"use strict";f.d(ie,{$d:function(){return V},$y:function(){return C.$y},AE:function(){return li},AH:function(){return C.AH},Ah:function(){return Ts},B:function(){return C.B},BK:function(){return C.BK},Bj:function(){return C.Bj},Bz:function(){return vu},C3:function(){return Fl},C_:function(){return _.C_},Cn:function(){return un},EB:function(){return C.EB},EM:function(){return Xd},ER:function(){return C.ER},Eo:function(){return ig},Eq:function(){return Xe},F4:function(){return Bl},FN:function(){return al},Fl:function(){return Ru},Fp:function(){return nt},G:function(){return gc},Gn:function(){return ah},HX:function(){return Xn},HY:function(){return ui},Ho:function(){return Oa},IU:function(){return C.IU},JJ:function(){return $l},Jd:function(){return or},KU:function(){return I},Ko:function(){return pu},LL:function(){return Rl},MW:function(){return Ml},MX:function(){return _h},Me:function(){return fi},Mr:function(){return Sh},Nv:function(){return Lo},OT:function(){return C.OT},Ob:function(){return Gi},P$:function(){return ps},PG:function(){return C.PG},PQ:function(){return C.PQ},Q2:function(){return Va},Q6:function(){return Er},RC:function(){return pn},RM:function(){return cg},Rh:function(){return og},Rr:function(){return Kd},S3:function(){return q},SM:function(){return J},SU:function(){return C.SU},Tn:function(){return C.Tn},U2:function(){return xt},Uc:function(){return rf},Uk:function(){return fa},Um:function(){return C.Um},Us:function(){return fh},Vf:function(){return rd},Vh:function(){return C.Vh},WI:function(){return Fr},WL:function(){return C.WL},WY:function(){return Oc},Wl:function(){return Ic},Wm:function(){return cs},Wu:function(){return le},X3:function(){return C.X3},XI:function(){return C.XI},Xl:function(){return C.Xl},Xn:function(){return Sa},Y1:function(){return yh},Y3:function(){return Oe},Y8:function(){return bo},YP:function(){return Dc},YS:function(){return C.YS},Yq:function(){return rl},Yu:function(){return Zf},ZK:function(){return ru},ZM:function(){return C.ZM},Zq:function(){return sf},_:function(){return dd},_A:function(){return _._A},aZ:function(){return Di},b9:function(){return Jf},bT:function(){return mu},bv:function(){return Si},cE:function(){return C.cE},d1:function(){return zs},dD:function(){return In},dG:function(){return Ia},dl:function(){return Ro},dq:function(){return C.dq},ec:function(){return cl},eg:function(){return Tt},eq:function(){return uf},f3:function(){return Io},h:function(){return pd},hR:function(){return _.hR},i8:function(){return xa},iD:function(){return ta},iH:function(){return C.iH},ic:function(){return El},j4:function(){return ho},j5:function(){return _.j5},kC:function(){return _.kC},kq:function(){return lf},l1:function(){return Pc},lA:function(){return bi},lR:function(){return sr},m0:function(){return Su},mI:function(){return he},mW:function(){return Bo},mv:function(){return Qf},mx:function(){return je},n4:function(){return ql},nJ:function(){return zi},nK:function(){return Xr},nQ:function(){return ul},nZ:function(){return C.nZ},oR:function(){return C.oR},of:function(){return dc},p1:function(){return Gd},qG:function(){return Ll},qZ:function(){return vh},qb:function(){return It},qj:function(){return C.qj},qq:function(){return C.qq},ry:function(){return ug},sT:function(){return C.sT},se:function(){return Ns},sv:function(){return ys},tT:function(){return ol},uE:function(){return Ut},u_:function(){return Yd},up:function(){return Go},vl:function(){return ua},vs:function(){return _.vs},w5:function(){return en},wF:function(){return Zu},wg:function(){return ac},wy:function(){return di},xv:function(){return da},yT:function(){return C.yT},yX:function(){return Ys},yg:function(){return bh},zF:function(){return C.zF},zw:function(){return _.zw}});var C=f(88692),_=f(42281);const B=[];function K(v){B.push(v)}function k(){B.pop()}let Q=!1;function X(v,...b){if(Q)return;Q=!0,(0,C.Jd)();const D=B.length?B[B.length-1].component:null,F=D&&D.appContext.config.warnHandler,c=N();if(F)I(F,D,11,[v+b.map(m=>{var E,R;return(R=(E=m.toString)==null?void 0:E.call(m))!=null?R:JSON.stringify(m)}).join(""),D&&D.proxy,c.map(({vnode:m})=>`at <${_s(D,m.type)}>`).join(`
`),c]);else{const m=[`[Vue warn]: ${v}`,...b];c.length&&m.push(`
`,...ce(c)),console.warn(...m)}(0,C.lk)(),Q=!1}function N(){let v=B[B.length-1];if(!v)return[];const b=[];for(;v;){const D=b[0];D&&D.vnode===v?D.recurseCount++:b.push({vnode:v,recurseCount:0});const F=v.component&&v.component.parent;v=F&&F.vnode}return b}function ce(v){const b=[];return v.forEach((D,F)=>{b.push(...F===0?[]:[`
`],...Y(D))}),b}function Y({vnode:v,recurseCount:b}){const D=b>0?`... (${b} recursive calls)`:"",F=v.component?v.component.parent==null:!1,c=` at <${_s(v.component,v.type,F)}`,m=">"+D;return v.props?[c,...Z(v.props),m]:[c+m]}function Z(v){const b=[],D=Object.keys(v);return D.slice(0,3).forEach(F=>{b.push(...ee(F,v[F]))}),D.length>3&&b.push(" ..."),b}function ee(v,b,D){return(0,_.HD)(b)?(b=JSON.stringify(b),D?b:[`${v}=${b}`]):typeof b=="number"||typeof b=="boolean"||b==null?D?b:[`${v}=${b}`]:(0,C.dq)(b)?(b=ee(v,(0,C.IU)(b.value),!0),D?b:[`${v}=Ref<`,b,">"]):(0,_.mf)(b)?[`${v}=fn${b.name?`<${b.name}>`:""}`]:(b=(0,C.IU)(b),D?b:[`${v}=`,b])}function le(v,b){}const J={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},W={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function I(v,b,D,F){try{return F?v(...F):v()}catch(c){q(c,b,D)}}function V(v,b,D,F){if((0,_.mf)(v)){const c=I(v,b,D,F);return c&&(0,_.tI)(c)&&c.catch(m=>{q(m,b,D)}),c}if((0,_.kJ)(v)){const c=[];for(let m=0;m<v.length;m++)c.push(V(v[m],b,D,F));return c}}function q(v,b,D,F=!0){const c=b?b.vnode:null,{errorHandler:m,throwUnhandledErrorInProduction:E}=b&&b.appContext.config||_.kT;if(b){let R=b.parent;const L=b.proxy,ae=`https://vuejs.org/error-reference/#runtime-${D}`;for(;R;){const Ce=R.ec;if(Ce){for(let _e=0;_e<Ce.length;_e++)if(Ce[_e](v,L,ae)===!1)return}R=R.parent}if(m){(0,C.Jd)(),I(m,null,10,[v,L,ae]),(0,C.lk)();return}}de(v,D,c,F,E)}function de(v,b,D,F=!0,c=!1){if(c)throw v;console.error(v)}const ue=[];let ve=-1;const pe=[];let Se=null,Ee=0;const He=Promise.resolve();let Fe=null;const et=100;function Oe(v){const b=Fe||He;return v?b.then(this?v.bind(this):v):b}function ct(v){let b=ve+1,D=ue.length;for(;b<D;){const F=b+D>>>1,c=ue[F],m=Ye(c);m<v||m===v&&c.flags&2?b=F+1:D=F}return b}function ze(v){if(!(v.flags&1)){const b=Ye(v),D=ue[ue.length-1];!D||!(v.flags&2)&&b>=Ye(D)?ue.push(v):ue.splice(ct(b),0,v),v.flags|=1,dt()}}function dt(){Fe||(Fe=He.then(Be))}function It(v){(0,_.kJ)(v)?pe.push(...v):Se&&v.id===-1?Se.splice(Ee+1,0,v):v.flags&1||(pe.push(v),v.flags|=1),dt()}function Sn(v,b,D=ve+1){for(;D<ue.length;D++){const F=ue[D];if(F&&F.flags&2){if(v&&F.id!==v.uid)continue;ue.splice(D,1),D--,F.flags&4&&(F.flags&=-2),F(),F.flags&4||(F.flags&=-2)}}}function jt(v){if(pe.length){const b=[...new Set(pe)].sort((D,F)=>Ye(D)-Ye(F));if(pe.length=0,Se){Se.push(...b);return}for(Se=b,Ee=0;Ee<Se.length;Ee++){const D=Se[Ee];D.flags&4&&(D.flags&=-2),D.flags&8||D(),D.flags&=-2}Se=null,Ee=0}}const Ye=v=>v.id==null?v.flags&2?-1:1/0:v.id;function Be(v){const b=_.dG;try{for(ve=0;ve<ue.length;ve++){const D=ue[ve];D&&!(D.flags&8)&&(D.flags&4&&(D.flags&=-2),I(D,D.i,D.i?15:14),D.flags&4||(D.flags&=-2))}}finally{for(;ve<ue.length;ve++){const D=ue[ve];D&&(D.flags&=-2)}ve=-1,ue.length=0,jt(v),Fe=null,(ue.length||pe.length)&&Be(v)}}function hn(v,b){const D=v.get(b)||0;if(D>et){const F=b.i,c=F&&Bc(F.type);return q(`Maximum recursive updates exceeded${c?` in component <${c}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`,null,10),!0}return v.set(b,D+1),!1}let Je=!1;const mt=new Map,Ae=new Map;function rt(v){const b=v.type.__hmrId;let D=Ae.get(b);D||(zt(b,v.type),D=Ae.get(b)),D.instances.add(v)}function Ft(v){Ae.get(v.type.__hmrId).instances.delete(v)}function zt(v,b){return Ae.has(v)?!1:(Ae.set(v,{initialDef:Et(b),instances:new Set}),!0)}function Et(v){return Hs(v)?v.__vccOpts:v}function Qe(v,b){const D=Ae.get(v);D&&(D.initialDef.render=b,[...D.instances].forEach(F=>{b&&(F.render=b,Et(F.type).render=b),F.renderCache=[],Je=!0,F.update(),Je=!1}))}function an(v,b){const D=Ae.get(v);if(!D)return;b=Et(b),Mt(D.initialDef,b);const F=[...D.instances];for(let c=0;c<F.length;c++){const m=F[c],E=Et(m.type);let R=mt.get(E);R||(E!==D.initialDef&&Mt(E,b),mt.set(E,R=new Set)),R.add(m),m.appContext.propsCache.delete(m.type),m.appContext.emitsCache.delete(m.type),m.appContext.optionsCache.delete(m.type),m.ceReload?(R.add(m),m.ceReload(b.styles),R.delete(m)):m.parent?ze(()=>{Je=!0,m.parent.update(),Je=!1,R.delete(m)}):m.appContext.reload?m.appContext.reload():typeof window!="undefined"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required."),m.root.ce&&m!==m.root&&m.root.ce._removeChildStyle(E)}It(()=>{mt.clear()})}function Mt(v,b){extend(v,b);for(const D in v)D!=="__file"&&!(D in b)&&delete v[D]}function Cn(v){return(b,D)=>{try{return v(b,D)}catch(F){console.error(F),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let bn,mr=[],br=!1;function qr(v,...b){bn?bn.emit(v,...b):br||mr.push({event:v,args:b})}function ir(v,b){var D,F;bn=v,bn?(bn.enabled=!0,mr.forEach(({event:c,args:m})=>bn.emit(c,...m)),mr=[]):typeof window!="undefined"&&window.HTMLElement&&!((F=(D=window.navigator)==null?void 0:D.userAgent)!=null&&F.includes("jsdom"))?((b.__VUE_DEVTOOLS_HOOK_REPLAY__=b.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(m=>{ir(m,b)}),setTimeout(()=>{bn||(b.__VUE_DEVTOOLS_HOOK_REPLAY__=null,br=!0,mr=[])},3e3)):(br=!0,mr=[])}function Qn(v,b){qr("app:init",v,b,{Fragment:ui,Text:da,Comment:ys,Static:Ll})}function kr(v){qr("app:unmount",v)}const mn=null,Rs=null,Mi=null,_o=v=>{bn&&typeof bn.cleanupBuffer=="function"&&!bn.cleanupBuffer(v)&&Mi(v)};function Hn(v){return b=>{qr(v,b.appContext.app,b.uid,b.parent?b.parent.uid:void 0,b)}}const Oi=null,pr=null;function Vs(v){return(b,D,F)=>{qr(v,b.appContext.app,b.uid,b,D,F)}}function Qi(v,b,D){qr("component:emit",v.appContext.app,v,b,D)}let Ln=null,yn=null;function qi(v){const b=Ln;return Ln=v,yn=v&&v.type.__scopeId||null,b}function In(v){yn=v}function un(){yn=null}const Xn=v=>en;function en(v,b=Ln,D){if(!b||v._n)return v;const F=(...c)=>{F._d&&vh(-1);const m=qi(b);let E;try{E=v(...c)}finally{qi(m),F._d&&vh(1)}return E};return F._n=!0,F._c=!0,F._d=!0,F}function Vr(v){isBuiltInDirective(v)&&X("Do not use built-in directive ids as custom directive id: "+v)}function di(v,b){if(Ln===null)return v;const D=fc(Ln),F=v.dirs||(v.dirs=[]);for(let c=0;c<b.length;c++){let[m,E,R,L=_.kT]=b[c];m&&((0,_.mf)(m)&&(m={mounted:m,updated:m}),m.deep&&(0,C.fw)(E),F.push({dir:m,instance:D,value:E,oldValue:void 0,arg:R,modifiers:L}))}return v}function Mr(v,b,D,F){const c=v.dirs,m=b&&b.dirs;for(let E=0;E<c.length;E++){const R=c[E];m&&(R.oldValue=m[E].value);let L=R.dir[F];L&&((0,C.Jd)(),V(L,D,8,[v.el,R,v,b]),(0,C.lk)())}}const js=Symbol("_vte"),as=v=>v.__isTeleport,Te=v=>v&&(v.disabled||v.disabled===""),tt=v=>v&&(v.defer||v.defer===""),St=v=>typeof SVGElement!="undefined"&&v instanceof SVGElement,Ke=v=>typeof MathMLElement=="function"&&v instanceof MathMLElement,Gt=(v,b)=>{const D=v&&v.to;return(0,_.HD)(D)?b?b(D):null:D},Vn={name:"Teleport",__isTeleport:!0,process(v,b,D,F,c,m,E,R,L,ae){const{mc:Ce,pc:_e,pbc:Ge,o:{insert:ht,querySelector:Dt,createText:Ht,createComment:tr}}=ae,cr=Te(b.props);let{shapeFlag:An,children:lt,dynamicChildren:Nt}=b;if(v==null){const At=b.el=Ht(""),vn=b.anchor=Ht("");ht(At,D,F),ht(vn,D,F);const qn=(Qt,dn)=>{An&16&&(c&&c.isCE&&(c.ce._teleportTarget=Qt),Ce(lt,Qt,dn,c,m,E,R,L))},hr=()=>{const Qt=b.target=Gt(b.props,Dt),dn=ur(Qt,b,Ht,ht);Qt&&(E!=="svg"&&St(Qt)?E="svg":E!=="mathml"&&Ke(Qt)&&(E="mathml"),cr||(qn(Qt,dn),Ps(b,!1)))};cr&&(qn(D,vn),Ps(b,!0)),tt(b.props)?(b.el.__isMounted=!1,Ks(()=>{hr(),delete b.el.__isMounted},m)):hr()}else{if(tt(b.props)&&v.el.__isMounted===!1){Ks(()=>{Vn.process(v,b,D,F,c,m,E,R,L,ae)},m);return}b.el=v.el,b.targetStart=v.targetStart;const At=b.anchor=v.anchor,vn=b.target=v.target,qn=b.targetAnchor=v.targetAnchor,hr=Te(v.props),Qt=hr?D:vn,dn=hr?At:qn;if(E==="svg"||St(vn)?E="svg":(E==="mathml"||Ke(vn))&&(E="mathml"),Nt?(Ge(v.dynamicChildren,Nt,Qt,c,m,E,R),sc(v,b,!0)):L||_e(v,b,Qt,dn,c,m,E,R,!1),cr)hr?b.props&&v.props&&b.props.to!==v.props.to&&(b.props.to=v.props.to):$r(b,D,At,ae,1);else if((b.props&&b.props.to)!==(v.props&&v.props.to)){const ar=b.target=Gt(b.props,Dt);ar&&$r(b,ar,null,ae,0)}else hr&&$r(b,vn,qn,ae,1);Ps(b,cr)}},remove(v,b,D,{um:F,o:{remove:c}},m){const{shapeFlag:E,children:R,anchor:L,targetStart:ae,targetAnchor:Ce,target:_e,props:Ge}=v;if(_e&&(c(ae),c(Ce)),m&&c(L),E&16){const ht=m||!Te(Ge);for(let Dt=0;Dt<R.length;Dt++){const Ht=R[Dt];F(Ht,b,D,ht,!!Ht.dynamicChildren)}}},move:$r,hydrate:Ur};function $r(v,b,D,{o:{insert:F},m:c},m=2){m===0&&F(v.targetAnchor,b,D);const{el:E,anchor:R,shapeFlag:L,children:ae,props:Ce}=v,_e=m===2;if(_e&&F(E,b,D),(!_e||Te(Ce))&&L&16)for(let Ge=0;Ge<ae.length;Ge++)c(ae[Ge],b,D,2);_e&&F(R,b,D)}function Ur(v,b,D,F,c,m,{o:{nextSibling:E,parentNode:R,querySelector:L,insert:ae,createText:Ce}},_e){const Ge=b.target=Gt(b.props,L);if(Ge){const ht=Te(b.props),Dt=Ge._lpa||Ge.firstChild;if(b.shapeFlag&16)if(ht)b.anchor=_e(E(v),b,R(v),D,F,c,m),b.targetStart=Dt,b.targetAnchor=Dt&&E(Dt);else{b.anchor=E(v);let Ht=Dt;for(;Ht;){if(Ht&&Ht.nodeType===8){if(Ht.data==="teleport start anchor")b.targetStart=Ht;else if(Ht.data==="teleport anchor"){b.targetAnchor=Ht,Ge._lpa=b.targetAnchor&&E(b.targetAnchor);break}}Ht=E(Ht)}b.targetAnchor||ur(Ge,b,Ce,ae),_e(Dt&&E(Dt),b,Ge,D,F,c,m)}Ps(b,ht)}return b.anchor&&E(b.anchor)}const sr=Vn;function Ps(v,b){const D=v.ctx;if(D&&D.ut){let F,c;for(b?(F=v.el,c=v.anchor):(F=v.targetStart,c=v.targetAnchor);F&&F!==c;)F.nodeType===1&&F.setAttribute("data-v-owner",D.uid),F=F.nextSibling;D.ut()}}function ur(v,b,D,F){const c=b.targetStart=D(""),m=b.targetAnchor=D("");return c[js]=m,v&&(F(c,v),F(m,v)),m}const Hr=Symbol("_leaveCb"),Rr=Symbol("_enterCb");function bo(){const v={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Si(()=>{v.isMounted=!0}),or(()=>{v.isUnmounting=!0}),v}const Kn=[Function,Array],zi={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Kn,onEnter:Kn,onAfterEnter:Kn,onEnterCancelled:Kn,onBeforeLeave:Kn,onLeave:Kn,onAfterLeave:Kn,onLeaveCancelled:Kn,onBeforeAppear:Kn,onAppear:Kn,onAfterAppear:Kn,onAppearCancelled:Kn},Pr=v=>{const b=v.subTree;return b.component?Pr(b.component):b},gi={name:"BaseTransition",props:zi,setup(v,{slots:b}){const D=al(),F=bo();return()=>{const c=b.default&&Er(b.default(),!0);if(!c||!c.length)return;const m=Lr(c),E=(0,C.IU)(v),{mode:R}=E;if(F.isLeaving)return $t(m);const L=_n(m);if(!L)return $t(m);let ae=xt(L,E,F,D,_e=>ae=_e);L.type!==ys&&Xr(L,ae);let Ce=D.subTree&&_n(D.subTree);if(Ce&&Ce.type!==ys&&!us(L,Ce)&&Pr(D).type!==ys){let _e=xt(Ce,E,F,D);if(Xr(Ce,_e),R==="out-in"&&L.type!==ys)return F.isLeaving=!0,_e.afterLeave=()=>{F.isLeaving=!1,D.job.flags&8||D.update(),delete _e.afterLeave,Ce=void 0},$t(m);R==="in-out"&&L.type!==ys?_e.delayLeave=(Ge,ht,Dt)=>{const Ht=Ue(F,Ce);Ht[String(Ce.key)]=Ce,Ge[Hr]=()=>{ht(),Ge[Hr]=void 0,delete ae.delayedLeave,Ce=void 0},ae.delayedLeave=()=>{Dt(),delete ae.delayedLeave,Ce=void 0}}:Ce=void 0}else Ce&&(Ce=void 0);return m}}};function Lr(v){let b=v[0];if(v.length>1){let D=!1;for(const F of v)if(F.type!==ys){b=F,D=!0;break}}return b}const ps=gi;function Ue(v,b){const{leavingVNodes:D}=v;let F=D.get(b.type);return F||(F=Object.create(null),D.set(b.type,F)),F}function xt(v,b,D,F,c){const{appear:m,mode:E,persisted:R=!1,onBeforeEnter:L,onEnter:ae,onAfterEnter:Ce,onEnterCancelled:_e,onBeforeLeave:Ge,onLeave:ht,onAfterLeave:Dt,onLeaveCancelled:Ht,onBeforeAppear:tr,onAppear:cr,onAfterAppear:An,onAppearCancelled:lt}=b,Nt=String(v.key),At=Ue(D,v),vn=(Qt,dn)=>{Qt&&V(Qt,F,9,dn)},qn=(Qt,dn)=>{const ar=dn[1];vn(Qt,dn),(0,_.kJ)(Qt)?Qt.every(ai=>ai.length<=1)&&ar():Qt.length<=1&&ar()},hr={mode:E,persisted:R,beforeEnter(Qt){let dn=L;if(!D.isMounted)if(m)dn=tr||L;else return;Qt[Hr]&&Qt[Hr](!0);const ar=At[Nt];ar&&us(v,ar)&&ar.el[Hr]&&ar.el[Hr](),vn(dn,[Qt])},enter(Qt){let dn=ae,ar=Ce,ai=_e;if(!D.isMounted)if(m)dn=cr||ae,ar=An||Ce,ai=lt||_e;else return;let ti=!1;const Ei=Qt[Rr]=bs=>{ti||(ti=!0,bs?vn(ai,[Qt]):vn(ar,[Qt]),hr.delayedLeave&&hr.delayedLeave(),Qt[Rr]=void 0)};dn?qn(dn,[Qt,Ei]):Ei()},leave(Qt,dn){const ar=String(v.key);if(Qt[Rr]&&Qt[Rr](!0),D.isUnmounting)return dn();vn(Ge,[Qt]);let ai=!1;const ti=Qt[Hr]=Ei=>{ai||(ai=!0,dn(),Ei?vn(Ht,[Qt]):vn(Dt,[Qt]),Qt[Hr]=void 0,At[ar]===v&&delete At[ar])};At[ar]=v,ht?qn(ht,[Qt,ti]):ti()},clone(Qt){const dn=xt(Qt,b,D,F,c);return c&&c(dn),dn}};return hr}function $t(v){if(Cr(v))return v=Oa(v),v.children=null,v}function _n(v){if(!Cr(v))return as(v.type)&&v.children?Lr(v.children):v;if(v.component)return v.component.subTree;const{shapeFlag:b,children:D}=v;if(D){if(b&16)return D[0];if(b&32&&(0,_.mf)(D.default))return D.default()}}function Xr(v,b){v.shapeFlag&6&&v.component?(v.transition=b,Xr(v.component.subTree,b)):v.shapeFlag&128?(v.ssContent.transition=b.clone(v.ssContent),v.ssFallback.transition=b.clone(v.ssFallback)):v.transition=b}function Er(v,b=!1,D){let F=[],c=0;for(let m=0;m<v.length;m++){let E=v[m];const R=D==null?E.key:String(D)+String(E.key!=null?E.key:m);E.type===ui?(E.patchFlag&128&&c++,F=F.concat(Er(E.children,b,R))):(b||E.type!==ys)&&F.push(R!=null?Oa(E,{key:R}):E)}if(c>1)for(let m=0;m<F.length;m++)F[m].patchFlag=-2;return F}function Di(v,b){return(0,_.mf)(v)?(0,_.l7)({name:v.name},b,{setup:v}):v}function fi(){const v=al();return v?(v.appContext.config.idPrefix||"v")+"-"+v.ids[0]+v.ids[1]++:""}function fr(v){v.ids=[v.ids[0]+v.ids[2]+++"-",0,0]}const tl=new WeakSet;function li(v){const b=al(),D=(0,C.XI)(null);if(b){const c=b.refs===_.kT?b.refs={}:b.refs;let m;Object.defineProperty(c,v,{enumerable:!0,get:()=>D.value,set:E=>D.value=E})}return D}function Eo(v,b,D,F,c=!1){if((0,_.kJ)(v)){v.forEach((Dt,Ht)=>Eo(Dt,b&&((0,_.kJ)(b)?b[Ht]:b),D,F,c));return}if(Tn(F)&&!c){F.shapeFlag&512&&F.type.__asyncResolved&&F.component.subTree.component&&Eo(v,b,D,F.component.subTree);return}const m=F.shapeFlag&4?fc(F.component):F.el,E=c?null:m,{i:R,r:L}=v,ae=b&&b.r,Ce=R.refs===_.kT?R.refs={}:R.refs,_e=R.setupState,Ge=(0,C.IU)(_e),ht=_e===_.kT?()=>!1:Dt=>(0,_.RI)(Ge,Dt);if(ae!=null&&ae!==L&&((0,_.HD)(ae)?(Ce[ae]=null,ht(ae)&&(_e[ae]=null)):(0,C.dq)(ae)&&(ae.value=null)),(0,_.mf)(L))I(L,R,12,[E,Ce]);else{const Dt=(0,_.HD)(L),Ht=(0,C.dq)(L);if(Dt||Ht){const tr=()=>{if(v.f){const cr=Dt?ht(L)?_e[L]:Ce[L]:L.value;c?(0,_.kJ)(cr)&&(0,_.Od)(cr,m):(0,_.kJ)(cr)?cr.includes(m)||cr.push(m):Dt?(Ce[L]=[m],ht(L)&&(_e[L]=Ce[L])):(L.value=[m],v.k&&(Ce[v.k]=L.value))}else Dt?(Ce[L]=E,ht(L)&&(_e[L]=E)):Ht&&(L.value=E,v.k&&(Ce[v.k]=E))};E?(tr.id=-1,Ks(tr,D)):tr()}}}let Wn=!1;const vs=()=>{Wn||(console.error("Hydration completed but contains mismatches."),Wn=!0)},bl=v=>v.namespaceURI.includes("svg")&&v.tagName!=="foreignObject",xn=v=>v.namespaceURI.includes("MathML"),tn=v=>{if(v.nodeType===1){if(bl(v))return"svg";if(xn(v))return"mathml"}},Ko=v=>v.nodeType===8;function nl(v){const{mt:b,p:D,o:{patchProp:F,createText:c,nextSibling:m,parentNode:E,remove:R,insert:L,createComment:ae}}=v,Ce=(lt,Nt)=>{if(!Nt.hasChildNodes()){D(null,lt,Nt),jt(),Nt._vnode=lt;return}_e(Nt.firstChild,lt,null,null,null),jt(),Nt._vnode=lt},_e=(lt,Nt,At,vn,qn,hr=!1)=>{hr=hr||!!Nt.dynamicChildren;const Qt=Ko(lt)&&lt.data==="[",dn=()=>Ht(lt,Nt,At,vn,qn,Qt),{type:ar,ref:ai,shapeFlag:ti,patchFlag:Ei}=Nt;let bs=lt.nodeType;Nt.el=lt,Ei===-2&&(hr=!1,Nt.dynamicChildren=null);let $n=null;switch(ar){case da:bs!==3?Nt.children===""?(L(Nt.el=c(""),E(lt),lt),$n=lt):$n=dn():(lt.data!==Nt.children&&(vs(),lt.data=Nt.children),$n=m(lt));break;case ys:An(lt)?($n=m(lt),cr(Nt.el=lt.content.firstChild,lt,At)):bs!==8||Qt?$n=dn():$n=m(lt);break;case Ll:if(Qt&&(lt=m(lt),bs=lt.nodeType),bs===1||bs===3){$n=lt;const ni=!Nt.children.length;for(let lr=0;lr<Nt.staticCount;lr++)ni&&(Nt.children+=$n.nodeType===1?$n.outerHTML:$n.data),lr===Nt.staticCount-1&&(Nt.anchor=$n),$n=m($n);return Qt?m($n):$n}else dn();break;case ui:Qt?$n=Dt(lt,Nt,At,vn,qn,hr):$n=dn();break;default:if(ti&1)(bs!==1||Nt.type.toLowerCase()!==lt.tagName.toLowerCase())&&!An(lt)?$n=dn():$n=Ge(lt,Nt,At,vn,qn,hr);else if(ti&6){Nt.slotScopeIds=qn;const ni=E(lt);if(Qt?$n=tr(lt):Ko(lt)&&lt.data==="teleport start"?$n=tr(lt,lt.data,"teleport end"):$n=m(lt),b(Nt,ni,null,At,vn,tn(ni),hr),Tn(Nt)&&!Nt.type.__asyncResolved){let lr;Qt?(lr=cs(ui),lr.anchor=$n?$n.previousSibling:ni.lastChild):lr=lt.nodeType===3?fa(""):cs("div"),lr.el=lt,Nt.component.subTree=lr}}else ti&64?bs!==8?$n=dn():$n=Nt.type.hydrate(lt,Nt,At,vn,qn,hr,v,ht):ti&128&&($n=Nt.type.hydrate(lt,Nt,At,vn,tn(E(lt)),qn,hr,v,_e))}return ai!=null&&Eo(ai,null,vn,Nt),$n},Ge=(lt,Nt,At,vn,qn,hr)=>{hr=hr||!!Nt.dynamicChildren;const{type:Qt,props:dn,patchFlag:ar,shapeFlag:ai,dirs:ti,transition:Ei}=Nt,bs=Qt==="input"||Qt==="option";if(bs||ar!==-1){ti&&Mr(Nt,null,At,"created");let $n=!1;if(An(lt)){$n=tf(null,Ei)&&At&&At.vnode.props&&At.vnode.props.appear;const lr=lt.content.firstChild;if($n){const Ls=lr.getAttribute("class");Ls&&(lr.$cls=Ls),Ei.beforeEnter(lr)}cr(lr,lt,At),Nt.el=lt=lr}if(ai&16&&!(dn&&(dn.innerHTML||dn.textContent))){let lr=ht(lt.firstChild,Nt,lt,At,vn,qn,hr),Ls=!1;for(;lr;){O(lt,1)||vs();const Tu=lr;lr=lr.nextSibling,R(Tu)}}else if(ai&8){let lr=Nt.children;lr[0]===`
`&&(lt.tagName==="PRE"||lt.tagName==="TEXTAREA")&&(lr=lr.slice(1)),lt.textContent!==lr&&(O(lt,0)||vs(),lt.textContent=Nt.children)}if(dn){if(bs||!hr||ar&48){const lr=lt.tagName.includes("-");for(const Ls in dn)(bs&&(Ls.endsWith("value")||Ls==="indeterminate")||(0,_.F7)(Ls)&&!(0,_.Gg)(Ls)||Ls[0]==="."||lr)&&F(lt,Ls,null,dn[Ls],void 0,At)}else if(dn.onClick)F(lt,"onClick",null,dn.onClick,void 0,At);else if(ar&4&&(0,C.PG)(dn.style))for(const lr in dn.style)dn.style[lr]}let ni;(ni=dn&&dn.onVnodeBeforeMount)&&Ss(ni,At,Nt),ti&&Mr(Nt,null,At,"beforeMount"),((ni=dn&&dn.onVnodeMounted)||ti||$n)&&Wo(()=>{ni&&Ss(ni,At,Nt),$n&&Ei.enter(lt),ti&&Mr(Nt,null,At,"mounted")},vn)}return lt.nextSibling},ht=(lt,Nt,At,vn,qn,hr,Qt)=>{Qt=Qt||!!Nt.dynamicChildren;const dn=Nt.children,ar=dn.length;let ai=!1;for(let ti=0;ti<ar;ti++){const Ei=Qt?dn[ti]:dn[ti]=Ar(dn[ti]),bs=Ei.type===da;lt?(bs&&!Qt&&ti+1<ar&&Ar(dn[ti+1]).type===da&&(L(c(lt.data.slice(Ei.children.length)),At,m(lt)),lt.data=Ei.children),lt=_e(lt,Ei,vn,qn,hr,Qt)):bs&&!Ei.children?L(Ei.el=c(""),At):(O(At,1)||vs(),D(null,Ei,At,null,vn,qn,tn(At),hr))}return lt},Dt=(lt,Nt,At,vn,qn,hr)=>{const{slotScopeIds:Qt}=Nt;Qt&&(qn=qn?qn.concat(Qt):Qt);const dn=E(lt),ar=ht(m(lt),Nt,dn,At,vn,qn,hr);return ar&&Ko(ar)&&ar.data==="]"?m(Nt.anchor=ar):(vs(),L(Nt.anchor=ae("]"),dn,ar),ar)},Ht=(lt,Nt,At,vn,qn,hr)=>{if(O(lt.parentElement,1)||vs(),Nt.el=null,hr){const ar=tr(lt);for(;;){const ai=m(lt);if(ai&&ai!==ar)R(ai);else break}}const Qt=m(lt),dn=E(lt);return R(lt),D(null,Nt,dn,Qt,At,vn,tn(dn),qn),At&&(At.vnode.el=Nt.el,Fc(At,Nt.el)),Qt},tr=(lt,Nt="[",At="]")=>{let vn=0;for(;lt;)if(lt=m(lt),lt&&Ko(lt)&&(lt.data===Nt&&vn++,lt.data===At)){if(vn===0)return m(lt);vn--}return lt},cr=(lt,Nt,At)=>{const vn=Nt.parentNode;vn&&vn.replaceChild(lt,Nt);let qn=At;for(;qn;)qn.vnode.el===Nt&&(qn.vnode.el=qn.subTree.el=lt),qn=qn.parent},An=lt=>lt.nodeType===1&&lt.tagName==="TEMPLATE";return[Ce,_e]}function lo(v,b,D,F,c){let m,E,R,L;if(b==="class")v.$cls?(R=v.$cls,delete v.$cls):R=v.getAttribute("class"),L=normalizeClass(D),Yi(xs(R||""),xs(L))||(m=2,E="class");else if(b==="style"){R=v.getAttribute("style")||"",L=isString(D)?D:stringifyStyle(normalizeStyle(D));const ae=ya(R),Ce=ya(L);if(F.dirs)for(const{dir:_e,value:Ge}of F.dirs)_e.name==="show"&&!Ge&&Ce.set("display","none");c&&ls(c,F,Ce),ka(ae,Ce)||(m=3,E="style")}else(v instanceof SVGElement&&isKnownSvgAttr(b)||v instanceof HTMLElement&&(isBooleanAttr(b)||isKnownHtmlAttr(b)))&&(isBooleanAttr(b)?(R=v.hasAttribute(b),L=includeBooleanAttr(D)):D==null?(R=v.hasAttribute(b),L=!1):(v.hasAttribute(b)?R=v.getAttribute(b):b==="value"&&v.tagName==="TEXTAREA"?R=v.value:R=!1,L=isRenderableAttrValue(D)?String(D):!1),R!==L&&(m=4,E=b));if(m!=null&&!O(v,m)){const ae=Ge=>Ge===!1?"(not rendered)":`${E}="${Ge}"`,Ce=`Hydration ${se[m]} mismatch on`,_e=`
  - rendered on server: ${ae(R)}
  - expected on client: ${ae(L)}
  Note: this mismatch is check-only. The DOM will not be rectified in production due to performance overhead.
  You should fix the source of the mismatch.`;return X(Ce,v,_e),!0}return!1}function xs(v){return new Set(v.trim().split(/\s+/))}function Yi(v,b){if(v.size!==b.size)return!1;for(const D of v)if(!b.has(D))return!1;return!0}function ya(v){const b=new Map;for(const D of v.split(";")){let[F,c]=D.split(":");F=F.trim(),c=c&&c.trim(),F&&c&&b.set(F,c)}return b}function ka(v,b){if(v.size!==b.size)return!1;for(const[D,F]of v)if(F!==b.get(D))return!1;return!0}function ls(v,b,D){const F=v.subTree;if(v.getCssVars&&(b===F||F&&F.type===ui&&F.children.includes(b))){const c=v.getCssVars();for(const m in c)D.set(`--${getEscapedCssVarName(m,!1)}`,String(c[m]))}b===F&&v.parent&&ls(v.parent,v.vnode,D)}const dr="data-allow-mismatch",se={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function O(v,b){if(b===0||b===1)for(;v&&!v.hasAttribute(dr);)v=v.parentElement;const D=v&&v.getAttribute(dr);if(D==null)return!1;if(D==="")return!0;{const F=D.split(",");return b===0&&F.includes("children")?!0:F.includes(se[b])}}const x=(0,_.E9)().requestIdleCallback||(v=>setTimeout(v,1)),re=(0,_.E9)().cancelIdleCallback||(v=>clearTimeout(v)),he=(v=1e4)=>b=>{const D=x(b,{timeout:v});return()=>re(D)};function Me(v){const{top:b,left:D,bottom:F,right:c}=v.getBoundingClientRect(),{innerHeight:m,innerWidth:E}=window;return(b>0&&b<m||F>0&&F<m)&&(D>0&&D<E||c>0&&c<E)}const Xe=v=>(b,D)=>{const F=new IntersectionObserver(c=>{for(const m of c)if(m.isIntersecting){F.disconnect(),b();break}},v);return D(c=>{if(c instanceof Element){if(Me(c))return b(),F.disconnect(),!1;F.observe(c)}}),()=>F.disconnect()},nt=v=>b=>{if(v){const D=matchMedia(v);if(D.matches)b();else return D.addEventListener("change",b,{once:!0}),()=>D.removeEventListener("change",b)}},Tt=(v=[])=>(b,D)=>{(0,_.HD)(v)&&(v=[v]);let F=!1;const c=E=>{F||(F=!0,m(),b(),E.target.dispatchEvent(new E.constructor(E.type,E)))},m=()=>{D(E=>{for(const R of v)E.removeEventListener(R,c)})};return D(E=>{for(const R of v)E.addEventListener(R,c,{once:!0})}),m};function En(v,b){if(Ko(v)&&v.data==="["){let D=1,F=v.nextSibling;for(;F;){if(F.nodeType===1){if(b(F)===!1)break}else if(Ko(F))if(F.data==="]"){if(--D===0)break}else F.data==="["&&D++;F=F.nextSibling}}else b(v)}const Tn=v=>!!v.type.__asyncLoader;function pn(v){(0,_.mf)(v)&&(v={loader:v});const{loader:b,loadingComponent:D,errorComponent:F,delay:c=200,hydrate:m,timeout:E,suspensible:R=!0,onError:L}=v;let ae=null,Ce,_e=0;const Ge=()=>(_e++,ae=null,ht()),ht=()=>{let Dt;return ae||(Dt=ae=b().catch(Ht=>{if(Ht=Ht instanceof Error?Ht:new Error(String(Ht)),L)return new Promise((tr,cr)=>{L(Ht,()=>tr(Ge()),()=>cr(Ht),_e+1)});throw Ht}).then(Ht=>Dt!==ae&&ae?ae:(Ht&&(Ht.__esModule||Ht[Symbol.toStringTag]==="Module")&&(Ht=Ht.default),Ce=Ht,Ht)))};return Di({name:"AsyncComponentWrapper",__asyncLoader:ht,__asyncHydrate(Dt,Ht,tr){let cr=!1;const An=m?()=>{const Nt=m(()=>{tr()},At=>En(Dt,At));Nt&&(Ht.bum||(Ht.bum=[])).push(Nt),(Ht.u||(Ht.u=[])).push(()=>cr=!0)}:tr;Ce?An():ht().then(()=>!Ht.isUnmounted&&An())},get __asyncResolved(){return Ce},setup(){const Dt=Bi;if(fr(Dt),Ce)return()=>vr(Ce,Dt);const Ht=lt=>{ae=null,q(lt,Dt,13,!F)};if(R&&Dt.suspense||tu)return ht().then(lt=>()=>vr(lt,Dt)).catch(lt=>(Ht(lt),()=>F?cs(F,{error:lt}):null));const tr=(0,C.iH)(!1),cr=(0,C.iH)(),An=(0,C.iH)(!!c);return c&&setTimeout(()=>{An.value=!1},c),E!=null&&setTimeout(()=>{if(!tr.value&&!cr.value){const lt=new Error(`Async component timed out after ${E}ms.`);Ht(lt),cr.value=lt}},E),ht().then(()=>{tr.value=!0,Dt.parent&&Cr(Dt.parent.vnode)&&Dt.parent.update()}).catch(lt=>{Ht(lt),cr.value=lt}),()=>{if(tr.value&&Ce)return vr(Ce,Dt);if(cr.value&&F)return cs(F,{error:cr.value});if(D&&!An.value)return cs(D)}}})}function vr(v,b){const{ref:D,props:F,children:c,ce:m}=b.vnode,E=cs(v,F,c);return E.ref=D,E.ce=m,delete b.vnode.ce,E}const Cr=v=>v.type.__isKeepAlive,Gi={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(v,{slots:b}){const D=al(),F=D.ctx;if(!F.renderer)return()=>{const An=b.default&&b.default();return An&&An.length===1?An[0]:An};const c=new Map,m=new Set;let E=null;const R=D.suspense,{renderer:{p:L,m:ae,um:Ce,o:{createElement:_e}}}=F,Ge=_e("div");F.activate=(An,lt,Nt,At,vn)=>{const qn=An.component;ae(An,lt,Nt,0,R),L(qn.vnode,An,lt,Nt,qn,R,At,An.slotScopeIds,vn),Ks(()=>{qn.isDeactivated=!1,qn.a&&(0,_.ir)(qn.a);const hr=An.props&&An.props.onVnodeMounted;hr&&Ss(hr,qn.parent,An)},R)},F.deactivate=An=>{const lt=An.component;xr(lt.m),xr(lt.a),ae(An,Ge,null,1,R),Ks(()=>{lt.da&&(0,_.ir)(lt.da);const Nt=An.props&&An.props.onVnodeUnmounted;Nt&&Ss(Nt,lt.parent,An),lt.isDeactivated=!0},R)};function ht(An){Yn(An),Ce(An,D,R,!0)}function Dt(An){c.forEach((lt,Nt)=>{const At=Bc(lt.type);At&&!An(At)&&Ht(Nt)})}function Ht(An){const lt=c.get(An);lt&&(!E||!us(lt,E))?ht(lt):E&&Yn(E),c.delete(An),m.delete(An)}Dc(()=>[v.include,v.exclude],([An,lt])=>{An&&Dt(Nt=>As(An,Nt)),lt&&Dt(Nt=>!As(lt,Nt))},{flush:"post",deep:!0});let tr=null;const cr=()=>{tr!=null&&($s(D.subTree.type)?Ks(()=>{c.set(tr,Us(D.subTree))},D.subTree.suspense):c.set(tr,Us(D.subTree)))};return Si(cr),El(cr),or(()=>{c.forEach(An=>{const{subTree:lt,suspense:Nt}=D,At=Us(lt);if(An.type===At.type&&An.key===At.key){Yn(At);const vn=At.component.da;vn&&Ks(vn,Nt);return}ht(An)})}),()=>{if(tr=null,!b.default)return E=null;const An=b.default(),lt=An[0];if(An.length>1)return E=null,An;if(!bi(lt)||!(lt.shapeFlag&4)&&!(lt.shapeFlag&128))return E=null,lt;let Nt=Us(lt);if(Nt.type===ys)return E=null,Nt;const At=Nt.type,vn=Bc(Tn(Nt)?Nt.type.__asyncResolved||{}:At),{include:qn,exclude:hr,max:Qt}=v;if(qn&&(!vn||!As(qn,vn))||hr&&vn&&As(hr,vn))return Nt.shapeFlag&=-257,E=Nt,lt;const dn=Nt.key==null?At:Nt.key,ar=c.get(dn);return Nt.el&&(Nt=Oa(Nt),lt.shapeFlag&128&&(lt.ssContent=Nt)),tr=dn,ar?(Nt.el=ar.el,Nt.component=ar.component,Nt.transition&&Xr(Nt,Nt.transition),Nt.shapeFlag|=512,m.delete(dn),m.add(dn)):(m.add(dn),Qt&&m.size>parseInt(Qt,10)&&Ht(m.values().next().value)),Nt.shapeFlag|=256,E=Nt,$s(lt.type)?lt:Nt}}};function As(v,b){return(0,_.kJ)(v)?v.some(D=>As(D,b)):(0,_.HD)(v)?v.split(",").includes(b):(0,_.Kj)(v)?(v.lastIndex=0,v.test(b)):!1}function Ro(v,b){fe(v,"a",b)}function Ns(v,b){fe(v,"da",b)}function fe(v,b,D=Bi){const F=v.__wdc||(v.__wdc=()=>{let c=D;for(;c;){if(c.isDeactivated)return;c=c.parent}return v()});if(To(b,F,D),D){let c=D.parent;for(;c&&c.parent;)Cr(c.parent.vnode)&&Do(F,b,D,c),c=c.parent}}function Do(v,b,D,F){const c=To(b,v,F,!0);Ts(()=>{(0,_.Od)(F[b],c)},D)}function Yn(v){v.shapeFlag&=-257,v.shapeFlag&=-513}function Us(v){return v.shapeFlag&128?v.ssContent:v}function To(v,b,D=Bi,F=!1){if(D){const c=D[v]||(D[v]=[]),m=b.__weh||(b.__weh=(...E)=>{(0,C.Jd)();const R=ns(D),L=V(b,D,v,E);return R(),(0,C.lk)(),L});return F?c.unshift(m):c.push(m),m}}const qs=v=>(b,D=Bi)=>{(!tu||v==="sp")&&To(v,(...F)=>b(...F),D)},Zu=qs("bm"),Si=qs("m"),Sa=qs("bu"),El=qs("u"),or=qs("bum"),Ts=qs("um"),ua=qs("sp"),rl=qs("rtg"),mu=qs("rtc");function zs(v,b=Bi){To("ec",v,b)}const ws="components",Yo="directives";function Go(v,b){return Ho(ws,v,!0,b)||v}const Mo=Symbol.for("v-ndc");function Rl(v){return(0,_.HD)(v)?Ho(ws,v,!1)||v:v||Mo}function Va(v){return Ho(Yo,v)}function Ho(v,b,D=!0,F=!1){const c=Ln||Bi;if(c){const m=c.type;if(v===ws){const R=Bc(m,!1);if(R&&(R===b||R===(0,_._A)(b)||R===(0,_.kC)((0,_._A)(b))))return m}const E=Ju(c[v]||m[v],b)||Ju(c.appContext[v],b);return!E&&F?m:E}}function Ju(v,b){return v&&(v[b]||v[(0,_._A)(b)]||v[(0,_.kC)((0,_._A)(b))])}function pu(v,b,D,F){let c;const m=D&&D[F],E=(0,_.kJ)(v);if(E||(0,_.HD)(v)){const R=E&&(0,C.PG)(v);let L=!1,ae=!1;R&&(L=!(0,C.yT)(v),ae=(0,C.$y)(v),v=(0,C.XB)(v)),c=new Array(v.length);for(let Ce=0,_e=v.length;Ce<_e;Ce++)c[Ce]=b(L?ae?(0,C.BX)((0,C.YL)(v[Ce])):(0,C.YL)(v[Ce]):v[Ce],Ce,void 0,m&&m[Ce])}else if(typeof v=="number"){c=new Array(v);for(let R=0;R<v;R++)c[R]=b(R+1,R,void 0,m&&m[R])}else if((0,_.Kn)(v))if(v[Symbol.iterator])c=Array.from(v,(R,L)=>b(R,L,void 0,m&&m[L]));else{const R=Object.keys(v);c=new Array(R.length);for(let L=0,ae=R.length;L<ae;L++){const Ce=R[L];c[L]=b(v[Ce],Ce,L,m&&m[L])}}else c=[];return D&&(D[F]=c),c}function Lo(v,b){for(let D=0;D<b.length;D++){const F=b[D];if((0,_.kJ)(F))for(let c=0;c<F.length;c++)v[F[c].name]=F[c].fn;else F&&(v[F.name]=F.key?(...c)=>{const m=F.fn(...c);return m&&(m.key=F.key),m}:F.fn)}return v}function Fr(v,b,D={},F,c){if(Ln.ce||Ln.parent&&Tn(Ln.parent)&&Ln.parent.ce)return b!=="default"&&(D.name=b),ac(),ho(ui,null,[cs("slot",D,F&&F())],64);let m=v[b];m&&m._c&&(m._d=!1),ac();const E=m&&Gn(m(D)),R=D.key||E&&E.key,L=ho(ui,{key:(R&&!(0,_.yk)(R)?R:`_${b}`)+(!E&&F?"_fb":"")},E||(F?F():[]),E&&v._===1?64:-2);return!c&&L.scopeId&&(L.slotScopeIds=[L.scopeId+"-s"]),m&&m._c&&(m._d=!0),L}function Gn(v){return v.some(b=>bi(b)?!(b.type===ys||b.type===ui&&!Gn(b.children)):!0)?v:null}function je(v,b){const D={};for(const F in v)D[b&&/[A-Z]/.test(F)?`on:${F}`:(0,_.hR)(F)]=v[F];return D}const Wt=v=>v?eu(v)?fc(v):Wt(v.parent):null,Pn=(0,_.l7)(Object.create(null),{$:v=>v,$el:v=>v.vnode.el,$data:v=>v.data,$props:v=>v.props,$attrs:v=>v.attrs,$slots:v=>v.slots,$refs:v=>v.refs,$parent:v=>Wt(v.parent),$root:v=>Wt(v.root),$host:v=>v.ce,$emit:v=>v.emit,$options:v=>Ea(v),$forceUpdate:v=>v.f||(v.f=()=>{ze(v.update)}),$nextTick:v=>v.n||(v.n=Oe.bind(v.proxy)),$watch:v=>cm.bind(v)}),Hi=v=>v==="_"||v==="$",es=(v,b)=>v!==_.kT&&!v.__isScriptSetup&&(0,_.RI)(v,b),_i={get({_:v},b){if(b==="__v_skip")return!0;const{ctx:D,setupState:F,data:c,props:m,accessCache:E,type:R,appContext:L}=v;let ae;if(b[0]!=="$"){const ht=E[b];if(ht!==void 0)switch(ht){case 1:return F[b];case 2:return c[b];case 4:return D[b];case 3:return m[b]}else{if(es(F,b))return E[b]=1,F[b];if(c!==_.kT&&(0,_.RI)(c,b))return E[b]=2,c[b];if((ae=v.propsOptions[0])&&(0,_.RI)(ae,b))return E[b]=3,m[b];if(D!==_.kT&&(0,_.RI)(D,b))return E[b]=4,D[b];lh&&(E[b]=0)}}const Ce=Pn[b];let _e,Ge;if(Ce)return b==="$attrs"&&(0,C.j)(v.attrs,"get",""),Ce(v);if((_e=R.__cssModules)&&(_e=_e[b]))return _e;if(D!==_.kT&&(0,_.RI)(D,b))return E[b]=4,D[b];if(Ge=L.config.globalProperties,(0,_.RI)(Ge,b))return Ge[b]},set({_:v},b,D){const{data:F,setupState:c,ctx:m}=v;return es(c,b)?(c[b]=D,!0):F!==_.kT&&(0,_.RI)(F,b)?(F[b]=D,!0):(0,_.RI)(v.props,b)||b[0]==="$"&&b.slice(1)in v?!1:(m[b]=D,!0)},has({_:{data:v,setupState:b,accessCache:D,ctx:F,appContext:c,propsOptions:m}},E){let R;return!!D[E]||v!==_.kT&&(0,_.RI)(v,E)||es(b,E)||(R=m[0])&&(0,_.RI)(R,E)||(0,_.RI)(F,E)||(0,_.RI)(Pn,E)||(0,_.RI)(c.config.globalProperties,E)},defineProperty(v,b,D){return D.get!=null?v._.accessCache[b]=0:(0,_.RI)(D,"value")&&this.set(v,b,D.value,null),Reflect.defineProperty(v,b,D)}},Li=(0,_.l7)({},_i,{get(v,b){if(b!==Symbol.unscopables)return _i.get(v,b,v)},has(v,b){return b[0]!=="_"&&!(0,_.yl)(b)}});function _a(v){const b={};return Object.defineProperty(b,"_",{configurable:!0,enumerable:!1,get:()=>v}),Object.keys(Pn).forEach(D=>{Object.defineProperty(b,D,{configurable:!0,enumerable:!1,get:()=>Pn[D](v),set:NOOP})}),b}function Tl(v){const{ctx:b,propsOptions:[D]}=v;D&&Object.keys(D).forEach(F=>{Object.defineProperty(b,F,{enumerable:!0,configurable:!0,get:()=>v.props[F],set:NOOP})})}function ba(v){const{ctx:b,setupState:D}=v;Object.keys(toRaw(D)).forEach(F=>{if(!D.__isScriptSetup){if(Hi(F[0])){X(`setup() return property ${JSON.stringify(F)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(b,F,{enumerable:!0,configurable:!0,get:()=>D[F],set:NOOP})}})}const uo=v=>X(`${v}() is a compiler-hint helper that is only usable inside <script setup> of a single file component. Its arguments should be compiled away and passing it at runtime has no effect.`);function Ml(){return null}function vu(){return null}function Oc(v){}function Zf(v){}function Ic(){return null}function ah(){}function Jf(v,b){return null}function Kd(){return $o().slots}function Pc(){return $o().attrs}function $o(){const v=al();return v.setupContext||(v.setupContext=ll(v))}function xc(v){return(0,_.kJ)(v)?v.reduce((b,D)=>(b[D]=null,b),{}):v}function Yd(v,b){const D=xc(v);for(const F in b){if(F.startsWith("__skip"))continue;let c=D[F];c?(0,_.kJ)(c)||(0,_.mf)(c)?c=D[F]={type:c,default:b[F]}:c.default=b[F]:c===null&&(c=D[F]={default:b[F]}),c&&b[`__skip_${F}`]&&(c.skipFactory=!0)}return D}function rd(v,b){return!v||!b?v||b:(0,_.kJ)(v)&&(0,_.kJ)(b)?v.concat(b):(0,_.l7)({},xc(v),xc(b))}function Gd(v,b){const D={};for(const F in v)b.includes(F)||Object.defineProperty(D,F,{enumerable:!0,get:()=>v[F]});return D}function Qf(v){const b=al();let D=v();return cc(),(0,_.tI)(D)&&(D=D.catch(F=>{throw ns(b),F})),[D,()=>ns(b)]}function qf(){const v=Object.create(null);return(b,D)=>{v[D]?X(`${b} property "${D}" is already defined in ${v[D]}.`):v[D]=b}}let lh=!0;function Cu(v){const b=Ea(v),D=v.proxy,F=v.ctx;lh=!1,b.beforeCreate&&Ol(b.beforeCreate,v,"bc");const{data:c,computed:m,methods:E,watch:R,provide:L,inject:ae,created:Ce,beforeMount:_e,mounted:Ge,beforeUpdate:ht,updated:Dt,activated:Ht,deactivated:tr,beforeDestroy:cr,beforeUnmount:An,destroyed:lt,unmounted:Nt,render:At,renderTracked:vn,renderTriggered:qn,errorCaptured:hr,serverPrefetch:Qt,expose:dn,inheritAttrs:ar,components:ai,directives:ti,filters:Ei}=b;if(ae&&eg(ae,F,null),E)for(const ni in E){const lr=E[ni];(0,_.mf)(lr)&&(F[ni]=lr.bind(D))}if(c){const ni=c.call(D,D);(0,_.Kn)(ni)&&(v.data=(0,C.qj)(ni))}if(lh=!0,m)for(const ni in m){const lr=m[ni],Ls=(0,_.mf)(lr)?lr.bind(D,D):(0,_.mf)(lr.get)?lr.get.bind(D,D):_.dG,Tu=!(0,_.mf)(lr)&&(0,_.mf)(lr.set)?lr.set.bind(D):_.dG,kc=Ru({get:Ls,set:Tu});Object.defineProperty(F,ni,{enumerable:!0,configurable:!0,get:()=>kc.value,set:ri=>kc.value=ri})}if(R)for(const ni in R)ja(R[ni],F,D,ni);if(L){const ni=(0,_.mf)(L)?L.call(D):L;Reflect.ownKeys(ni).forEach(lr=>{$l(lr,ni[lr])})}Ce&&Ol(Ce,v,"c");function $n(ni,lr){(0,_.kJ)(lr)?lr.forEach(Ls=>ni(Ls.bind(D))):lr&&ni(lr.bind(D))}if($n(Zu,_e),$n(Si,Ge),$n(Sa,ht),$n(El,Dt),$n(Ro,Ht),$n(Ns,tr),$n(zs,hr),$n(mu,vn),$n(rl,qn),$n(or,An),$n(Ts,Nt),$n(ua,Qt),(0,_.kJ)(dn))if(dn.length){const ni=v.exposed||(v.exposed={});dn.forEach(lr=>{Object.defineProperty(ni,lr,{get:()=>D[lr],set:Ls=>D[lr]=Ls})})}else v.exposed||(v.exposed={});At&&v.render===_.dG&&(v.render=At),ar!=null&&(v.inheritAttrs=ar),ai&&(v.components=ai),ti&&(v.directives=ti),Qt&&fr(v)}function eg(v,b,D=_.dG){(0,_.kJ)(v)&&(v=uh(v));for(const F in v){const c=v[F];let m;(0,_.Kn)(c)?"default"in c?m=Io(c.from||F,c.default,!0):m=Io(c.from||F):m=Io(c),(0,C.dq)(m)?Object.defineProperty(b,F,{enumerable:!0,configurable:!0,get:()=>m.value,set:E=>m.value=E}):b[F]=m}}function Ol(v,b,D){V((0,_.kJ)(v)?v.map(F=>F.bind(b.proxy)):v.bind(b.proxy),b,D)}function ja(v,b,D,F){let c=F.includes(".")?za(D,F):()=>D[F];if((0,_.HD)(v)){const m=b[v];(0,_.mf)(m)&&Dc(c,m)}else if((0,_.mf)(v))Dc(c,v.bind(D));else if((0,_.Kn)(v))if((0,_.kJ)(v))v.forEach(m=>ja(m,b,D,F));else{const m=(0,_.mf)(v.handler)?v.handler.bind(D):b[v.handler];(0,_.mf)(m)&&Dc(c,m,v)}}function Ea(v){const b=v.type,{mixins:D,extends:F}=b,{mixins:c,optionsCache:m,config:{optionMergeStrategies:E}}=v.appContext,R=m.get(b);let L;return R?L=R:!c.length&&!D&&!F?L=b:(L={},c.length&&c.forEach(ae=>Ra(L,ae,E,!0)),Ra(L,b,E)),(0,_.Kn)(b)&&m.set(b,L),L}function Ra(v,b,D,F=!1){const{mixins:c,extends:m}=b;m&&Ra(v,m,D,!0),c&&c.forEach(E=>Ra(v,E,D,!0));for(const E in b)if(!(F&&E==="expose")){const R=tg[E]||D&&D[E];v[E]=R?R(v[E],b[E]):b[E]}return v}const tg={data:id,props:Ii,emits:Ii,methods:wu,computed:wu,beforeCreate:Oo,created:Oo,beforeMount:Oo,mounted:Oo,beforeUpdate:Oo,updated:Oo,beforeDestroy:Oo,beforeUnmount:Oo,destroyed:Oo,unmounted:Oo,activated:Oo,deactivated:Oo,errorCaptured:Oo,serverPrefetch:Oo,components:wu,directives:wu,watch:ng,provide:id,inject:Il};function id(v,b){return b?v?function(){return(0,_.l7)((0,_.mf)(v)?v.call(this,this):v,(0,_.mf)(b)?b.call(this,this):b)}:b:v}function Il(v,b){return wu(uh(v),uh(b))}function uh(v){if((0,_.kJ)(v)){const b={};for(let D=0;D<v.length;D++)b[v[D]]=v[D];return b}return v}function Oo(v,b){return v?[...new Set([].concat(v,b))]:b}function wu(v,b){return v?(0,_.l7)(Object.create(null),v,b):b}function Ii(v,b){return v?(0,_.kJ)(v)&&(0,_.kJ)(b)?[...new Set([...v,...b])]:(0,_.l7)(Object.create(null),xc(v),xc(b!=null?b:{})):b}function ng(v,b){if(!v)return b;if(!b)return v;const D=(0,_.l7)(Object.create(null),v);for(const F in b)D[F]=Oo(v[F],b[F]);return D}function eo(){return{app:null,config:{isNativeTag:_.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $d=0;function rg(v,b){return function(F,c=null){(0,_.mf)(F)||(F=(0,_.l7)({},F)),c!=null&&!(0,_.Kn)(c)&&(c=null);const m=eo(),E=new WeakSet,R=[];let L=!1;const ae=m.app={_uid:$d++,_component:F,_props:c,_container:null,_context:m,_instance:null,version:xa,get config(){return m.config},set config(Ce){},use(Ce,..._e){return E.has(Ce)||(Ce&&(0,_.mf)(Ce.install)?(E.add(Ce),Ce.install(ae,..._e)):(0,_.mf)(Ce)&&(E.add(Ce),Ce(ae,..._e))),ae},mixin(Ce){return m.mixins.includes(Ce)||m.mixins.push(Ce),ae},component(Ce,_e){return _e?(m.components[Ce]=_e,ae):m.components[Ce]},directive(Ce,_e){return _e?(m.directives[Ce]=_e,ae):m.directives[Ce]},mount(Ce,_e,Ge){if(!L){const ht=ae._ceVNode||cs(F,c);return ht.appContext=m,Ge===!0?Ge="svg":Ge===!1&&(Ge=void 0),_e&&b?b(ht,Ce):v(ht,Ce,Ge),L=!0,ae._container=Ce,Ce.__vue_app__=ae,fc(ht.component)}},onUnmount(Ce){R.push(Ce)},unmount(){L&&(V(R,ae._instance,16),v(null,ae._container),delete ae._container.__vue_app__)},provide(Ce,_e){return m.provides[Ce]=_e,ae},runWithContext(Ce){const _e=yu;yu=ae;try{return Ce()}finally{yu=_e}}};return ae}}let yu=null;function $l(v,b){if(Bi){let D=Bi.provides;const F=Bi.parent&&Bi.parent.provides;F===D&&(D=Bi.provides=Object.create(F)),D[v]=b}}function Io(v,b,D=!1){const F=Bi||Ln;if(F||yu){let c=yu?yu._context.provides:F?F.parent==null||F.ce?F.vnode.appContext&&F.vnode.appContext.provides:F.parent.provides:void 0;if(c&&v in c)return c[v];if(arguments.length>1)return D&&(0,_.mf)(b)?b.call(F&&F.proxy):b}}function Xd(){return!!(Bi||Ln||yu)}const ch={},Qu=()=>Object.create(ch),Fi=v=>Object.getPrototypeOf(v)===ch;function qu(v,b,D,F=!1){const c={},m=Qu();v.propsDefaults=Object.create(null),Ac(v,b,c,m);for(const E in v.propsOptions[0])E in c||(c[E]=void 0);D?v.props=F?c:(0,C.Um)(c):v.type.props?v.props=c:v.props=m,v.attrs=m}function Xl(v){for(;v;){if(v.type.__hmrId)return!0;v=v.parent}}function Rn(v,b,D,F){const{props:c,attrs:m,vnode:{patchFlag:E}}=v,R=(0,C.IU)(c),[L]=v.propsOptions;let ae=!1;if((F||E>0)&&!(E&16)){if(E&8){const Ce=v.vnode.dynamicProps;for(let _e=0;_e<Ce.length;_e++){let Ge=Ce[_e];if(Qo(v.emitsOptions,Ge))continue;const ht=b[Ge];if(L)if((0,_.RI)(m,Ge))ht!==m[Ge]&&(m[Ge]=ht,ae=!0);else{const Dt=(0,_._A)(Ge);c[Dt]=Nc(L,R,Dt,ht,v,!1)}else ht!==m[Ge]&&(m[Ge]=ht,ae=!0)}}}else{Ac(v,b,c,m)&&(ae=!0);let Ce;for(const _e in R)(!b||!(0,_.RI)(b,_e)&&((Ce=(0,_.rs)(_e))===_e||!(0,_.RI)(b,Ce)))&&(L?D&&(D[_e]!==void 0||D[Ce]!==void 0)&&(c[_e]=Nc(L,R,_e,void 0,v,!0)):delete c[_e]);if(m!==R)for(const _e in m)(!b||!(0,_.RI)(b,_e))&&(delete m[_e],ae=!0)}ae&&(0,C.X$)(v.attrs,"set","")}function Ac(v,b,D,F){const[c,m]=v.propsOptions;let E=!1,R;if(b)for(let L in b){if((0,_.Gg)(L))continue;const ae=b[L];let Ce;c&&(0,_.RI)(c,Ce=(0,_._A)(L))?!m||!m.includes(Ce)?D[Ce]=ae:(R||(R={}))[Ce]=ae:Qo(v.emitsOptions,L)||(!(L in F)||ae!==F[L])&&(F[L]=ae,E=!0)}if(m){const L=(0,C.IU)(D),ae=R||_.kT;for(let Ce=0;Ce<m.length;Ce++){const _e=m[Ce];D[_e]=Nc(c,L,_e,ae[_e],v,!(0,_.RI)(ae,_e))}}return E}function Nc(v,b,D,F,c,m){const E=v[D];if(E!=null){const R=(0,_.RI)(E,"default");if(R&&F===void 0){const L=E.default;if(E.type!==Function&&!E.skipFactory&&(0,_.mf)(L)){const{propsDefaults:ae}=c;if(D in ae)F=ae[D];else{const Ce=ns(c);F=ae[D]=L.call(null,b),Ce()}}else F=L;c.ce&&c.ce._setProp(D,F)}E[0]&&(m&&!R?F=!1:E[1]&&(F===""||F===(0,_.rs)(D))&&(F=!0))}return F}const Zl=new WeakMap;function hh(v,b,D=!1){const F=D?Zl:b.propsCache,c=F.get(v);if(c)return c;const m=v.props,E={},R=[];let L=!1;if(!(0,_.mf)(v)){const Ce=_e=>{L=!0;const[Ge,ht]=hh(_e,b,!0);(0,_.l7)(E,Ge),ht&&R.push(...ht)};!D&&b.mixins.length&&b.mixins.forEach(Ce),v.extends&&Ce(v.extends),v.mixins&&v.mixins.forEach(Ce)}if(!m&&!L)return(0,_.Kn)(v)&&F.set(v,_.Z6),_.Z6;if((0,_.kJ)(m))for(let Ce=0;Ce<m.length;Ce++){const _e=(0,_._A)(m[Ce]);ec(_e)&&(E[_e]=_.kT)}else if(m)for(const Ce in m){const _e=(0,_._A)(Ce);if(ec(_e)){const Ge=m[Ce],ht=E[_e]=(0,_.kJ)(Ge)||(0,_.mf)(Ge)?{type:Ge}:(0,_.l7)({},Ge),Dt=ht.type;let Ht=!1,tr=!0;if((0,_.kJ)(Dt))for(let cr=0;cr<Dt.length;++cr){const An=Dt[cr],lt=(0,_.mf)(An)&&An.name;if(lt==="Boolean"){Ht=!0;break}else lt==="String"&&(tr=!1)}else Ht=(0,_.mf)(Dt)&&Dt.name==="Boolean";ht[0]=Ht,ht[1]=tr,(Ht||(0,_.RI)(ht,"default"))&&R.push(_e)}}const ae=[E,R];return(0,_.Kn)(v)&&F.set(v,ae),ae}function ec(v){return v[0]!=="$"&&!(0,_.Gg)(v)}function Zd(v){return v===null?"null":typeof v=="function"?v.name||"":typeof v=="object"&&v.constructor&&v.constructor.name||""}function Jl(v,b,D){const F=toRaw(b),c=D.propsOptions[0],m=Object.keys(v).map(E=>camelize(E));for(const E in c){let R=c[E];R!=null&&Jd(E,F[E],R,F,!m.includes(E))}}function Jd(v,b,D,F,c){const{type:m,required:E,validator:R,skipCheck:L}=D;if(E&&c){X('Missing required prop: "'+v+'"');return}if(!(b==null&&!E)){if(m!=null&&m!==!0&&!L){let ae=!1;const Ce=isArray(m)?m:[m],_e=[];for(let Ge=0;Ge<Ce.length&&!ae;Ge++){const{valid:ht,expectedType:Dt}=Xo(b,Ce[Ge]);_e.push(Dt||""),ae=ht}if(!ae){X(Qd(v,b,_e));return}}R&&!R(b,F)&&X('Invalid prop: custom validator check failed for prop "'+v+'".')}}const sd=null;function Xo(v,b){let D;const F=Zd(b);if(F==="null")D=v===null;else if(sd(F)){const c=typeof v;D=c===F.toLowerCase(),!D&&c==="object"&&(D=v instanceof b)}else F==="Object"?D=isObject(v):F==="Array"?D=isArray(v):D=v instanceof b;return{valid:D,expectedType:F}}function Qd(v,b,D){if(D.length===0)return`Prop type [] for prop "${v}" won't match anything. Did you mean to use type Array instead?`;let F=`Invalid prop: type check failed for prop "${v}". Expected ${D.map(capitalize).join(" | ")}`;const c=D[0],m=toRawType(b),E=il(b,c),R=il(b,m);return D.length===1&&tc(c)&&!qd(c,m)&&(F+=` with value ${E}`),F+=`, got ${m} `,tc(m)&&(F+=`with value ${R}.`),F}function il(v,b){return b==="String"?`"${v}"`:b==="Number"?`${Number(v)}`:`${v}`}function tc(v){return["string","number","boolean"].some(D=>v.toLowerCase()===D)}function qd(...v){return v.some(b=>b.toLowerCase()==="boolean")}const Ua=v=>v[0]==="_"||v==="$stable",Zo=v=>(0,_.kJ)(v)?v.map(Ar):[Ar(v)],nc=(v,b,D)=>{if(b._n)return b;const F=en((...c)=>Zo(b(...c)),D);return F._c=!1,F},Ql=(v,b,D)=>{const F=v._ctx;for(const c in v){if(Ua(c))continue;const m=v[c];if((0,_.mf)(m))b[c]=nc(c,m,F);else if(m!=null){const E=Zo(m);b[c]=()=>E}}},Po=(v,b)=>{const D=Zo(b);v.slots.default=()=>D},Fo=(v,b,D)=>{for(const F in b)(D||!Ua(F))&&(v[F]=b[F])},ca=(v,b,D)=>{const F=v.slots=Qu();if(v.vnode.shapeFlag&32){const c=b.__;c&&(0,_.Nj)(F,"__",c,!0);const m=b._;m?(Fo(F,b,D),D&&(0,_.Nj)(F,"_",m,!0)):Ql(b,F)}else b&&Po(v,b)},od=(v,b,D)=>{const{vnode:F,slots:c}=v;let m=!0,E=_.kT;if(F.shapeFlag&32){const R=b._;R?D&&R===1?m=!1:Fo(c,b,D):(m=!b.$stable,Ql(b,c)),E=b}else b&&(Po(v,b),E={default:1});if(m)for(const R in c)!Ua(R)&&E[R]==null&&delete c[R]};let rc,sl;function ef(v,b){v.appContext.config.performance&&dh()&&sl.mark(`vue-${b}-${v.uid}`)}function Ta(v,b){if(v.appContext.config.performance&&dh()){const D=`vue-${b}-${v.uid}`,F=D+":end";sl.mark(F),sl.measure(`<${_s(v,v.type)}> ${b}`,D,F),sl.clearMarks(D),sl.clearMarks(F)}}function dh(){return rc!==void 0||(typeof window!="undefined"&&window.performance?(rc=!0,sl=window.performance):rc=!1),rc}function ha(){const v=[]}const Ks=Wo;function fh(v){return ic(v)}function ig(v){return ic(v,nl)}function ic(v,b){ha();const D=(0,_.E9)();D.__VUE__=!0;const{insert:F,remove:c,patchProp:m,createElement:E,createText:R,createComment:L,setText:ae,setElementText:Ce,parentNode:_e,nextSibling:Ge,setScopeId:ht=_.dG,insertStaticContent:Dt}=v,Ht=(Ne,We,Rt,ln=null,Xt=null,rn=null,fn=void 0,gt=null,cn=!!We.dynamicChildren)=>{if(Ne===We)return;Ne&&!us(Ne,We)&&(ln=hg(Ne),iu(Ne,Xt,rn,!0),Ne=null),We.patchFlag===-2&&(cn=!1,We.dynamicChildren=null);const{type:Lt,ref:wn,shapeFlag:Dn}=We;switch(Lt){case da:tr(Ne,We,Rt,ln);break;case ys:cr(Ne,We,Rt,ln);break;case Ll:Ne==null&&An(We,Rt,ln,fn);break;case ui:ti(Ne,We,Rt,ln,Xt,rn,fn,gt,cn);break;default:Dn&1?vn(Ne,We,Rt,ln,Xt,rn,fn,gt,cn):Dn&6?Ei(Ne,We,Rt,ln,Xt,rn,fn,gt,cn):(Dn&64||Dn&128)&&Lt.process(Ne,We,Rt,ln,Xt,rn,fn,gt,cn,Mu)}wn!=null&&Xt?Eo(wn,Ne&&Ne.ref,rn,We||Ne,!We):wn==null&&Ne&&Ne.ref!=null&&Eo(Ne.ref,null,rn,Ne,!0)},tr=(Ne,We,Rt,ln)=>{if(Ne==null)F(We.el=R(We.children),Rt,ln);else{const Xt=We.el=Ne.el;We.children!==Ne.children&&ae(Xt,We.children)}},cr=(Ne,We,Rt,ln)=>{Ne==null?F(We.el=L(We.children||""),Rt,ln):We.el=Ne.el},An=(Ne,We,Rt,ln)=>{[Ne.el,Ne.anchor]=Dt(Ne.children,We,Rt,ln,Ne.el,Ne.anchor)},lt=(Ne,We,Rt,ln)=>{if(We.children!==Ne.children){const Xt=Ge(Ne.anchor);At(Ne),[We.el,We.anchor]=Dt(We.children,Rt,Xt,ln)}else We.el=Ne.el,We.anchor=Ne.anchor},Nt=({el:Ne,anchor:We},Rt,ln)=>{let Xt;for(;Ne&&Ne!==We;)Xt=Ge(Ne),F(Ne,Rt,ln),Ne=Xt;F(We,Rt,ln)},At=({el:Ne,anchor:We})=>{let Rt;for(;Ne&&Ne!==We;)Rt=Ge(Ne),c(Ne),Ne=Rt;c(We)},vn=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn)=>{We.type==="svg"?fn="svg":We.type==="math"&&(fn="mathml"),Ne==null?qn(We,Rt,ln,Xt,rn,fn,gt,cn):dn(Ne,We,Xt,rn,fn,gt,cn)},qn=(Ne,We,Rt,ln,Xt,rn,fn,gt)=>{let cn,Lt;const{props:wn,shapeFlag:Dn,transition:Nn,dirs:wr}=Ne;if(cn=Ne.el=E(Ne.type,rn,wn&&wn.is,wn),Dn&8?Ce(cn,Ne.children):Dn&16&&Qt(Ne.children,cn,null,ln,Xt,gh(Ne,rn),fn,gt),wr&&Mr(Ne,null,ln,"created"),hr(cn,Ne,Ne.scopeId,fn,ln),wn){for(const rs in wn)rs!=="value"&&!(0,_.Gg)(rs)&&m(cn,rs,null,wn[rs],rn,ln);"value"in wn&&m(cn,"value",null,wn.value,rn),(Lt=wn.onVnodeBeforeMount)&&Ss(Lt,ln,Ne)}wr&&Mr(Ne,null,ln,"beforeMount");const Zr=tf(Xt,Nn);Zr&&Nn.beforeEnter(cn),F(cn,We,Rt),((Lt=wn&&wn.onVnodeMounted)||Zr||wr)&&Ks(()=>{Lt&&Ss(Lt,ln,Ne),Zr&&Nn.enter(cn),wr&&Mr(Ne,null,ln,"mounted")},Xt)},hr=(Ne,We,Rt,ln,Xt)=>{if(Rt&&ht(Ne,Rt),ln)for(let rn=0;rn<ln.length;rn++)ht(Ne,ln[rn]);if(Xt){let rn=Xt.subTree;if(We===rn||$s(rn.type)&&(rn.ssContent===We||rn.ssFallback===We)){const fn=Xt.vnode;hr(Ne,fn,fn.scopeId,fn.slotScopeIds,Xt.parent)}}},Qt=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn=0)=>{for(let Lt=cn;Lt<Ne.length;Lt++){const wn=Ne[Lt]=gt?to(Ne[Lt]):Ar(Ne[Lt]);Ht(null,wn,We,Rt,ln,Xt,rn,fn,gt)}},dn=(Ne,We,Rt,ln,Xt,rn,fn)=>{const gt=We.el=Ne.el;let{patchFlag:cn,dynamicChildren:Lt,dirs:wn}=We;cn|=Ne.patchFlag&16;const Dn=Ne.props||_.kT,Nn=We.props||_.kT;let wr;if(Rt&&Jo(Rt,!1),(wr=Nn.onVnodeBeforeUpdate)&&Ss(wr,Rt,We,Ne),wn&&Mr(We,Ne,Rt,"beforeUpdate"),Rt&&Jo(Rt,!0),(Dn.innerHTML&&Nn.innerHTML==null||Dn.textContent&&Nn.textContent==null)&&Ce(gt,""),Lt?ar(Ne.dynamicChildren,Lt,gt,Rt,ln,gh(We,Xt),rn):fn||Ls(Ne,We,gt,null,Rt,ln,gh(We,Xt),rn,!1),cn>0){if(cn&16)ai(gt,Dn,Nn,Rt,Xt);else if(cn&2&&Dn.class!==Nn.class&&m(gt,"class",null,Nn.class,Xt),cn&4&&m(gt,"style",Dn.style,Nn.style,Xt),cn&8){const Zr=We.dynamicProps;for(let rs=0;rs<Zr.length;rs++){const ki=Zr[rs],Na=Dn[ki],fo=Nn[ki];(fo!==Na||ki==="value")&&m(gt,ki,Na,fo,Xt,Rt)}}cn&1&&Ne.children!==We.children&&Ce(gt,We.children)}else!fn&&Lt==null&&ai(gt,Dn,Nn,Rt,Xt);((wr=Nn.onVnodeUpdated)||wn)&&Ks(()=>{wr&&Ss(wr,Rt,We,Ne),wn&&Mr(We,Ne,Rt,"updated")},ln)},ar=(Ne,We,Rt,ln,Xt,rn,fn)=>{for(let gt=0;gt<We.length;gt++){const cn=Ne[gt],Lt=We[gt],wn=cn.el&&(cn.type===ui||!us(cn,Lt)||cn.shapeFlag&198)?_e(cn.el):Rt;Ht(cn,Lt,wn,null,ln,Xt,rn,fn,!0)}},ai=(Ne,We,Rt,ln,Xt)=>{if(We!==Rt){if(We!==_.kT)for(const rn in We)!(0,_.Gg)(rn)&&!(rn in Rt)&&m(Ne,rn,We[rn],null,Xt,ln);for(const rn in Rt){if((0,_.Gg)(rn))continue;const fn=Rt[rn],gt=We[rn];fn!==gt&&rn!=="value"&&m(Ne,rn,gt,fn,Xt,ln)}"value"in Rt&&m(Ne,"value",We.value,Rt.value,Xt)}},ti=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn)=>{const Lt=We.el=Ne?Ne.el:R(""),wn=We.anchor=Ne?Ne.anchor:R("");let{patchFlag:Dn,dynamicChildren:Nn,slotScopeIds:wr}=We;wr&&(gt=gt?gt.concat(wr):wr),Ne==null?(F(Lt,Rt,ln),F(wn,Rt,ln),Qt(We.children||[],Rt,wn,Xt,rn,fn,gt,cn)):Dn>0&&Dn&64&&Nn&&Ne.dynamicChildren?(ar(Ne.dynamicChildren,Nn,Rt,Xt,rn,fn,gt),(We.key!=null||Xt&&We===Xt.subTree)&&sc(Ne,We,!0)):Ls(Ne,We,Rt,wn,Xt,rn,fn,gt,cn)},Ei=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn)=>{We.slotScopeIds=gt,Ne==null?We.shapeFlag&512?Xt.ctx.activate(We,Rt,ln,fn,cn):bs(We,Rt,ln,Xt,rn,fn,cn):$n(Ne,We,cn)},bs=(Ne,We,Rt,ln,Xt,rn,fn)=>{const gt=Ne.component=ra(Ne,ln,Xt);if(Cr(Ne)&&(gt.ctx.renderer=Mu),hc(gt,!1,fn),gt.asyncDep){if(Xt&&Xt.registerDep(gt,ni,fn),!Ne.el){const cn=gt.subTree=cs(ys);cr(null,cn,We,Rt)}}else ni(gt,Ne,We,Rt,Xt,rn,fn)},$n=(Ne,We,Rt)=>{const ln=We.component=Ne.component;if(Dl(Ne,We,Rt))if(ln.asyncDep&&!ln.asyncResolved){lr(ln,We,Rt);return}else ln.next=We,ln.update();else We.el=Ne.el,ln.vnode=We},ni=(Ne,We,Rt,ln,Xt,rn,fn)=>{const gt=()=>{if(Ne.isMounted){let{next:Dn,bu:Nn,u:wr,parent:Zr,vnode:rs}=Ne;{const Ga=sg(Ne);if(Ga){Dn&&(Dn.el=rs.el,lr(Ne,Dn,fn)),Ga.asyncDep.then(()=>{Ne.isUnmounted||gt()});return}}let ki=Dn,Na;Jo(Ne,!1),Dn?(Dn.el=rs.el,lr(Ne,Dn,fn)):Dn=rs,Nn&&(0,_.ir)(Nn),(Na=Dn.props&&Dn.props.onVnodeBeforeUpdate)&&Ss(Na,Zr,Dn,rs),Jo(Ne,!0);const fo=xl(Ne),Da=Ne.subTree;Ne.subTree=fo,Ht(Da,fo,_e(Da.el),hg(Da),Ne,Xt,rn),Dn.el=fo.el,ki===null&&Fc(Ne,fo.el),wr&&Ks(wr,Xt),(Na=Dn.props&&Dn.props.onVnodeUpdated)&&Ks(()=>Ss(Na,Zr,Dn,rs),Xt)}else{let Dn;const{el:Nn,props:wr}=We,{bm:Zr,m:rs,parent:ki,root:Na,type:fo}=Ne,Da=Tn(We);if(Jo(Ne,!1),Zr&&(0,_.ir)(Zr),!Da&&(Dn=wr&&wr.onVnodeBeforeMount)&&Ss(Dn,ki,We),Jo(Ne,!0),Nn&&Eh){const Ga=()=>{Ne.subTree=xl(Ne),Eh(Nn,Ne.subTree,Ne,Xt,null)};Da&&fo.__asyncHydrate?fo.__asyncHydrate(Nn,Ne,Ga):Ga()}else{Na.ce&&Na.ce._def.shadowRoot!==!1&&Na.ce._injectChildStyle(fo);const Ga=Ne.subTree=xl(Ne);Ht(null,Ga,Rt,ln,Ne,Xt,rn),We.el=Ga.el}if(rs&&Ks(rs,Xt),!Da&&(Dn=wr&&wr.onVnodeMounted)){const Ga=We;Ks(()=>Ss(Dn,ki,Ga),Xt)}(We.shapeFlag&256||ki&&Tn(ki.vnode)&&ki.vnode.shapeFlag&256)&&Ne.a&&Ks(Ne.a,Xt),Ne.isMounted=!0,We=Rt=ln=null}};Ne.scope.on();const cn=Ne.effect=new C.qq(gt);Ne.scope.off();const Lt=Ne.update=cn.run.bind(cn),wn=Ne.job=cn.runIfDirty.bind(cn);wn.i=Ne,wn.id=Ne.uid,cn.scheduler=()=>ze(wn),Jo(Ne,!0),Lt()},lr=(Ne,We,Rt)=>{We.component=Ne;const ln=Ne.vnode.props;Ne.vnode=We,Ne.next=null,Rn(Ne,We.props,ln,Rt),od(Ne,We.children,Rt),(0,C.Jd)(),Sn(Ne),(0,C.lk)()},Ls=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn=!1)=>{const Lt=Ne&&Ne.children,wn=Ne?Ne.shapeFlag:0,Dn=We.children,{patchFlag:Nn,shapeFlag:wr}=We;if(Nn>0){if(Nn&128){kc(Lt,Dn,Rt,ln,Xt,rn,fn,gt,cn);return}else if(Nn&256){Tu(Lt,Dn,Rt,ln,Xt,rn,fn,gt,cn);return}}wr&8?(wn&16&&Aa(Lt,Xt,rn),Dn!==Lt&&Ce(Rt,Dn)):wn&16?wr&16?kc(Lt,Dn,Rt,ln,Xt,rn,fn,gt,cn):Aa(Lt,Xt,rn,!0):(wn&8&&Ce(Rt,""),wr&16&&Qt(Dn,Rt,ln,Xt,rn,fn,gt,cn))},Tu=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn)=>{Ne=Ne||_.Z6,We=We||_.Z6;const Lt=Ne.length,wn=We.length,Dn=Math.min(Lt,wn);let Nn;for(Nn=0;Nn<Dn;Nn++){const wr=We[Nn]=cn?to(We[Nn]):Ar(We[Nn]);Ht(Ne[Nn],wr,Rt,null,Xt,rn,fn,gt,cn)}Lt>wn?Aa(Ne,Xt,rn,!0,!1,Dn):Qt(We,Rt,ln,Xt,rn,fn,gt,cn,Dn)},kc=(Ne,We,Rt,ln,Xt,rn,fn,gt,cn)=>{let Lt=0;const wn=We.length;let Dn=Ne.length-1,Nn=wn-1;for(;Lt<=Dn&&Lt<=Nn;){const wr=Ne[Lt],Zr=We[Lt]=cn?to(We[Lt]):Ar(We[Lt]);if(us(wr,Zr))Ht(wr,Zr,Rt,null,Xt,rn,fn,gt,cn);else break;Lt++}for(;Lt<=Dn&&Lt<=Nn;){const wr=Ne[Dn],Zr=We[Nn]=cn?to(We[Nn]):Ar(We[Nn]);if(us(wr,Zr))Ht(wr,Zr,Rt,null,Xt,rn,fn,gt,cn);else break;Dn--,Nn--}if(Lt>Dn){if(Lt<=Nn){const wr=Nn+1,Zr=wr<wn?We[wr].el:ln;for(;Lt<=Nn;)Ht(null,We[Lt]=cn?to(We[Lt]):Ar(We[Lt]),Rt,Zr,Xt,rn,fn,gt,cn),Lt++}}else if(Lt>Nn)for(;Lt<=Dn;)iu(Ne[Lt],Xt,rn,!0),Lt++;else{const wr=Lt,Zr=Lt,rs=new Map;for(Lt=Zr;Lt<=Nn;Lt++){const $a=We[Lt]=cn?to(We[Lt]):Ar(We[Lt]);$a.key!=null&&rs.set($a.key,Lt)}let ki,Na=0;const fo=Nn-Zr+1;let Da=!1,Ga=0;const Vc=new Array(fo);for(Lt=0;Lt<fo;Lt++)Vc[Lt]=0;for(Lt=wr;Lt<=Dn;Lt++){const $a=Ne[Lt];if(Na>=fo){iu($a,Xt,rn,!0);continue}let su;if($a.key!=null)su=rs.get($a.key);else for(ki=Zr;ki<=Nn;ki++)if(Vc[ki-Zr]===0&&us($a,We[ki])){su=ki;break}su===void 0?iu($a,Xt,rn,!0):(Vc[su-Zr]=Lt+1,su>=Ga?Ga=su:Da=!0,Ht($a,We[su],Rt,null,Xt,rn,fn,gt,cn),Na++)}const Ou=Da?nf(Vc):_.Z6;for(ki=Ou.length-1,Lt=fo-1;Lt>=0;Lt--){const $a=Zr+Lt,su=We[$a],sa=$a+1<wn?We[$a+1].el:ln;Vc[Lt]===0?Ht(null,su,Rt,sa,Xt,rn,fn,gt,cn):Da&&(ki<0||Lt!==Ou[ki]?ri(su,Rt,sa,2):ki--)}}},ri=(Ne,We,Rt,ln,Xt=null)=>{const{el:rn,type:fn,transition:gt,children:cn,shapeFlag:Lt}=Ne;if(Lt&6){ri(Ne.component.subTree,We,Rt,ln);return}if(Lt&128){Ne.suspense.move(We,Rt,ln);return}if(Lt&64){fn.move(Ne,We,Rt,Mu);return}if(fn===ui){F(rn,We,Rt);for(let Dn=0;Dn<cn.length;Dn++)ri(cn[Dn],We,Rt,ln);F(Ne.anchor,We,Rt);return}if(fn===Ll){Nt(Ne,We,Rt);return}if(ln!==2&&Lt&1&&gt)if(ln===0)gt.beforeEnter(rn),F(rn,We,Rt),Ks(()=>gt.enter(rn),Xt);else{const{leave:Dn,delayLeave:Nn,afterLeave:wr}=gt,Zr=()=>{Ne.ctx.isUnmounted?c(rn):F(rn,We,Rt)},rs=()=>{Dn(rn,()=>{Zr(),wr&&wr()})};Nn?Nn(rn,Zr,rs):rs()}else F(rn,We,Rt)},iu=(Ne,We,Rt,ln=!1,Xt=!1)=>{const{type:rn,props:fn,ref:gt,children:cn,dynamicChildren:Lt,shapeFlag:wn,patchFlag:Dn,dirs:Nn,cacheIndex:wr}=Ne;if(Dn===-2&&(Xt=!1),gt!=null&&((0,C.Jd)(),Eo(gt,null,Rt,Ne,!0),(0,C.lk)()),wr!=null&&(We.renderCache[wr]=void 0),wn&256){We.ctx.deactivate(Ne);return}const Zr=wn&1&&Nn,rs=!Tn(Ne);let ki;if(rs&&(ki=fn&&fn.onVnodeBeforeUnmount)&&Ss(ki,We,Ne),wn&6)fm(Ne.component,Rt,ln);else{if(wn&128){Ne.suspense.unmount(Rt,ln);return}Zr&&Mr(Ne,null,We,"beforeUnmount"),wn&64?Ne.type.remove(Ne,We,Rt,Mu,ln):Lt&&!Lt.hasOnce&&(rn!==ui||Dn>0&&Dn&64)?Aa(Lt,We,Rt,!1,!0):(rn===ui&&Dn&384||!Xt&&wn&16)&&Aa(cn,We,Rt),ln&&mc(Ne)}(rs&&(ki=fn&&fn.onVnodeUnmounted)||Zr)&&Ks(()=>{ki&&Ss(ki,We,Ne),Zr&&Mr(Ne,null,We,"unmounted")},Rt)},mc=Ne=>{const{type:We,el:Rt,anchor:ln,transition:Xt}=Ne;if(We===ui){ia(Rt,ln);return}if(We===Ll){At(Ne);return}const rn=()=>{c(Rt),Xt&&!Xt.persisted&&Xt.afterLeave&&Xt.afterLeave()};if(Ne.shapeFlag&1&&Xt&&!Xt.persisted){const{leave:fn,delayLeave:gt}=Xt,cn=()=>fn(Rt,rn);gt?gt(Ne.el,rn,cn):cn()}else rn()},ia=(Ne,We)=>{let Rt;for(;Ne!==We;)Rt=Ge(Ne),c(Ne),Ne=Rt;c(We)},fm=(Ne,We,Rt)=>{const{bum:ln,scope:Xt,job:rn,subTree:fn,um:gt,m:cn,a:Lt,parent:wn,slots:{__:Dn}}=Ne;xr(cn),xr(Lt),ln&&(0,_.ir)(ln),wn&&(0,_.kJ)(Dn)&&Dn.forEach(Nn=>{wn.renderCache[Nn]=void 0}),Xt.stop(),rn&&(rn.flags|=8,iu(fn,Ne,We,Rt)),gt&&Ks(gt,We),Ks(()=>{Ne.isUnmounted=!0},We),We&&We.pendingBranch&&!We.isUnmounted&&Ne.asyncDep&&!Ne.asyncResolved&&Ne.suspenseId===We.pendingId&&(We.deps--,We.deps===0&&We.resolve())},Aa=(Ne,We,Rt,ln=!1,Xt=!1,rn=0)=>{for(let fn=rn;fn<Ne.length;fn++)iu(Ne[fn],We,Rt,ln,Xt)},hg=Ne=>{if(Ne.shapeFlag&6)return hg(Ne.component.subTree);if(Ne.shapeFlag&128)return Ne.suspense.next();const We=Ge(Ne.anchor||Ne.el),Rt=We&&We[js];return Rt?Ge(Rt):We};let kl=!1;const ko=(Ne,We,Rt)=>{Ne==null?We._vnode&&iu(We._vnode,null,null,!0):Ht(We._vnode||null,Ne,We,null,null,null,Rt),We._vnode=Ne,kl||(kl=!0,Sn(),jt(),kl=!1)},Mu={p:Ht,um:iu,m:ri,r:mc,mt:bs,mc:Qt,pc:Ls,pbc:ar,n:hg,o:v};let gm,Eh;return b&&([gm,Eh]=b(Mu)),{render:ko,hydrate:gm,createApp:rg(ko,gm)}}function gh({type:v,props:b},D){return D==="svg"&&v==="foreignObject"||D==="mathml"&&v==="annotation-xml"&&b&&b.encoding&&b.encoding.includes("html")?void 0:D}function Jo({effect:v,job:b},D){D?(v.flags|=32,b.flags|=4):(v.flags&=-33,b.flags&=-5)}function tf(v,b){return(!v||v&&!v.pendingBranch)&&b&&!b.persisted}function sc(v,b,D=!1){const F=v.children,c=b.children;if((0,_.kJ)(F)&&(0,_.kJ)(c))for(let m=0;m<F.length;m++){const E=F[m];let R=c[m];R.shapeFlag&1&&!R.dynamicChildren&&((R.patchFlag<=0||R.patchFlag===32)&&(R=c[m]=to(c[m]),R.el=E.el),!D&&R.patchFlag!==-2&&sc(E,R)),R.type===da&&(R.el=E.el),R.type===ys&&!R.el&&(R.el=E.el)}}function nf(v){const b=v.slice(),D=[0];let F,c,m,E,R;const L=v.length;for(F=0;F<L;F++){const ae=v[F];if(ae!==0){if(c=D[D.length-1],v[c]<ae){b[F]=c,D.push(F);continue}for(m=0,E=D.length-1;m<E;)R=m+E>>1,v[D[R]]<ae?m=R+1:E=R;ae<v[D[m]]&&(m>0&&(b[F]=D[m-1]),D[m]=F)}}for(m=D.length,E=D[m-1];m-- >0;)D[m]=E,E=b[E];return D}function sg(v){const b=v.subTree.component;if(b)return b.asyncDep&&!b.asyncResolved?b:sg(b)}function xr(v){if(v)for(let b=0;b<v.length;b++)v[b].flags|=8}const rf=Symbol.for("v-scx"),sf=()=>{{const v=Io(rf);return v}};function Su(v,b){return Gs(v,null,b)}function og(v,b){return Gs(v,null,{flush:"post"})}function Ys(v,b){return Gs(v,null,{flush:"sync"})}function Dc(v,b,D){return Gs(v,b,D)}function Gs(v,b,D=_.kT){const{immediate:F,deep:c,flush:m,once:E}=D,R=(0,_.l7)({},D),L=b&&F||!b&&m!=="post";let ae;if(tu){if(m==="sync"){const ht=sf();ae=ht.__watcherHandles||(ht.__watcherHandles=[])}else if(!L){const ht=()=>{};return ht.stop=_.dG,ht.resume=_.dG,ht.pause=_.dG,ht}}const Ce=Bi;R.call=(ht,Dt,Ht)=>V(ht,Ce,Dt,Ht);let _e=!1;m==="post"?R.scheduler=ht=>{Ks(ht,Ce&&Ce.suspense)}:m!=="sync"&&(_e=!0,R.scheduler=(ht,Dt)=>{Dt?ht():ze(ht)}),R.augmentJob=ht=>{b&&(ht.flags|=4),_e&&(ht.flags|=2,Ce&&(ht.id=Ce.uid,ht.i=Ce))};const Ge=(0,C.YP)(v,b,R);return tu&&(ae?ae.push(Ge):L&&Ge()),Ge}function cm(v,b,D){const F=this.proxy,c=(0,_.HD)(v)?v.includes(".")?za(F,v):()=>F[v]:v.bind(F,F);let m;(0,_.mf)(b)?m=b:(m=b.handler,D=b);const E=ns(this),R=Gs(c,m.bind(F),D);return E(),R}function za(v,b){const D=b.split(".");return()=>{let F=v;for(let c=0;c<D.length&&F;c++)F=F[D[c]];return F}}function ol(v,b,D=_.kT){const F=al(),c=(0,_._A)(b),m=(0,_.rs)(b),E=ad(v,c),R=(0,C.ZM)((L,ae)=>{let Ce,_e=_.kT,Ge;return Ys(()=>{const ht=v[c];(0,_.aU)(Ce,ht)&&(Ce=ht,ae())}),{get(){return L(),D.get?D.get(Ce):Ce},set(ht){const Dt=D.set?D.set(ht):ht;if(!(0,_.aU)(Dt,Ce)&&!(_e!==_.kT&&(0,_.aU)(ht,_e)))return;const Ht=F.vnode.props;Ht&&(b in Ht||c in Ht||m in Ht)&&(`onUpdate:${b}`in Ht||`onUpdate:${c}`in Ht||`onUpdate:${m}`in Ht)||(Ce=ht,ae()),F.emit(`update:${b}`,Dt),(0,_.aU)(ht,Dt)&&(0,_.aU)(ht,_e)&&!(0,_.aU)(Dt,Ge)&&ae(),_e=ht,Ge=Dt}}});return R[Symbol.iterator]=()=>{let L=0;return{next(){return L<2?{value:L++?E||_.kT:R,done:!1}:{done:!0}}}},R}const ad=(v,b)=>b==="modelValue"||b==="model-value"?v.modelModifiers:v[`${b}Modifiers`]||v[`${(0,_._A)(b)}Modifiers`]||v[`${(0,_.rs)(b)}Modifiers`];function Hc(v,b,...D){if(v.isUnmounted)return;const F=v.vnode.props||_.kT;let c=D;const m=b.startsWith("update:"),E=m&&ad(F,b.slice(7));E&&(E.trim&&(c=D.map(Ce=>(0,_.HD)(Ce)?Ce.trim():Ce)),E.number&&(c=D.map(_.h5)));let R,L=F[R=(0,_.hR)(b)]||F[R=(0,_.hR)((0,_._A)(b))];!L&&m&&(L=F[R=(0,_.hR)((0,_.rs)(b))]),L&&V(L,v,6,c);const ae=F[R+"Once"];if(ae){if(!v.emitted)v.emitted={};else if(v.emitted[R])return;v.emitted[R]=!0,V(ae,v,6,c)}}function jr(v,b,D=!1){const F=b.emitsCache,c=F.get(v);if(c!==void 0)return c;const m=v.emits;let E={},R=!1;if(!(0,_.mf)(v)){const L=ae=>{const Ce=jr(ae,b,!0);Ce&&(R=!0,(0,_.l7)(E,Ce))};!D&&b.mixins.length&&b.mixins.forEach(L),v.extends&&L(v.extends),v.mixins&&v.mixins.forEach(L)}return!m&&!R?((0,_.Kn)(v)&&F.set(v,null),null):((0,_.kJ)(m)?m.forEach(L=>E[L]=null):(0,_.l7)(E,m),(0,_.Kn)(v)&&F.set(v,E),E)}function Qo(v,b){return!v||!(0,_.F7)(b)?!1:(b=b.slice(2).replace(/Once$/,""),(0,_.RI)(v,b[0].toLowerCase()+b.slice(1))||(0,_.RI)(v,(0,_.rs)(b))||(0,_.RI)(v,b))}let Lc=!1;function Pl(){Lc=!0}function xl(v){const{type:b,vnode:D,proxy:F,withProxy:c,propsOptions:[m],slots:E,attrs:R,emit:L,render:ae,renderCache:Ce,props:_e,data:Ge,setupState:ht,ctx:Dt,inheritAttrs:Ht}=v,tr=qi(v);let cr,An;try{if(D.shapeFlag&4){const At=c||F,vn=At;cr=Ar(ae.call(vn,At,Ce,_e,ht,Ge,Dt)),An=R}else{const At=b;cr=Ar(At.length>1?At(_e,{attrs:R,slots:E,emit:L}):At(_e,null)),An=b.props?R:ld(R)}}catch(At){oc.length=0,q(At,v,1),cr=cs(ys)}let lt=cr,Nt;if(An&&Ht!==!1){const At=Object.keys(An),{shapeFlag:vn}=lt;At.length&&vn&7&&(m&&At.some(_.tR)&&(An=Nl(An,m)),lt=Oa(lt,An,!1,!0))}return D.dirs&&(lt=Oa(lt,null,!1,!0),lt.dirs=lt.dirs?lt.dirs.concat(D.dirs):D.dirs),D.transition&&Xr(lt,D.transition),cr=lt,qi(tr),cr}const of=v=>{const b=v.children,D=v.dynamicChildren,F=Al(b,!1);if(!F)return[v,void 0];const c=b.indexOf(F),m=D?D.indexOf(F):-1,E=R=>{b[c]=R,D&&(m>-1?D[m]=R:R.patchFlag>0&&(v.dynamicChildren=[...D,R]))};return[Ar(F),E]};function Al(v,b=!0){let D;for(let F=0;F<v.length;F++){const c=v[F];if(bi(c)){if(c.type!==ys||c.children==="v-if"){if(D)return;D=c}}else return}return D}const ld=v=>{let b;for(const D in v)(D==="class"||D==="style"||(0,_.F7)(D))&&((b||(b={}))[D]=v[D]);return b},Nl=(v,b)=>{const D={};for(const F in v)(!(0,_.tR)(F)||!(F.slice(9)in b))&&(D[F]=v[F]);return D},Ka=v=>v.shapeFlag&7||v.type===ys;function Dl(v,b,D){const{props:F,children:c,component:m}=v,{props:E,children:R,patchFlag:L}=b,ae=m.emitsOptions;if(b.dirs||b.transition)return!0;if(D&&L>=0){if(L&1024)return!0;if(L&16)return F?mh(F,E,ae):!!E;if(L&8){const Ce=b.dynamicProps;for(let _e=0;_e<Ce.length;_e++){const Ge=Ce[_e];if(E[Ge]!==F[Ge]&&!Qo(ae,Ge))return!0}}}else return(c||R)&&(!R||!R.$stable)?!0:F===E?!1:F?E?mh(F,E,ae):!0:!!E;return!1}function mh(v,b,D){const F=Object.keys(b);if(F.length!==Object.keys(v).length)return!0;for(let c=0;c<F.length;c++){const m=F[c];if(b[m]!==v[m]&&!Qo(D,m))return!0}return!1}function Fc({vnode:v,parent:b},D){for(;b;){const F=b.subTree;if(F.suspense&&F.suspense.activeBranch===v&&(F.el=v.el),F===v)(v=b.vnode).el=D,b=b.parent;else break}}const $s=v=>v.__isSuspense;let ud=0;const ql={name:"Suspense",__isSuspense:!0,process(v,b,D,F,c,m,E,R,L,ae){if(v==null)qo(b,D,F,c,m,E,R,L,ae);else{if(m&&m.deps>0&&!v.suspense.isInFallback){b.suspense=v.suspense,b.suspense.vnode=b,b.el=v.el;return}cd(v,b,D,F,c,E,R,L,ae)}},hydrate:ph,normalize:_u};function Hl(v,b){const D=v.props&&v.props[b];(0,_.mf)(D)&&D()}function qo(v,b,D,F,c,m,E,R,L){const{p:ae,o:{createElement:Ce}}=L,_e=Ce("div"),Ge=v.suspense=af(v,c,F,b,_e,D,m,E,R,L);ae(null,Ge.pendingBranch=v.ssContent,_e,null,F,Ge,m,E),Ge.deps>0?(Hl(v,"onPending"),Hl(v,"onFallback"),ae(null,v.ssFallback,b,D,F,null,m,E),ea(Ge,v.ssFallback)):Ge.resolve(!1,!0)}function cd(v,b,D,F,c,m,E,R,{p:L,um:ae,o:{createElement:Ce}}){const _e=b.suspense=v.suspense;_e.vnode=b,b.el=v.el;const Ge=b.ssContent,ht=b.ssFallback,{activeBranch:Dt,pendingBranch:Ht,isInFallback:tr,isHydrating:cr}=_e;if(Ht)_e.pendingBranch=Ge,us(Ge,Ht)?(L(Ht,Ge,_e.hiddenContainer,null,c,_e,m,E,R),_e.deps<=0?_e.resolve():tr&&(cr||(L(Dt,ht,D,F,c,null,m,E,R),ea(_e,ht)))):(_e.pendingId=ud++,cr?(_e.isHydrating=!1,_e.activeBranch=Ht):ae(Ht,c,_e),_e.deps=0,_e.effects.length=0,_e.hiddenContainer=Ce("div"),tr?(L(null,Ge,_e.hiddenContainer,null,c,_e,m,E,R),_e.deps<=0?_e.resolve():(L(Dt,ht,D,F,c,null,m,E,R),ea(_e,ht))):Dt&&us(Ge,Dt)?(L(Dt,Ge,D,F,c,_e,m,E,R),_e.resolve(!0)):(L(null,Ge,_e.hiddenContainer,null,c,_e,m,E,R),_e.deps<=0&&_e.resolve()));else if(Dt&&us(Ge,Dt))L(Dt,Ge,D,F,c,_e,m,E,R),ea(_e,Ge);else if(Hl(b,"onPending"),_e.pendingBranch=Ge,Ge.shapeFlag&512?_e.pendingId=Ge.component.suspenseId:_e.pendingId=ud++,L(null,Ge,_e.hiddenContainer,null,c,_e,m,E,R),_e.deps<=0)_e.resolve();else{const{timeout:An,pendingId:lt}=_e;An>0?setTimeout(()=>{_e.pendingId===lt&&_e.fallback(ht)},An):An===0&&_e.fallback(ht)}}let yp=!1;function af(v,b,D,F,c,m,E,R,L,ae,Ce=!1){const{p:_e,m:Ge,um:ht,n:Dt,o:{parentNode:Ht,remove:tr}}=ae;let cr;const An=Ya(v);An&&b&&b.pendingBranch&&(cr=b.pendingId,b.deps++);const lt=v.props?(0,_.He)(v.props.timeout):void 0,Nt=m,At={vnode:v,parent:b,parentComponent:D,namespace:E,container:F,hiddenContainer:c,deps:0,pendingId:ud++,timeout:typeof lt=="number"?lt:-1,activeBranch:null,pendingBranch:null,isInFallback:!Ce,isHydrating:Ce,isUnmounted:!1,effects:[],resolve(vn=!1,qn=!1){const{vnode:hr,activeBranch:Qt,pendingBranch:dn,pendingId:ar,effects:ai,parentComponent:ti,container:Ei}=At;let bs=!1;At.isHydrating?At.isHydrating=!1:vn||(bs=Qt&&dn.transition&&dn.transition.mode==="out-in",bs&&(Qt.transition.afterLeave=()=>{ar===At.pendingId&&(Ge(dn,Ei,m===Nt?Dt(Qt):m,0),It(ai))}),Qt&&(Ht(Qt.el)===Ei&&(m=Dt(Qt)),ht(Qt,ti,At,!0)),bs||Ge(dn,Ei,m,0)),ea(At,dn),At.pendingBranch=null,At.isInFallback=!1;let $n=At.parent,ni=!1;for(;$n;){if($n.pendingBranch){$n.effects.push(...ai),ni=!0;break}$n=$n.parent}!ni&&!bs&&It(ai),At.effects=[],An&&b&&b.pendingBranch&&cr===b.pendingId&&(b.deps--,b.deps===0&&!qn&&b.resolve()),Hl(hr,"onResolve")},fallback(vn){if(!At.pendingBranch)return;const{vnode:qn,activeBranch:hr,parentComponent:Qt,container:dn,namespace:ar}=At;Hl(qn,"onFallback");const ai=Dt(hr),ti=()=>{At.isInFallback&&(_e(null,vn,dn,ai,Qt,null,ar,R,L),ea(At,vn))},Ei=vn.transition&&vn.transition.mode==="out-in";Ei&&(hr.transition.afterLeave=ti),At.isInFallback=!0,ht(hr,Qt,null,!0),Ei||ti()},move(vn,qn,hr){At.activeBranch&&Ge(At.activeBranch,vn,qn,hr),At.container=vn},next(){return At.activeBranch&&Dt(At.activeBranch)},registerDep(vn,qn,hr){const Qt=!!At.pendingBranch;Qt&&At.deps++;const dn=vn.vnode.el;vn.asyncDep.catch(ar=>{q(ar,vn,0)}).then(ar=>{if(vn.isUnmounted||At.isUnmounted||At.pendingId!==vn.suspenseId)return;vn.asyncResolved=!0;const{vnode:ai}=vn;gd(vn,ar,!1),dn&&(ai.el=dn);const ti=!dn&&vn.subTree.el;qn(vn,ai,Ht(dn||vn.subTree.el),dn?null:Dt(vn.subTree),At,E,hr),ti&&tr(ti),Fc(vn,ai.el),Qt&&--At.deps===0&&At.resolve()})},unmount(vn,qn){At.isUnmounted=!0,At.activeBranch&&ht(At.activeBranch,D,vn,qn),At.pendingBranch&&ht(At.pendingBranch,D,vn,qn)}};return At}function ph(v,b,D,F,c,m,E,R,L){const ae=b.suspense=af(b,F,D,v.parentNode,document.createElement("div"),null,c,m,E,R,!0),Ce=L(v,ae.pendingBranch=b.ssContent,D,ae,m,E);return ae.deps===0&&ae.resolve(!1,!0),Ce}function _u(v){const{shapeFlag:b,children:D}=v,F=b&32;v.ssContent=Pi(F?D.default:D),v.ssFallback=F?Pi(D.fallback):cs(ys)}function Pi(v){let b;if((0,_.mf)(v)){const D=Ds&&v._c;D&&(v._d=!1,ac()),v=v(),D&&(v._d=!0,b=co,Wi())}return(0,_.kJ)(v)&&(v=Al(v)),v=Ar(v),b&&!v.dynamicChildren&&(v.dynamicChildren=b.filter(D=>D!==v)),v}function Wo(v,b){b&&b.pendingBranch?(0,_.kJ)(v)?b.effects.push(...v):b.effects.push(v):It(v)}function ea(v,b){v.activeBranch=b;const{vnode:D,parentComponent:F}=v;let c=b.el;for(;!c&&b.component;)b=b.component.subTree,c=b.el;D.el=c,F&&F.subTree===D&&(F.vnode.el=c,Fc(F,c))}function Ya(v){const b=v.props&&v.props.suspensible;return b!=null&&b!==!1}const ui=Symbol.for("v-fgt"),da=Symbol.for("v-txt"),ys=Symbol.for("v-cmt"),Ll=Symbol.for("v-stc"),oc=[];let co=null;function ac(v=!1){oc.push(co=v?null:[])}function Wi(){oc.pop(),co=oc[oc.length-1]||null}let Ds=1;function vh(v,b=!1){Ds+=v,v<0&&co&&b&&(co.hasOnce=!0)}function Br(v){return v.dynamicChildren=Ds>0?co||_.Z6:null,Wi(),Ds>0&&co&&co.push(v),v}function ta(v,b,D,F,c,m){return Br(dd(v,b,D,F,c,m,!0))}function ho(v,b,D,F,c){return Br(cs(v,b,D,F,c,!0))}function bi(v){return v?v.__v_isVNode===!0:!1}function us(v,b){return v.type===b.type&&v.key===b.key}let Ma;function Fl(v){Ma=v}const hd=(...v)=>na(...Ma?Ma(v,Ln):v),Wl=({key:v})=>v!=null?v:null,lc=({ref:v,ref_key:b,ref_for:D})=>(typeof v=="number"&&(v=""+v),v!=null?(0,_.HD)(v)||(0,C.dq)(v)||(0,_.mf)(v)?{i:Ln,r:v,k:b,f:!!D}:v:null);function dd(v,b=null,D=null,F=0,c=null,m=v===ui?0:1,E=!1,R=!1){const L={__v_isVNode:!0,__v_skip:!0,type:v,props:b,key:b&&Wl(b),ref:b&&lc(b),scopeId:yn,slotScopeIds:null,children:D,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:m,patchFlag:F,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Ln};return R?(ei(L,D),m&128&&v.normalize(L)):D&&(L.shapeFlag|=(0,_.HD)(D)?8:16),Ds>0&&!E&&co&&(L.patchFlag>0||m&6)&&L.patchFlag!==32&&co.push(L),L}const cs=na;function na(v,b=null,D=null,F=0,c=null,m=!1){if((!v||v===Mo)&&(v=ys),bi(v)){const R=Oa(v,b,!0);return D&&ei(R,D),Ds>0&&!m&&co&&(R.shapeFlag&6?co[co.indexOf(v)]=R:co.push(R)),R.patchFlag=-2,R}if(Hs(v)&&(v=v.__vccOpts),b){b=Bl(b);let{class:R,style:L}=b;R&&!(0,_.HD)(R)&&(b.class=(0,_.C_)(R)),(0,_.Kn)(L)&&((0,C.X3)(L)&&!(0,_.kJ)(L)&&(L=(0,_.l7)({},L)),b.style=(0,_.j5)(L))}const E=(0,_.HD)(v)?1:$s(v)?128:as(v)?64:(0,_.Kn)(v)?4:(0,_.mf)(v)?2:0;return dd(v,b,D,F,c,E,m,!0)}function Bl(v){return v?(0,C.X3)(v)||Fi(v)?(0,_.l7)({},v):v:null}function Oa(v,b,D=!1,F=!1){const{props:c,ref:m,patchFlag:E,children:R,transition:L}=v,ae=b?Ia(c||{},b):c,Ce={__v_isVNode:!0,__v_skip:!0,type:v.type,props:ae,key:ae&&Wl(ae),ref:b&&b.ref?D&&m?(0,_.kJ)(m)?m.concat(lc(b)):[m,lc(b)]:lc(b):m,scopeId:v.scopeId,slotScopeIds:v.slotScopeIds,children:R,target:v.target,targetStart:v.targetStart,targetAnchor:v.targetAnchor,staticCount:v.staticCount,shapeFlag:v.shapeFlag,patchFlag:b&&v.type!==ui?E===-1?16:E|16:E,dynamicProps:v.dynamicProps,dynamicChildren:v.dynamicChildren,appContext:v.appContext,dirs:v.dirs,transition:L,component:v.component,suspense:v.suspense,ssContent:v.ssContent&&Oa(v.ssContent),ssFallback:v.ssFallback&&Oa(v.ssFallback),el:v.el,anchor:v.anchor,ctx:v.ctx,ce:v.ce};return L&&F&&Xr(Ce,L.clone(Ce)),Ce}function ts(v){const b=Oa(v);return isArray(v.children)&&(b.children=v.children.map(ts)),b}function fa(v=" ",b=0){return cs(da,null,v,b)}function Ut(v,b){const D=cs(Ll,null,v);return D.staticCount=b,D}function lf(v="",b=!1){return b?(ac(),ho(ys,null,v)):cs(ys,null,v)}function Ar(v){return v==null||typeof v=="boolean"?cs(ys):(0,_.kJ)(v)?cs(ui,null,v.slice()):bi(v)?to(v):cs(da,null,String(v))}function to(v){return v.el===null&&v.patchFlag!==-1||v.memo?v:Oa(v)}function ei(v,b){let D=0;const{shapeFlag:F}=v;if(b==null)b=null;else if((0,_.kJ)(b))D=16;else if(typeof b=="object")if(F&65){const c=b.default;c&&(c._c&&(c._d=!1),ei(v,c()),c._c&&(c._d=!0));return}else{D=32;const c=b._;!c&&!Fi(b)?b._ctx=Ln:c===3&&Ln&&(Ln.slots._===1?b._=1:(b._=2,v.patchFlag|=1024))}else(0,_.mf)(b)?(b={default:b,_ctx:Ln},D=32):(b=String(b),F&64?(D=16,b=[fa(b)]):D=8);v.children=b,v.shapeFlag|=D}function Ia(...v){const b={};for(let D=0;D<v.length;D++){const F=v[D];for(const c in F)if(c==="class")b.class!==F.class&&(b.class=(0,_.C_)([b.class,F.class]));else if(c==="style")b.style=(0,_.j5)([b.style,F.style]);else if((0,_.F7)(c)){const m=b[c],E=F[c];E&&m!==E&&!((0,_.kJ)(m)&&m.includes(E))&&(b[c]=m?[].concat(m,E):E)}else c!==""&&(b[c]=F[c])}return b}function Ss(v,b,D,F=null){V(v,b,7,[D,F])}const bu=eo();let uc=0;function ra(v,b,D){const F=v.type,c=(b?b.appContext:v.appContext)||bu,m={uid:uc++,vnode:v,type:F,parent:b,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new C.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:b?b.provides:Object.create(c.provides),ids:b?b.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:hh(F,c),emitsOptions:jr(F,c),emit:null,emitted:null,propsDefaults:_.kT,inheritAttrs:F.inheritAttrs,ctx:_.kT,data:_.kT,props:_.kT,attrs:_.kT,slots:_.kT,refs:_.kT,setupState:_.kT,setupContext:null,suspense:D,suspenseId:D?D.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return m.ctx={_:m},m.root=b?b.root:m,m.emit=Hc.bind(null,m),v.ce&&v.ce(m),m}let Bi=null;const al=()=>Bi||Ln;let Ch,Pa;{const v=(0,_.E9)(),b=(D,F)=>{let c;return(c=v[D])||(c=v[D]=[]),c.push(F),m=>{c.length>1?c.forEach(E=>E(m)):c[0](m)}};Ch=b("__VUE_INSTANCE_SETTERS__",D=>Bi=D),Pa=b("__VUE_SSR_SETTERS__",D=>tu=D)}const ns=v=>{const b=Bi;return Ch(v),v.scope.on(),()=>{v.scope.off(),Ch(b)}},cc=()=>{Bi&&Bi.scope.off(),Ch(null)},ga=null;function wh(v,{isNativeTag:b}){(ga(v)||b(v))&&X("Do not use built-in or reserved HTML elements as component id: "+v)}function eu(v){return v.vnode.shapeFlag&4}let tu=!1;function hc(v,b=!1,D=!1){b&&Pa(b);const{props:F,children:c}=v.vnode,m=eu(v);qu(v,F,m,b),ca(v,c,D||b);const E=m?fd(v,b):void 0;return b&&Pa(!1),E}function fd(v,b){var D;const F=v.type;v.accessCache=Object.create(null),v.proxy=new Proxy(v.ctx,_i);const{setup:c}=F;if(c){(0,C.Jd)();const m=v.setupContext=c.length>1?ll(v):null,E=ns(v),R=I(c,v,0,[v.props,m]),L=(0,_.tI)(R);if((0,C.lk)(),E(),(L||v.sp)&&!Tn(v)&&fr(v),L){if(R.then(cc,cc),b)return R.then(ae=>{gd(v,ae,b)}).catch(ae=>{q(ae,v,0)});v.asyncDep=R}else gd(v,R,b)}else md(v,b)}function gd(v,b,D){(0,_.mf)(b)?v.type.__ssrInlineRender?v.ssrRender=b:v.render=b:(0,_.Kn)(b)&&(v.setupState=(0,C.WL)(b)),md(v,D)}let ma,Eu;function yh(v){ma=v,Eu=b=>{b.render._rc&&(b.withProxy=new Proxy(b.ctx,Li))}}const dc=()=>!ma;function md(v,b,D){const F=v.type;if(!v.render){if(!b&&ma&&!F.render){const c=F.template||Ea(v).template;if(c){const{isCustomElement:m,compilerOptions:E}=v.appContext.config,{delimiters:R,compilerOptions:L}=F,ae=(0,_.l7)((0,_.l7)({isCustomElement:m,delimiters:R},E),L);F.render=ma(c,ae)}}v.render=F.render||_.dG,Eu&&Eu(v)}{const c=ns(v);(0,C.Jd)();try{Cu(v)}finally{(0,C.lk)(),c()}}}const Wc={get(v,b){return(0,C.j)(v,"get",""),v[b]}};function ag(v){return new Proxy(v.slots,{get(b,D){return track(v,"get","$slots"),b[D]}})}function ll(v){const b=D=>{v.exposed=D||{}};return{attrs:new Proxy(v.attrs,Wc),slots:v.slots,emit:v.emit,expose:b}}function fc(v){return v.exposed?v.exposeProxy||(v.exposeProxy=new Proxy((0,C.WL)((0,C.Xl)(v.exposed)),{get(b,D){if(D in b)return b[D];if(D in Pn)return Pn[D](v)},has(b,D){return D in b||D in Pn}})):v.proxy}const nu=/(?:^|[-_])(\w)/g,lg=v=>v.replace(nu,b=>b.toUpperCase()).replace(/[-_]/g,"");function Bc(v,b=!0){return(0,_.mf)(v)?v.displayName||v.name:v.name||b&&v.__name}function _s(v,b,D=!1){let F=Bc(b);if(!F&&b.__file){const c=b.__file.match(/([^/\\]+)\.\w+$/);c&&(F=c[1])}if(!F&&v&&v.parent){const c=m=>{for(const E in m)if(m[E]===b)return E};F=c(v.components||v.parent.type.components)||c(v.appContext.components)}return F?lg(F):D?"App":"Anonymous"}function Hs(v){return(0,_.mf)(v)&&"__vccOpts"in v}const Ru=(v,b)=>(0,C.Fl)(v,b,tu);function pd(v,b,D){const F=arguments.length;return F===2?(0,_.Kn)(b)&&!(0,_.kJ)(b)?bi(b)?cs(v,null,[b]):cs(v,b):cs(v,null,b):(F>3?D=Array.prototype.slice.call(arguments,2):F===3&&bi(D)&&(D=[D]),cs(v,b,D))}function Sh(){return;function m(_e){const Ge=[];_e.type.props&&_e.props&&Ge.push(E("props",(0,C.IU)(_e.props))),_e.setupState!==_.kT&&Ge.push(E("setup",_e.setupState)),_e.data!==_.kT&&Ge.push(E("data",(0,C.IU)(_e.data)));const ht=L(_e,"computed");ht&&Ge.push(E("computed",ht));const Dt=L(_e,"inject");return Dt&&Ge.push(E("injected",Dt)),Ge.push(["div",{},["span",{style:F.style+";opacity:0.66"},"$ (internal): "],["object",{object:_e}]]),Ge}function E(_e,Ge){return Ge=(0,_.l7)({},Ge),Object.keys(Ge).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},_e],["div",{style:"padding-left:1.25em"},...Object.keys(Ge).map(ht=>["div",{},["span",F,ht+": "],R(Ge[ht],!1)])]]:["span",{}]}function R(_e,Ge=!0){return typeof _e=="number"?["span",b,_e]:typeof _e=="string"?["span",D,JSON.stringify(_e)]:typeof _e=="boolean"?["span",F,_e]:(0,_.Kn)(_e)?["object",{object:Ge?(0,C.IU)(_e):_e}]:["span",D,String(_e)]}function L(_e,Ge){const ht=_e.type;if((0,_.mf)(ht))return;const Dt={};for(const Ht in _e.ctx)ae(ht,Ht,Ge)&&(Dt[Ht]=_e.ctx[Ht]);return Dt}function ae(_e,Ge,ht){const Dt=_e[ht];if((0,_.kJ)(Dt)&&Dt.includes(Ge)||(0,_.Kn)(Dt)&&Ge in Dt||_e.extends&&ae(_e.extends,Ge,ht)||_e.mixins&&_e.mixins.some(Ht=>ae(Ht,Ge,ht)))return!0}function Ce(_e){return(0,C.yT)(_e)?"ShallowRef":_e.effect?"ComputedRef":"Ref"}}function _h(v,b,D,F){const c=D[F];if(c&&ul(c,v))return c;const m=b();return m.memo=v.slice(),m.cacheIndex=F,D[F]=m}function ul(v,b){const D=v.memo;if(D.length!=b.length)return!1;for(let F=0;F<D.length;F++)if((0,_.aU)(D[F],b[F]))return!1;return Ds>0&&co&&co.push(v),!0}const xa="3.5.17",ru=_.dG,bh=W,Bo=bn,cl=ir,gc={createComponentInstance:ra,setupComponent:hc,renderComponentRoot:xl,setCurrentRenderingInstance:qi,isVNode:bi,normalizeVNode:Ar,getComponentPublicInstance:fc,ensureValidVNode:Gn,pushWarningContext:K,popWarningContext:k},uf=null,ug=null,cg=null},23970:function($,ie,f){"use strict";f.d(ie,{$:function(){return Mr},$d:function(){return C.$d},$y:function(){return C.$y},AE:function(){return C.AE},AH:function(){return C.AH},Ah:function(){return en},B:function(){return C.B},BK:function(){return C.BK},Bj:function(){return C.Bj},Bz:function(){return C.Bz},C3:function(){return C.C3},C_:function(){return C.C_},Cn:function(){return C.Cn},D2:function(){return Eo},EB:function(){return C.EB},EM:function(){return C.EM},ER:function(){return C.ER},Eo:function(){return C.Eo},Eq:function(){return C.Eq},F4:function(){return C.F4},F8:function(){return Be},FN:function(){return C.FN},Fl:function(){return C.Fl},Fp:function(){return C.Fp},G:function(){return C.G},G2:function(){return Lr},Gn:function(){return C.Gn},HX:function(){return C.HX},HY:function(){return C.HY},Ho:function(){return C.Ho},IU:function(){return C.IU},JJ:function(){return C.JJ},Jd:function(){return C.Jd},KU:function(){return C.KU},Ko:function(){return C.Ko},LL:function(){return C.LL},MW:function(){return Xn},MX:function(){return C.MX},Me:function(){return C.Me},Mr:function(){return C.Mr},Nd:function(){return se},Nv:function(){return C.Nv},OT:function(){return C.OT},Ob:function(){return C.Ob},P$:function(){return C.P$},PG:function(){return C.PG},PQ:function(){return C.PQ},Q2:function(){return C.Q2},Q6:function(){return C.Q6},RC:function(){return C.RC},RM:function(){return C.RM},Rh:function(){return C.Rh},Rr:function(){return C.Rr},S3:function(){return C.S3},SK:function(){return C.Ah},SM:function(){return C.SM},SU:function(){return C.SU},Tn:function(){return C.Tn},U2:function(){return C.U2},Uc:function(){return C.Uc},Uk:function(){return C.Uk},Um:function(){return C.Um},Us:function(){return C.Us},Vf:function(){return C.Vf},Vh:function(){return C.Vh},W3:function(){return $r},WI:function(){return C.WI},WL:function(){return C.WL},WY:function(){return C.WY},Wl:function(){return C.Wl},Wm:function(){return C.Wm},Wu:function(){return C.Wu},X3:function(){return C.X3},XI:function(){return C.XI},Xl:function(){return C.Xl},Xn:function(){return C.Xn},Y1:function(){return C.Y1},Y3:function(){return C.Y3},Y8:function(){return C.Y8},YP:function(){return C.YP},YS:function(){return C.YS},YZ:function(){return _n},Yq:function(){return C.Yq},Yu:function(){return C.Yu},ZB:function(){return nl},ZK:function(){return C.ZK},ZM:function(){return C.ZM},Zq:function(){return C.Zq},_:function(){return C._},_A:function(){return C._A},a2:function(){return di},aZ:function(){return C.aZ},b9:function(){return C.b9},bM:function(){return ps},bT:function(){return C.bT},bv:function(){return C.bv},cE:function(){return C.cE},d1:function(){return C.d1},dD:function(){return C.dD},dG:function(){return C.dG},dl:function(){return C.dl},dq:function(){return C.dq},e8:function(){return Pr},ec:function(){return C.ec},eg:function(){return C.eg},eq:function(){return C.eq},f3:function(){return C.f3},fb:function(){return as},h:function(){return C.h},hR:function(){return C.hR},i8:function(){return C.i8},iD:function(){return C.iD},iH:function(){return C.iH},iM:function(){return tl},ic:function(){return C.ic},j4:function(){return C.j4},j5:function(){return C.j5},kC:function(){return C.kC},kq:function(){return C.kq},l1:function(){return C.l1},lA:function(){return C.lA},lR:function(){return C.lR},m0:function(){return C.m0},mI:function(){return C.mI},mW:function(){return C.mW},mv:function(){return C.mv},mx:function(){return C.mx},n4:function(){return C.n4},nJ:function(){return C.nJ},nK:function(){return C.nK},nQ:function(){return C.nQ},nZ:function(){return C.nZ},nr:function(){return zi},oR:function(){return C.oR},of:function(){return C.of},p1:function(){return C.p1},pR:function(){return js},qG:function(){return C.qG},qZ:function(){return C.qZ},qb:function(){return C.qb},qj:function(){return C.qj},qq:function(){return C.qq},ri:function(){return lo},ry:function(){return C.ry},sT:function(){return C.sT},sY:function(){return Ko},se:function(){return C.se},sj:function(){return Ae},sv:function(){return C.sv},tT:function(){return C.tT},uE:function(){return C.uE},uT:function(){return q},u_:function(){return C.u_},up:function(){return C.up},vl:function(){return C.vl},vr:function(){return xs},vs:function(){return C.vs},w5:function(){return C.w5},wF:function(){return C.wF},wg:function(){return C.wg},wy:function(){return C.wy},xv:function(){return C.xv},yT:function(){return C.yT},yX:function(){return C.yX},yb:function(){return C.MW},yg:function(){return C.yg},zF:function(){return C.zF},zw:function(){return C.zw}});var C=f(6803),_=f(42281),B=f(88692);let K;const k=typeof window!="undefined"&&window.trustedTypes;if(k)try{K=k.createPolicy("vue",{createHTML:O=>O})}catch(O){}const Q=K?O=>K.createHTML(O):O=>O,X="http://www.w3.org/2000/svg",N="http://www.w3.org/1998/Math/MathML",ce=typeof document!="undefined"?document:null,Y=ce&&ce.createElement("template"),Z={insert:(O,x,re)=>{x.insertBefore(O,re||null)},remove:O=>{const x=O.parentNode;x&&x.removeChild(O)},createElement:(O,x,re,he)=>{const Me=x==="svg"?ce.createElementNS(X,O):x==="mathml"?ce.createElementNS(N,O):re?ce.createElement(O,{is:re}):ce.createElement(O);return O==="select"&&he&&he.multiple!=null&&Me.setAttribute("multiple",he.multiple),Me},createText:O=>ce.createTextNode(O),createComment:O=>ce.createComment(O),setText:(O,x)=>{O.nodeValue=x},setElementText:(O,x)=>{O.textContent=x},parentNode:O=>O.parentNode,nextSibling:O=>O.nextSibling,querySelector:O=>ce.querySelector(O),setScopeId(O,x){O.setAttribute(x,"")},insertStaticContent(O,x,re,he,Me,Xe){const nt=re?re.previousSibling:x.lastChild;if(Me&&(Me===Xe||Me.nextSibling))for(;x.insertBefore(Me.cloneNode(!0),re),!(Me===Xe||!(Me=Me.nextSibling)););else{Y.innerHTML=Q(he==="svg"?`<svg>${O}</svg>`:he==="mathml"?`<math>${O}</math>`:O);const Tt=Y.content;if(he==="svg"||he==="mathml"){const En=Tt.firstChild;for(;En.firstChild;)Tt.appendChild(En.firstChild);Tt.removeChild(En)}x.insertBefore(Tt,re)}return[nt?nt.nextSibling:x.firstChild,re?re.previousSibling:x.lastChild]}},ee="transition",le="animation",J=Symbol("_vtc"),W={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},I=(0,_.l7)({},C.nJ,W),q=(O=>(O.displayName="Transition",O.props=I,O))((O,{slots:x})=>(0,C.h)(C.P$,ve(O),x)),de=(O,x=[])=>{(0,_.kJ)(O)?O.forEach(re=>re(...x)):O&&O(...x)},ue=O=>O?(0,_.kJ)(O)?O.some(x=>x.length>1):O.length>1:!1;function ve(O){const x={};for(const or in O)or in W||(x[or]=O[or]);if(O.css===!1)return x;const{name:re="v",type:he,duration:Me,enterFromClass:Xe=`${re}-enter-from`,enterActiveClass:nt=`${re}-enter-active`,enterToClass:Tt=`${re}-enter-to`,appearFromClass:En=Xe,appearActiveClass:Tn=nt,appearToClass:pn=Tt,leaveFromClass:vr=`${re}-leave-from`,leaveActiveClass:Cr=`${re}-leave-active`,leaveToClass:Cs=`${re}-leave-to`}=O,Gi=pe(Me),As=Gi&&Gi[0],Ro=Gi&&Gi[1],{onBeforeEnter:Ns,onEnter:fe,onEnterCancelled:Do,onLeave:Yn,onLeaveCancelled:Us,onBeforeAppear:To=Ns,onAppear:qs=fe,onAppearCancelled:Zu=Do}=x,Si=(or,Ts,ua,rl)=>{or._enterCancelled=rl,He(or,Ts?pn:Tt),He(or,Ts?Tn:nt),ua&&ua()},Sa=(or,Ts)=>{or._isLeaving=!1,He(or,vr),He(or,Cs),He(or,Cr),Ts&&Ts()},El=or=>(Ts,ua)=>{const rl=or?qs:fe,mu=()=>Si(Ts,or,ua);de(rl,[Ts,mu]),Fe(()=>{He(Ts,or?En:Xe),Ee(Ts,or?pn:Tt),ue(rl)||Oe(Ts,he,As,mu)})};return(0,_.l7)(x,{onBeforeEnter(or){de(Ns,[or]),Ee(or,Xe),Ee(or,nt)},onBeforeAppear(or){de(To,[or]),Ee(or,En),Ee(or,Tn)},onEnter:El(!1),onAppear:El(!0),onLeave(or,Ts){or._isLeaving=!0;const ua=()=>Sa(or,Ts);Ee(or,vr),or._enterCancelled?(Ee(or,Cr),It()):(It(),Ee(or,Cr)),Fe(()=>{or._isLeaving&&(He(or,vr),Ee(or,Cs),ue(Yn)||Oe(or,he,Ro,ua))}),de(Yn,[or,ua])},onEnterCancelled(or){Si(or,!1,void 0,!0),de(Do,[or])},onAppearCancelled(or){Si(or,!0,void 0,!0),de(Zu,[or])},onLeaveCancelled(or){Sa(or),de(Us,[or])}})}function pe(O){if(O==null)return null;if((0,_.Kn)(O))return[Se(O.enter),Se(O.leave)];{const x=Se(O);return[x,x]}}function Se(O){return(0,_.He)(O)}function Ee(O,x){x.split(/\s+/).forEach(re=>re&&O.classList.add(re)),(O[J]||(O[J]=new Set)).add(x)}function He(O,x){x.split(/\s+/).forEach(he=>he&&O.classList.remove(he));const re=O[J];re&&(re.delete(x),re.size||(O[J]=void 0))}function Fe(O){requestAnimationFrame(()=>{requestAnimationFrame(O)})}let et=0;function Oe(O,x,re,he){const Me=O._endId=++et,Xe=()=>{Me===O._endId&&he()};if(re!=null)return setTimeout(Xe,re);const{type:nt,timeout:Tt,propCount:En}=ct(O,x);if(!nt)return he();const Tn=nt+"end";let pn=0;const vr=()=>{O.removeEventListener(Tn,Cr),Xe()},Cr=Cs=>{Cs.target===O&&++pn>=En&&vr()};setTimeout(()=>{pn<En&&vr()},Tt+1),O.addEventListener(Tn,Cr)}function ct(O,x){const re=window.getComputedStyle(O),he=Gi=>(re[Gi]||"").split(", "),Me=he(`${ee}Delay`),Xe=he(`${ee}Duration`),nt=ze(Me,Xe),Tt=he(`${le}Delay`),En=he(`${le}Duration`),Tn=ze(Tt,En);let pn=null,vr=0,Cr=0;x===ee?nt>0&&(pn=ee,vr=nt,Cr=Xe.length):x===le?Tn>0&&(pn=le,vr=Tn,Cr=En.length):(vr=Math.max(nt,Tn),pn=vr>0?nt>Tn?ee:le:null,Cr=pn?pn===ee?Xe.length:En.length:0);const Cs=pn===ee&&/\b(transform|all)(,|$)/.test(he(`${ee}Property`).toString());return{type:pn,timeout:vr,propCount:Cr,hasTransform:Cs}}function ze(O,x){for(;O.length<x.length;)O=O.concat(O);return Math.max(...x.map((re,he)=>dt(re)+dt(O[he])))}function dt(O){return O==="auto"?0:Number(O.slice(0,-1).replace(",","."))*1e3}function It(){return document.body.offsetHeight}function Sn(O,x,re){const he=O[J];he&&(x=(x?[x,...he]:[...he]).join(" ")),x==null?O.removeAttribute("class"):re?O.setAttribute("class",x):O.className=x}const jt=Symbol("_vod"),Ye=Symbol("_vsh"),Be={beforeMount(O,{value:x},{transition:re}){O[jt]=O.style.display==="none"?"":O.style.display,re&&x?re.beforeEnter(O):hn(O,x)},mounted(O,{value:x},{transition:re}){re&&x&&re.enter(O)},updated(O,{value:x,oldValue:re},{transition:he}){!x!=!re&&(he?x?(he.beforeEnter(O),hn(O,!0),he.enter(O)):he.leave(O,()=>{hn(O,!1)}):hn(O,x))},beforeUnmount(O,{value:x}){hn(O,x)}};function hn(O,x){O.style.display=x?O[jt]:"none",O[Ye]=!x}function Je(){Be.getSSRProps=({value:O})=>{if(!O)return{style:{display:"none"}}}}const mt=Symbol("");function Ae(O){const x=(0,C.FN)();if(!x)return;const re=x.ut=(Me=O(x.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${x.uid}"]`)).forEach(Xe=>Ft(Xe,Me))},he=()=>{const Me=O(x.proxy);x.ce?Ft(x.ce,Me):rt(x.subTree,Me),re(Me)};(0,C.Xn)(()=>{(0,C.qb)(he)}),(0,C.bv)(()=>{(0,C.YP)(he,_.dG,{flush:"post"});const Me=new MutationObserver(he);Me.observe(x.subTree.el.parentNode,{childList:!0}),(0,C.Ah)(()=>Me.disconnect())})}function rt(O,x){if(O.shapeFlag&128){const re=O.suspense;O=re.activeBranch,re.pendingBranch&&!re.isHydrating&&re.effects.push(()=>{rt(re.activeBranch,x)})}for(;O.component;)O=O.component.subTree;if(O.shapeFlag&1&&O.el)Ft(O.el,x);else if(O.type===C.HY)O.children.forEach(re=>rt(re,x));else if(O.type===C.qG){let{el:re,anchor:he}=O;for(;re&&(Ft(re,x),re!==he);)re=re.nextSibling}}function Ft(O,x){if(O.nodeType===1){const re=O.style;let he="";for(const Me in x)re.setProperty(`--${Me}`,x[Me]),he+=`--${Me}: ${x[Me]};`;re[mt]=he}}const zt=/(^|;)\s*display\s*:/;function Et(O,x,re){const he=O.style,Me=(0,_.HD)(re);let Xe=!1;if(re&&!Me){if(x)if((0,_.HD)(x))for(const nt of x.split(";")){const Tt=nt.slice(0,nt.indexOf(":")).trim();re[Tt]==null&&Mt(he,Tt,"")}else for(const nt in x)re[nt]==null&&Mt(he,nt,"");for(const nt in re)nt==="display"&&(Xe=!0),Mt(he,nt,re[nt])}else if(Me){if(x!==re){const nt=he[mt];nt&&(re+=";"+nt),he.cssText=re,Xe=zt.test(re)}}else x&&O.removeAttribute("style");jt in O&&(O[jt]=Xe?he.display:"",O[Ye]&&(he.display="none"))}const Qe=/[^\\];\s*$/,an=/\s*!important$/;function Mt(O,x,re){if((0,_.kJ)(re))re.forEach(he=>Mt(O,x,he));else if(re==null&&(re=""),x.startsWith("--"))O.setProperty(x,re);else{const he=mr(O,x);an.test(re)?O.setProperty((0,_.rs)(he),re.replace(an,""),"important"):O[he]=re}}const Cn=["Webkit","Moz","ms"],bn={};function mr(O,x){const re=bn[x];if(re)return re;let he=(0,_._A)(x);if(he!=="filter"&&he in O)return bn[x]=he;he=(0,_.kC)(he);for(let Me=0;Me<Cn.length;Me++){const Xe=Cn[Me]+he;if(Xe in O)return bn[x]=Xe}return x}const br="http://www.w3.org/1999/xlink";function qr(O,x,re,he,Me,Xe=(0,_.Pq)(x)){he&&x.startsWith("xlink:")?re==null?O.removeAttributeNS(br,x.slice(6,x.length)):O.setAttributeNS(br,x,re):re==null||Xe&&!(0,_.yA)(re)?O.removeAttribute(x):O.setAttribute(x,Xe?"":(0,_.yk)(re)?String(re):re)}function ir(O,x,re,he,Me){if(x==="innerHTML"||x==="textContent"){re!=null&&(O[x]=x==="innerHTML"?Q(re):re);return}const Xe=O.tagName;if(x==="value"&&Xe!=="PROGRESS"&&!Xe.includes("-")){const Tt=Xe==="OPTION"?O.getAttribute("value")||"":O.value,En=re==null?O.type==="checkbox"?"on":"":String(re);(Tt!==En||!("_value"in O))&&(O.value=En),re==null&&O.removeAttribute(x),O._value=re;return}let nt=!1;if(re===""||re==null){const Tt=typeof O[x];Tt==="boolean"?re=(0,_.yA)(re):re==null&&Tt==="string"?(re="",nt=!0):Tt==="number"&&(re=0,nt=!0)}try{O[x]=re}catch(Tt){}nt&&O.removeAttribute(Me||x)}function Qn(O,x,re,he){O.addEventListener(x,re,he)}function kr(O,x,re,he){O.removeEventListener(x,re,he)}const mn=Symbol("_vei");function Rs(O,x,re,he,Me=null){const Xe=O[mn]||(O[mn]={}),nt=Xe[x];if(he&&nt)nt.value=he;else{const[Tt,En]=_o(x);if(he){const Tn=Xe[x]=Vs(he,Me);Qn(O,Tt,Tn,En)}else nt&&(kr(O,Tt,nt,En),Xe[x]=void 0)}}const Mi=/(?:Once|Passive|Capture)$/;function _o(O){let x;if(Mi.test(O)){x={};let he;for(;he=O.match(Mi);)O=O.slice(0,O.length-he[0].length),x[he[0].toLowerCase()]=!0}return[O[2]===":"?O.slice(3):(0,_.rs)(O.slice(2)),x]}let Hn=0;const Oi=Promise.resolve(),pr=()=>Hn||(Oi.then(()=>Hn=0),Hn=Date.now());function Vs(O,x){const re=he=>{if(!he._vts)he._vts=Date.now();else if(he._vts<=re.attached)return;(0,C.$d)(Ln(he,re.value),x,5,[he])};return re.value=O,re.attached=pr(),re}function Qi(O,x){return isFunction(O)||isArray(O)?O:(warn(`Wrong type passed as event handler to ${x} - did you forget @ or : in front of your prop?
Expected function or array of functions, received type ${typeof O}.`),NOOP)}function Ln(O,x){if((0,_.kJ)(x)){const re=O.stopImmediatePropagation;return O.stopImmediatePropagation=()=>{re.call(O),O._stopped=!0},x.map(he=>Me=>!Me._stopped&&he&&he(Me))}else return x}const yn=O=>O.charCodeAt(0)===111&&O.charCodeAt(1)===110&&O.charCodeAt(2)>96&&O.charCodeAt(2)<123,qi=(O,x,re,he,Me,Xe)=>{const nt=Me==="svg";x==="class"?Sn(O,he,nt):x==="style"?Et(O,re,he):(0,_.F7)(x)?(0,_.tR)(x)||Rs(O,x,re,he,Xe):(x[0]==="."?(x=x.slice(1),!0):x[0]==="^"?(x=x.slice(1),!1):In(O,x,he,nt))?(ir(O,x,he),!O.tagName.includes("-")&&(x==="value"||x==="checked"||x==="selected")&&qr(O,x,he,nt,Xe,x!=="value")):O._isVueCE&&(/[A-Z]/.test(x)||!(0,_.HD)(he))?ir(O,(0,_._A)(x),he,Xe,x):(x==="true-value"?O._trueValue=he:x==="false-value"&&(O._falseValue=he),qr(O,x,he,nt))};function In(O,x,re,he){if(he)return!!(x==="innerHTML"||x==="textContent"||x in O&&yn(x)&&(0,_.mf)(re));if(x==="spellcheck"||x==="draggable"||x==="translate"||x==="autocorrect"||x==="form"||x==="list"&&O.tagName==="INPUT"||x==="type"&&O.tagName==="TEXTAREA")return!1;if(x==="width"||x==="height"){const Me=O.tagName;if(Me==="IMG"||Me==="VIDEO"||Me==="CANVAS"||Me==="SOURCE")return!1}return yn(x)&&(0,_.HD)(re)?!1:x in O}const un={};function Xn(O,x,re){const he=(0,C.aZ)(O,x);(0,_.PO)(he)&&(0,_.l7)(he,x);class Me extends di{constructor(nt){super(he,nt,re)}}return Me.def=he,Me}const en=(O,x)=>Xn(O,x,xs),Vr=typeof HTMLElement!="undefined"?HTMLElement:class{};class di extends Vr{constructor(x,re={},he=lo){super(),this._def=x,this._props=re,this._createApp=he,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&he!==lo?this._root=this.shadowRoot:x.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let x=this;for(;x=x&&(x.parentNode||x.host);)if(x instanceof di){this._parent=x;break}this._instance||(this._resolved?this._mount(this._def):x&&x._pendingResolve?this._pendingResolve=x._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(x=this._parent){x&&(this._instance.parent=x._instance,this._inheritParentContext(x))}_inheritParentContext(x=this._parent){x&&this._app&&Object.setPrototypeOf(this._app._context.provides,x._instance.provides)}disconnectedCallback(){this._connected=!1,(0,C.Y3)(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let he=0;he<this.attributes.length;he++)this._setAttr(this.attributes[he].name);this._ob=new MutationObserver(he=>{for(const Me of he)this._setAttr(Me.attributeName)}),this._ob.observe(this,{attributes:!0});const x=(he,Me=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:Xe,styles:nt}=he;let Tt;if(Xe&&!(0,_.kJ)(Xe))for(const En in Xe){const Tn=Xe[En];(Tn===Number||Tn&&Tn.type===Number)&&(En in this._props&&(this._props[En]=(0,_.He)(this._props[En])),(Tt||(Tt=Object.create(null)))[(0,_._A)(En)]=!0)}this._numberProps=Tt,this._resolveProps(he),this.shadowRoot&&this._applyStyles(nt),this._mount(he)},re=this._def.__asyncLoader;re?this._pendingResolve=re().then(he=>{he.configureApp=this._def.configureApp,x(this._def=he,!0)}):x(this._def)}_mount(x){this._app=this._createApp(x),this._inheritParentContext(),x.configureApp&&x.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const re=this._instance&&this._instance.exposed;if(re)for(const he in re)(0,_.RI)(this,he)||Object.defineProperty(this,he,{get:()=>(0,B.SU)(re[he])})}_resolveProps(x){const{props:re}=x,he=(0,_.kJ)(re)?re:Object.keys(re||{});for(const Me of Object.keys(this))Me[0]!=="_"&&he.includes(Me)&&this._setProp(Me,this[Me]);for(const Me of he.map(_._A))Object.defineProperty(this,Me,{get(){return this._getProp(Me)},set(Xe){this._setProp(Me,Xe,!0,!0)}})}_setAttr(x){if(x.startsWith("data-v-"))return;const re=this.hasAttribute(x);let he=re?this.getAttribute(x):un;const Me=(0,_._A)(x);re&&this._numberProps&&this._numberProps[Me]&&(he=(0,_.He)(he)),this._setProp(Me,he,!1,!0)}_getProp(x){return this._props[x]}_setProp(x,re,he=!0,Me=!1){if(re!==this._props[x]&&(re===un?delete this._props[x]:(this._props[x]=re,x==="key"&&this._app&&(this._app._ceVNode.key=re)),Me&&this._instance&&this._update(),he)){const Xe=this._ob;Xe&&Xe.disconnect(),re===!0?this.setAttribute((0,_.rs)(x),""):typeof re=="string"||typeof re=="number"?this.setAttribute((0,_.rs)(x),re+""):re||this.removeAttribute((0,_.rs)(x)),Xe&&Xe.observe(this,{attributes:!0})}}_update(){const x=this._createVNode();this._app&&(x.appContext=this._app._context),Ko(x,this._root)}_createVNode(){const x={};this.shadowRoot||(x.onVnodeMounted=x.onVnodeUpdated=this._renderSlots.bind(this));const re=(0,C.Wm)(this._def,(0,_.l7)(x,this._props));return this._instance||(re.ce=he=>{this._instance=he,he.ce=this,he.isCE=!0;const Me=(Xe,nt)=>{this.dispatchEvent(new CustomEvent(Xe,(0,_.PO)(nt[0])?(0,_.l7)({detail:nt},nt[0]):{detail:nt}))};he.emit=(Xe,...nt)=>{Me(Xe,nt),(0,_.rs)(Xe)!==Xe&&Me((0,_.rs)(Xe),nt)},this._setParent()}),re}_applyStyles(x,re){if(!x)return;if(re){if(re===this._def||this._styleChildren.has(re))return;this._styleChildren.add(re)}const he=this._nonce;for(let Me=x.length-1;Me>=0;Me--){const Xe=document.createElement("style");he&&Xe.setAttribute("nonce",he),Xe.textContent=x[Me],this.shadowRoot.prepend(Xe)}}_parseSlots(){const x=this._slots={};let re;for(;re=this.firstChild;){const he=re.nodeType===1&&re.getAttribute("slot")||"default";(x[he]||(x[he]=[])).push(re),this.removeChild(re)}}_renderSlots(){const x=(this._teleportTarget||this).querySelectorAll("slot"),re=this._instance.type.__scopeId;for(let he=0;he<x.length;he++){const Me=x[he],Xe=Me.getAttribute("name")||"default",nt=this._slots[Xe],Tt=Me.parentNode;if(nt)for(const En of nt){if(re&&En.nodeType===1){const Tn=re+"-s",pn=document.createTreeWalker(En,1);En.setAttribute(Tn,"");let vr;for(;vr=pn.nextNode();)vr.setAttribute(Tn,"")}Tt.insertBefore(En,Me)}else for(;Me.firstChild;)Tt.insertBefore(Me.firstChild,Me);Tt.removeChild(Me)}}_injectChildStyle(x){this._applyStyles(x.styles,x)}_removeChildStyle(x){}}function Mr(O){const x=(0,C.FN)(),re=x&&x.ce;return re||null}function js(){const O=Mr();return O&&O.shadowRoot}function as(O="$style"){{const x=(0,C.FN)();if(!x)return _.kT;const re=x.type.__cssModules;if(!re)return _.kT;const he=re[O];return he||_.kT}}const Te=new WeakMap,tt=new WeakMap,St=Symbol("_moveCb"),Ke=Symbol("_enterCb"),$r=(O=>(delete O.props.mode,O))({name:"TransitionGroup",props:(0,_.l7)({},I,{tag:String,moveClass:String}),setup(O,{slots:x}){const re=(0,C.FN)(),he=(0,C.Y8)();let Me,Xe;return(0,C.ic)(()=>{if(!Me.length)return;const nt=O.moveClass||`${O.name||"v"}-move`;if(!ur(Me[0].el,re.vnode.el,nt)){Me=[];return}Me.forEach(Ur),Me.forEach(sr);const Tt=Me.filter(Ps);It(),Tt.forEach(En=>{const Tn=En.el,pn=Tn.style;Ee(Tn,nt),pn.transform=pn.webkitTransform=pn.transitionDuration="";const vr=Tn[St]=Cr=>{Cr&&Cr.target!==Tn||(!Cr||/transform$/.test(Cr.propertyName))&&(Tn.removeEventListener("transitionend",vr),Tn[St]=null,He(Tn,nt))};Tn.addEventListener("transitionend",vr)}),Me=[]}),()=>{const nt=(0,B.IU)(O),Tt=ve(nt);let En=nt.tag||C.HY;if(Me=[],Xe)for(let Tn=0;Tn<Xe.length;Tn++){const pn=Xe[Tn];pn.el&&pn.el instanceof Element&&(Me.push(pn),(0,C.nK)(pn,(0,C.U2)(pn,Tt,he,re)),Te.set(pn,pn.el.getBoundingClientRect()))}Xe=x.default?(0,C.Q6)(x.default()):[];for(let Tn=0;Tn<Xe.length;Tn++){const pn=Xe[Tn];pn.key!=null&&(0,C.nK)(pn,(0,C.U2)(pn,Tt,he,re))}return(0,C.Wm)(En,null,Xe)}}});function Ur(O){const x=O.el;x[St]&&x[St](),x[Ke]&&x[Ke]()}function sr(O){tt.set(O,O.el.getBoundingClientRect())}function Ps(O){const x=Te.get(O),re=tt.get(O),he=x.left-re.left,Me=x.top-re.top;if(he||Me){const Xe=O.el.style;return Xe.transform=Xe.webkitTransform=`translate(${he}px,${Me}px)`,Xe.transitionDuration="0s",O}}function ur(O,x,re){const he=O.cloneNode(),Me=O[J];Me&&Me.forEach(Tt=>{Tt.split(/\s+/).forEach(En=>En&&he.classList.remove(En))}),re.split(/\s+/).forEach(Tt=>Tt&&he.classList.add(Tt)),he.style.display="none";const Xe=x.nodeType===1?x:x.parentNode;Xe.appendChild(he);const{hasTransform:nt}=ct(he);return Xe.removeChild(he),nt}const Hr=O=>{const x=O.props["onUpdate:modelValue"]||!1;return(0,_.kJ)(x)?re=>(0,_.ir)(x,re):x};function Rr(O){O.target.composing=!0}function bo(O){const x=O.target;x.composing&&(x.composing=!1,x.dispatchEvent(new Event("input")))}const Kn=Symbol("_assign"),zi={created(O,{modifiers:{lazy:x,trim:re,number:he}},Me){O[Kn]=Hr(Me);const Xe=he||Me.props&&Me.props.type==="number";Qn(O,x?"change":"input",nt=>{if(nt.target.composing)return;let Tt=O.value;re&&(Tt=Tt.trim()),Xe&&(Tt=(0,_.h5)(Tt)),O[Kn](Tt)}),re&&Qn(O,"change",()=>{O.value=O.value.trim()}),x||(Qn(O,"compositionstart",Rr),Qn(O,"compositionend",bo),Qn(O,"change",bo))},mounted(O,{value:x}){O.value=x==null?"":x},beforeUpdate(O,{value:x,oldValue:re,modifiers:{lazy:he,trim:Me,number:Xe}},nt){if(O[Kn]=Hr(nt),O.composing)return;const Tt=(Xe||O.type==="number")&&!/^0\d/.test(O.value)?(0,_.h5)(O.value):O.value,En=x==null?"":x;Tt!==En&&(document.activeElement===O&&O.type!=="range"&&(he&&x===re||Me&&O.value.trim()===En)||(O.value=En))}},Pr={deep:!0,created(O,x,re){O[Kn]=Hr(re),Qn(O,"change",()=>{const he=O._modelValue,Me=xt(O),Xe=O.checked,nt=O[Kn];if((0,_.kJ)(he)){const Tt=(0,_.hq)(he,Me),En=Tt!==-1;if(Xe&&!En)nt(he.concat(Me));else if(!Xe&&En){const Tn=[...he];Tn.splice(Tt,1),nt(Tn)}}else if((0,_.DM)(he)){const Tt=new Set(he);Xe?Tt.add(Me):Tt.delete(Me),nt(Tt)}else nt($t(O,Xe))})},mounted:gi,beforeUpdate(O,x,re){O[Kn]=Hr(re),gi(O,x,re)}};function gi(O,{value:x,oldValue:re},he){O._modelValue=x;let Me;if((0,_.kJ)(x))Me=(0,_.hq)(x,he.props.value)>-1;else if((0,_.DM)(x))Me=x.has(he.props.value);else{if(x===re)return;Me=(0,_.WV)(x,$t(O,!0))}O.checked!==Me&&(O.checked=Me)}const Lr={created(O,{value:x},re){O.checked=(0,_.WV)(x,re.props.value),O[Kn]=Hr(re),Qn(O,"change",()=>{O[Kn](xt(O))})},beforeUpdate(O,{value:x,oldValue:re},he){O[Kn]=Hr(he),x!==re&&(O.checked=(0,_.WV)(x,he.props.value))}},ps={deep:!0,created(O,{value:x,modifiers:{number:re}},he){const Me=(0,_.DM)(x);Qn(O,"change",()=>{const Xe=Array.prototype.filter.call(O.options,nt=>nt.selected).map(nt=>re?(0,_.h5)(xt(nt)):xt(nt));O[Kn](O.multiple?Me?new Set(Xe):Xe:Xe[0]),O._assigning=!0,(0,C.Y3)(()=>{O._assigning=!1})}),O[Kn]=Hr(he)},mounted(O,{value:x}){Ue(O,x)},beforeUpdate(O,x,re){O[Kn]=Hr(re)},updated(O,{value:x}){O._assigning||Ue(O,x)}};function Ue(O,x){const re=O.multiple,he=(0,_.kJ)(x);if(!(re&&!he&&!(0,_.DM)(x))){for(let Me=0,Xe=O.options.length;Me<Xe;Me++){const nt=O.options[Me],Tt=xt(nt);if(re)if(he){const En=typeof Tt;En==="string"||En==="number"?nt.selected=x.some(Tn=>String(Tn)===String(Tt)):nt.selected=(0,_.hq)(x,Tt)>-1}else nt.selected=x.has(Tt);else if((0,_.WV)(xt(nt),x)){O.selectedIndex!==Me&&(O.selectedIndex=Me);return}}!re&&O.selectedIndex!==-1&&(O.selectedIndex=-1)}}function xt(O){return"_value"in O?O._value:O.value}function $t(O,x){const re=x?"_trueValue":"_falseValue";return re in O?O[re]:x}const _n={created(O,x,re){Er(O,x,re,null,"created")},mounted(O,x,re){Er(O,x,re,null,"mounted")},beforeUpdate(O,x,re,he){Er(O,x,re,he,"beforeUpdate")},updated(O,x,re,he){Er(O,x,re,he,"updated")}};function Xr(O,x){switch(O){case"SELECT":return ps;case"TEXTAREA":return zi;default:switch(x){case"checkbox":return Pr;case"radio":return Lr;default:return zi}}}function Er(O,x,re,he,Me){const nt=Xr(O.tagName,re.props&&re.props.type)[Me];nt&&nt(O,x,re,he)}function Di(){zi.getSSRProps=({value:O})=>({value:O}),Lr.getSSRProps=({value:O},x)=>{if(x.props&&(0,_.WV)(x.props.value,O))return{checked:!0}},Pr.getSSRProps=({value:O},x)=>{if((0,_.kJ)(O)){if(x.props&&(0,_.hq)(O,x.props.value)>-1)return{checked:!0}}else if((0,_.DM)(O)){if(x.props&&O.has(x.props.value))return{checked:!0}}else if(O)return{checked:!0}},_n.getSSRProps=(O,x)=>{if(typeof x.type!="string")return;const re=Xr(x.type.toUpperCase(),x.props&&x.props.type);if(re.getSSRProps)return re.getSSRProps(O,x)}}const fi=["ctrl","shift","alt","meta"],fr={stop:O=>O.stopPropagation(),prevent:O=>O.preventDefault(),self:O=>O.target!==O.currentTarget,ctrl:O=>!O.ctrlKey,shift:O=>!O.shiftKey,alt:O=>!O.altKey,meta:O=>!O.metaKey,left:O=>"button"in O&&O.button!==0,middle:O=>"button"in O&&O.button!==1,right:O=>"button"in O&&O.button!==2,exact:(O,x)=>fi.some(re=>O[`${re}Key`]&&!x.includes(re))},tl=(O,x)=>{const re=O._withMods||(O._withMods={}),he=x.join(".");return re[he]||(re[he]=(Me,...Xe)=>{for(let nt=0;nt<x.length;nt++){const Tt=fr[x[nt]];if(Tt&&Tt(Me,x))return}return O(Me,...Xe)})},li={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Eo=(O,x)=>{const re=O._withKeys||(O._withKeys={}),he=x.join(".");return re[he]||(re[he]=Me=>{if(!("key"in Me))return;const Xe=(0,_.rs)(Me.key);if(x.some(nt=>nt===Xe||li[nt]===Xe))return O(Me)})},Wn=(0,_.l7)({patchProp:qi},Z);let vs,bl=!1;function xn(){return vs||(vs=(0,C.Us)(Wn))}function tn(){return vs=bl?vs:(0,C.Eo)(Wn),bl=!0,vs}const Ko=(...O)=>{xn().render(...O)},nl=(...O)=>{tn().hydrate(...O)},lo=(...O)=>{const x=xn().createApp(...O),{mount:re}=x;return x.mount=he=>{const Me=ls(he);if(!Me)return;const Xe=x._component;!(0,_.mf)(Xe)&&!Xe.render&&!Xe.template&&(Xe.template=Me.innerHTML),Me.nodeType===1&&(Me.textContent="");const nt=re(Me,!1,Yi(Me));return Me instanceof Element&&(Me.removeAttribute("v-cloak"),Me.setAttribute("data-v-app","")),nt},x},xs=(...O)=>{const x=tn().createApp(...O),{mount:re}=x;return x.mount=he=>{const Me=ls(he);if(Me)return re(Me,!0,Yi(Me))},x};function Yi(O){if(O instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&O instanceof MathMLElement)return"mathml"}function ya(O){Object.defineProperty(O.config,"isNativeTag",{value:x=>isHTMLTag(x)||isSVGTag(x)||isMathMLTag(x),writable:!1})}function ka(O){if(isRuntimeOnly()){const x=O.config.isCustomElement;Object.defineProperty(O.config,"isCustomElement",{get(){return x},set(){warn("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const re=O.config.compilerOptions,he='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-sfc';Object.defineProperty(O.config,"compilerOptions",{get(){return warn(he),re},set(){warn(he)}})}}function ls(O){return(0,_.HD)(O)?document.querySelector(O):O}let dr=!1;const se=()=>{dr||(dr=!0,Di(),Je())}},42281:function($,ie,f){"use strict";f.d(ie,{C_:function(){return pr},DM:function(){return J},E9:function(){return Ft},F7:function(){return Q},Gg:function(){return et},HD:function(){return q},He:function(){return Ae},Kj:function(){return I},Kn:function(){return ue},NO:function(){return k},Nj:function(){return Je},Od:function(){return ce},PO:function(){return He},Pq:function(){return di},RI:function(){return Z},S0:function(){return Fe},W7:function(){return Ee},WV:function(){return Kn},Z6:function(){return B},_A:function(){return dt},_N:function(){return le},aU:function(){return Be},dG:function(){return K},fY:function(){return C},h5:function(){return mt},hR:function(){return Ye},hq:function(){return zi},ir:function(){return hn},j5:function(){return mn},kC:function(){return jt},kJ:function(){return ee},kT:function(){return _},l7:function(){return N},mf:function(){return V},rs:function(){return Sn},tI:function(){return ve},tR:function(){return X},vs:function(){return Vs},yA:function(){return js},yk:function(){return de},yl:function(){return qr},zw:function(){return gi}});function C(Ue){const xt=Object.create(null);for(const $t of Ue.split(","))xt[$t]=1;return $t=>$t in xt}const _={},B=[],K=()=>{},k=()=>!1,Q=Ue=>Ue.charCodeAt(0)===111&&Ue.charCodeAt(1)===110&&(Ue.charCodeAt(2)>122||Ue.charCodeAt(2)<97),X=Ue=>Ue.startsWith("onUpdate:"),N=Object.assign,ce=(Ue,xt)=>{const $t=Ue.indexOf(xt);$t>-1&&Ue.splice($t,1)},Y=Object.prototype.hasOwnProperty,Z=(Ue,xt)=>Y.call(Ue,xt),ee=Array.isArray,le=Ue=>Se(Ue)==="[object Map]",J=Ue=>Se(Ue)==="[object Set]",W=Ue=>Se(Ue)==="[object Date]",I=Ue=>Se(Ue)==="[object RegExp]",V=Ue=>typeof Ue=="function",q=Ue=>typeof Ue=="string",de=Ue=>typeof Ue=="symbol",ue=Ue=>Ue!==null&&typeof Ue=="object",ve=Ue=>(ue(Ue)||V(Ue))&&V(Ue.then)&&V(Ue.catch),pe=Object.prototype.toString,Se=Ue=>pe.call(Ue),Ee=Ue=>Se(Ue).slice(8,-1),He=Ue=>Se(Ue)==="[object Object]",Fe=Ue=>q(Ue)&&Ue!=="NaN"&&Ue[0]!=="-"&&""+parseInt(Ue,10)===Ue,et=C(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Oe=null,ct=Ue=>{const xt=Object.create(null);return $t=>xt[$t]||(xt[$t]=Ue($t))},ze=/-(\w)/g,dt=ct(Ue=>Ue.replace(ze,(xt,$t)=>$t?$t.toUpperCase():"")),It=/\B([A-Z])/g,Sn=ct(Ue=>Ue.replace(It,"-$1").toLowerCase()),jt=ct(Ue=>Ue.charAt(0).toUpperCase()+Ue.slice(1)),Ye=ct(Ue=>Ue?`on${jt(Ue)}`:""),Be=(Ue,xt)=>!Object.is(Ue,xt),hn=(Ue,...xt)=>{for(let $t=0;$t<Ue.length;$t++)Ue[$t](...xt)},Je=(Ue,xt,$t,_n=!1)=>{Object.defineProperty(Ue,xt,{configurable:!0,enumerable:!1,writable:_n,value:$t})},mt=Ue=>{const xt=parseFloat(Ue);return isNaN(xt)?Ue:xt},Ae=Ue=>{const xt=q(Ue)?Number(Ue):NaN;return isNaN(xt)?Ue:xt};let rt;const Ft=()=>rt||(rt=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof f.g!="undefined"?f.g:{}),zt=/^[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*$/;function Et(Ue){return zt.test(Ue)?`__props.${Ue}`:`__props[${JSON.stringify(Ue)}]`}function Qe(Ue,xt){return Ue+JSON.stringify(xt,($t,_n)=>typeof _n=="function"?_n.toString():_n)}const an={TEXT:1,1:"TEXT",CLASS:2,2:"CLASS",STYLE:4,4:"STYLE",PROPS:8,8:"PROPS",FULL_PROPS:16,16:"FULL_PROPS",NEED_HYDRATION:32,32:"NEED_HYDRATION",STABLE_FRAGMENT:64,64:"STABLE_FRAGMENT",KEYED_FRAGMENT:128,128:"KEYED_FRAGMENT",UNKEYED_FRAGMENT:256,256:"UNKEYED_FRAGMENT",NEED_PATCH:512,512:"NEED_PATCH",DYNAMIC_SLOTS:1024,1024:"DYNAMIC_SLOTS",DEV_ROOT_FRAGMENT:2048,2048:"DEV_ROOT_FRAGMENT",CACHED:-1,"-1":"CACHED",BAIL:-2,"-2":"BAIL"},Mt={1:"TEXT",2:"CLASS",4:"STYLE",8:"PROPS",16:"FULL_PROPS",32:"NEED_HYDRATION",64:"STABLE_FRAGMENT",128:"KEYED_FRAGMENT",256:"UNKEYED_FRAGMENT",512:"NEED_PATCH",1024:"DYNAMIC_SLOTS",2048:"DEV_ROOT_FRAGMENT",[-1]:"CACHED",[-2]:"BAIL"},Cn={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"},bn={STABLE:1,1:"STABLE",DYNAMIC:2,2:"DYNAMIC",FORWARDED:3,3:"FORWARDED"},mr={1:"STABLE",2:"DYNAMIC",3:"FORWARDED"},qr=C("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol"),ir=null,Qn=2;function kr(Ue,xt=0,$t=Ue.length){if(xt=Math.max(0,Math.min(xt,Ue.length)),$t=Math.max(0,Math.min($t,Ue.length)),xt>$t)return"";let _n=Ue.split(/(\r?\n)/);const Xr=_n.filter((fi,fr)=>fr%2===1);_n=_n.filter((fi,fr)=>fr%2===0);let Er=0;const Di=[];for(let fi=0;fi<_n.length;fi++)if(Er+=_n[fi].length+(Xr[fi]&&Xr[fi].length||0),Er>=xt){for(let fr=fi-Qn;fr<=fi+Qn||$t>Er;fr++){if(fr<0||fr>=_n.length)continue;const tl=fr+1;Di.push(`${tl}${" ".repeat(Math.max(3-String(tl).length,0))}|  ${_n[fr]}`);const li=_n[fr].length,Eo=Xr[fr]&&Xr[fr].length||0;if(fr===fi){const Wn=xt-(Er-(li+Eo)),vs=Math.max(1,$t>Er?li-Wn:$t-xt);Di.push("   |  "+" ".repeat(Wn)+"^".repeat(vs))}else if(fr>fi){if($t>Er){const Wn=Math.max(Math.min($t-Er,li),1);Di.push("   |  "+"^".repeat(Wn))}Er+=li+Eo}}break}return Di.join(`
`)}function mn(Ue){if(ee(Ue)){const xt={};for(let $t=0;$t<Ue.length;$t++){const _n=Ue[$t],Xr=q(_n)?Hn(_n):mn(_n);if(Xr)for(const Er in Xr)xt[Er]=Xr[Er]}return xt}else if(q(Ue)||ue(Ue))return Ue}const Rs=/;(?![^(]*\))/g,Mi=/:([^]+)/,_o=/\/\*[^]*?\*\//g;function Hn(Ue){const xt={};return Ue.replace(_o,"").split(Rs).forEach($t=>{if($t){const _n=$t.split(Mi);_n.length>1&&(xt[_n[0].trim()]=_n[1].trim())}}),xt}function Oi(Ue){if(!Ue)return"";if(q(Ue))return Ue;let xt="";for(const $t in Ue){const _n=Ue[$t];if(q(_n)||typeof _n=="number"){const Xr=$t.startsWith("--")?$t:Sn($t);xt+=`${Xr}:${_n};`}}return xt}function pr(Ue){let xt="";if(q(Ue))xt=Ue;else if(ee(Ue))for(let $t=0;$t<Ue.length;$t++){const _n=pr(Ue[$t]);_n&&(xt+=_n+" ")}else if(ue(Ue))for(const $t in Ue)Ue[$t]&&(xt+=$t+" ");return xt.trim()}function Vs(Ue){if(!Ue)return null;let{class:xt,style:$t}=Ue;return xt&&!q(xt)&&(Ue.class=pr(xt)),$t&&(Ue.style=mn($t)),Ue}const Qi="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Ln="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",yn="annotation,annotation-xml,maction,maligngroup,malignmark,math,menclose,merror,mfenced,mfrac,mfraction,mglyph,mi,mlabeledtr,mlongdiv,mmultiscripts,mn,mo,mover,mpadded,mphantom,mprescripts,mroot,mrow,ms,mscarries,mscarry,msgroup,msline,mspace,msqrt,msrow,mstack,mstyle,msub,msubsup,msup,mtable,mtd,mtext,mtr,munder,munderover,none,semantics",qi="area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr",In=null,un=null,Xn=null,en=null,Vr="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",di=C(Vr),Mr=C(Vr+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");function js(Ue){return!!Ue||Ue===""}const as=/[>/="'\u0009\u000a\u000c\u0020]/,Te={};function tt(Ue){if(Te.hasOwnProperty(Ue))return Te[Ue];const xt=as.test(Ue);return xt&&console.error(`unsafe attribute name: ${Ue}`),Te[Ue]=!xt}const St={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},Ke=null,Gt=null,Vn=null;function $r(Ue){if(Ue==null)return!1;const xt=typeof Ue;return xt==="string"||xt==="number"||xt==="boolean"}const Ur=/["'&<>]/;function sr(Ue){const xt=""+Ue,$t=Ur.exec(xt);if(!$t)return xt;let _n="",Xr,Er,Di=0;for(Er=$t.index;Er<xt.length;Er++){switch(xt.charCodeAt(Er)){case 34:Xr="&quot;";break;case 38:Xr="&amp;";break;case 39:Xr="&#39;";break;case 60:Xr="&lt;";break;case 62:Xr="&gt;";break;default:continue}Di!==Er&&(_n+=xt.slice(Di,Er)),Di=Er+1,_n+=Xr}return Di!==Er?_n+xt.slice(Di,Er):_n}const Ps=/^-?>|<!--|-->|--!>|<!-$/g;function ur(Ue){return Ue.replace(Ps,"")}const Hr=/[ !"#$%&'()*+,./:;<=>?@[\\\]^`{|}~]/g;function Rr(Ue,xt){return Ue.replace(Hr,$t=>xt?$t==='"'?'\\\\\\"':`\\\\${$t}`:`\\${$t}`)}function bo(Ue,xt){if(Ue.length!==xt.length)return!1;let $t=!0;for(let _n=0;$t&&_n<Ue.length;_n++)$t=Kn(Ue[_n],xt[_n]);return $t}function Kn(Ue,xt){if(Ue===xt)return!0;let $t=W(Ue),_n=W(xt);if($t||_n)return $t&&_n?Ue.getTime()===xt.getTime():!1;if($t=de(Ue),_n=de(xt),$t||_n)return Ue===xt;if($t=ee(Ue),_n=ee(xt),$t||_n)return $t&&_n?bo(Ue,xt):!1;if($t=ue(Ue),_n=ue(xt),$t||_n){if(!$t||!_n)return!1;const Xr=Object.keys(Ue).length,Er=Object.keys(xt).length;if(Xr!==Er)return!1;for(const Di in Ue){const fi=Ue.hasOwnProperty(Di),fr=xt.hasOwnProperty(Di);if(fi&&!fr||!fi&&fr||!Kn(Ue[Di],xt[Di]))return!1}}return String(Ue)===String(xt)}function zi(Ue,xt){return Ue.findIndex($t=>Kn($t,xt))}const Pr=Ue=>!!(Ue&&Ue.__v_isRef===!0),gi=Ue=>q(Ue)?Ue:Ue==null?"":ee(Ue)||ue(Ue)&&(Ue.toString===pe||!V(Ue.toString))?Pr(Ue)?gi(Ue.value):JSON.stringify(Ue,Lr,2):String(Ue),Lr=(Ue,xt)=>Pr(xt)?Lr(Ue,xt.value):le(xt)?{[`Map(${xt.size})`]:[...xt.entries()].reduce(($t,[_n,Xr],Er)=>($t[ps(_n,Er)+" =>"]=Xr,$t),{})}:J(xt)?{[`Set(${xt.size})`]:[...xt.values()].map($t=>ps($t))}:de(xt)?ps(xt):ue(xt)&&!ee(xt)&&!He(xt)?String(xt):xt,ps=(Ue,xt="")=>{var $t;return de(Ue)?`Symbol(${($t=Ue.description)!=null?$t:xt})`:Ue}},4276:function($,ie,f){"use strict";var C=f(43895),_=f(53545),B=TypeError;$.exports=function(K){if(C(K))return K;throw new B(_(K)+" is not a function")}},94520:function($,ie,f){"use strict";var C=f(98184),_=String,B=TypeError;$.exports=function(K){if(C(K))return K;throw new B("Can't set "+_(K)+" as a prototype")}},63745:function($,ie,f){"use strict";var C=f(21203).has;$.exports=function(_){return C(_),_}},37833:function($,ie,f){"use strict";var C=f(20364),_=f(12256),B=f(56802).f,K=C("unscopables"),k=Array.prototype;k[K]===void 0&&B(k,K,{configurable:!0,value:_(null)}),$.exports=function(Q){k[K][Q]=!0}},13593:function($,ie,f){"use strict";var C=f(23062),_=TypeError;$.exports=function(B,K){if(C(K,B))return B;throw new _("Incorrect invocation")}},73108:function($,ie,f){"use strict";var C=f(78310),_=String,B=TypeError;$.exports=function(K){if(C(K))return K;throw new B(_(K)+" is not an object")}},34433:function($,ie,f){"use strict";var C=f(58079);$.exports=function(_,B,K){for(var k=0,Q=arguments.length>2?K:C(B),X=new _(Q);Q>k;)X[k]=B[k++];return X}},70116:function($,ie,f){"use strict";var C=f(863),_=f(30872),B=f(58079),K=function(k){return function(Q,X,N){var ce=C(Q),Y=B(ce);if(Y===0)return!k&&-1;var Z=_(N,Y),ee;if(k&&X!==X){for(;Y>Z;)if(ee=ce[Z++],ee!==ee)return!0}else for(;Y>Z;Z++)if((k||Z in ce)&&ce[Z]===X)return k||Z||0;return!k&&-1}};$.exports={includes:K(!0),indexOf:K(!1)}},50882:function($,ie,f){"use strict";var C=f(26298),_=f(54861),B=TypeError,K=Object.getOwnPropertyDescriptor,k=C&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(Q){return Q instanceof TypeError}}();$.exports=k?function(Q,X){if(_(Q)&&!K(Q,"length").writable)throw new B("Cannot set read only .length");return Q.length=X}:function(Q,X){return Q.length=X}},32945:function($,ie,f){"use strict";var C=f(48585);$.exports=C([].slice)},77752:function($,ie,f){"use strict";var C=f(73108),_=f(81703);$.exports=function(B,K,k,Q){try{return Q?K(C(k)[0],k[1]):K(k)}catch(X){_(B,"throw",X)}}},19454:function($,ie,f){"use strict";var C=f(48585),_=C({}.toString),B=C("".slice);$.exports=function(K){return B(_(K),8,-1)}},4767:function($,ie,f){"use strict";var C=f(99530),_=f(43895),B=f(19454),K=f(20364),k=K("toStringTag"),Q=Object,X=B(function(){return arguments}())==="Arguments",N=function(ce,Y){try{return ce[Y]}catch(Z){}};$.exports=C?B:function(ce){var Y,Z,ee;return ce===void 0?"Undefined":ce===null?"Null":typeof(Z=N(Y=Q(ce),k))=="string"?Z:X?B(Y):(ee=B(Y))==="Object"&&_(Y.callee)?"Arguments":ee}},47073:function($,ie,f){"use strict";var C=f(96893),_=f(9791),B=f(51453),K=f(56802);$.exports=function(k,Q,X){for(var N=_(Q),ce=K.f,Y=B.f,Z=0;Z<N.length;Z++){var ee=N[Z];!C(k,ee)&&!(X&&C(X,ee))&&ce(k,ee,Y(Q,ee))}}},212:function($,ie,f){"use strict";var C=f(62181);$.exports=!C(function(){function _(){}return _.prototype.constructor=null,Object.getPrototypeOf(new _)!==_.prototype})},75872:function($){"use strict";$.exports=function(ie,f){return{value:ie,done:f}}},55905:function($,ie,f){"use strict";var C=f(26298),_=f(56802),B=f(35124);$.exports=C?function(K,k,Q){return _.f(K,k,B(1,Q))}:function(K,k,Q){return K[k]=Q,K}},35124:function($){"use strict";$.exports=function(ie,f){return{enumerable:!(ie&1),configurable:!(ie&2),writable:!(ie&4),value:f}}},20767:function($,ie,f){"use strict";var C=f(26298),_=f(56802),B=f(35124);$.exports=function(K,k,Q){C?_.f(K,k,B(0,Q)):K[k]=Q}},20255:function($,ie,f){"use strict";var C=f(50883),_=f(56802);$.exports=function(B,K,k){return k.get&&C(k.get,K,{getter:!0}),k.set&&C(k.set,K,{setter:!0}),_.f(B,K,k)}},44869:function($,ie,f){"use strict";var C=f(43895),_=f(56802),B=f(50883),K=f(49133);$.exports=function(k,Q,X,N){N||(N={});var ce=N.enumerable,Y=N.name!==void 0?N.name:Q;if(C(X)&&B(X,Y,N),N.global)ce?k[Q]=X:K(Q,X);else{try{N.unsafe?k[Q]&&(ce=!0):delete k[Q]}catch(Z){}ce?k[Q]=X:_.f(k,Q,{value:X,enumerable:!1,configurable:!N.nonConfigurable,writable:!N.nonWritable})}return k}},91626:function($,ie,f){"use strict";var C=f(44869);$.exports=function(_,B,K){for(var k in B)C(_,k,B[k],K);return _}},49133:function($,ie,f){"use strict";var C=f(4435),_=Object.defineProperty;$.exports=function(B,K){try{_(C,B,{value:K,configurable:!0,writable:!0})}catch(k){C[B]=K}return K}},99311:function($,ie,f){"use strict";var C=f(53545),_=TypeError;$.exports=function(B,K){if(!delete B[K])throw new _("Cannot delete property "+C(K)+" of "+C(B))}},26298:function($,ie,f){"use strict";var C=f(62181);$.exports=!C(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},9882:function($,ie,f){"use strict";var C=f(4435),_=f(78310),B=C.document,K=_(B)&&_(B.createElement);$.exports=function(k){return K?B.createElement(k):{}}},35780:function($){"use strict";var ie=TypeError,f=9007199254740991;$.exports=function(C){if(C>f)throw ie("Maximum allowed index exceeded");return C}},63684:function($){"use strict";$.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},39200:function($,ie,f){"use strict";var C=f(81840);$.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(C)},81685:function($,ie,f){"use strict";var C=f(26834);$.exports=C==="NODE"},81840:function($,ie,f){"use strict";var C=f(4435),_=C.navigator,B=_&&_.userAgent;$.exports=B?String(B):""},97774:function($,ie,f){"use strict";var C=f(4435),_=f(81840),B=C.process,K=C.Deno,k=B&&B.versions||K&&K.version,Q=k&&k.v8,X,N;Q&&(X=Q.split("."),N=X[0]>0&&X[0]<4?1:+(X[0]+X[1])),!N&&_&&(X=_.match(/Edge\/(\d+)/),(!X||X[1]>=74)&&(X=_.match(/Chrome\/(\d+)/),X&&(N=+X[1]))),$.exports=N},26834:function($,ie,f){"use strict";var C=f(4435),_=f(81840),B=f(19454),K=function(k){return _.slice(0,k.length)===k};$.exports=function(){return K("Bun/")?"BUN":K("Cloudflare-Workers")?"CLOUDFLARE":K("Deno/")?"DENO":K("Node.js/")?"NODE":C.Bun&&typeof Bun.version=="string"?"BUN":C.Deno&&typeof Deno.version=="object"?"DENO":B(C.process)==="process"?"NODE":C.window&&C.document?"BROWSER":"REST"}()},6383:function($,ie,f){"use strict";var C=f(48585),_=Error,B=C("".replace),K=function(X){return String(new _(X).stack)}("zxcasd"),k=/\n\s*at [^:]*:[^\n]*/,Q=k.test(K);$.exports=function(X,N){if(Q&&typeof X=="string"&&!_.prepareStackTrace)for(;N--;)X=B(X,k,"");return X}},43021:function($,ie,f){"use strict";var C=f(55905),_=f(6383),B=f(47213),K=Error.captureStackTrace;$.exports=function(k,Q,X,N){B&&(K?K(k,Q):C(k,"stack",_(X,N)))}},47213:function($,ie,f){"use strict";var C=f(62181),_=f(35124);$.exports=!C(function(){var B=new Error("a");return"stack"in B?(Object.defineProperty(B,"stack",_(1,7)),B.stack!==7):!0})},60416:function($,ie,f){"use strict";var C=f(4435),_=f(51453).f,B=f(55905),K=f(44869),k=f(49133),Q=f(47073),X=f(12657);$.exports=function(N,ce){var Y=N.target,Z=N.global,ee=N.stat,le,J,W,I,V,q;if(Z?J=C:ee?J=C[Y]||k(Y,{}):J=C[Y]&&C[Y].prototype,J)for(W in ce){if(V=ce[W],N.dontCallGetSet?(q=_(J,W),I=q&&q.value):I=J[W],le=X(Z?W:Y+(ee?".":"#")+W,N.forced),!le&&I!==void 0){if(typeof V==typeof I)continue;Q(V,I)}(N.sham||I&&I.sham)&&B(V,"sham",!0),K(J,W,V,N)}}},62181:function($){"use strict";$.exports=function(ie){try{return!!ie()}catch(f){return!0}}},18e3:function($,ie,f){"use strict";var C=f(21990),_=Function.prototype,B=_.apply,K=_.call;$.exports=typeof Reflect=="object"&&Reflect.apply||(C?K.bind(B):function(){return K.apply(B,arguments)})},5402:function($,ie,f){"use strict";var C=f(91618),_=f(4276),B=f(21990),K=C(C.bind);$.exports=function(k,Q){return _(k),Q===void 0?k:B?K(k,Q):function(){return k.apply(Q,arguments)}}},21990:function($,ie,f){"use strict";var C=f(62181);$.exports=!C(function(){var _=function(){}.bind();return typeof _!="function"||_.hasOwnProperty("prototype")})},72304:function($,ie,f){"use strict";var C=f(21990),_=Function.prototype.call;$.exports=C?_.bind(_):function(){return _.apply(_,arguments)}},47381:function($,ie,f){"use strict";var C=f(26298),_=f(96893),B=Function.prototype,K=C&&Object.getOwnPropertyDescriptor,k=_(B,"name"),Q=k&&function(){}.name==="something",X=k&&(!C||C&&K(B,"name").configurable);$.exports={EXISTS:k,PROPER:Q,CONFIGURABLE:X}},54403:function($,ie,f){"use strict";var C=f(48585),_=f(4276);$.exports=function(B,K,k){try{return C(_(Object.getOwnPropertyDescriptor(B,K)[k]))}catch(Q){}}},91618:function($,ie,f){"use strict";var C=f(19454),_=f(48585);$.exports=function(B){if(C(B)==="Function")return _(B)}},48585:function($,ie,f){"use strict";var C=f(21990),_=Function.prototype,B=_.call,K=C&&_.bind.bind(B,B);$.exports=C?K:function(k){return function(){return B.apply(k,arguments)}}},71317:function($,ie,f){"use strict";var C=f(4435);$.exports=function(_,B){var K=C[_],k=K&&K.prototype;return k&&k[B]}},32216:function($,ie,f){"use strict";var C=f(4435),_=f(43895),B=function(K){return _(K)?K:void 0};$.exports=function(K,k){return arguments.length<2?B(C[K]):C[K]&&C[K][k]}},14732:function($){"use strict";$.exports=function(ie){return{iterator:ie,next:ie.next,done:!1}}},8125:function($,ie,f){"use strict";var C=f(72304),_=f(73108),B=f(14732),K=f(34771);$.exports=function(k,Q){(!Q||typeof k!="string")&&_(k);var X=K(k);return B(_(X!==void 0?C(X,k):k))}},34771:function($,ie,f){"use strict";var C=f(4767),_=f(70098),B=f(52606),K=f(93175),k=f(20364),Q=k("iterator");$.exports=function(X){if(!B(X))return _(X,Q)||_(X,"@@iterator")||K[C(X)]}},73860:function($,ie,f){"use strict";var C=f(72304),_=f(4276),B=f(73108),K=f(53545),k=f(34771),Q=TypeError;$.exports=function(X,N){var ce=arguments.length<2?k(X):N;if(_(ce))return B(C(ce,X));throw new Q(K(X)+" is not iterable")}},1268:function($,ie,f){"use strict";var C=f(48585),_=f(54861),B=f(43895),K=f(19454),k=f(94673),Q=C([].push);$.exports=function(X){if(B(X))return X;if(_(X)){for(var N=X.length,ce=[],Y=0;Y<N;Y++){var Z=X[Y];typeof Z=="string"?Q(ce,Z):(typeof Z=="number"||K(Z)==="Number"||K(Z)==="String")&&Q(ce,k(Z))}var ee=ce.length,le=!0;return function(J,W){if(le)return le=!1,W;if(_(this))return W;for(var I=0;I<ee;I++)if(ce[I]===J)return W}}}},70098:function($,ie,f){"use strict";var C=f(4276),_=f(52606);$.exports=function(B,K){var k=B[K];return _(k)?void 0:C(k)}},15817:function($,ie,f){"use strict";var C=f(4276),_=f(73108),B=f(72304),K=f(80098),k=f(14732),Q="Invalid size",X=RangeError,N=TypeError,ce=Math.max,Y=function(Z,ee){this.set=Z,this.size=ce(ee,0),this.has=C(Z.has),this.keys=C(Z.keys)};Y.prototype={getIterator:function(){return k(_(B(this.keys,this.set)))},includes:function(Z){return B(this.has,this.set,Z)}},$.exports=function(Z){_(Z);var ee=+Z.size;if(ee!==ee)throw new N(Q);var le=K(ee);if(le<0)throw new X(Q);return new Y(Z,le)}},61887:function($,ie,f){"use strict";var C=f(48585),_=f(83885),B=Math.floor,K=C("".charAt),k=C("".replace),Q=C("".slice),X=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,N=/\$([$&'`]|\d{1,2})/g;$.exports=function(ce,Y,Z,ee,le,J){var W=Z+ce.length,I=ee.length,V=N;return le!==void 0&&(le=_(le),V=X),k(J,V,function(q,de){var ue;switch(K(de,0)){case"$":return"$";case"&":return ce;case"`":return Q(Y,0,Z);case"'":return Q(Y,W);case"<":ue=le[Q(de,1,-1)];break;default:var ve=+de;if(ve===0)return q;if(ve>I){var pe=B(ve/10);return pe===0?q:pe<=I?ee[pe-1]===void 0?K(de,1):ee[pe-1]+K(de,1):q}ue=ee[ve-1]}return ue===void 0?"":ue})}},4435:function($,ie,f){"use strict";var C=function(_){return _&&_.Math===Math&&_};$.exports=C(typeof globalThis=="object"&&globalThis)||C(typeof window=="object"&&window)||C(typeof self=="object"&&self)||C(typeof f.g=="object"&&f.g)||C(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},96893:function($,ie,f){"use strict";var C=f(48585),_=f(83885),B=C({}.hasOwnProperty);$.exports=Object.hasOwn||function(k,Q){return B(_(k),Q)}},28804:function($){"use strict";$.exports={}},75451:function($,ie,f){"use strict";var C=f(32216);$.exports=C("document","documentElement")},37560:function($,ie,f){"use strict";var C=f(26298),_=f(62181),B=f(9882);$.exports=!C&&!_(function(){return Object.defineProperty(B("div"),"a",{get:function(){return 7}}).a!==7})},35085:function($,ie,f){"use strict";var C=f(48585),_=f(62181),B=f(19454),K=Object,k=C("".split);$.exports=_(function(){return!K("z").propertyIsEnumerable(0)})?function(Q){return B(Q)==="String"?k(Q,""):K(Q)}:K},12998:function($,ie,f){"use strict";var C=f(43895),_=f(78310),B=f(67043);$.exports=function(K,k,Q){var X,N;return B&&C(X=k.constructor)&&X!==Q&&_(N=X.prototype)&&N!==Q.prototype&&B(K,N),K}},59617:function($,ie,f){"use strict";var C=f(48585),_=f(43895),B=f(23835),K=C(Function.toString);_(B.inspectSource)||(B.inspectSource=function(k){return K(k)}),$.exports=B.inspectSource},15130:function($,ie,f){"use strict";var C=f(78310),_=f(55905);$.exports=function(B,K){C(K)&&"cause"in K&&_(B,"cause",K.cause)}},55991:function($,ie,f){"use strict";var C=f(77082),_=f(4435),B=f(78310),K=f(55905),k=f(96893),Q=f(23835),X=f(65830),N=f(28804),ce="Object already initialized",Y=_.TypeError,Z=_.WeakMap,ee,le,J,W=function(de){return J(de)?le(de):ee(de,{})},I=function(de){return function(ue){var ve;if(!B(ue)||(ve=le(ue)).type!==de)throw new Y("Incompatible receiver, "+de+" required");return ve}};if(C||Q.state){var V=Q.state||(Q.state=new Z);V.get=V.get,V.has=V.has,V.set=V.set,ee=function(de,ue){if(V.has(de))throw new Y(ce);return ue.facade=de,V.set(de,ue),ue},le=function(de){return V.get(de)||{}},J=function(de){return V.has(de)}}else{var q=X("state");N[q]=!0,ee=function(de,ue){if(k(de,q))throw new Y(ce);return ue.facade=de,K(de,q,ue),ue},le=function(de){return k(de,q)?de[q]:{}},J=function(de){return k(de,q)}}$.exports={set:ee,get:le,has:J,enforce:W,getterFor:I}},36015:function($,ie,f){"use strict";var C=f(20364),_=f(93175),B=C("iterator"),K=Array.prototype;$.exports=function(k){return k!==void 0&&(_.Array===k||K[B]===k)}},54861:function($,ie,f){"use strict";var C=f(19454);$.exports=Array.isArray||function(B){return C(B)==="Array"}},43895:function($){"use strict";var ie=typeof document=="object"&&document.all;$.exports=typeof ie=="undefined"&&ie!==void 0?function(f){return typeof f=="function"||f===ie}:function(f){return typeof f=="function"}},12657:function($,ie,f){"use strict";var C=f(62181),_=f(43895),B=/#|\.prototype\./,K=function(ce,Y){var Z=Q[k(ce)];return Z===N?!0:Z===X?!1:_(Y)?C(Y):!!Y},k=K.normalize=function(ce){return String(ce).replace(B,".").toLowerCase()},Q=K.data={},X=K.NATIVE="N",N=K.POLYFILL="P";$.exports=K},52606:function($){"use strict";$.exports=function(ie){return ie==null}},78310:function($,ie,f){"use strict";var C=f(43895);$.exports=function(_){return typeof _=="object"?_!==null:C(_)}},98184:function($,ie,f){"use strict";var C=f(78310);$.exports=function(_){return C(_)||_===null}},81142:function($){"use strict";$.exports=!1},13168:function($,ie,f){"use strict";var C=f(78310),_=f(19454),B=f(20364),K=B("match");$.exports=function(k){var Q;return C(k)&&((Q=k[K])!==void 0?!!Q:_(k)==="RegExp")}},50796:function($,ie,f){"use strict";var C=f(32216),_=f(43895),B=f(23062),K=f(72762),k=Object;$.exports=K?function(Q){return typeof Q=="symbol"}:function(Q){var X=C("Symbol");return _(X)&&B(X.prototype,k(Q))}},93303:function($,ie,f){"use strict";var C=f(72304);$.exports=function(_,B,K){for(var k=K?_:_.iterator,Q=_.next,X,N;!(X=C(Q,k)).done;)if(N=B(X.value),N!==void 0)return N}},16291:function($,ie,f){"use strict";var C=f(5402),_=f(72304),B=f(73108),K=f(53545),k=f(36015),Q=f(58079),X=f(23062),N=f(73860),ce=f(34771),Y=f(81703),Z=TypeError,ee=function(J,W){this.stopped=J,this.result=W},le=ee.prototype;$.exports=function(J,W,I){var V=I&&I.that,q=!!(I&&I.AS_ENTRIES),de=!!(I&&I.IS_RECORD),ue=!!(I&&I.IS_ITERATOR),ve=!!(I&&I.INTERRUPTED),pe=C(W,V),Se,Ee,He,Fe,et,Oe,ct,ze=function(It){return Se&&Y(Se,"normal"),new ee(!0,It)},dt=function(It){return q?(B(It),ve?pe(It[0],It[1],ze):pe(It[0],It[1])):ve?pe(It,ze):pe(It)};if(de)Se=J.iterator;else if(ue)Se=J;else{if(Ee=ce(J),!Ee)throw new Z(K(J)+" is not iterable");if(k(Ee)){for(He=0,Fe=Q(J);Fe>He;He++)if(et=dt(J[He]),et&&X(le,et))return et;return new ee(!1)}Se=N(J,Ee)}for(Oe=de?J.next:Se.next;!(ct=_(Oe,Se)).done;){try{et=dt(ct.value)}catch(It){Y(Se,"throw",It)}if(typeof et=="object"&&et&&X(le,et))return et}return new ee(!1)}},52801:function($,ie,f){"use strict";var C=f(81703);$.exports=function(_,B,K){for(var k=_.length-1;k>=0;k--)if(_[k]!==void 0)try{K=C(_[k].iterator,B,K)}catch(Q){B="throw",K=Q}if(B==="throw")throw K;return K}},81703:function($,ie,f){"use strict";var C=f(72304),_=f(73108),B=f(70098);$.exports=function(K,k,Q){var X,N;_(K);try{if(X=B(K,"return"),!X){if(k==="throw")throw Q;return Q}X=C(X,K)}catch(ce){N=!0,X=ce}if(k==="throw")throw Q;if(N)throw X;return _(X),Q}},39626:function($,ie,f){"use strict";var C=f(72304),_=f(12256),B=f(55905),K=f(91626),k=f(20364),Q=f(55991),X=f(70098),N=f(1164).IteratorPrototype,ce=f(75872),Y=f(81703),Z=f(52801),ee=k("toStringTag"),le="IteratorHelper",J="WrapForValidIterator",W="normal",I="throw",V=Q.set,q=function(ve){var pe=Q.getterFor(ve?J:le);return K(_(N),{next:function(){var Ee=pe(this);if(ve)return Ee.nextHandler();if(Ee.done)return ce(void 0,!0);try{var He=Ee.nextHandler();return Ee.returnHandlerResult?He:ce(He,Ee.done)}catch(Fe){throw Ee.done=!0,Fe}},return:function(){var Se=pe(this),Ee=Se.iterator;if(Se.done=!0,ve){var He=X(Ee,"return");return He?C(He,Ee):ce(void 0,!0)}if(Se.inner)try{Y(Se.inner.iterator,W)}catch(Fe){return Y(Ee,I,Fe)}if(Se.openIters)try{Z(Se.openIters,W)}catch(Fe){return Y(Ee,I,Fe)}return Ee&&Y(Ee,W),ce(void 0,!0)}})},de=q(!0),ue=q(!1);B(ue,ee,"Iterator Helper"),$.exports=function(ve,pe,Se){var Ee=function(Fe,et){et?(et.iterator=Fe.iterator,et.next=Fe.next):et=Fe,et.type=pe?J:le,et.returnHandlerResult=!!Se,et.nextHandler=ve,et.counter=0,et.done=!1,V(this,et)};return Ee.prototype=pe?de:ue,Ee}},41328:function($){"use strict";$.exports=function(ie,f){var C=typeof Iterator=="function"&&Iterator.prototype[ie];if(C)try{C.call({next:null},f).next()}catch(_){return!0}}},85385:function($,ie,f){"use strict";var C=f(4435);$.exports=function(_,B){var K=C.Iterator,k=K&&K.prototype,Q=k&&k[_],X=!1;if(Q)try{Q.call({next:function(){return{done:!0}},return:function(){X=!0}},-1)}catch(N){N instanceof B||(X=!1)}if(!X)return Q}},1164:function($,ie,f){"use strict";var C=f(62181),_=f(43895),B=f(78310),K=f(12256),k=f(80796),Q=f(44869),X=f(20364),N=f(81142),ce=X("iterator"),Y=!1,Z,ee,le;[].keys&&(le=[].keys(),"next"in le?(ee=k(k(le)),ee!==Object.prototype&&(Z=ee)):Y=!0);var J=!B(Z)||C(function(){var W={};return Z[ce].call(W)!==W});J?Z={}:N&&(Z=K(Z)),_(Z[ce])||Q(Z,ce,function(){return this}),$.exports={IteratorPrototype:Z,BUGGY_SAFARI_ITERATORS:Y}},93175:function($){"use strict";$.exports={}},58079:function($,ie,f){"use strict";var C=f(43729);$.exports=function(_){return C(_.length)}},50883:function($,ie,f){"use strict";var C=f(48585),_=f(62181),B=f(43895),K=f(96893),k=f(26298),Q=f(47381).CONFIGURABLE,X=f(59617),N=f(55991),ce=N.enforce,Y=N.get,Z=String,ee=Object.defineProperty,le=C("".slice),J=C("".replace),W=C([].join),I=k&&!_(function(){return ee(function(){},"length",{value:8}).length!==8}),V=String(String).split("String"),q=$.exports=function(de,ue,ve){le(Z(ue),0,7)==="Symbol("&&(ue="["+J(Z(ue),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),ve&&ve.getter&&(ue="get "+ue),ve&&ve.setter&&(ue="set "+ue),(!K(de,"name")||Q&&de.name!==ue)&&(k?ee(de,"name",{value:ue,configurable:!0}):de.name=ue),I&&ve&&K(ve,"arity")&&de.length!==ve.arity&&ee(de,"length",{value:ve.arity});try{ve&&K(ve,"constructor")&&ve.constructor?k&&ee(de,"prototype",{writable:!1}):de.prototype&&(de.prototype=void 0)}catch(Se){}var pe=ce(de);return K(pe,"source")||(pe.source=W(V,typeof ue=="string"?ue:"")),de};Function.prototype.toString=q(function(){return B(this)&&Y(this).source||X(this)},"toString")},40758:function($){"use strict";var ie=Math.ceil,f=Math.floor;$.exports=Math.trunc||function(_){var B=+_;return(B>0?f:ie)(B)}},53620:function($,ie,f){"use strict";var C=f(94673);$.exports=function(_,B){return _===void 0?arguments.length<2?"":B:C(_)}},12256:function($,ie,f){"use strict";var C=f(73108),_=f(32787),B=f(63684),K=f(28804),k=f(75451),Q=f(9882),X=f(65830),N=">",ce="<",Y="prototype",Z="script",ee=X("IE_PROTO"),le=function(){},J=function(de){return ce+Z+N+de+ce+"/"+Z+N},W=function(de){de.write(J("")),de.close();var ue=de.parentWindow.Object;return de=null,ue},I=function(){var de=Q("iframe"),ue="java"+Z+":",ve;return de.style.display="none",k.appendChild(de),de.src=String(ue),ve=de.contentWindow.document,ve.open(),ve.write(J("document.F=Object")),ve.close(),ve.F},V,q=function(){try{V=new ActiveXObject("htmlfile")}catch(ue){}q=typeof document!="undefined"?document.domain&&V?W(V):I():W(V);for(var de=B.length;de--;)delete q[Y][B[de]];return q()};K[ee]=!0,$.exports=Object.create||function(ue,ve){var pe;return ue!==null?(le[Y]=C(ue),pe=new le,le[Y]=null,pe[ee]=ue):pe=q(),ve===void 0?pe:_.f(pe,ve)}},32787:function($,ie,f){"use strict";var C=f(26298),_=f(21707),B=f(56802),K=f(73108),k=f(863),Q=f(65515);ie.f=C&&!_?Object.defineProperties:function(N,ce){K(N);for(var Y=k(ce),Z=Q(ce),ee=Z.length,le=0,J;ee>le;)B.f(N,J=Z[le++],Y[J]);return N}},56802:function($,ie,f){"use strict";var C=f(26298),_=f(37560),B=f(21707),K=f(73108),k=f(16303),Q=TypeError,X=Object.defineProperty,N=Object.getOwnPropertyDescriptor,ce="enumerable",Y="configurable",Z="writable";ie.f=C?B?function(le,J,W){if(K(le),J=k(J),K(W),typeof le=="function"&&J==="prototype"&&"value"in W&&Z in W&&!W[Z]){var I=N(le,J);I&&I[Z]&&(le[J]=W.value,W={configurable:Y in W?W[Y]:I[Y],enumerable:ce in W?W[ce]:I[ce],writable:!1})}return X(le,J,W)}:X:function(le,J,W){if(K(le),J=k(J),K(W),_)try{return X(le,J,W)}catch(I){}if("get"in W||"set"in W)throw new Q("Accessors not supported");return"value"in W&&(le[J]=W.value),le}},51453:function($,ie,f){"use strict";var C=f(26298),_=f(72304),B=f(91742),K=f(35124),k=f(863),Q=f(16303),X=f(96893),N=f(37560),ce=Object.getOwnPropertyDescriptor;ie.f=C?ce:function(Z,ee){if(Z=k(Z),ee=Q(ee),N)try{return ce(Z,ee)}catch(le){}if(X(Z,ee))return K(!_(B.f,Z,ee),Z[ee])}},15767:function($,ie,f){"use strict";var C=f(77607),_=f(63684),B=_.concat("length","prototype");ie.f=Object.getOwnPropertyNames||function(k){return C(k,B)}},25466:function($,ie){"use strict";ie.f=Object.getOwnPropertySymbols},80796:function($,ie,f){"use strict";var C=f(96893),_=f(43895),B=f(83885),K=f(65830),k=f(212),Q=K("IE_PROTO"),X=Object,N=X.prototype;$.exports=k?X.getPrototypeOf:function(ce){var Y=B(ce);if(C(Y,Q))return Y[Q];var Z=Y.constructor;return _(Z)&&Y instanceof Z?Z.prototype:Y instanceof X?N:null}},23062:function($,ie,f){"use strict";var C=f(48585);$.exports=C({}.isPrototypeOf)},77607:function($,ie,f){"use strict";var C=f(48585),_=f(96893),B=f(863),K=f(70116).indexOf,k=f(28804),Q=C([].push);$.exports=function(X,N){var ce=B(X),Y=0,Z=[],ee;for(ee in ce)!_(k,ee)&&_(ce,ee)&&Q(Z,ee);for(;N.length>Y;)_(ce,ee=N[Y++])&&(~K(Z,ee)||Q(Z,ee));return Z}},65515:function($,ie,f){"use strict";var C=f(77607),_=f(63684);$.exports=Object.keys||function(K){return C(K,_)}},91742:function($,ie){"use strict";var f={}.propertyIsEnumerable,C=Object.getOwnPropertyDescriptor,_=C&&!f.call({1:2},1);ie.f=_?function(K){var k=C(this,K);return!!k&&k.enumerable}:f},67043:function($,ie,f){"use strict";var C=f(54403),_=f(78310),B=f(47925),K=f(94520);$.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var k=!1,Q={},X;try{X=C(Object.prototype,"__proto__","set"),X(Q,[]),k=Q instanceof Array}catch(N){}return function(ce,Y){return B(ce),K(Y),_(ce)&&(k?X(ce,Y):ce.__proto__=Y),ce}}():void 0)},58538:function($,ie,f){"use strict";var C=f(72304),_=f(43895),B=f(78310),K=TypeError;$.exports=function(k,Q){var X,N;if(Q==="string"&&_(X=k.toString)&&!B(N=C(X,k))||_(X=k.valueOf)&&!B(N=C(X,k))||Q!=="string"&&_(X=k.toString)&&!B(N=C(X,k)))return N;throw new K("Can't convert object to primitive value")}},9791:function($,ie,f){"use strict";var C=f(32216),_=f(48585),B=f(15767),K=f(25466),k=f(73108),Q=_([].concat);$.exports=C("Reflect","ownKeys")||function(N){var ce=B.f(k(N)),Y=K.f;return Y?Q(ce,Y(N)):ce}},77204:function($,ie,f){"use strict";var C=f(56802).f;$.exports=function(_,B,K){K in _||C(_,K,{configurable:!0,get:function(){return B[K]},set:function(k){B[K]=k}})}},26333:function($,ie,f){"use strict";var C=f(4435),_=f(62181),B=C.RegExp,K=!_(function(){var k=!0;try{B(".","d")}catch(le){k=!1}var Q={},X="",N=k?"dgimsy":"gimsy",ce=function(le,J){Object.defineProperty(Q,le,{get:function(){return X+=J,!0}})},Y={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};k&&(Y.hasIndices="d");for(var Z in Y)ce(Z,Y[Z]);var ee=Object.getOwnPropertyDescriptor(B.prototype,"flags").get.call(Q);return ee!==N||X!==N});$.exports={correct:K}},19938:function($,ie,f){"use strict";var C=f(73108);$.exports=function(){var _=C(this),B="";return _.hasIndices&&(B+="d"),_.global&&(B+="g"),_.ignoreCase&&(B+="i"),_.multiline&&(B+="m"),_.dotAll&&(B+="s"),_.unicode&&(B+="u"),_.unicodeSets&&(B+="v"),_.sticky&&(B+="y"),B}},79453:function($,ie,f){"use strict";var C=f(72304),_=f(96893),B=f(23062),K=f(26333),k=f(19938),Q=RegExp.prototype;$.exports=K.correct?function(X){return X.flags}:function(X){return!K.correct&&B(Q,X)&&!_(X,"flags")?C(k,X):X.flags}},47925:function($,ie,f){"use strict";var C=f(52606),_=TypeError;$.exports=function(B){if(C(B))throw new _("Can't call method on "+B);return B}},10158:function($,ie,f){"use strict";var C=f(4435),_=f(18e3),B=f(43895),K=f(26834),k=f(81840),Q=f(32945),X=f(79638),N=C.Function,ce=/MSIE .\./.test(k)||K==="BUN"&&function(){var Y=C.Bun.version.split(".");return Y.length<3||Y[0]==="0"&&(Y[1]<3||Y[1]==="3"&&Y[2]==="0")}();$.exports=function(Y,Z){var ee=Z?2:1;return ce?function(le,J){var W=X(arguments.length,1)>ee,I=B(le)?le:N(le),V=W?Q(arguments,ee):[],q=W?function(){_(I,this,V)}:I;return Z?Y(q,J):Y(q)}:Y}},30378:function($,ie,f){"use strict";var C=f(21203),_=f(51917),B=C.Set,K=C.add;$.exports=function(k){var Q=new B;return _(k,function(X){K(Q,X)}),Q}},21994:function($,ie,f){"use strict";var C=f(63745),_=f(21203),B=f(30378),K=f(68064),k=f(15817),Q=f(51917),X=f(93303),N=_.has,ce=_.remove;$.exports=function(Z){var ee=C(this),le=k(Z),J=B(ee);return K(ee)<=le.size?Q(ee,function(W){le.includes(W)&&ce(J,W)}):X(le.getIterator(),function(W){N(J,W)&&ce(J,W)}),J}},21203:function($,ie,f){"use strict";var C=f(48585),_=Set.prototype;$.exports={Set,add:C(_.add),has:C(_.has),remove:C(_.delete),proto:_}},79674:function($,ie,f){"use strict";var C=f(63745),_=f(21203),B=f(68064),K=f(15817),k=f(51917),Q=f(93303),X=_.Set,N=_.add,ce=_.has;$.exports=function(Z){var ee=C(this),le=K(Z),J=new X;return B(ee)>le.size?Q(le.getIterator(),function(W){ce(ee,W)&&N(J,W)}):k(ee,function(W){le.includes(W)&&N(J,W)}),J}},28072:function($,ie,f){"use strict";var C=f(63745),_=f(21203).has,B=f(68064),K=f(15817),k=f(51917),Q=f(93303),X=f(81703);$.exports=function(ce){var Y=C(this),Z=K(ce);if(B(Y)<=Z.size)return k(Y,function(le){if(Z.includes(le))return!1},!0)!==!1;var ee=Z.getIterator();return Q(ee,function(le){if(_(Y,le))return X(ee,"normal",!1)})!==!1}},38728:function($,ie,f){"use strict";var C=f(63745),_=f(68064),B=f(51917),K=f(15817);$.exports=function(Q){var X=C(this),N=K(Q);return _(X)>N.size?!1:B(X,function(ce){if(!N.includes(ce))return!1},!0)!==!1}},16785:function($,ie,f){"use strict";var C=f(63745),_=f(21203).has,B=f(68064),K=f(15817),k=f(93303),Q=f(81703);$.exports=function(N){var ce=C(this),Y=K(N);if(B(ce)<Y.size)return!1;var Z=Y.getIterator();return k(Z,function(ee){if(!_(ce,ee))return Q(Z,"normal",!1)})!==!1}},51917:function($,ie,f){"use strict";var C=f(48585),_=f(93303),B=f(21203),K=B.Set,k=B.proto,Q=C(k.forEach),X=C(k.keys),N=X(new K).next;$.exports=function(ce,Y,Z){return Z?_({iterator:X(ce),next:N},Y):Q(ce,Y)}},55157:function($,ie,f){"use strict";var C=f(32216),_=function(K){return{size:K,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},B=function(K){return{size:K,has:function(){return!0},keys:function(){throw new Error("e")}}};$.exports=function(K,k){var Q=C("Set");try{new Q()[K](_(0));try{return new Q()[K](_(-1)),!1}catch(N){if(!k)return!0;try{return new Q()[K](B(-1/0)),!1}catch(ce){var X=new Q;return X.add(1),X.add(2),k(X[K](B(1/0)))}}}catch(N){return!1}}},24160:function($){"use strict";$.exports=function(ie){try{var f=new Set,C={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return f.clear(),f.add(4),function(){return{done:!0}}}})}},_=f[ie](C);return _.size!==1||_.values().next().value!==4}catch(B){return!1}}},68064:function($,ie,f){"use strict";var C=f(54403),_=f(21203);$.exports=C(_.proto,"size","get")||function(B){return B.size}},5134:function($,ie,f){"use strict";var C=f(63745),_=f(21203),B=f(30378),K=f(15817),k=f(93303),Q=_.add,X=_.has,N=_.remove;$.exports=function(Y){var Z=C(this),ee=K(Y).getIterator(),le=B(Z);return k(ee,function(J){X(Z,J)?N(le,J):Q(le,J)}),le}},80471:function($,ie,f){"use strict";var C=f(63745),_=f(21203).add,B=f(30378),K=f(15817),k=f(93303);$.exports=function(X){var N=C(this),ce=K(X).getIterator(),Y=B(N);return k(ce,function(Z){_(Y,Z)}),Y}},65830:function($,ie,f){"use strict";var C=f(95889),_=f(38146),B=C("keys");$.exports=function(K){return B[K]||(B[K]=_(K))}},23835:function($,ie,f){"use strict";var C=f(81142),_=f(4435),B=f(49133),K="__core-js_shared__",k=$.exports=_[K]||B(K,{});(k.versions||(k.versions=[])).push({version:"3.43.0",mode:C?"pure":"global",copyright:"\xA9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"})},95889:function($,ie,f){"use strict";var C=f(23835);$.exports=function(_,B){return C[_]||(C[_]=B||{})}},43733:function($,ie,f){"use strict";var C=f(97774),_=f(62181),B=f(4435),K=B.String;$.exports=!!Object.getOwnPropertySymbols&&!_(function(){var k=Symbol("symbol detection");return!K(k)||!(Object(k)instanceof Symbol)||!Symbol.sham&&C&&C<41})},89724:function($,ie,f){"use strict";var C=f(4435),_=f(18e3),B=f(5402),K=f(43895),k=f(96893),Q=f(62181),X=f(75451),N=f(32945),ce=f(9882),Y=f(79638),Z=f(39200),ee=f(81685),le=C.setImmediate,J=C.clearImmediate,W=C.process,I=C.Dispatch,V=C.Function,q=C.MessageChannel,de=C.String,ue=0,ve={},pe="onreadystatechange",Se,Ee,He,Fe;Q(function(){Se=C.location});var et=function(dt){if(k(ve,dt)){var It=ve[dt];delete ve[dt],It()}},Oe=function(dt){return function(){et(dt)}},ct=function(dt){et(dt.data)},ze=function(dt){C.postMessage(de(dt),Se.protocol+"//"+Se.host)};(!le||!J)&&(le=function(It){Y(arguments.length,1);var Sn=K(It)?It:V(It),jt=N(arguments,1);return ve[++ue]=function(){_(Sn,void 0,jt)},Ee(ue),ue},J=function(It){delete ve[It]},ee?Ee=function(dt){W.nextTick(Oe(dt))}:I&&I.now?Ee=function(dt){I.now(Oe(dt))}:q&&!Z?(He=new q,Fe=He.port2,He.port1.onmessage=ct,Ee=B(Fe.postMessage,Fe)):C.addEventListener&&K(C.postMessage)&&!C.importScripts&&Se&&Se.protocol!=="file:"&&!Q(ze)?(Ee=ze,C.addEventListener("message",ct,!1)):pe in ce("script")?Ee=function(dt){X.appendChild(ce("script"))[pe]=function(){X.removeChild(this),et(dt)}}:Ee=function(dt){setTimeout(Oe(dt),0)}),$.exports={set:le,clear:J}},30872:function($,ie,f){"use strict";var C=f(80098),_=Math.max,B=Math.min;$.exports=function(K,k){var Q=C(K);return Q<0?_(Q+k,0):B(Q,k)}},863:function($,ie,f){"use strict";var C=f(35085),_=f(47925);$.exports=function(B){return C(_(B))}},80098:function($,ie,f){"use strict";var C=f(40758);$.exports=function(_){var B=+_;return B!==B||B===0?0:C(B)}},43729:function($,ie,f){"use strict";var C=f(80098),_=Math.min;$.exports=function(B){var K=C(B);return K>0?_(K,9007199254740991):0}},83885:function($,ie,f){"use strict";var C=f(47925),_=Object;$.exports=function(B){return _(C(B))}},26010:function($,ie,f){"use strict";var C=f(72304),_=f(78310),B=f(50796),K=f(70098),k=f(58538),Q=f(20364),X=TypeError,N=Q("toPrimitive");$.exports=function(ce,Y){if(!_(ce)||B(ce))return ce;var Z=K(ce,N),ee;if(Z){if(Y===void 0&&(Y="default"),ee=C(Z,ce,Y),!_(ee)||B(ee))return ee;throw new X("Can't convert object to primitive value")}return Y===void 0&&(Y="number"),k(ce,Y)}},16303:function($,ie,f){"use strict";var C=f(26010),_=f(50796);$.exports=function(B){var K=C(B,"string");return _(K)?K:K+""}},99530:function($,ie,f){"use strict";var C=f(20364),_=C("toStringTag"),B={};B[_]="z",$.exports=String(B)==="[object z]"},94673:function($,ie,f){"use strict";var C=f(4767),_=String;$.exports=function(B){if(C(B)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return _(B)}},53545:function($){"use strict";var ie=String;$.exports=function(f){try{return ie(f)}catch(C){return"Object"}}},38146:function($,ie,f){"use strict";var C=f(48585),_=0,B=Math.random(),K=C(1.1.toString);$.exports=function(k){return"Symbol("+(k===void 0?"":k)+")_"+K(++_+B,36)}},72762:function($,ie,f){"use strict";var C=f(43733);$.exports=C&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},21707:function($,ie,f){"use strict";var C=f(26298),_=f(62181);$.exports=C&&_(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},79638:function($){"use strict";var ie=TypeError;$.exports=function(f,C){if(f<C)throw new ie("Not enough arguments");return f}},77082:function($,ie,f){"use strict";var C=f(4435),_=f(43895),B=C.WeakMap;$.exports=_(B)&&/native code/.test(String(B))},20364:function($,ie,f){"use strict";var C=f(4435),_=f(95889),B=f(96893),K=f(38146),k=f(43733),Q=f(72762),X=C.Symbol,N=_("wks"),ce=Q?X.for||X:X&&X.withoutSetter||K;$.exports=function(Y){return B(N,Y)||(N[Y]=k&&B(X,Y)?X[Y]:ce("Symbol."+Y)),N[Y]}},95442:function($,ie,f){"use strict";var C=f(32216),_=f(96893),B=f(55905),K=f(23062),k=f(67043),Q=f(47073),X=f(77204),N=f(12998),ce=f(53620),Y=f(15130),Z=f(43021),ee=f(26298),le=f(81142);$.exports=function(J,W,I,V){var q="stackTraceLimit",de=V?2:1,ue=J.split("."),ve=ue[ue.length-1],pe=C.apply(null,ue);if(pe){var Se=pe.prototype;if(!le&&_(Se,"cause")&&delete Se.cause,!I)return pe;var Ee=C("Error"),He=W(function(Fe,et){var Oe=ce(V?et:Fe,void 0),ct=V?new pe(Fe):new pe;return Oe!==void 0&&B(ct,"message",Oe),Z(ct,He,ct.stack,2),this&&K(Se,this)&&N(ct,this,He),arguments.length>de&&Y(ct,arguments[de]),ct});if(He.prototype=Se,ve!=="Error"?k?k(He,Ee):Q(He,Ee,{name:!0}):ee&&q in pe&&(X(He,pe,q),X(He,pe,"prepareStackTrace")),Q(He,pe),!le)try{Se.name!==ve&&B(Se,"name",ve),Se.constructor=He}catch(Fe){}return He}}},61699:function($,ie,f){"use strict";var C=f(60416),_=f(83885),B=f(58079),K=f(80098),k=f(37833);C({target:"Array",proto:!0},{at:function(X){var N=_(this),ce=B(N),Y=K(X),Z=Y>=0?Y:ce+Y;return Z<0||Z>=ce?void 0:N[Z]}}),k("at")},25813:function($,ie,f){"use strict";var C=f(60416),_=f(83885),B=f(58079),K=f(50882),k=f(35780),Q=f(62181),X=Q(function(){return[].push.call({length:4294967296},1)!==4294967297}),N=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(Y){return Y instanceof TypeError}},ce=X||!N();C({target:"Array",proto:!0,arity:1,forced:ce},{push:function(Z){var ee=_(this),le=B(ee),J=arguments.length;k(le+J);for(var W=0;W<J;W++)ee[le]=arguments[W],le++;return K(ee,le),le}})},80686:function($,ie,f){"use strict";var C=f(60416),_=f(48585),B=f(4276),K=f(863),k=f(34433),Q=f(71317),X=f(37833),N=Array,ce=_(Q("Array","sort"));C({target:"Array",proto:!0},{toSorted:function(Z){Z!==void 0&&B(Z);var ee=K(this),le=k(N,ee);return ce(le,Z)}}),X("toSorted")},25372:function($,ie,f){"use strict";var C=f(37833);C("flatMap")},25799:function($,ie,f){"use strict";var C=f(37833);C("flat")},82891:function($,ie,f){"use strict";var C=f(60416),_=f(83885),B=f(58079),K=f(50882),k=f(99311),Q=f(35780),X=[].unshift(0)!==1,N=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(Y){return Y instanceof TypeError}},ce=X||!N();C({target:"Array",proto:!0,arity:1,forced:ce},{unshift:function(Z){var ee=_(this),le=B(ee),J=arguments.length;if(J){Q(le+J);for(var W=le;W--;){var I=W+J;W in ee?ee[I]=ee[W]:k(ee,I)}for(var V=0;V<J;V++)ee[V]=arguments[V]}return K(ee,le+J)}})},29297:function($,ie,f){"use strict";var C=f(60416),_=f(4435),B=f(18e3),K=f(95442),k="WebAssembly",Q=_[k],X=new Error("e",{cause:7}).cause!==7,N=function(Y,Z){var ee={};ee[Y]=K(Y,Z,X),C({global:!0,constructor:!0,arity:1,forced:X},ee)},ce=function(Y,Z){if(Q&&Q[Y]){var ee={};ee[Y]=K(k+"."+Y,Z,X),C({target:k,stat:!0,constructor:!0,arity:1,forced:X},ee)}};N("Error",function(Y){return function(ee){return B(Y,this,arguments)}}),N("EvalError",function(Y){return function(ee){return B(Y,this,arguments)}}),N("RangeError",function(Y){return function(ee){return B(Y,this,arguments)}}),N("ReferenceError",function(Y){return function(ee){return B(Y,this,arguments)}}),N("SyntaxError",function(Y){return function(ee){return B(Y,this,arguments)}}),N("TypeError",function(Y){return function(ee){return B(Y,this,arguments)}}),N("URIError",function(Y){return function(ee){return B(Y,this,arguments)}}),ce("CompileError",function(Y){return function(ee){return B(Y,this,arguments)}}),ce("LinkError",function(Y){return function(ee){return B(Y,this,arguments)}}),ce("RuntimeError",function(Y){return function(ee){return B(Y,this,arguments)}})},68984:function($,ie,f){"use strict";var C=f(60416),_=f(4435),B=f(13593),K=f(73108),k=f(43895),Q=f(80796),X=f(20255),N=f(20767),ce=f(62181),Y=f(96893),Z=f(20364),ee=f(1164).IteratorPrototype,le=f(26298),J=f(81142),W="constructor",I="Iterator",V=Z("toStringTag"),q=TypeError,de=_[I],ue=J||!k(de)||de.prototype!==ee||!ce(function(){de({})}),ve=function(){if(B(this,ee),Q(this)===ee)throw new q("Abstract class Iterator not directly constructable")},pe=function(Se,Ee){le?X(ee,Se,{configurable:!0,get:function(){return Ee},set:function(He){if(K(this),this===ee)throw new q("You can't redefine this property");Y(this,Se)?this[Se]=He:N(this,Se,He)}}):ee[Se]=Ee};Y(ee,V)||pe(V,I),(ue||!Y(ee,W)||ee[W]===Object)&&pe(W,ve),ve.prototype=ee,C({global:!0,constructor:!0,forced:ue},{Iterator:ve})},31867:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(16291),K=f(4276),k=f(73108),Q=f(14732),X=f(81703),N=f(85385),ce=N("every",TypeError);C({target:"Iterator",proto:!0,real:!0,forced:ce},{every:function(Z){k(this);try{K(Z)}catch(J){X(this,"throw",J)}if(ce)return _(ce,this,Z);var ee=Q(this),le=0;return!B(ee,function(J,W){if(!Z(J,le++))return W()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},2825:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(4276),K=f(73108),k=f(14732),Q=f(39626),X=f(77752),N=f(81142),ce=f(81703),Y=f(41328),Z=f(85385),ee=!N&&!Y("filter",function(){}),le=!N&&!ee&&Z("filter",TypeError),J=N||ee||le,W=Q(function(){for(var I=this.iterator,V=this.predicate,q=this.next,de,ue,ve;;){if(de=K(_(q,I)),ue=this.done=!!de.done,ue)return;if(ve=de.value,X(I,V,[ve,this.counter++],!0))return ve}});C({target:"Iterator",proto:!0,real:!0,forced:J},{filter:function(V){K(this);try{B(V)}catch(q){ce(this,"throw",q)}return le?_(le,this,V):new W(k(this),{predicate:V})}})},1720:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(16291),K=f(4276),k=f(73108),Q=f(14732),X=f(81703),N=f(85385),ce=N("find",TypeError);C({target:"Iterator",proto:!0,real:!0,forced:ce},{find:function(Z){k(this);try{K(Z)}catch(J){X(this,"throw",J)}if(ce)return _(ce,this,Z);var ee=Q(this),le=0;return B(ee,function(J,W){if(Z(J,le++))return W(J)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},65374:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(4276),K=f(73108),k=f(14732),Q=f(8125),X=f(39626),N=f(81703),ce=f(81142),Y=f(41328),Z=f(85385),ee=!ce&&!Y("flatMap",function(){}),le=!ce&&!ee&&Z("flatMap",TypeError),J=ce||ee||le,W=X(function(){for(var I=this.iterator,V=this.mapper,q,de;;){if(de=this.inner)try{if(q=K(_(de.next,de.iterator)),!q.done)return q.value;this.inner=null}catch(ue){N(I,"throw",ue)}if(q=K(_(this.next,I)),this.done=!!q.done)return;try{this.inner=Q(V(q.value,this.counter++),!1)}catch(ue){N(I,"throw",ue)}}});C({target:"Iterator",proto:!0,real:!0,forced:J},{flatMap:function(V){K(this);try{B(V)}catch(q){N(this,"throw",q)}return le?_(le,this,V):new W(k(this),{mapper:V,inner:null})}})},27257:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(16291),K=f(4276),k=f(73108),Q=f(14732),X=f(81703),N=f(85385),ce=N("forEach",TypeError);C({target:"Iterator",proto:!0,real:!0,forced:ce},{forEach:function(Z){k(this);try{K(Z)}catch(J){X(this,"throw",J)}if(ce)return _(ce,this,Z);var ee=Q(this),le=0;B(ee,function(J){Z(J,le++)},{IS_RECORD:!0})}})},32795:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(4276),K=f(73108),k=f(14732),Q=f(39626),X=f(77752),N=f(81703),ce=f(41328),Y=f(85385),Z=f(81142),ee=!Z&&!ce("map",function(){}),le=!Z&&!ee&&Y("map",TypeError),J=Z||ee||le,W=Q(function(){var I=this.iterator,V=K(_(this.next,I)),q=this.done=!!V.done;if(!q)return X(I,this.mapper,[V.value,this.counter++],!0)});C({target:"Iterator",proto:!0,real:!0,forced:J},{map:function(V){K(this);try{B(V)}catch(q){N(this,"throw",q)}return le?_(le,this,V):new W(k(this),{mapper:V})}})},90971:function($,ie,f){"use strict";var C=f(60416),_=f(16291),B=f(4276),K=f(73108),k=f(14732),Q=f(81703),X=f(85385),N=f(18e3),ce=f(62181),Y=TypeError,Z=ce(function(){[].keys().reduce(function(){},void 0)}),ee=!Z&&X("reduce",Y);C({target:"Iterator",proto:!0,real:!0,forced:Z||ee},{reduce:function(J){K(this);try{B(J)}catch(de){Q(this,"throw",de)}var W=arguments.length<2,I=W?void 0:arguments[1];if(ee)return N(ee,this,W?[J]:[J,I]);var V=k(this),q=0;if(_(V,function(de){W?(W=!1,I=de):I=J(I,de,q),q++},{IS_RECORD:!0}),W)throw new Y("Reduce of empty iterator with no initial value");return I}})},86901:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(16291),K=f(4276),k=f(73108),Q=f(14732),X=f(81703),N=f(85385),ce=N("some",TypeError);C({target:"Iterator",proto:!0,real:!0,forced:ce},{some:function(Z){k(this);try{K(Z)}catch(J){X(this,"throw",J)}if(ce)return _(ce,this,Z);var ee=Q(this),le=0;return B(ee,function(J,W){if(Z(J,le++))return W()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},18601:function($,ie,f){"use strict";var C=f(60416),_=f(32216),B=f(18e3),K=f(72304),k=f(48585),Q=f(62181),X=f(43895),N=f(50796),ce=f(32945),Y=f(1268),Z=f(43733),ee=String,le=_("JSON","stringify"),J=k(/./.exec),W=k("".charAt),I=k("".charCodeAt),V=k("".replace),q=k(1.1.toString),de=/[\uD800-\uDFFF]/g,ue=/^[\uD800-\uDBFF]$/,ve=/^[\uDC00-\uDFFF]$/,pe=!Z||Q(function(){var Fe=_("Symbol")("stringify detection");return le([Fe])!=="[null]"||le({a:Fe})!=="{}"||le(Object(Fe))!=="{}"}),Se=Q(function(){return le("\uDF06\uD834")!=='"\\udf06\\ud834"'||le("\uDEAD")!=='"\\udead"'}),Ee=function(Fe,et){var Oe=ce(arguments),ct=Y(et);if(!(!X(ct)&&(Fe===void 0||N(Fe))))return Oe[1]=function(ze,dt){if(X(ct)&&(dt=K(ct,this,ee(ze),dt)),!N(dt))return dt},B(le,null,Oe)},He=function(Fe,et,Oe){var ct=W(Oe,et-1),ze=W(Oe,et+1);return J(ue,Fe)&&!J(ve,ze)||J(ve,Fe)&&!J(ue,ct)?"\\u"+q(I(Fe,0),16):Fe};le&&C({target:"JSON",stat:!0,arity:3,forced:pe||Se},{stringify:function(et,Oe,ct){var ze=ce(arguments),dt=B(pe?Ee:le,null,ze);return Se&&typeof dt=="string"?V(dt,de,He):dt}})},13588:function($,ie,f){"use strict";var C=f(60416),_=f(16291),B=f(20767);C({target:"Object",stat:!0},{fromEntries:function(k){var Q={};return _(k,function(X,N){B(Q,X,N)},{AS_ENTRIES:!0}),Q}})},71441:function($,ie,f){"use strict";var C=f(60416),_=f(21994),B=f(62181),K=f(55157),k=!K("difference",function(X){return X.size===0}),Q=k||B(function(){var X={size:1,has:function(){return!0},keys:function(){var ce=0;return{next:function(){var Y=ce++>1;return N.has(1)&&N.clear(),{done:Y,value:2}}}}},N=new Set([1,2,3,4]);return N.difference(X).size!==3});C({target:"Set",proto:!0,real:!0,forced:Q},{difference:_})},31702:function($,ie,f){"use strict";var C=f(60416),_=f(62181),B=f(79674),K=f(55157),k=!K("intersection",function(Q){return Q.size===2&&Q.has(1)&&Q.has(2)})||_(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});C({target:"Set",proto:!0,real:!0,forced:k},{intersection:B})},89050:function($,ie,f){"use strict";var C=f(60416),_=f(28072),B=f(55157),K=!B("isDisjointFrom",function(k){return!k});C({target:"Set",proto:!0,real:!0,forced:K},{isDisjointFrom:_})},16110:function($,ie,f){"use strict";var C=f(60416),_=f(38728),B=f(55157),K=!B("isSubsetOf",function(k){return k});C({target:"Set",proto:!0,real:!0,forced:K},{isSubsetOf:_})},8274:function($,ie,f){"use strict";var C=f(60416),_=f(16785),B=f(55157),K=!B("isSupersetOf",function(k){return!k});C({target:"Set",proto:!0,real:!0,forced:K},{isSupersetOf:_})},64109:function($,ie,f){"use strict";var C=f(60416),_=f(5134),B=f(24160),K=f(55157),k=!K("symmetricDifference")||!B("symmetricDifference");C({target:"Set",proto:!0,real:!0,forced:k},{symmetricDifference:_})},92128:function($,ie,f){"use strict";var C=f(60416),_=f(80471),B=f(24160),K=f(55157),k=!K("union")||!B("union");C({target:"Set",proto:!0,real:!0,forced:k},{union:_})},47723:function($,ie,f){"use strict";var C=f(60416),_=f(48585),B=f(47925),K=f(80098),k=f(94673),Q=f(62181),X=_("".charAt),N=Q(function(){return"\u{20BB7}".at(-2)!=="\uD842"});C({target:"String",proto:!0,forced:N},{at:function(Y){var Z=k(B(this)),ee=Z.length,le=K(Y),J=le>=0?le:ee+le;return J<0||J>=ee?void 0:X(Z,J)}})},34499:function($,ie,f){"use strict";var C=f(60416),_=f(72304),B=f(48585),K=f(47925),k=f(43895),Q=f(78310),X=f(13168),N=f(94673),ce=f(70098),Y=f(79453),Z=f(61887),ee=f(20364),le=f(81142),J=ee("replace"),W=TypeError,I=B("".indexOf),V=B("".replace),q=B("".slice),de=Math.max;C({target:"String",proto:!0},{replaceAll:function(ve,pe){var Se=K(this),Ee,He,Fe,et,Oe,ct,ze,dt,It,Sn,jt=0,Ye="";if(Q(ve)){if(Ee=X(ve),Ee&&(He=N(K(Y(ve))),!~I(He,"g")))throw new W("`.replaceAll` does not allow non-global regexes");if(Fe=ce(ve,J),Fe)return _(Fe,ve,Se,pe);if(le&&Ee)return V(N(Se),ve,pe)}for(et=N(Se),Oe=N(ve),ct=k(pe),ct||(pe=N(pe)),ze=Oe.length,dt=de(1,ze),It=I(et,Oe);It!==-1;)Sn=ct?N(pe(Oe,It,et)):Z(Oe,et,It,[],void 0,pe),Ye+=q(et,jt,It)+Sn,jt=It+ze,It=It+dt>et.length?-1:I(et,Oe,It+dt);return jt<et.length&&(Ye+=q(et,jt)),Ye}})},48442:function($,ie,f){"use strict";f(68984)},49691:function($,ie,f){"use strict";f(31867)},78127:function($,ie,f){"use strict";f(2825)},11174:function($,ie,f){"use strict";f(1720)},30834:function($,ie,f){"use strict";f(65374)},97487:function($,ie,f){"use strict";f(27257)},73190:function($,ie,f){"use strict";f(32795)},66515:function($,ie,f){"use strict";f(90971)},5499:function($,ie,f){"use strict";f(86901)},76806:function($,ie,f){"use strict";var C=f(60416),_=f(4435),B=f(89724).clear;C({global:!0,bind:!0,enumerable:!0,forced:_.clearImmediate!==B},{clearImmediate:B})},83225:function($,ie,f){"use strict";f(76806),f(66234)},66234:function($,ie,f){"use strict";var C=f(60416),_=f(4435),B=f(89724).set,K=f(10158),k=_.setImmediate?K(B,!1):B;C({global:!0,bind:!0,enumerable:!0,forced:_.setImmediate!==k},{setImmediate:k})},4338:function($,ie,f){"use strict";f.d(ie,{P:function(){return k},Q:function(){return K}});const C=/^(\r\n|\n\r|\r|\n)/,_=/^[^\t\r\n]+/,B=/^\t/;function K(Q){const X=[[""]];if(Q.length===0)return X;let N=0,ce=0,Y;for(;Q.length>0&&Y!==Q.length;)if(Y=Q.length,Q.match(B))Q=Q.replace(B,""),N+=1,X[ce][N]="";else if(Q.match(C))Q=Q.replace(C,""),N=0,ce+=1,X[ce]=[""];else{let Z="";if(Q.startsWith('"')){let ee=0,le=!0;for(;le;){const J=Q.slice(0,1);J==='"'&&(ee+=1),Z+=J,Q=Q.slice(1),(Q.length===0||Q.match(/^[\t\r\n]/)&&ee%2===0)&&(le=!1)}Z=Z.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,J=>new Array(Math.floor(J.length/2)).fill('"').join(""))}else{const ee=Q.match(_);Z=ee?ee[0]:"",Q=Q.slice(Z.length)}X[ce][N]=Z}return X}function k(Q){let X,N,ce,Y,Z="",ee;for(X=0,N=Q.length;X<N;X+=1){for(Y=Q[X].length,ce=0;ce<Y;ce+=1)ce>0&&(Z+="	"),ee=Q[X][ce],typeof ee=="string"?ee.indexOf(`
`)>-1?Z+=`"${ee.replace(/"/g,'""')}"`:Z+=ee:ee==null?Z+="":Z+=ee;X!==N-1&&(Z+=`
`)}return Z}},76161:function($,ie,f){"use strict";f.d(ie,{f:function(){return Y}});var C=f(29297),_=f.n(C),B=f(48442),K=f.n(B),k=f(97487),Q=f.n(k);function X(Z,ee,le){return(ee=N(ee))in Z?Object.defineProperty(Z,ee,{value:le,enumerable:!0,configurable:!0,writable:!0}):Z[ee]=le,Z}function N(Z){var ee=ce(Z,"string");return typeof ee=="symbol"?ee:ee+""}function ce(Z,ee){if(typeof Z!="object"||!Z)return Z;var le=Z[Symbol.toPrimitive];if(le!==void 0){var J=le.call(Z,ee||"default");if(typeof J!="object")return J;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ee==="string"?String:Number)(Z)}class Y{constructor(ee){X(this,"calculationTypes",[]),X(this,"calculationResults",new Map),this.calculationTypes=ee}_initialize(ee){this.calculationTypes.forEach(le=>{let[J,W]=le;this.calculationResults.set(J,W),W.initialize(ee)})}_process(ee,le){this.calculationTypes.forEach(J=>{let[,W]=J;return W.process(ee,le)})}_finalize(ee){this.calculationTypes.forEach(le=>{let[,J]=le;return J.finalize(ee)})}getResultsFor(ee){return this.calculationResults.get(ee)}}},39097:function($,ie,f){"use strict";f.d(ie,{$:function(){return ce},E:function(){return Y}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(76161);function Q(Z,ee,le){return(ee=X(ee))in Z?Object.defineProperty(Z,ee,{value:le,enumerable:!0,configurable:!0,writable:!0}):Z[ee]=le,Z}function X(Z){var ee=N(Z,"string");return typeof ee=="symbol"?ee:ee+""}function N(Z,ee){if(typeof Z!="object"||!Z)return Z;var le=Z[Symbol.toPrimitive];if(le!==void 0){var J=le.call(Z,ee||"default");if(typeof J!="object")return J;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ee==="string"?String:Number)(Z)}const ce=50;class Y extends k.f{constructor(ee){let{calculationTypes:le,viewportWidth:J,scrollOffset:W,totalColumns:I,columnWidthFn:V,overrideFn:q,inlineStartOffset:de}=ee;super(le),Q(this,"viewportWidth",0),Q(this,"scrollOffset",0),Q(this,"zeroBasedScrollOffset",0),Q(this,"totalColumns",0),Q(this,"columnWidthFn",null),Q(this,"columnWidth",0),Q(this,"overrideFn",null),Q(this,"inlineStartOffset",0),Q(this,"totalCalculatedWidth",0),Q(this,"startPositions",[]),Q(this,"needReverse",!0),this.viewportWidth=J,this.scrollOffset=W,this.zeroBasedScrollOffset=Math.max(W,0),this.totalColumns=I,this.columnWidthFn=V,this.overrideFn=q,this.inlineStartOffset=de,this.calculate()}calculate(){this._initialize(this);for(let ee=0;ee<this.totalColumns;ee++)if(this.columnWidth=this.getColumnWidth(ee),this._process(ee,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(ee){const le=this.columnWidthFn(ee);return isNaN(le)?ce:le}}},958:function($,ie,f){"use strict";var C=f(29297),_=f.n(C);function B(le,J,W){K(le,J),J.set(le,W)}function K(le,J){if(J.has(le))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k(le,J,W){return(J=Q(J))in le?Object.defineProperty(le,J,{value:W,enumerable:!0,configurable:!0,writable:!0}):le[J]=W,le}function Q(le){var J=X(le,"string");return typeof J=="symbol"?J:J+""}function X(le,J){if(typeof le!="object"||!le)return le;var W=le[Symbol.toPrimitive];if(W!==void 0){var I=W.call(le,J||"default");if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(J==="string"?String:Number)(le)}function N(le,J){return le.get(Y(le,J))}function ce(le,J,W){return le.set(Y(le,J),W),W}function Y(le,J,W){if(typeof le=="function"?le===J:le.has(J))return arguments.length<3?J:W;throw new TypeError("Private element is not present on this object")}var Z=new WeakMap;class ee{constructor(J,W){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;k(this,"row",null),k(this,"col",null),B(this,Z,!1),ce(Z,this,I),typeof J!="undefined"&&typeof W!="undefined"&&(this.row=J,this.col=W)}isValid(J){const{countRows:W,countCols:I,countRowHeaders:V,countColHeaders:q}=hi({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},J);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-q||this.col<-V||this.row>=W||this.col>=I)}isEqual(J){return J===this?!0:this.row===J.row&&this.col===J.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return N(Z,this)}isSouthEastOf(J){return this.row>=J.row&&(N(Z,this)?this.col<=J.col:this.col>=J.col)}isNorthWestOf(J){return this.row<=J.row&&(N(Z,this)?this.col>=J.col:this.col<=J.col)}isSouthWestOf(J){return this.row>=J.row&&(N(Z,this)?this.col>=J.col:this.col<=J.col)}isNorthEastOf(J){return this.row<=J.row&&(N(Z,this)?this.col<=J.col:this.col>=J.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(J){return Number.isInteger(J==null?void 0:J.row)&&(this.row=J.row),Number.isInteger(J==null?void 0:J.col)&&(this.col=J.col),J instanceof ee&&ce(Z,this,J.isRtl()),this}clone(){return new ee(this.row,this.col,N(Z,this))}toObject(){return{row:this.row,col:this.col}}}ie.Z=ee},6146:function($,ie,f){"use strict";var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(958);function Q(I,V,q){X(I,V),V.set(I,q)}function X(I,V){if(V.has(I))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N(I,V,q){return(V=ce(V))in I?Object.defineProperty(I,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):I[V]=q,I}function ce(I){var V=Y(I,"string");return typeof V=="symbol"?V:V+""}function Y(I,V){if(typeof I!="object"||!I)return I;var q=I[Symbol.toPrimitive];if(q!==void 0){var de=q.call(I,V||"default");if(typeof de!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(I)}function Z(I,V){return I.get(le(I,V))}function ee(I,V,q){return I.set(le(I,V),q),q}function le(I,V,q){if(typeof I=="function"?I===V:I.has(V))return arguments.length<3?V:q;throw new TypeError("Private element is not present on this object")}var J=new WeakMap;class W{constructor(V){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:V,de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:V,ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;N(this,"highlight",null),N(this,"from",null),N(this,"to",null),Q(this,J,!1),this.highlight=V.clone(),this.from=q.clone(),this.to=de.clone(),ee(J,this,ue)}setHighlight(V){return this.highlight=V.clone(),this}setFrom(V){return this.from=V.clone(),this}setTo(V){return this.to=V.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(V){return this.from.isValid(V)&&this.to.isValid(V)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const V=Math.max(this.from.row,0),q=Math.max(this.to.row,0);return Math.max(V,q)-Math.min(V,q)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const V=Math.max(this.from.col,0),q=Math.max(this.to.col,0);return Math.max(V,q)-Math.min(V,q)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(V){const{row:q,col:de}=V,ue=this.getOuterTopStartCorner(),ve=this.getOuterBottomEndCorner();return ue.row<=q&&ve.row>=q&&ue.col<=de&&ve.col>=de}includesRange(V){return this.includes(V.getOuterTopStartCorner())&&this.includes(V.getOuterBottomEndCorner())}isEqual(V){return Math.min(this.from.row,this.to.row)===Math.min(V.from.row,V.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(V.from.row,V.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(V.from.col,V.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(V.from.col,V.to.col)}overlaps(V){return V.isSouthEastOf(this.getOuterTopLeftCorner())&&V.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(V){return this.getOuterTopLeftCorner().isSouthEastOf(V)||this.getOuterBottomRightCorner().isSouthEastOf(V)}isNorthWestOf(V){return this.getOuterTopLeftCorner().isNorthWestOf(V)||this.getOuterBottomRightCorner().isNorthWestOf(V)}isOverlappingHorizontally(V){return this.getOuterTopEndCorner().col>=V.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=V.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=V.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=V.getOuterTopStartCorner().col}isOverlappingVertically(V){return this.getOuterBottomStartCorner().row>=V.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=V.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=V.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=V.getOuterTopRightCorner().row}expand(V){const q=this.getOuterTopStartCorner(),de=this.getOuterBottomEndCorner();return V.row<q.row||V.col<q.col||V.row>de.row||V.col>de.col?(this.from=this._createCellCoords(Math.min(q.row,V.row),Math.min(q.col,V.col)),this.to=this._createCellCoords(Math.max(de.row,V.row),Math.max(de.col,V.col)),!0):!1}expandByRange(V){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(V)||!this.overlaps(V))return!1;const de=this.getOuterTopStartCorner(),ue=this.getOuterBottomEndCorner(),ve=this.getDirection(),pe=V.getOuterTopStartCorner(),Se=V.getOuterBottomEndCorner(),Ee=Math.min(de.row,pe.row),He=Math.min(de.col,pe.col),Fe=Math.max(ue.row,Se.row),et=Math.max(ue.col,Se.col),Oe=this._createCellCoords(Ee,He),ct=this._createCellCoords(Fe,et);return this.from=Oe,this.to=ct,this.setDirection(ve),q&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(V){switch(V){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Z(J,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Z(J,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Z(J,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Z(J,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Z(J,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Z(J,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Z(J,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Z(J,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(V){return V.isEqual(this.getOuterTopLeftCorner())||V.isEqual(this.getOuterTopRightCorner())||V.isEqual(this.getOuterBottomLeftCorner())||V.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(V){if(!(V instanceof k.Z))return!1;if(V.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(V.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(V.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(V.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(V){if(!this.includesRange(V))return[];const q={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},de={top:Math.min(V.from.row,V.to.row),bottom:Math.max(V.from.row,V.to.row),left:Math.min(V.from.col,V.to.col),right:Math.max(V.from.col,V.to.col)},ue=[];return q.top===de.top&&ue.push("top"),q.right===de.right&&ue.push(Z(J,this)?"left":"right"),q.bottom===de.bottom&&ue.push("bottom"),q.left===de.left&&ue.push(Z(J,this)?"right":"left"),ue}getInner(){const V=this.getOuterTopStartCorner(),q=this.getOuterBottomEndCorner(),de=[];for(let ue=V.row;ue<=q.row;ue++)for(let ve=V.col;ve<=q.col;ve++)!(this.from.row===ue&&this.from.col===ve)&&!(this.to.row===ue&&this.to.col===ve)&&de.push(this._createCellCoords(ue,ve));return de}getAll(){const V=this.getOuterTopStartCorner(),q=this.getOuterBottomEndCorner(),de=[];for(let ue=V.row;ue<=q.row;ue++)for(let ve=V.col;ve<=q.col;ve++)V.row===ue&&V.col===ve?de.push(V):q.row===ue&&q.col===ve?de.push(q):de.push(this._createCellCoords(ue,ve));return de}forAll(V){const q=this.getOuterTopStartCorner(),de=this.getOuterBottomEndCorner();for(let ue=q.row;ue<=de.row;ue++)for(let ve=q.col;ve<=de.col;ve++)if(V(ue,ve)===!1)return}clone(){return new W(this.highlight,this.from,this.to,Z(J,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(V,q){return new k.Z(V,q,Z(J,this))}}ie.Z=W},99450:function($,ie,f){"use strict";f.d(ie,{$7:function(){return N},AI:function(){return B},BA:function(){return X},CD:function(){return C},Nc:function(){return _},Os:function(){return Q},P$:function(){return k},t8:function(){return K}});const C="active-header",_="header",B="area",K="focus",k="fill",Q="row",X="column",N="custom-selection"},44307:function($,ie,f){"use strict";f.d(ie,{ZP:function(){return n0}});var C=f(29297),_=f(25813),B=f(13588),K=f(71441),k=f(31702),Q=f(89050),X=f(16110),N=f(8274),ce=f(64109),Y=f(92128),Z=f(48442),ee=f(78127),le=f(97487),J=f(73190),W=f(83225),I=f(88555),V=f(27122),q=f(13617),de=f(94070),ue=f(40581),ve=f(76909),pe=f(15227),Se=f(63955);function Ee(u,i){He(u,i),i.add(u)}function He(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(u,i,a){return(i=et(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function et(u){var i=Oe(u,"string");return typeof i=="symbol"?i:i+""}function Oe(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function ct(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var ze=new WeakSet;class dt{constructor(i,a,d){Ee(this,ze),Fe(this,"hot",void 0),Fe(this,"tableMeta",void 0),Fe(this,"selection",void 0),Fe(this,"eventManager",void 0),Fe(this,"destroyed",!1),Fe(this,"activeEditor",void 0),Fe(this,"cellProperties",void 0),this.hot=i,this.tableMeta=a,this.selection=d,this.eventManager=new Se.Z(i),this.hot.addHook("afterDocumentKeyDown",w=>ct(ze,this,It).call(this,w)),this.hot.addHook("beforeCompositionStart",w=>ct(ze,this,It).call(this,w)),this.hot.view._wt.update("onCellDblClick",(w,p,T)=>ct(ze,this,Sn).call(this,w,p,T))}getActiveEditor(){return this.activeEditor}prepareEditor(){var i;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,te=>{te&&this.prepareEditor()});return}const a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!a||a.isHeader())return;const{row:d,col:w}=a,p=this.hot.runHooks("modifyGetCellCoords",d,w,!1,"meta");let T=d,H=w;if(Array.isArray(p)&&([T,H]=p),this.cellProperties=this.hot.getCellMeta(T,H),!this.isCellEditable()){this.clearActiveEditor();return}const z=this.hot.getCell(d,w,!0);if(z){const te=this.hot.getCellEditor(this.cellProperties),we=this.hot.colToProp(H),Ie=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(T),H);this.activeEditor=(0,pe.Jq)(te,this.hot),this.activeEditor.prepare(d,w,we,z,Ie,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const w=this.hot.getSelectedRangeLast();let p=this.hot.runHooks("beforeBeginEditing",w.highlight.row,w.highlight.col,i,a,d);if(a instanceof MouseEvent&&typeof p!="boolean"&&(p=this.hot.selection.getLayerLevel()===0&&w.isSingle()),p===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(d&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(i,a))}closeEditor(i,a,d){this.activeEditor?this.activeEditor.finishEditing(i,a,d):d&&d(!1)}closeEditorAndSaveChanges(i){this.closeEditor(!1,i)}closeEditorAndRestoreOriginalValue(i){this.closeEditor(!0,i)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const i=this.hot.getSelectedRangeLast();if(!i)return!1;const a=this.hot.getCellEditor(this.cellProperties),{row:d,col:w}=i.highlight,{rowIndexMapper:p,columnIndexMapper:T}=this.hot,H=p.isHidden(this.hot.toPhysicalRow(d))||T.isHidden(this.hot.toPhysicalColumn(w));return!(this.cellProperties.readOnly||!a||H)}moveSelectionAfterEnter(i){const a=hi({},typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(i):this.tableMeta.enterMoves);i.shiftKey&&(a.row=-a.row,a.col=-a.col),this.hot.selection.isMultiple()?this.selection.transformFocus(a.row,a.col):this.selection.transformStart(a.row,a.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function It(u){const i=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!i||i.highlight.isHeader()||(0,ve.isImmediatePropagationStopped)(u))return;const{keyCode:a}=u,d=(u.ctrlKey||u.metaKey)&&!u.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(0,ue.isFunctionKey)(a)&&!(0,ue.isCtrlMetaKey)(a)&&!d&&!this.isEditorOpened()&&this.openEditor("",u)}function Sn(u,i){i.isCell()&&this.openEditor(null,u,!0)}const jt=new WeakMap;dt.getInstance=function(u,i,a){let d=jt.get(u);return d||(d=new dt(u,i,a),jt.set(u,d)),d};var Ye=dt,Be=f(33987),hn=f(40674);function Je(u,i){Ae(u,i),i.add(u)}function mt(u,i,a){Ae(u,i),i.set(u,a)}function Ae(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(u,i){return u.get(zt(u,i))}function Ft(u,i,a){return u.set(zt(u,i),a),a}function zt(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}const Et=Object.freeze({CELL:"cell",MIXED:"mixed"});var Qe=new WeakMap,an=new WeakMap,Mt=new WeakMap,Cn=new WeakMap,bn=new WeakMap,mr=new WeakSet;class br{constructor(i){var a=this;Je(this,mr),mt(this,Qe,void 0),mt(this,an,void 0),mt(this,Mt,1),mt(this,Cn,null),mt(this,bn,new Map);const d=i.getSettings();Ft(Qe,this,i),Ft(an,this,d.imeFastEdit?Et.MIXED:Et.CELL),rt(Qe,this).addHook("afterUpdateSettings",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return zt(mr,a,kr).call(a,...p)}),rt(Qe,this).addHook("afterSelection",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return zt(mr,a,ir).call(a,...p)}),rt(Qe,this).addHook("afterSelectionFocusSet",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return zt(mr,a,ir).call(a,...p)}),rt(Qe,this).addHook("afterSelectionEnd",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return zt(mr,a,Qn).call(a,...p)})}getFocusMode(){return rt(an,this)}setFocusMode(i){Object.values(Et).includes(i)?Ft(an,this,i):(0,hn.ZK)(`"${i}" is not a valid focus mode.`)}getRefocusDelay(){return rt(Mt,this)}setRefocusDelay(i){Ft(Mt,this,i)}setRefocusElementGetter(i){Ft(Cn,this,i)}getRefocusElement(){var i;return typeof rt(Cn,this)=="function"?rt(Cn,this).call(this):(i=rt(Qe,this).getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA}focusOnHighlightedCell(i){const a=d=>{var w,p;const T=(w=rt(Qe,this).getSelectedRangeLast())===null||w===void 0?void 0:w.highlight;if(!T)return;let H=rt(Qe,this).runHooks("modifyFocusedElement",T.row,T.col,d);(0,I.isHTMLElement)(H)||(H=d),H&&!((p=rt(Qe,this).getActiveEditor())!==null&&p!==void 0&&p.isOpened())&&H.focus({preventScroll:!0})};i?a(i):zt(mr,this,qr).call(this,d=>a(d))}refocusToEditorTextarea(){var i;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rt(Mt,this);if(rt(Qe,this).getSettings().imeFastEdit&&!((i=rt(Qe,this).getActiveEditor())!==null&&i!==void 0&&i.isOpened())){var d,w;(d=rt(Qe,this).getActiveEditor())===null||d===void 0||(w=d.refreshValue)===null||w===void 0||w.call(d),rt(bn,this).has(a)||rt(bn,this).set(a,(0,V.debounce)(()=>{if(!rt(Qe,this).isDestroyed){var p;(p=this.getRefocusElement())===null||p===void 0||p.select()}},a)),rt(bn,this).get(a)()}}}function qr(u){var i;const a=(i=rt(Qe,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!a||!rt(Qe,this).selection.isCellVisible(a)){u(null);return}const d=rt(Qe,this).getCell(a.row,a.col,!0);d===null?rt(Qe,this).addHookOnce("afterScroll",()=>{u(rt(Qe,this).getCell(a.row,a.col,!0))}):u(d)}function ir(){zt(mr,this,qr).call(this,u=>{const{activeElement:i}=rt(Qe,this).rootDocument;i&&(0,I.isOutsideInput)(i)&&i.blur(),this.focusOnHighlightedCell(u)})}function Qn(){zt(mr,this,qr).call(this,u=>{this.getFocusMode()===Et.MIXED&&(u==null?void 0:u.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function kr(u){typeof u.imeFastEdit=="boolean"&&this.setFocusMode(u.imeFastEdit?Et.MIXED:Et.CELL)}var mn=f(11981),Rs=f(67910),Mi=f(59189),_o=f(70959),Hn=f(72095),Oi=f(22492),pr=f(46495),Vs=f(54883);function Qi(u,i,a){Ln(u,i),i.set(u,a)}function Ln(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(u,i){return u.get(In(u,i))}function qi(u,i,a){return u.set(In(u,i),a),a}function In(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var un=new WeakMap,Xn=new WeakMap,en=new WeakMap,Vr=new WeakMap,di=new WeakMap,Mr=new WeakMap,js=new WeakMap,as=new WeakMap,Te=new WeakMap,tt=new WeakMap;class St{constructor(i,a,d,w,p,T){let H=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Qi(this,un,void 0),Qi(this,Xn,void 0),Qi(this,en,void 0),Qi(this,Vr,void 0),Qi(this,di,void 0),Qi(this,Mr,void 0),Qi(this,js,void 0),Qi(this,as,void 0),Qi(this,Te,[null,null]),Qi(this,tt,[null,null]),qi(un,this,d),qi(Xn,this,a),qi(en,this,p),qi(Vr,this,T),qi(di,this,H),qi(Mr,this,w),qi(js,this,i),this.registerEvents()}registerEvents(){yn(Mr,this).addEventListener(yn(en,this).holder,"contextmenu",d=>this.onContextMenu(d)),yn(Mr,this).addEventListener(yn(en,this).TABLE,"mouseover",d=>this.onMouseOver(d)),yn(Mr,this).addEventListener(yn(en,this).TABLE,"mouseout",d=>this.onMouseOut(d));const i=()=>{yn(Mr,this).addEventListener(yn(en,this).holder,"touchstart",d=>this.onTouchStart(d)),yn(Mr,this).addEventListener(yn(en,this).holder,"touchend",d=>this.onTouchEnd(d)),this.momentumScrolling||(this.momentumScrolling={}),yn(Mr,this).addEventListener(yn(en,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||yn(un,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,yn(un,this).getSetting("onAfterMomentumScroll"))},200)})},a=()=>{yn(Mr,this).addEventListener(yn(en,this).holder,"mouseup",d=>this.onMouseUp(d)),yn(Mr,this).addEventListener(yn(en,this).holder,"mousedown",d=>this.onMouseDown(d))};(0,de.isMobileBrowser)()?i():((0,Vs.isTouchSupported)()&&i(),a())}selectedCellWasTouched(i){const d=this.parentCell(i).coords;if(yn(as,this)&&d){const[w,p]=[d.row,yn(as,this).from.row],[T,H]=[d.col,yn(as,this).from.col];return w===p&&T===H}return!1}parentCell(i){const a={},d=yn(en,this).TABLE,w=(0,I.closestDown)(i,["TD","TH"],d);return w?(a.coords=yn(en,this).getCoords(w),a.TD=w):(0,I.hasClass)(i,"wtBorder")&&(0,I.hasClass)(i,"current")?(a.coords=yn(Vr,this).getFocusSelection().cellRange.highlight,a.TD=yn(en,this).getCell(a.coords)):(0,I.hasClass)(i,"wtBorder")&&(0,I.hasClass)(i,"area")&&yn(Vr,this).getAreaSelection().cellRange&&(a.coords=yn(Vr,this).getAreaSelection().cellRange.to,a.TD=yn(en,this).getCell(a.coords)),a}onMouseDown(i){const a=yn(Xn,this).rootDocument.activeElement,d=(0,V.partial)(I.getParent,i.target),w=i.target;if(!["TD","TH"].includes(a.nodeName)&&(w===a||d(0)===a||d(1)===a))return;const p=this.parentCell(w);(0,I.hasClass)(w,"corner")?yn(un,this).getSetting("onCellCornerMouseDown",i,w):p.TD&&yn(un,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",i,p.coords,p.TD),(i.button===0||this.touchApplied)&&p.TD&&(yn(tt,this)[0]=p.TD,clearTimeout(yn(Te,this)[0]),yn(Te,this)[0]=setTimeout(()=>{yn(tt,this)[0]=null},1e3))}onContextMenu(i){if(yn(un,this).has("onCellContextMenu")){const a=this.parentCell(i.target);a.TD&&this.callListener("onCellContextMenu",i,a.coords,a.TD)}}onMouseOver(i){if(!yn(un,this).has("onCellMouseOver"))return;const a=yn(en,this).TABLE,d=(0,I.closestDown)(i.target,["TD","TH"],a),w=yn(di,this)||this;d&&d!==w.lastMouseOver&&(0,I.isChildOf)(d,a)&&(w.lastMouseOver=d,this.callListener("onCellMouseOver",i,yn(en,this).getCoords(d),d))}onMouseOut(i){if(!yn(un,this).has("onCellMouseOut"))return;const a=yn(en,this).TABLE,d=(0,I.closestDown)(i.target,["TD","TH"],a),w=(0,I.closestDown)(i.relatedTarget,["TD","TH"],a),p=yn(di,this)||this;d&&d!==w&&(0,I.isChildOf)(d,a)&&(this.callListener("onCellMouseOut",i,yn(en,this).getCoords(d),d),w===null&&(p.lastMouseOver=null))}onMouseUp(i){const a=this.parentCell(i.target);a.TD&&yn(un,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",i,a.coords,a.TD),!(i.button!==0&&!this.touchApplied)&&(a.TD===yn(tt,this)[0]&&a.TD===yn(tt,this)[1]?((0,I.hasClass)(i.target,"corner")?this.callListener("onCellCornerDblClick",i,a.coords,a.TD):this.callListener("onCellDblClick",i,a.coords,a.TD),yn(tt,this)[0]=null,yn(tt,this)[1]=null):a.TD===yn(tt,this)[0]&&(yn(tt,this)[1]=a.TD,clearTimeout(yn(Te,this)[1]),yn(Te,this)[1]=setTimeout(()=>{yn(tt,this)[1]=null},500)))}onTouchStart(i){qi(as,this,yn(Vr,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(i)}onTouchEnd(i){var a;const d=i.target,w=(a=this.parentCell(d))===null||a===void 0?void 0:a.coords,p=(0,q.isDefined)(w)&&w.row>=0&&w.col>=0;if(i.cancelable&&p&&yn(un,this).getSetting("isDataViewInstance")){const H=["A","BUTTON","INPUT"];(0,de.isIOS)()&&((0,de.isChromeWebKit)()||(0,de.isFirefoxWebKit)())&&this.selectedCellWasTouched(d)&&!H.includes(d.tagName)?i.preventDefault():this.selectedCellWasTouched(d)||i.preventDefault()}this.onMouseUp(i),this.touchApplied=!1}callListener(i,a,d,w){const p=yn(un,this).getSettingPure(i);p&&p(a,d,w,yn(js,this).call(this))}destroy(){clearTimeout(yn(Te,this)[0]),clearTimeout(yn(Te,this)[1]),yn(Mr,this).destroy()}}var Ke=St,Gt=f(66515);function Vn(u,i,a){return(i=$r(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function $r(u){var i=Ur(u,"string");return typeof i=="symbol"?i:i+""}function Ur(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class sr{constructor(i,a,d){Vn(this,"offset",void 0),Vn(this,"total",void 0),Vn(this,"countTH",void 0),this.offset=i,this.total=a,this.countTH=d}offsetted(i){return i+this.offset}unOffsetted(i){return i-this.offset}renderedToSource(i){return this.offsetted(i)}sourceToRendered(i){return this.unOffsetted(i)}offsettedTH(i){return i-this.countTH}unOffsettedTH(i){return i+this.countTH}visibleRowHeadedColumnToSourceColumn(i){return this.renderedToSource(this.offsettedTH(i))}sourceColumnToVisibleRowHeadedColumn(i){return this.unOffsettedTH(this.sourceToRendered(i))}}var Ps=sr;function ur(u,i,a){return(i=Hr(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Hr(u){var i=Rr(u,"string");return typeof i=="symbol"?i:i+""}function Rr(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class bo{constructor(i,a,d){ur(this,"offset",void 0),ur(this,"total",void 0),ur(this,"countTH",void 0),this.offset=i,this.total=a,this.countTH=d}offsetted(i){return i+this.offset}unOffsetted(i){return i-this.offset}renderedToSource(i){return this.offsetted(i)}sourceToRendered(i){return this.unOffsetted(i)}offsettedTH(i){return i-this.countTH}unOffsettedTH(i){return i+this.countTH}visibleColHeadedRowToSourceRow(i){return this.renderedToSource(this.offsettedTH(i))}sourceRowToVisibleColHeadedRow(i){return this.unOffsettedTH(this.sourceToRendered(i))}}var Kn=bo;function zi(u,i,a){return(i=Pr(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Pr(u){var i=gi(u,"string");return typeof i=="symbol"?i:i+""}function gi(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Lr{constructor(){zi(this,"currentSize",0),zi(this,"nextSize",0),zi(this,"currentOffset",0),zi(this,"nextOffset",0)}setSize(i){this.currentSize=this.nextSize,this.nextSize=i}setOffset(i){this.currentOffset=this.nextOffset,this.nextOffset=i}}const ps=0,Ue=1,xt=2;function $t(u,i,a){return(i=_n(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function _n(u){var i=Xr(u,"string");return typeof i=="symbol"?i:i+""}function Xr(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Er{constructor(){$t(this,"size",new Lr),$t(this,"workingSpace",ps),$t(this,"sharedSize",null)}setSize(i){this.size.setSize(i)}setOffset(i){this.size.setOffset(i)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(i){return this.workingSpace===i}append(i){this.workingSpace=Ue,i.workingSpace=xt,this.sharedSize=i.getViewSize()}prepend(i){this.workingSpace=xt,i.workingSpace=Ue,this.sharedSize=i.getViewSize()}}var Di=f(82891);function fi(u,i,a){return(i=fr(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function fr(u){var i=tl(u,"string");return typeof i=="symbol"?i:i+""}function tl(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class li{constructor(i,a){fi(this,"order",[]),this.order=[...Array(a).keys()].map(d=>i+d)}get length(){return this.order.length}has(i){return this.order.indexOf(i)>-1}get(i){return i<this.order.length?this.order[i]:-1}remove(i){this.order.splice(this.order.indexOf(i),1)}prepend(i){return this.order.unshift(i),this.order.pop()}}function Eo(u,i,a){return(i=Wn(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Wn(u){var i=vs(u,"string");return typeof i=="symbol"?i:i+""}function vs(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class bl{constructor(i){Eo(this,"sizeSet",void 0),this.sizeSet=i}diff(){const{sizeSet:i}=this,{currentSize:a,nextSize:d}=i.getViewSize();let w=Math.max(d,a);if(w===0)return[];const{currentOffset:p,nextOffset:T}=i.getViewSize(),H=new li(p,a),z=new li(T,d),te=[];for(let we=0;we<w;we++){const Ie=H.get(we),De=z.get(we);if(De===-1)te.push(["remove",Ie]);else if(Ie===-1)!i.isShared()||i.isShared()&&i.isPlaceOn(xt)?te.push(["append",De]):te.push(["prepend",De]);else if(De>Ie)H.has(De)&&(H.remove(De),d<=H.length&&(w-=1)),te.push(["replace",De,Ie]);else if(De<Ie){const Le=H.prepend(De);te.push(["insert_before",De,Ie,Le])}else te.push(["none",De])}return te}}function xn(u,i,a){return(i=tn(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function tn(u){var i=Ko(u,"string");return typeof i=="symbol"?i:i+""}function Ko(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class nl{constructor(i,a){xn(this,"rootNode",void 0),xn(this,"nodesPool",void 0),xn(this,"sizeSet",new Er),xn(this,"collectedNodes",[]),xn(this,"viewDiffer",new bl(this.sizeSet)),xn(this,"leads",[]),this.rootNode=i,this.nodesPool=a}setSize(i){return this.sizeSet.setSize(i),this}setOffset(i){return this.sizeSet.setOffset(i),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(i){return i<this.collectedNodes.length?this.collectedNodes[i]:null}getCurrentNode(){const i=this.collectedNodes.length;return i>0?this.collectedNodes[i-1]:null}applyCommand(i){const{rootNode:a}=this,[d,w,p,T]=i,H=this.nodesPool(w);switch(this.collectedNodes.push(H),d){case"prepend":a.insertBefore(H,a.firstChild);break;case"append":a.appendChild(H);break;case"insert_before":a.insertBefore(H,this.nodesPool(p)),a.removeChild(this.nodesPool(T));break;case"replace":a.replaceChild(H,this.nodesPool(p));break;case"remove":a.removeChild(H);break;default:break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class lo extends nl{prependView(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}appendView(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}function xs(u,i,a){return(i=Yi(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Yi(u){var i=ya(u,"string");return typeof i=="symbol"?i:i+""}function ya(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class ka{constructor(i){xs(this,"nodeType",void 0),xs(this,"pool",new Map),this.nodeType=i.toUpperCase()}setRootDocument(i){this.rootDocument=i}obtain(i,a){const w=typeof a=="number"?`${i}x${a}`:i.toString();if(this.pool.has(w))return this.pool.get(w);const p=this.rootDocument.createElement(this.nodeType);return this.pool.set(w,p),p}}function ls(u,i,a){return(i=dr(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function dr(u){var i=se(u,"string");return typeof i=="symbol"?i:i+""}function se(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class O{constructor(i,a){ls(this,"nodesPool",null),ls(this,"nodeType",void 0),ls(this,"rootNode",void 0),ls(this,"table",null),ls(this,"renderedNodes",0),this.nodesPool=typeof i=="string"?new ka(i):null,this.nodeType=i,this.rootNode=a}setTable(i){this.nodesPool&&this.nodesPool.setRootDocument(i.rootDocument),this.table=i}adjust(){}render(){}}var x=f(40629);function re(u,i,a){return(i=he(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function he(u){var i=Me(u,"string");return typeof i=="symbol"?i:i+""}function Me(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Xe extends O{constructor(){super("TH"),re(this,"orderViews",new WeakMap),re(this,"sourceRowIndex",0)}obtainOrderView(i){let a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new lo(i,d=>this.nodesPool.obtain(this.sourceRowIndex,d)),this.orderViews.set(i,a)),a}render(){const{rowsToRender:i,rowHeaderFunctions:a,rowHeadersCount:d,rows:w,cells:p}=this.table;for(let T=0;T<i;T++){const H=this.table.renderedRowToSource(T),z=w.getRenderedNode(T);this.sourceRowIndex=H;const te=this.obtainOrderView(z),we=p.obtainOrderView(z);te.appendView(we).setSize(d).setOffset(0).start();for(let Ie=d-1;Ie>=0;Ie--){te.render();const De=te.getCurrentNode();De.className="",De.removeAttribute("style"),(0,I.removeAttribute)(De,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,I.setAttribute)(De,[(0,x.iL)(),(0,x.Pp)(),(0,x.yz)(Ie+1),(0,x.Qk)(-1)]),a[Ie](H,De,Ie)}te.end()}}}class nt extends O{constructor(i){super(null,i)}adjust(){const{columnHeadersCount:i,rowHeadersCount:a}=this.table;let d=this.rootNode.firstChild;if(i){const{columnsToRender:w}=this.table,p=w+a;for(let H=0,z=i;H<z;H++){for(d=this.rootNode.childNodes[H],d||(d=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(d)),this.renderedNodes=d.childNodes.length;this.renderedNodes<p;)d.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>p;)d.removeChild(d.lastChild),this.renderedNodes-=1}const T=this.rootNode.childNodes.length;if(T>i)for(let H=i;H<T;H++)this.rootNode.removeChild(this.rootNode.lastChild)}else d&&(0,I.empty)(d)}render(){const{columnHeadersCount:i}=this.table;this.table.isAriaEnabled()&&(0,I.setAttribute)(this.rootNode,[(0,x.Ct)()]);for(let a=0;a<i;a+=1){const{columnHeaderFunctions:d,columnsToRender:w,rowHeadersCount:p}=this.table,T=this.rootNode.childNodes[a];this.table.isAriaEnabled()&&(0,I.setAttribute)(T,[(0,x.f3)(),(0,x.d5)(a+1)]);for(let H=-1*p;H<w;H+=1){const z=this.table.renderedColumnToSource(H),te=T.childNodes[H+p];te.className="",te.removeAttribute("style"),(0,I.removeAttribute)(te,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,I.setAttribute)(te,[(0,x.yz)(H+1+this.table.rowHeadersCount),(0,x.Qk)(-1),(0,x.Ng)(),...H>=0?[(0,x.iJ)()]:[(0,x.f3)()]]),d[a](z,te,a)}}}}var Tt=f(8767);let En=!1;class Tn extends O{constructor(i){super(null,i)}adjust(){const{columnsToRender:i,rowHeadersCount:a}=this.table,d=i+a;for(;this.renderedNodes<d;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>d;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:i,rowHeadersCount:a}=this.table;!En&&i>1e3&&(En=!0,(0,hn.ZK)((0,Tt.e)`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let w=0;w<a;w++){const p=this.table.renderedColumnToSource(w),T=this.table.columnUtils.getHeaderWidth(p);this.rootNode.childNodes[w].style.width=`${T}px`}for(let w=0;w<i;w++){const p=this.table.renderedColumnToSource(w),T=this.table.columnUtils.getWidth(p);this.rootNode.childNodes[w+a].style.width=`${T}px`}const d=this.rootNode.firstChild;d&&(0,I.addClass)(d,"rowHeader")}}function pn(u,i,a){return(i=vr(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function vr(u){var i=Cr(u,"string");return typeof i=="symbol"?i:i+""}function Cr(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}const Cs={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Gi=!1;class As extends O{constructor(i){super("TR",i),pn(this,"orderView",void 0),this.orderView=new nl(i,a=>this.nodesPool.obtain(a))}getRenderedNode(i){return this.orderView.getNode(i)}hasStaleContent(i){return this.orderView.hasStaleContent(i)}render(){const{rowsToRender:i}=this.table;!Gi&&i>1e3&&(Gi=!0,(0,hn.ZK)((0,Tt.e)`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,I.setAttribute)(this.rootNode,[(0,x.Ct)()]),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(let w=0;w<i;w++){this.orderView.render();const p=this.orderView.getCurrentNode(),T=this.table.renderedRowToSource(w);if(this.table.isAriaEnabled()){var a,d;(0,I.setAttribute)(p,[(0,x.f3)(),(0,x.d5)(T+((a=(d=this.table.rowUtils)===null||d===void 0||(d=d.dataAccessObject)===null||d===void 0?void 0:d.columnHeaders.length)!==null&&a!==void 0?a:0)+1)])}(T+1)%2===0?(0,I.hasClass)(p,Cs.rowEven)||((0,I.removeClass)(p,Cs.rowOdd),(0,I.addClass)(p,Cs.rowEven)):(0,I.hasClass)(p,Cs.rowOdd)||((0,I.removeClass)(p,Cs.rowEven),(0,I.addClass)(p,Cs.rowOdd))}this.orderView.end()}}function Ro(u,i,a){return(i=Ns(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Ns(u){var i=fe(u,"string");return typeof i=="symbol"?i:i+""}function fe(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Do extends O{constructor(){super("TD"),Ro(this,"orderViews",new WeakMap),Ro(this,"sourceRowIndex",0)}obtainOrderView(i){let a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new lo(i,d=>this.nodesPool.obtain(this.sourceRowIndex,d),this.nodeType),this.orderViews.set(i,a)),a}render(){const{rowsToRender:i,columnsToRender:a,rows:d,rowHeaders:w}=this.table;for(let H=0;H<i;H++){const z=this.table.renderedRowToSource(H),te=d.getRenderedNode(H);this.sourceRowIndex=z;const we=this.obtainOrderView(te),Ie=w.obtainOrderView(te);we.prependView(Ie).setSize(a).setOffset(0).start();for(let De=0;De<a;De++){we.render();const Le=this.table.renderedColumnToSource(De),ut=we.getCurrentNode();if((0,I.hasClass)(ut,"hide")||(ut.className=""),ut.removeAttribute("style"),ut.removeAttribute("dir"),(0,I.removeAttribute)(ut,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(z,Le,ut),this.table.isAriaEnabled()){var p,T;(0,I.setAttribute)(ut,[...ut.hasAttribute("role")?[]:[(0,x.Qz)()],(0,x.Qk)(-1),(0,x.yz)(Le+((p=(T=this.table.rowUtils)===null||T===void 0||(T=T.dataAccessObject)===null||T===void 0?void 0:T.rowHeaders.length)!==null&&p!==void 0?p:0)+1)])}}we.end()}}}function Yn(u,i,a){return(i=Us(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Us(u){var i=To(u,"string");return typeof i=="symbol"?i:i+""}function To(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class qs{constructor(i){let{cellRenderer:a,stylesHandler:d}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yn(this,"rootNode",void 0),Yn(this,"rootDocument",void 0),Yn(this,"rowHeaders",null),Yn(this,"columnHeaders",null),Yn(this,"colGroup",null),Yn(this,"rows",null),Yn(this,"cells",null),Yn(this,"rowFilter",null),Yn(this,"columnFilter",null),Yn(this,"rowUtils",null),Yn(this,"columnUtils",null),Yn(this,"rowsToRender",0),Yn(this,"columnsToRender",0),Yn(this,"rowHeaderFunctions",[]),Yn(this,"rowHeadersCount",0),Yn(this,"columnHeaderFunctions",[]),Yn(this,"columnHeadersCount",0),Yn(this,"cellRenderer",void 0),Yn(this,"activeOverlayName",void 0),Yn(this,"stylesHandler",void 0),this.rootNode=i,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=a,this.stylesHandler=d}setActiveOverlayName(i){this.activeOverlayName=i}setAxisUtils(i,a){this.rowUtils=i,this.columnUtils=a}setViewportSize(i,a){this.rowsToRender=i,this.columnsToRender=a}setFilters(i,a){this.rowFilter=i,this.columnFilter=a}setHeaderContentRenderers(i,a){this.rowHeaderFunctions=i,this.rowHeadersCount=i.length,this.columnHeaderFunctions=a,this.columnHeadersCount=a.length}setRenderers(){let{rowHeaders:i,columnHeaders:a,colGroup:d,rows:w,cells:p}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};i.setTable(this),a.setTable(this),d.setTable(this),w.setTable(this),p.setTable(this),this.rowHeaders=i,this.columnHeaders=a,this.colGroup=d,this.rows=w,this.cells=p}renderedRowToSource(i){return this.rowFilter.renderedToSource(i)}renderedColumnToSource(i){return this.columnFilter.renderedToSource(i)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:i,rows:a}=this;for(let d=0;d<i;d++){const w=a.getRenderedNode(d),p=this.rowUtils;if(w.firstChild){const T=this.renderedRowToSource(d),H=p.getHeightByOverlayName(T,this.activeOverlayName),te=this.stylesHandler.areCellsBorderBox()?0:1;H?w.firstChild.style.height=`${H-te}px`:w.firstChild.style.height=""}}}}class Zu{constructor(){let{TABLE:i,THEAD:a,COLGROUP:d,TBODY:w,rowUtils:p,columnUtils:T,cellRenderer:H,stylesHandler:z}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new qs(i,{cellRenderer:H,stylesHandler:z}),this.renderer.setRenderers({rowHeaders:new Xe,columnHeaders:new nt(a),colGroup:new Tn(d),rows:new As(w),cells:new Do}),this.renderer.setAxisUtils(p,T)}setActiveOverlayName(i){return this.renderer.setActiveOverlayName(i),this}setFilters(i,a){return this.renderer.setFilters(i,a),this}setViewportSize(i,a){return this.renderer.setViewportSize(i,a),this}setHeaderContentRenderers(i,a){return this.renderer.setHeaderContentRenderers(i,a),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Si(u,i,a){return(i=Sa(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Sa(u){var i=El(u,"string");return typeof i=="symbol"?i:i+""}function El(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class or{constructor(i,a){Si(this,"dataAccessObject",void 0),Si(this,"wtSettings",void 0),Si(this,"headerWidths",new Map),this.dataAccessObject=i,this.wtSettings=a}getWidth(i){return this.wtSettings.getSetting("columnWidth",i)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(i){let a=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const d=this.dataAccessObject.wtViewport.oversizedColumnHeaders[i];return d!==void 0&&(a=a?Math.max(a,d):d),a}getHeaderWidth(i){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(i))}calculateWidths(){const{wtSettings:i}=this;let a=i.getSetting("rowHeaderWidth");if(a=i.getSetting("onModifyRowHeaderWidth",a),a!=null){const d=i.getSetting("rowHeaders").length,w=i.getSetting("defaultColumnWidth");for(let p=0;p<d;p++){let T=Array.isArray(a)?a[p]:a;T=T==null?w:T,this.headerWidths.set(p,T)}}}}function Ts(u,i,a){return(i=ua(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function ua(u){var i=rl(u,"string");return typeof i=="symbol"?i:i+""}function rl(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class mu{constructor(i,a){Ts(this,"dataAccessObject",void 0),Ts(this,"wtSettings",void 0),this.dataAccessObject=i,this.wtSettings=a}getHeight(i){let a=this.wtSettings.getSetting("rowHeight",i);const d=this.dataAccessObject.wtViewport.oversizedRows[i];return d!==void 0&&(a=a===void 0?d:Math.max(a,d)),a}getHeightByOverlayName(i,a){let d=this.wtSettings.getSetting("rowHeightByOverlayName",i,a);const w=this.dataAccessObject.wtViewport.oversizedRows[i];return w!==void 0&&(d=d===void 0?w:Math.max(d,w)),d}}const zs="top",ws="bottom",Yo="inline_start",Go="top_inline_start_corner",Mo="bottom_inline_start_corner",Rl=[zs,ws,Yo,Go,Mo],Va=new Map([[zs,`ht_clone_${zs}`],[ws,`ht_clone_${ws}`],[Yo,`ht_clone_${Yo} ht_clone_left`],[Go,`ht_clone_${Go} ht_clone_top_left_corner`],[Mo,`ht_clone_${Mo} ht_clone_bottom_left_corner`]]);function Ho(u,i,a){return(i=Ju(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Ju(u){var i=pu(u,"string");return typeof i=="symbol"?i:i+""}function pu(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Lo{constructor(i,a,d,w,p){Ho(this,"wtSettings",null),Ho(this,"domBindings",void 0),Ho(this,"TBODY",null),Ho(this,"THEAD",null),Ho(this,"COLGROUP",null),Ho(this,"hasTableHeight",!0),Ho(this,"hasTableWidth",!0),Ho(this,"isTableVisible",!1),Ho(this,"tableOffset",0),Ho(this,"holderOffset",0),this.domBindings=d,this.isMaster=p==="master",this.name=p,this.dataAccessObject=i,this.facadeGetter=a,this.wtSettings=w,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=d.rootTable,(0,I.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const T=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(T)),this.rowUtils=new mu(this.dataAccessObject,this.wtSettings),this.columnUtils=new or(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Zu({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(i){return this.name===i}fixTableDomTree(){const i=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=i.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=i.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=i.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(i){const a=i.parentNode;let d;return(!a||a.nodeType!==Node.ELEMENT_NODE||!(0,I.hasClass)(a,"wtHolder"))&&(d=this.domBindings.rootDocument.createElement("div"),d.className="wtSpreader",a&&a.insertBefore(d,i),d.appendChild(i)),d.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,I.setAttribute)(d,[(0,x.Rn)()]),d}createHider(i){const a=i.parentNode;let d;return(!a||a.nodeType!==Node.ELEMENT_NODE||!(0,I.hasClass)(a,"wtHolder"))&&(d=this.domBindings.rootDocument.createElement("div"),d.className="wtHider",a&&a.insertBefore(d,i),d.appendChild(i)),this.wtSettings.getSetting("ariaTags")&&(0,I.setAttribute)(d,[(0,x.Rn)()]),d}createHolder(i){const a=i.parentNode;let d;return(!a||a.nodeType!==Node.ELEMENT_NODE||!(0,I.hasClass)(a,"wtHolder"))&&(d=this.domBindings.rootDocument.createElement("div"),d.style.position="relative",d.className="wtHolder",(0,I.setAttribute)(d,[(0,x.Qk)(-1)]),a&&a.insertBefore(d,i),this.isMaster&&(d.parentNode.className+="ht_master handsontable",d.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,I.setAttribute)(d.parentNode,[(0,x.Rn)()])),d.appendChild(i)),this.wtSettings.getSetting("ariaTags")&&(0,I.setAttribute)(d,[(0,x.Rn)()]),d}draw(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:a}=this,{wtOverlays:d,wtViewport:w}=this.dataAccessObject,p=a.getSetting("totalRows"),T=a.getSetting("totalColumns"),H=a.getSetting("rowHeaders"),z=H.length,te=a.getSetting("columnHeaders"),we=te.length;let Ie=i;if(this.isMaster&&(d.beforeDraw(),this.holderOffset=(0,I.offset)(this.holder),Ie=w.createCalculators(Ie),z&&!a.getSetting("fixedColumnsStart"))){const Le=d.inlineStartOverlay.getScrollPosition(),ut=this.correctHeaderWidth;this.correctHeaderWidth=Le!==0,ut!==this.correctHeaderWidth&&(Ie=!1)}if(Ie)this.isMaster&&d.refresh(!0);else{this.isMaster?this.tableOffset=(0,I.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const Le=Math.max(this.getFirstRenderedRow(),0),ut=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Kn(Le,p,we),this.columnFilter=new Ps(ut,T,z);let Bt=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const zn={};this.wtSettings.getSetting("beforeDraw",!0,zn),Bt=zn.skipRender!==!0}Bt&&(this.tableRenderer.setHeaderContentRenderers(H,te),(this.is(ws)||this.is(Mo))&&this.tableRenderer.setHeaderContentRenderers(H,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ws))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||w.createVisibleCalculators(),d.refresh(!1),d.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(ws)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let De=!1;return this.isMaster&&(De=d.topOverlay.resetFixedPosition(),d.bottomOverlay.clone&&(De=d.bottomOverlay.resetFixedPosition()||De),De=d.inlineStartOverlay.resetFixedPosition()||De,d.topInlineStartCornerOverlay&&d.topInlineStartCornerOverlay.resetFixedPosition(),d.bottomInlineStartCornerOverlay&&d.bottomInlineStartCornerOverlay.clone&&d.bottomInlineStartCornerOverlay.resetFixedPosition()),De?(d.refreshAll(),d.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(Ie),this.isMaster&&d.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(i){const a=this.columnFilter.renderedToSource(i);let d=this.wtSettings.getSetting("columnHeaders").length;const w=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let p,T,H;const z=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;d;)d-=1,p=this.getColumnHeaderHeight(d),T=this.getColumnHeader(a,d),T&&(H=(0,I.innerHeight)(T),(!p&&w<H||p<H)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[d]=H),Array.isArray(z)?z[d]!==null&&z[d]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[d]=z[d]):isNaN(z)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[d]=z),this.dataAccessObject.wtViewport.oversizedColumnHeaders[d]<(z[d]||z)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[d]=z[d]||z))}adjustColumnHeaderHeights(){const{wtSettings:i}=this,a=this.THEAD.childNodes,d=this.dataAccessObject.wtViewport.oversizedColumnHeaders,w=i.getSetting("columnHeaders");for(let p=0,T=w.length;p<T;p++)if(d[p]){if(!a[p]||a[p].childNodes.length===0)return;a[p].childNodes[0].style.height=`${d[p]}px`}}resetOversizedRows(){const{wtSettings:i}=this,{wtViewport:a}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(ws))&&!i.getSetting("externalRowCalculator")){const d=this.getRenderedRowsCount();for(let w=0;w<d;w++){const p=this.rowFilter.renderedToSource(w);a.oversizedRows&&a.oversizedRows[p]&&(a.oversizedRows[p]=void 0)}}}getCell(i){let a=i.row,d=i.col;const w=this.wtSettings.getSetting("onModifyGetCellCoords",a,d,!this.isMaster,"render");if(w&&Array.isArray(w)&&([a,d]=w),this.isRowBeforeRenderedRows(a))return-1;if(this.isRowAfterRenderedRows(a))return-2;if(this.isColumnBeforeRenderedColumns(d))return-3;if(this.isColumnAfterRenderedColumns(d))return-4;const p=this.getRow(a);if(!p&&a>=0)throw new Error("TR was expected to be rendered but is not");const T=p.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(d)];if(!T&&d>=0)throw new Error("TD or TH was expected to be rendered but is not");return T}getRow(i){let a=null,d=null;if(i<0){var w;a=(w=this.rowFilter)===null||w===void 0?void 0:w.sourceRowToVisibleColHeadedRow(i),d=this.THEAD}else{var p;a=(p=this.rowFilter)===null||p===void 0?void 0:p.sourceToRendered(i),d=this.TBODY}return a!==void 0&&d!==void 0?d.childNodes.length<a+1?!1:d.childNodes[a]:!1}getColumnHeader(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const d=this.THEAD.childNodes[a];return d==null?void 0:d.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]}getColumnHeaders(i){const a=[],d=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i);return this.THEAD.childNodes.forEach(w=>{const p=w.childNodes[d];p&&a.push(p)}),a}getRowHeader(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const d=this.wtSettings.getSetting("rowHeaders").length;if(a>=d)return;const w=this.rowFilter.sourceToRendered(i),p=w<0?this.rowFilter.sourceRowToVisibleColHeadedRow(i):w,H=(w<0?this.THEAD:this.TBODY).childNodes[p];return H==null?void 0:H.childNodes[a]}getRowHeaders(i){const a=[],d=this.wtSettings.getSetting("rowHeaders").length;for(let w=0;w<d;w++){const p=this.TBODY.childNodes[this.rowFilter.sourceToRendered(i)],T=p==null?void 0:p.childNodes[w];T&&a.push(T)}return a}getCoords(i){let a=i;if(a.nodeName!=="TD"&&a.nodeName!=="TH"&&(a=(0,I.closest)(a,["TD","TH"])),a===null)return null;const d=a.parentNode;if(!d)return null;const w=d.parentNode;let p=(0,I.index)(d),T=a.cellIndex;(0,I.overlayContainsElement)(Go,a,this.wtRootElement)||(0,I.overlayContainsElement)(zs,a,this.wtRootElement)?w.nodeName==="THEAD"&&(p-=w.childNodes.length):(0,I.overlayContainsElement)(Mo,a,this.wtRootElement)||(0,I.overlayContainsElement)(ws,a,this.wtRootElement)?p=this.wtSettings.getSetting("totalRows")-w.childNodes.length+p:w===this.THEAD?p=this.rowFilter.visibleColHeadedRowToSourceRow(p):this.rowFilter&&(p=this.rowFilter.renderedToSource(p)),(0,I.overlayContainsElement)(Go,a,this.wtRootElement)||(0,I.overlayContainsElement)(Yo,a,this.wtRootElement)||(0,I.overlayContainsElement)(Mo,a,this.wtRootElement)?T=this.columnFilter.offsettedTH(T):this.columnFilter&&(T=this.columnFilter.visibleRowHeadedColumnToSourceColumn(T));const H=this.wtSettings.getSetting("onModifyGetCoordsElement",p,T);return H&&Array.isArray(H)&&([p,T]=H),this.wot.createCellCoords(p,T)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let i=this.TBODY.childNodes.length;const a=i*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),d=(0,I.innerHeight)(this.TBODY)-1,w=this.wot.stylesHandler.areCellsBorderBox(),p=w?I.outerHeight:I.innerHeight,T=w?0:1,H=w?1:0;let z,te,we,Ie,De;if(!(a===d&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;i;){i-=1,we=this.rowFilter.renderedToSource(i),z=this.getRowHeight(we),Ie=this.getTrForRow(we),De=Ie.querySelector("th");const Le=we===0?H:0;De?te=p(De):te=p(Ie)-T,(!z&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<te-Le||z<te)&&(w||(te+=1),this.dataAccessObject.wtViewport.oversizedRows[we]=te)}}getTrForRow(i){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(i)]}isColumnHeaderRendered(i){if(i>=0)return!1;const d=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(i)<=d}isRowHeaderRendered(i){if(i>=0)return!1;const d=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(i)<=d}isRowBeforeRenderedRows(i){const a=this.getFirstRenderedRow();return i<0&&a<=0?!this.isRowHeaderRendered(i):i<a}isRowAfterRenderedRows(i){return i>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(i){const a=this.getFirstRenderedColumn();return i<0&&a<=0?!this.isColumnHeaderRendered(i):i<a}isColumnAfterRenderedColumns(i){return this.columnFilter&&i>this.getLastRenderedColumn()}isColumnAfterViewport(i){return this.columnFilter&&i>this.getLastVisibleColumn()}isRowAfterViewport(i){return this.rowFilter&&i>this.getLastVisibleRow()}isColumnBeforeViewport(i){return this.columnFilter&&this.columnFilter.sourceToRendered(i)<0&&i>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(i){return this.rowUtils.getHeight(i)}getColumnHeaderHeight(i){return this.columnUtils.getHeaderHeight(i)}getColumnWidth(i){return this.columnUtils.getWidth(i)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,I.outerWidth)(this.TABLE)}getHeight(){return(0,I.outerHeight)(this.TABLE)}getTotalWidth(){const i=(0,I.outerWidth)(this.hider);return i!==0?i:this.getWidth()}getTotalHeight(){const i=(0,I.outerHeight)(this.hider);return i!==0?i:this.getHeight()}isVisible(){return(0,I.isVisible)(this.TABLE)}_modifyRowHeaderWidth(i){let a=(0,V.isFunction)(i)?i():null;return Array.isArray(a)?(a=[...a],a[a.length-1]=this._correctRowHeaderWidth(a[a.length-1])):a=this._correctRowHeaderWidth(a),a}_correctRowHeaderWidth(i){let a=i;return typeof i!="number"&&(a=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(a+=1),a}}var Fr=Lo;const Gn="stickyRowsTop",je={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,Be.defineGetter)(je,"MIXIN_NAME",Gn,{writable:!1,enumerable:!1});var Wt=je;const Pn="calculatedColumns",Hi={getFirstRenderedColumn(){const u=this.dataAccessObject.startColumnRendered;return u===null?-1:u},getFirstVisibleColumn(){const u=this.dataAccessObject.startColumnVisible;return u===null?-1:u},getFirstPartiallyVisibleColumn(){const u=this.dataAccessObject.startColumnPartiallyVisible;return u===null?-1:u},getLastRenderedColumn(){const u=this.dataAccessObject.endColumnRendered;return u===null?-1:u},getLastVisibleColumn(){const u=this.dataAccessObject.endColumnVisible;return u===null?-1:u},getLastPartiallyVisibleColumn(){const u=this.dataAccessObject.endColumnPartiallyVisible;return u===null?-1:u},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,Be.defineGetter)(Hi,"MIXIN_NAME",Pn,{writable:!1,enumerable:!1});var es=Hi;class _i extends Fr{constructor(i,a,d,w){super(i,a,d,w,zs)}}(0,Be.mixin)(_i,Wt),(0,Be.mixin)(_i,es);var Li=_i;function _a(u,i){Tl(u,i),i.add(u)}function Tl(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ba(u,i,a){return(i=uo(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function uo(u){var i=Ml(u,"string");return typeof i=="symbol"?i:i+""}function Ml(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function vu(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var Oc=new WeakSet;class Zf{constructor(i){_a(this,Oc),ba(this,"dataAccessObject",void 0),this.dataAccessObject=i}scrollViewport(i,a,d){if(i.col<0||i.row<0)return!1;const w=this.scrollViewportHorizontally(i.col,a),p=this.scrollViewportVertically(i.row,d);return w||p}scrollViewportHorizontally(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:d,totalColumns:w}=this.dataAccessObject;if(!d)return!1;const p=(0,Be.createObjectPropListener)(a);if(i=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",i,p),!Number.isInteger(i)||i<0||i>w)return!1;a=p.value;const{fixedColumnsStart:T,inlineStartOverlay:H}=this.dataAccessObject,z=a==="auto";if(z&&i<T)return!1;const te=this.getFirstVisibleColumn(),we=this.getLastVisibleColumn();let Ie=!1;return(z&&(i<te||i>we)||!z)&&(Ie=H.scrollTo(i,z?i>=this.getLastPartiallyVisibleColumn():a==="end")),Ie}scrollViewportVertically(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:d,totalRows:w}=this.dataAccessObject;if(!d)return!1;const p=(0,Be.createObjectPropListener)(a);if(i=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",i,p),!Number.isInteger(i)||i<0||i>w)return!1;a=p.value;const{fixedRowsBottom:T,fixedRowsTop:H,topOverlay:z}=this.dataAccessObject,te=a==="auto";if(te&&(i<H||i>w-T-1))return!1;const we=this.getFirstVisibleRow(),Ie=this.getLastVisibleRow();let De=!1;return(te&&(i<we||i>Ie)||!te)&&(De=z.scrollTo(i,te?i>=this.getLastPartiallyVisibleRow():a==="bottom")),De}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return vu(Oc,this,ah).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return vu(Oc,this,ah).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return vu(Oc,this,Ic).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return vu(Oc,this,Ic).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Ic(u){const{wtSettings:i,inlineStartOverlay:a,wtTable:d,wtViewport:w,totalColumns:p,rootWindow:T}=this.dataAccessObject;if(a.mainTableScrollableElement===T){const H=i.getSetting("rtlMode");let z=null;if(H){const we=d.TABLE.getBoundingClientRect(),De=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;z=Math.abs(we.right-De)}else z=(0,I.offset)(d.wtRootElement).left;const te=Math.abs((0,I.getScrollLeft)(T,T));if(z>te){const we=(0,I.innerWidth)(T);let Ie=w.getRowHeaderWidth();for(let De=1;De<=p;De++)if(Ie+=a.sumCellSizes(De-1,De),z+Ie-te>=we){u=De-2;break}}}return u}function ah(u){const{topOverlay:i,wtTable:a,wtViewport:d,totalRows:w,rootWindow:p}=this.dataAccessObject;if(i.mainTableScrollableElement===p){const T=(0,I.offset)(a.wtRootElement),H=(0,I.getScrollTop)(p,p);if(T.top>H){const z=(0,I.innerHeight)(p);let te=d.getColumnHeaderHeight();for(let we=1;we<=w;we++)if(te+=i.sumCellSizes(we-1,we),T.top+te-H>=z){u=we-2;break}}}return u}var Jf=Zf,Kd=f(958),Pc=f(6146);function $o(u,i,a){return(i=xc(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function xc(u){var i=Yd(u,"string");return typeof i=="symbol"?i:i+""}function Yd(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class rd{get eventManager(){return new Se.Z(this)}constructor(i,a){$o(this,"wtTable",void 0),$o(this,"wtScroll",void 0),$o(this,"wtViewport",void 0),$o(this,"wtOverlays",void 0),$o(this,"selectionManager",void 0),$o(this,"wtEvent",void 0),$o(this,"guid",`wt_${(0,Oi.randomString)()}`),$o(this,"drawInterrupted",!1),$o(this,"drawn",!1),$o(this,"activeOverlayName","master"),$o(this,"domBindings",void 0),$o(this,"wtSettings",void 0),this.domBindings={rootTable:i,rootDocument:i.ownerDocument,rootWindow:i.ownerDocument.defaultView},this.wtSettings=a,this.wtScroll=new Jf(this.createScrollDao())}findOriginalHeaders(){const i=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let a=0,d=this.wtTable.THEAD.childNodes[0].childNodes.length;a<d;a++)i.push(this.wtTable.THEAD.childNodes[0].childNodes[a].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(a,d){(0,I.fastInnerText)(d,i[a])}])}}createCellCoords(i,a){return new Kd.Z(i,a,this.wtSettings.getSetting("rtlMode"))}createCellRange(i,a,d){return new Pc.Z(i,a,d,this.wtSettings.getSetting("rtlMode"))}draw(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||(0,I.hasZeroHeight)(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(i),this}getCell(i){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(i);const d=this.wtSettings.getSetting("totalRows"),w=this.wtSettings.getSetting("fixedRowsTop"),p=this.wtSettings.getSetting("fixedRowsBottom"),T=this.wtSettings.getSetting("fixedColumnsStart");if(i.row<w&&i.col<T)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(i);if(i.row<w)return this.wtOverlays.topOverlay.clone.wtTable.getCell(i);if(i.col<T&&i.row>=d-p){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(i)}else{if(i.col<T)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(i);if(i.row<d&&i.row>=d-p&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(i)}return this.wtTable.getCell(i)}scrollViewport(i,a,d){return this.wtScroll.scrollViewport(i,a,d)}scrollViewportHorizontally(i,a){return this.wtScroll.scrollViewportHorizontally(i,a)}scrollViewportVertically(i,a){return this.wtScroll.scrollViewportVertically(i,a)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const i=this;return{get drawn(){return i.drawn},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get wtTable(){return i.wtTable},get wtViewport(){return i.wtViewport},get wtSettings(){return i.wtSettings},get rootWindow(){return i.domBindings.rootWindow},get totalRows(){return i.wtSettings.getSetting("totalRows")},get totalColumns(){return i.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return i.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return i.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return i.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const i=this;return{get wot(){return i},get parentTableOffset(){return i.cloneSource.wtTable.tableOffset},get cloneSource(){return i.cloneSource},get workspaceWidth(){return i.wtViewport.getWorkspaceWidth()},get wtViewport(){return i.wtViewport},get wtOverlays(){return i.wtOverlays},get selectionManager(){return i.selectionManager},get stylesHandler(){return i.stylesHandler},get drawn(){return i.drawn},set drawn(a){i.drawn=a},get wtTable(){return i.wtTable},get startColumnRendered(){return i.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return i.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return i.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return i.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return i.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return i.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return i.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return i.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return i.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return i.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return i.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return i.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return i.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return i.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return i.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return i.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return i.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return i.wtSettings.getSetting("rowHeaders")}}}}function Gd(u,i,a){return(i=Qf(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Qf(u){var i=qf(u,"string");return typeof i=="symbol"?i:i+""}function qf(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class lh extends rd{constructor(i,a,d){super(i,a),Gd(this,"cloneSource",void 0),Gd(this,"cloneOverlay",void 0);const w=this.wtSettings.getSetting("facade",this);this.cloneSource=d.source,this.cloneOverlay=d.overlay,this.stylesHandler=d.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),w,this.domBindings,this.wtSettings),this.wtViewport=d.viewport,this.selectionManager=d.selectionManager,this.wtEvent=new Ke(w,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,d.event),this.findOriginalHeaders()}}function Cu(u,i,a){return(i=eg(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function eg(u){var i=Ol(u,"string");return typeof i=="symbol"?i:i+""}function Ol(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class ja{constructor(i,a,d,w,p){Cu(this,"wtSettings",null),(0,Be.defineGetter)(this,"wot",i,{writable:!1}),this.domBindings=p,this.facadeGetter=a,this.wtSettings=w;const{TABLE:T,hider:H,spreader:z,holder:te,wtRootElement:we}=this.wot.wtTable;this.instance=this.wot,this.type=d,this.mainTableScrollableElement=null,this.TABLE=T,this.hider=H,this.spreader=z,this.holder=te,this.wtRootElement=we,this.trimmingContainer=(0,I.getTrimmingContainer)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(i){i==="before"&&this.shouldBeRendered()?this.needFullRender=!0:i==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,I.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:i}=this.wot,{rootWindow:a}=this.domBindings;a.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,I.getScrollableElement)(i.TABLE)}getRelativeCellPosition(i,a,d){if(this.clone.wtTable.holder.contains(i)===!1){(0,hn.ZK)(`The provided element is not a child of the ${this.type} overlay`);return}const w=this.mainTableScrollableElement===this.domBindings.rootWindow,p=d<this.wtSettings.getSetting("fixedColumnsStart"),T=a<this.wtSettings.getSetting("fixedRowsTop"),H=a>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),z=this.clone.wtTable.spreader,te={start:this.getRelativeStartPosition(z),top:z.offsetTop},we={start:this.getRelativeStartPosition(i),top:i.offsetTop};let Ie=null;return w?Ie=this.getRelativeCellPositionWithinWindow(T,p,we,te):Ie=this.getRelativeCellPositionWithinHolder(T,H,p,we,te),Ie}getRelativeStartPosition(i){return this.isRtl()?i.offsetParent.offsetWidth-i.offsetLeft-i.offsetWidth:i.offsetLeft}getRelativeCellPositionWithinWindow(i,a,d,w){const p=this.wot.wtTable.wtRootElement.getBoundingClientRect();let T=0,H=0;if(!a)T=w.start;else{let z=p.left;this.isRtl()&&(z=this.domBindings.rootWindow.innerWidth-(p.left+p.width+(0,I.getScrollbarWidth)())),T=z<=0?-1*z:0}return i?H=this.clone.wtTable.TABLE.getBoundingClientRect().top-p.top:H=w.top,{start:d.start+T,top:d.top+H}}getRelativeCellPositionWithinHolder(i,a,d,w,p){const T={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let H=0,z=0;if(d||(H=T.horizontal-p.start),a){const te=this.wot.wtTable.wtRootElement.getBoundingClientRect();z=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+te.top}else i||(z=T.vertical-p.top);return{start:w.start-H,top:w.top-z}}makeClone(){if(Rl.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:i,wtSettings:a}=this.wot,{rootDocument:d,rootWindow:w}=this.domBindings,p=d.createElement("div"),T=d.createElement("table"),H=i.wtRootElement.parentNode;p.className=`${Va.get(this.type)} handsontable`,p.setAttribute("dir",this.isRtl()?"rtl":"ltr"),p.style.position="absolute",p.style.top=0,p.style.overflow="visible",this.isRtl()?p.style.right=0:p.style.left=0,a.getSetting("ariaTags")&&(0,I.setAttribute)(p,[(0,x.Rn)()]),T.className=i.TABLE.className,i.TABLE.getAttribute("role")&&T.setAttribute("role",i.TABLE.getAttribute("role")),p.appendChild(T),H.appendChild(p);const te=this.wtSettings.getSetting("preventOverflow");return te===!0||te==="horizontal"&&this.type===zs||te==="vertical"&&this.type===Yo?this.mainTableScrollableElement=w:w.getComputedStyle(H).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=i.holder:this.mainTableScrollableElement=(0,I.getScrollableElement)(i.TABLE),new lh(T,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const a=this.clone.cloneSource;a.activeOverlayName=this.clone.wtTable.name,this.clone.draw(i),a.activeOverlayName="master"}}reset(){const i=this.clone.wtTable.holder,a=this.clone.wtTable.hider,d=i.style,w=a.style,p=i.parentNode.style;[d,w,p].forEach(T=>{T.width="",T.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const Ea=u=>{const i=u.stylesHandler;if(i.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const a=i.getCSSVariableValue("cell-autofill-size"),d=i.getCSSVariableValue("cell-autofill-border-width"),w=i.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:a,height:a,borderWidth:d,borderStyle:"solid",borderColor:w})};function Ra(u,i,a){return(i=tg(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function tg(u){var i=id(u,"string");return typeof i=="symbol"?i:i+""}function id(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Il extends ja{constructor(i,a,d,w){super(i,a,zs,d,w),Ra(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var i=arguments.length,a=new Array(i),d=0;d<i;d++)a[d]=arguments[d];return new Li(...a)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const i=this.clone.wtTable.holder.parentNode,{rootWindow:a}=this.domBindings,d=this.wtSettings.getSetting("preventOverflow");let w=0,p=!1;if(this.trimmingContainer===a&&(!d||d!=="vertical")){const{wtTable:H}=this.wot,z=H.hider.getBoundingClientRect(),te=Math.ceil(z.bottom),we=i.offsetHeight;p=te===we,w=this.getOverlayOffset(),(0,I.setOverlayPosition)(i,"0px",`${w}px`)}else w=this.getScrollPosition(),(0,I.resetCssTransform)(i);const T=this.adjustHeaderBordersPosition(w,p);return this.adjustElementsSize(),T}setScrollPosition(i){const{rootWindow:a}=this.domBindings,d=this.mainTableScrollableElement;let w=!1;if(d===a&&i!==a.scrollY){const p=a.scrollY;a.scrollTo((0,I.getWindowScrollLeft)(a),i),w=p!==a.scrollY}else if(i!==d.scrollTop){const p=d.scrollTop;d.scrollTop=i,w=p!==d.scrollTop}return w}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(i,a){const d=this.wot.stylesHandler.getDefaultRowHeight();let w=i,p=0;for(;w<a;){const T=this.wot.wtTable.getRowHeight(w);p+=T===void 0?d:T,w+=1}return p}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:i,wtViewport:a}=this.wot,{rootDocument:d,rootWindow:w}=this.domBindings,T=this.clone.wtTable.holder.parentNode.style,H=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==w||H==="horizontal"){let te=a.getWorkspaceWidth();a.hasVerticalScroll()&&(te-=(0,I.getScrollbarWidth)(d)),te=Math.min(te,i.wtRootElement.scrollWidth),T.width=`${te}px`}else T.width="";this.clone.wtTable.holder.style.width=T.width;let z=(0,I.outerHeight)(this.clone.wtTable.TABLE);i.hasDefinedSize()||(z=0),T.height=`${z}px`}adjustRootChildrenSize(){const{holder:i}=this.clone.wtTable,a=Ea(this.wot),d=this.wot.selectionManager.getFocusSelection()?parseInt(a.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=`${parseInt(i.parentNode.style.height,10)+d}px`}applyToDOM(){const i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const i=this.isRtl()?"right":"left",{spreader:a}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:a.style[i]=""}scrollTo(i,a){const{wot:d,wtSettings:w}=this,T=(d.cloneSource?d.cloneSource:d).wtTable.holder,H=w.getSetting("columnHeaders"),te=w.getSetting("fixedRowsTop")===0&&H.length>0&&!(0,I.hasClass)(T.parentNode,"innerBorderTop")?1:0;let we=this.getTableParentOffset(),Ie=0;if(a){const De=this.wot.wtTable.getRowHeight(i),Le=this.wot.wtViewport.getViewportHeight();De>Le&&(a=!1)}if(a&&T.offsetHeight!==T.clientHeight&&(Ie=(0,I.getScrollbarWidth)(this.domBindings.rootDocument)),a){const De=w.getSetting("fixedRowsBottom"),Le=w.getSetting("totalRows");we+=this.sumCellSizes(0,i+1),we-=d.wtViewport.getViewportHeight()-this.sumCellSizes(Le-De,Le),we+=1,we+=te}else we+=this.sumCellSizes(w.getSetting("fixedRowsTop"),i);return we+=Ie,(0,I.getMaximumScrollTop)(this.mainTableScrollableElement)===we-te&&te>0&&this.wot.wtOverlays.expandHiderVerticallyBy(te),this.setScrollPosition(we)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,I.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:i}=this.domBindings,a=this.wtSettings.getSetting("preventOverflow");let d=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){const w=this.wot.wtTable.getTotalHeight(),p=this.clone.wtTable.getTotalHeight(),T=w-p;d=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),d>T&&(d=0)}return d}adjustHeaderBordersPosition(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:d}=this,w=this.wot.wtTable.holder.parentNode,p=d.getSetting("totalColumns"),T=d.getSetting("preventOverflow")==="horizontal";p?(0,I.removeClass)(w,"emptyColumns"):(0,I.addClass)(w,"emptyColumns");let H=!1;if(!a&&!T){const z=d.getSetting("fixedRowsTop"),te=this.cachedFixedRowsTop!==z,we=d.getSetting("columnHeaders");if((te||z===0)&&we.length>0){const Ie=(0,I.hasClass)(w,"innerBorderTop");this.cachedFixedRowsTop=d.getSetting("fixedRowsTop"),i||d.getSetting("totalRows")===0?((0,I.addClass)(w,"innerBorderTop"),H=!Ie):((0,I.removeClass)(w,"innerBorderTop"),H=Ie)}}return H}}const uh="stickyRowsBottom",Oo={getFirstRenderedRow(){const u=this.getRenderedRowsCount();return u===0?-1:this.wtSettings.getSetting("totalRows")-u},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};(0,Be.defineGetter)(Oo,"MIXIN_NAME",uh,{writable:!1,enumerable:!1});var wu=Oo;class Ii extends Fr{constructor(i,a,d,w){super(i,a,d,w,ws)}}(0,Be.mixin)(Ii,wu),(0,Be.mixin)(Ii,es);var ng=Ii;function eo(u,i,a){return(i=$d(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function $d(u){var i=rg(u,"string");return typeof i=="symbol"?i:i+""}function rg(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class yu extends ja{constructor(i,a,d,w){super(i,a,ws,d,w),eo(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var i=arguments.length,a=new Array(i),d=0;d<i;d++)a[d]=arguments[d];return new ng(...a)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode;a.style.top="";let d=0;const w=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!w||w!=="vertical")?(d=this.getOverlayOffset(),a.style.bottom=`${d}px`):(d=this.getScrollPosition(),this.repositionOverlay());const p=this.adjustHeaderBordersPosition(d);return this.adjustElementsSize(),p}repositionOverlay(){const{wtTable:i,wtViewport:a}=this.wot,{rootDocument:d}=this.domBindings,w=this.clone.wtTable.holder.parentNode;let p=0;a.hasVerticalScroll()||(p+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(p+=(0,I.getScrollbarWidth)(d)),w.style.bottom=`${p}px`}setScrollPosition(i){const{rootWindow:a}=this.domBindings,d=this.mainTableScrollableElement;let w=!1;if(d===a&&i!==a.scrollY){const p=a.scrollY;a.scrollTo((0,I.getWindowScrollLeft)(a),top),w=p!==a.scrollY}else if(i!==d.scrollTop){const p=d.scrollTop;d.scrollTop=i,w=p!==d.scrollTop}return w}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(i,a){const{wtTable:d,stylesHandler:w}=this.wot,p=w.getDefaultRowHeight();let T=i,H=0;for(;T<a;){const z=d.getRowHeight(T);H+=z===void 0?p:z,T+=1}return H}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:i,wtViewport:a}=this.wot,{rootDocument:d,rootWindow:w}=this.domBindings,T=this.clone.wtTable.holder.parentNode.style,H=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==w||H==="horizontal"){let te=a.getWorkspaceWidth();a.hasVerticalScroll()&&(te-=(0,I.getScrollbarWidth)(d)),te=Math.min(te,i.wtRootElement.scrollWidth),T.width=`${te}px`}else T.width="";this.clone.wtTable.holder.style.width=T.width;let z=(0,I.outerHeight)(this.clone.wtTable.TABLE);i.hasDefinedSize()||(z=0),T.height=`${z}px`}adjustRootChildrenSize(){const{holder:i}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}applyToDOM(){const i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const i=this.isRtl()?"right":"left",{spreader:a}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:a.style[i]=""}scrollTo(i,a){let d=this.getTableParentOffset();const p=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let T=0;a&&p.offsetHeight!==p.clientHeight&&(T=(0,I.getScrollbarWidth)(this.domBindings.rootDocument)),a?(d+=this.sumCellSizes(0,i+1),d-=this.wot.wtViewport.getViewportHeight(),d+=1):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),d+=T,this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,I.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:i}=this.domBindings,a=this.wtSettings.getSetting("preventOverflow");let d=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){const w=this.wot.wtTable.getTotalHeight(),p=this.clone.wtTable.getTotalHeight(),T=w-p,H=this.domBindings.rootDocument.documentElement.clientHeight;d=Math.max(this.getTableParentOffset()-this.getScrollPosition()-H+w,0),d>T&&(d=0)}return d}adjustHeaderBordersPosition(i){const a=this.wtSettings.getSetting("fixedRowsBottom"),d=this.cachedFixedRowsBottom!==a,w=this.wtSettings.getSetting("columnHeaders");let p=!1;if((d||a===0)&&w.length>0){const T=this.wot.wtTable.holder.parentNode,H=(0,I.hasClass)(T,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?((0,I.addClass)(T,"innerBorderBottom"),p=!H):((0,I.removeClass)(T,"innerBorderBottom"),p=H)}return p}}const $l="calculatedRows",Io={getFirstRenderedRow(){const u=this.dataAccessObject.startRowRendered;return u===null?-1:u},getFirstVisibleRow(){const u=this.dataAccessObject.startRowVisible;return u===null?-1:u},getFirstPartiallyVisibleRow(){const u=this.dataAccessObject.startRowPartiallyVisible;return u===null?-1:u},getLastRenderedRow(){const u=this.dataAccessObject.endRowRendered;return u===null?-1:u},getLastVisibleRow(){const u=this.dataAccessObject.endRowVisible;return u===null?-1:u},getLastPartiallyVisibleRow(){const u=this.dataAccessObject.endRowPartiallyVisible;return u===null?-1:u},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,Be.defineGetter)(Io,"MIXIN_NAME",$l,{writable:!1,enumerable:!1});var Xd=Io;const ch="stickyColumnsStart",Qu={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,Be.defineGetter)(Qu,"MIXIN_NAME",ch,{writable:!1,enumerable:!1});var Fi=Qu;class qu extends Fr{constructor(i,a,d,w){super(i,a,d,w,Yo)}}(0,Be.mixin)(qu,Xd),(0,Be.mixin)(qu,Fi);var Xl=qu;class Rn extends ja{constructor(i,a,d,w){super(i,a,Yo,d,w)}createTable(){for(var i=arguments.length,a=new Array(i),d=0;d<i;d++)a[d]=arguments[d];return new Xl(...a)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:i}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!i.holder.parentNode)return!1;const{rootWindow:a}=this.domBindings,d=this.clone.wtTable.holder.parentNode,w=this.wtSettings.getSetting("preventOverflow");let p=0;this.trimmingContainer===a&&(!w||w!=="horizontal")?(p=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,I.setOverlayPosition)(d,`${p}px`,"0px")):(p=this.getScrollPosition(),(0,I.resetCssTransform)(d));const T=this.adjustHeaderBordersPosition(p);return this.adjustElementsSize(),T}setScrollPosition(i){const{rootWindow:a}=this.domBindings;let d=!1;this.isRtl()&&(i=-i);const w=this.mainTableScrollableElement;if(w===a&&i!==a.scrollX){const p=a.scrollX;a.scrollTo(i,(0,I.getWindowScrollTop)(a)),d=p!==a.scrollX}else if(i!==w.scrollLeft){const p=w.scrollLeft;w.scrollLeft=i,d=p!==w.scrollLeft}return d}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(i,a){const d=this.wtSettings.getSetting("defaultColumnWidth");let w=i,p=0;for(;w<a;)p+=this.wot.wtTable.getColumnWidth(w)||d,w+=1;return p}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:i,wtViewport:a}=this.wot,{rootDocument:d,rootWindow:w}=this.domBindings,T=this.clone.wtTable.holder.parentNode.style,H=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==w||H==="vertical"){let te=a.getWorkspaceHeight();a.hasHorizontalScroll()&&(te-=(0,I.getScrollbarWidth)(d)),te=Math.min(te,i.wtRootElement.scrollHeight),T.height=`${te}px`}else T.height="";this.clone.wtTable.holder.style.height=T.height;const z=(0,I.outerWidth)(this.clone.wtTable.TABLE);T.width=`${z}px`}adjustRootChildrenSize(){const{holder:i}=this.clone.wtTable,a=Ea(this.wot),d=this.wot.selectionManager.getFocusSelection()?parseInt(a.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width=`${parseInt(i.parentNode.style.width,10)+d}px`}applyToDOM(){const i=this.wtSettings.getSetting("totalColumns"),a=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[a]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(i===0)this.spreader.style[a]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(i,a){const{wtSettings:d}=this,w=d.getSetting("rowHeaders"),p=d.getSetting("fixedColumnsStart"),H=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,z=p===0&&w.length>0&&!(0,I.hasClass)(H.parentNode,"innerBorderInlineStart")?1:0;let te=this.getTableParentOffset(),we=0;if(a){const Ie=this.wot.wtTable.getColumnWidth(i),De=this.wot.wtViewport.getViewportWidth();Ie>De&&(a=!1)}return a&&H.offsetWidth!==H.clientWidth&&(we=(0,I.getScrollbarWidth)(this.domBindings.rootDocument)),a?(te+=this.sumCellSizes(0,i+1),te-=this.wot.wtViewport.getViewportWidth(),te+=z):te+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),te+=we,(0,I.getMaximumScrollLeft)(this.mainTableScrollableElement)===te-z&&z>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(z),this.setScrollPosition(te)}getTableParentOffset(){const i=this.wtSettings.getSetting("preventOverflow");let a=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(a=this.wot.wtTable.holderOffset.left),a}getScrollPosition(){return Math.abs((0,I.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:i}=this.domBindings,a=this.wtSettings.getSetting("preventOverflow");let d=0;if(this.trimmingContainer===i&&(!a||a!=="horizontal")){this.isRtl()?d=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):d=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const w=this.wot.wtTable.getTotalWidth(),p=this.clone.wtTable.getTotalWidth(),T=w-p;d>T&&(d=0)}return d}adjustHeaderBordersPosition(i){const{wtSettings:a}=this,d=this.wot.wtTable.holder.parentNode,w=a.getSetting("rowHeaders"),p=a.getSetting("fixedColumnsStart"),T=a.getSetting("totalRows"),H=a.getSetting("preventOverflow")==="vertical";T?(0,I.removeClass)(d,"emptyRows"):(0,I.addClass)(d,"emptyRows");let z=!1;if(!H){if(p&&!w.length)(0,I.addClass)(d,"innerBorderLeft innerBorderInlineStart");else if(!p&&w.length){const te=(0,I.hasClass)(d,"innerBorderInlineStart");i?((0,I.addClass)(d,"innerBorderLeft innerBorderInlineStart"),z=!te):((0,I.removeClass)(d,"innerBorderLeft innerBorderInlineStart"),z=te)}}return z}}class Ac extends Fr{constructor(i,a,d,w){super(i,a,d,w,Go)}}(0,Be.mixin)(Ac,Wt),(0,Be.mixin)(Ac,Fi);var Nc=Ac;function Zl(u,i,a){return(i=hh(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function hh(u){var i=ec(u,"string");return typeof i=="symbol"?i:i+""}function ec(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Zd extends ja{constructor(i,a,d,w,p,T){super(i,a,Go,d,w),Zl(this,"topOverlay",void 0),Zl(this,"inlineStartOverlay",void 0),this.topOverlay=p,this.inlineStartOverlay=T}createTable(){for(var i=arguments.length,a=new Array(i),d=0;d<i;d++)a[d]=arguments[d];return new Nc(...a)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const w=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),p=this.topOverlay.getOverlayOffset();(0,I.setOverlayPosition)(i,`${w}px`,`${p}px`)}else(0,I.resetCssTransform)(i);let a=(0,I.outerHeight)(this.clone.wtTable.TABLE);const d=(0,I.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(a=0),i.style.height=`${a}px`,i.style.width=`${d}px`,!1}}class Jl extends Fr{constructor(i,a,d,w){super(i,a,d,w,Mo)}}(0,Be.mixin)(Jl,wu),(0,Be.mixin)(Jl,Fi);var Jd=Jl;class sd extends ja{constructor(i,a,d,w,p,T){super(i,a,Mo,d,w),this.bottomOverlay=p,this.inlineStartOverlay=T}createTable(){for(var i=arguments.length,a=new Array(i),d=0;d<i;d++)a[d]=arguments[d];return new Jd(...a)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:i}=this;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;const a=this.clone.wtTable.holder.parentNode;if(a.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const p=this.inlineStartOverlay.getOverlayOffset(),T=this.bottomOverlay.getOverlayOffset();a.style[this.isRtl()?"right":"left"]=`${p}px`,a.style.bottom=`${T}px`}else(0,I.resetCssTransform)(a),this.repositionOverlay();let d=(0,I.outerHeight)(this.clone.wtTable.TABLE);const w=(0,I.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(d=0),a.style.height=`${d}px`,a.style.width=`${w}px`,!1}repositionOverlay(){const{wtTable:i,wtViewport:a}=this.wot,{rootDocument:d}=this.domBindings,w=this.clone.wtTable.holder.parentNode;let p=0;a.hasVerticalScroll()||(p+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(p+=(0,I.getScrollbarWidth)(d)),w.style.bottom=`${p}px`}}function Xo(u,i,a){Qd(u,i),i.set(u,a)}function Qd(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(u,i,a){return(i=tc(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function tc(u){var i=qd(u,"string");return typeof i=="symbol"?i:i+""}function qd(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function Ua(u,i,a){return u.set(nc(u,i),a),a}function Zo(u,i){return u.get(nc(u,i))}function nc(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var Ql=new WeakMap,Po=new WeakMap,Fo=new WeakMap,ca=new WeakMap;class od{constructor(i,a,d,w,p,T){il(this,"wot",null),Xo(this,Ql,[]),il(this,"topOverlay",null),il(this,"bottomOverlay",null),il(this,"inlineStartOverlay",null),il(this,"topInlineStartCornerOverlay",null),il(this,"bottomInlineStartCornerOverlay",null),il(this,"browserLineHeight",void 0),il(this,"wtSettings",null),Xo(this,Po,!1),Xo(this,Fo,0),Xo(this,ca,null),il(this,"resizeObserver",new ResizeObserver(we=>{(0,Vs.requestAnimationFrame)(()=>{!Array.isArray(we)||!we.length||(Ua(Fo,this,Zo(Fo,this)+1),Zo(Fo,this)===100&&((0,hn.ZK)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Zo(ca,this)!==null&&clearTimeout(Zo(ca,this)),Ua(ca,this,setTimeout(()=>{Ua(Fo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=i,this.wtSettings=w,this.domBindings=d,this.facadeGetter=a,this.wtTable=T;const{rootDocument:H,rootWindow:z}=this.domBindings;this.instance=this.wot,this.eventManager=p,this.scrollbarSize=(0,I.getScrollbarWidth)(H);const te=z.getComputedStyle(T.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=te?T.holder:(0,I.getScrollableElement)(T.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=z.scrollX,this.lastScrollY=z.scrollY}getOverlays(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const a=[...Zo(Ql,this)];return i&&a.push(this.wtTable),a}initBrowserLineHeight(){const{rootWindow:i,rootDocument:a}=this.domBindings,d=i.getComputedStyle(a.body),w=parseInt(d.lineHeight,10),p=parseInt(d.fontSize,10)*1.2;this.browserLineHeight=w||p}initOverlays(){const i=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Il(...i),this.bottomOverlay=new yu(...i),this.inlineStartOverlay=new Rn(...i),this.topInlineStartCornerOverlay=new Zd(...i,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new sd(...i,this.bottomOverlay,this.inlineStartOverlay),Ua(Ql,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ua(Po,this,Zo(Ql,this).reduce((i,a)=>a.hasRenderingStateChanged()||i,!1)),Zo(Ql,this).forEach(i=>i.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Zo(Ql,this).forEach(i=>{const a=i.hasRenderingStateChanged();i.updateStateOfRendering("after"),a&&!i.needFullRender&&i.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:i,rootWindow:a}=this.domBindings,{mainTableScrollableElement:d}=this.topOverlay,{mainTableScrollableElement:w}=this.inlineStartOverlay;this.eventManager.addEventListener(i.documentElement,"keydown",Ie=>this.onKeyDown(Ie)),this.eventManager.addEventListener(i.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(d,"scroll",Ie=>this.onTableScroll(Ie),{passive:!0}),d!==w&&this.eventManager.addEventListener(w,"scroll",Ie=>this.onTableScroll(Ie),{passive:!0});const p=a.devicePixelRatio&&a.devicePixelRatio>1,T=this.scrollableElement===a,H=this.wtSettings.getSetting("preventWheel"),z={passive:T};(H||p||!(0,de.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",Ie=>this.onCloneWheel(Ie,H),z),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(Ie=>{this.eventManager.addEventListener(Ie.clone.wtTable.holder,"wheel",De=>this.onCloneWheel(De,H),z)});let we;this.eventManager.addEventListener(a,"resize",()=>{(0,Vs.requestAnimationFrame)(()=>{clearTimeout(we),this.wtSettings.getSetting("onWindowResize"),we=setTimeout(()=>{Ua(Fo,this,0)},200)})}),T||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(i){const a=this.domBindings.rootWindow,d=this.inlineStartOverlay.mainTableScrollableElement,w=this.topOverlay.mainTableScrollableElement,p=i.target;this.keyPressed&&(w!==a&&p!==a&&!i.target.contains(w)||d!==a&&p!==a&&!i.target.contains(d))||this.syncScrollPositions(i)}onCloneWheel(i,a){const{rootWindow:d}=this.domBindings,w=this.inlineStartOverlay.mainTableScrollableElement,p=this.topOverlay.mainTableScrollableElement,T=i.target,H=p!==d&&T!==d&&!T.contains(p),z=w!==d&&T!==d&&!T.contains(w);if(this.keyPressed&&(H||z)||this.scrollableElement===d)return;const te=this.translateMouseWheelToScroll(i);(a||this.scrollableElement!==d&&te)&&i.preventDefault()}onKeyDown(i){this.keyPressed=(0,ue.isKey)(i.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(i){let a=isNaN(i.deltaY)?-1*i.wheelDeltaY:i.deltaY,d=isNaN(i.deltaX)?-1*i.wheelDeltaX:i.deltaX;i.deltaMode===1&&(d+=d*this.browserLineHeight,a+=a*this.browserLineHeight);const w=this.scrollVertically(a),p=this.scrollHorizontally(d);return w||p}scrollVertically(i){const a=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=i,a!==this.scrollableElement.scrollTop}scrollHorizontally(i){const a=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=i,a!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const i=this.topOverlay.clone.wtTable.holder,a=this.inlineStartOverlay.clone.wtTable.holder;let d=this.scrollableElement.scrollLeft,w=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(d=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(w=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==d,this.verticalScrolling=this.lastScrollY!==w,this.lastScrollX=d,this.lastScrollY=w,this.horizontalScrolling){i.scrollLeft=d;const p=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;p&&(p.scrollLeft=d)}this.verticalScrolling&&(a.scrollTop=w),this.refreshAll()}syncScrollWithMaster(){if(!Zo(Po,this))return;const i=this.topOverlay.mainTableScrollableElement,{scrollLeft:a,scrollTop:d}=i;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=a),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=a),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=d),Ua(Po,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:i}=this,{rootWindow:a}=this.domBindings;a.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=i.holder:this.scrollableElement=(0,I.getScrollableElement)(i.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(i),this.inlineStartOverlay.refresh(i),this.topOverlay.refresh(i),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(i),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(i)}updateLastSpreaderSize(){const i=this.wtTable.spreader,a=i.clientWidth,d=i.clientHeight,w=a!==this.spreaderLastSize.width||d!==this.spreaderLastSize.height;return w&&(this.spreaderLastSize.width=a,this.spreaderLastSize.height=d),w}adjustElementsSize(){const{wtViewport:i}=this.wot,{wtTable:a}=this,{rootWindow:d}=this.domBindings,w=this.scrollableElement===d,p=this.wtSettings.getSetting("totalColumns"),T=this.wtSettings.getSetting("totalRows"),H=i.getRowHeaderWidth(),te=i.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,T)+1,we=H+this.inlineStartOverlay.sumCellSizes(0,p),De=a.hider.style,Le=()=>w?!1:this.scrollableElement.scrollTop>Math.max(0,te-a.holder.clientHeight),ut=()=>w?!1:this.scrollableElement.scrollLeft>Math.max(0,we-a.holder.clientWidth),Bt=Le()?1:0,zn=ut()?1:0;De.width=`${we+zn}px`,De.height=`${te+Bt}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(i){const{wtTable:a}=this;a.hider.style.height=`${parseInt(a.hider.style.height,10)+i}px`}expandHiderHorizontallyBy(i){const{wtTable:a}=this;a.hider.style.width=`${parseInt(a.hider.style.width,10)+i}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(i){if(!i)return null;const a=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let d=null;return(0,mn.arrayEach)(a,w=>{w&&w.clone&&w.clone.wtTable.TABLE.contains(i)&&(d=w.clone)}),d}syncOverlayTableClassNames(){const i=this.wtTable.TABLE,a=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,mn.arrayEach)(a,d=>{d&&(d.clone.wtTable.TABLE.className=i.className)})}}var rc=od;function sl(u,i,a){return(i=ef(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function ef(u){var i=Ta(u,"string");return typeof i=="symbol"?i:i+""}function Ta(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class dh{constructor(i){sl(this,"settings",{}),sl(this,"defaults",Object.freeze(this.getDefaults())),(0,Be.objectEach)(this.defaults,(a,d)=>{if(i[d]!==void 0)this.settings[d]=i[d];else{if(a===void 0)throw new Error(`A required setting "${d}" was not provided`);this.settings[d]=a}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(i,a,d)=>{const w=this.getSetting("data",i,a);(0,I.fastInnerText)(d,w==null?"":w)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:i=>i,onBeforeViewportScrollVertically:i=>i,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:i=>i,onBeforeHighlightingColumnHeader:i=>i,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(i,a){return a===void 0?(0,Be.objectEach)(i,(d,w)=>{this.settings[w]=d}):this.settings[i]=a,this}getSetting(i,a,d,w,p){return typeof this.settings[i]=="function"?this.settings[i](a,d,w,p):a!==void 0&&Array.isArray(this.settings[i])?this.settings[i][a]:this.settings[i]}getSettingPure(i){return this.settings[i]}has(i){return!!this.settings[i]}}class ha extends Fr{constructor(i,a,d,w){super(i,a,d,w,"master")}alignOverlaysWithTrimmingContainer(){const i=(0,I.getTrimmingContainer)(this.wtRootElement),{rootWindow:a}=this.domBindings;if(i===a)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const d=i.parentElement,w=(0,I.getStyle)(i,"height",a),p=(0,I.getStyle)(i,"overflow",a),T=this.holder.style,{scrollWidth:H,scrollHeight:z}=i;let te=i.offsetWidth,we=i.offsetHeight;if(d&&["auto","hidden","scroll"].includes(p)){const De=i.cloneNode(!1);De.style.overflow="auto",De.style.position="absolute",i.nextElementSibling?d.insertBefore(De,i.nextElementSibling):d.appendChild(De);const Le=parseInt(a.getComputedStyle(De).height,10);d.removeChild(De),Le===0&&(we=0)}we=Math.min(we,z),T.height=w==="auto"?"auto":`${we}px`,te=Math.min(te,H),T.width=`${te}px`,T.overflow="",this.hasTableHeight=T.height==="auto"?!0:we>0,this.hasTableWidth=te>0}this.isTableVisible=(0,I.isVisible)(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:i}=this,{wtViewport:a}=this.dataAccessObject,d="master",p=i.getSetting("columnHeaders").length;if(p&&!a.hasOversizedColumnHeadersMarked[d]){const H=i.getSetting("rowHeaders").length,z=this.getRenderedColumnsCount();for(let te=0;te<p;te++)for(let we=-1*H;we<z;we++)this.markIfOversizedColumnHeader(we);a.hasOversizedColumnHeadersMarked[d]=!0}}}(0,Be.mixin)(ha,Xd),(0,Be.mixin)(ha,es);var Ks=ha;function fh(u,i,a){return(i=ig(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function ig(u){var i=ic(u,"string");return typeof i=="symbol"?i:i+""}function ic(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class gh{constructor(){fh(this,"count",0),fh(this,"startRow",0),fh(this,"endRow",0),fh(this,"startPosition",0),fh(this,"isVisibleInTrimmingContainer",!0)}initialize(i){let{totalRows:a}=i;this.count=a,this.endRow=this.count-1}process(){}finalize(){}}var Jo=f(61699),tf=f(47723);function sc(u,i,a){return(i=nf(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function nf(u){var i=sg(u,"string");return typeof i=="symbol"?i:i+""}function sg(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class xr{constructor(){sc(this,"count",0),sc(this,"startRow",null),sc(this,"endRow",null),sc(this,"startPosition",null),sc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(i,a){const{totalCalculatedHeight:d,zeroBasedScrollOffset:w,innerViewportHeight:p}=a;d<=w&&(this.startRow=i),d>=w&&d<=p&&this.startRow===null&&(this.startRow=i),this.endRow=i}finalize(i){var a;const{scrollOffset:d,viewportHeight:w,horizontalScrollbarHeight:p,totalRows:T,needReverse:H,startPositions:z,rowHeight:te}=i;if(this.endRow===T-1&&H)for(this.startRow=this.endRow;this.startRow>0;){const Ie=z[this.endRow]+te-z[this.startRow-1];if(this.startRow-=1,Ie>=w-p)break}this.startPosition=(a=z[this.startRow])!==null&&a!==void 0?a:null,d+w-p<0||d>z.at(-1)+te?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,T<this.endRow&&(this.endRow=T-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function rf(u,i,a){return(i=sf(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function sf(u){var i=Su(u,"string");return typeof i=="symbol"?i:i+""}function Su(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class og extends xr{constructor(){super(...arguments),rf(this,"rowStartOffset",0),rf(this,"rowEndOffset",0)}finalize(i){var a;super.finalize(i);const{overrideFn:d,totalRows:w,startPositions:p}=i;if(this.startRow!==null&&typeof d=="function"){const T=this.startRow,H=this.endRow;d(this),this.rowStartOffset=T-this.startRow,this.rowEndOffset=this.endRow-H}this.startRow<0&&(this.startRow=0),this.startPosition=(a=p[this.startRow])!==null&&a!==void 0?a:null,w<this.endRow&&(this.endRow=w-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ys(u,i,a){return(i=Dc(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Dc(u){var i=Gs(u,"string");return typeof i=="symbol"?i:i+""}function Gs(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class cm{constructor(){Ys(this,"count",0),Ys(this,"startRow",null),Ys(this,"endRow",null),Ys(this,"startPosition",null),Ys(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(i,a){const{totalCalculatedHeight:d,zeroBasedScrollOffset:w,innerViewportHeight:p,rowHeight:T}=a;d>=w&&d+T<=p&&(this.startRow===null&&(this.startRow=i),this.endRow=i)}finalize(i){var a;const{scrollOffset:d,viewportHeight:w,horizontalScrollbarHeight:p,totalRows:T,needReverse:H,startPositions:z,rowHeight:te}=i;if(this.endRow===T-1&&H)for(this.startRow=this.endRow;this.startRow>0;){const De=z[this.endRow]+te-z[this.startRow-1];if(De<=w-p&&(this.startRow-=1),De>=w-p)break}this.startPosition=(a=z[this.startRow])!==null&&a!==void 0?a:null;const we=d+w-p,Ie=this.startRow===null?0:i.getRowHeight(this.startRow);we<Ie||d>z.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,T<this.endRow&&(this.endRow=T-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function za(u,i,a){return(i=ol(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function ol(u){var i=ad(u,"string");return typeof i=="symbol"?i:i+""}function ad(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Hc{constructor(){za(this,"count",0),za(this,"startColumn",0),za(this,"endColumn",0),za(this,"startPosition",0),za(this,"isVisibleInTrimmingContainer",!0)}initialize(i){let{totalColumns:a}=i;this.count=a,this.endColumn=this.count-1}process(){}finalize(){}}function jr(u,i,a){return(i=Qo(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Qo(u){var i=Lc(u,"string");return typeof i=="symbol"?i:i+""}function Lc(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Pl{constructor(){jr(this,"count",0),jr(this,"startColumn",null),jr(this,"endColumn",null),jr(this,"startPosition",null),jr(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(i,a){const{totalCalculatedWidth:d,zeroBasedScrollOffset:w,viewportWidth:p}=a;d<=w&&(this.startColumn=i);const T=w>0?p+1:p;d>=w&&d<=w+T&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=i),this.endColumn=i}finalize(i){var a;const{scrollOffset:d,viewportWidth:w,inlineStartOffset:p,zeroBasedScrollOffset:T,totalColumns:H,needReverse:z,startPositions:te,columnWidth:we}=i;if(this.endColumn===H-1&&z)for(this.startColumn=this.endColumn;this.startColumn>0;){const Le=te[this.endColumn]+we-te[this.startColumn-1];if(this.startColumn-=1,Le>w)break}this.startPosition=(a=te[this.startColumn])!==null&&a!==void 0?a:null;const Ie=T>0?w+1:w;d+w-Ie<-1*p||d>te.at(-1)+we||-1*d-w>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,H<this.endColumn&&(this.endColumn=H-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xl(u,i,a){return(i=of(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function of(u){var i=Al(u,"string");return typeof i=="symbol"?i:i+""}function Al(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class ld extends Pl{constructor(){super(...arguments),xl(this,"columnStartOffset",0),xl(this,"columnEndOffset",0)}finalize(i){var a;super.finalize(i);const{overrideFn:d,totalColumns:w,startPositions:p}=i;if(this.startColumn!==null&&typeof d=="function"){const T=this.startColumn,H=this.endColumn;d(this),this.columnStartOffset=T-this.startColumn,this.columnEndOffset=this.endColumn-H}this.startColumn<0&&(this.startColumn=0),this.startPosition=(a=p[this.startColumn])!==null&&a!==void 0?a:null,w<this.endColumn&&(this.endColumn=w-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Nl(u,i,a){return(i=Ka(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Ka(u){var i=Dl(u,"string");return typeof i=="symbol"?i:i+""}function Dl(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class mh{constructor(){Nl(this,"count",0),Nl(this,"startColumn",null),Nl(this,"endColumn",null),Nl(this,"startPosition",null),Nl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(i,a){const{totalCalculatedWidth:d,zeroBasedScrollOffset:w,viewportWidth:p,columnWidth:T}=a,H=w>0?p+1:p;d>=w&&d+T<=w+H&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=i),this.endColumn=i)}finalize(i){var a;const{scrollOffset:d,viewportWidth:w,inlineStartOffset:p,zeroBasedScrollOffset:T,totalColumns:H,needReverse:z,startPositions:te,columnWidth:we}=i;if(this.endColumn===H-1&&z)for(this.startColumn=this.endColumn;this.startColumn>0;){const ut=te[this.endColumn]+we-te[this.startColumn-1];if(ut<=w&&(this.startColumn-=1),ut>=w)break}this.startPosition=(a=te[this.startColumn])!==null&&a!==void 0?a:null;const Ie=T>0?w+1:w,De=d+w-Ie,Le=this.startColumn===null?0:i.getColumnWidth(this.startColumn);De<-1*p||d>te.at(-1)||-1*d-w>-1*Le?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,H<this.endColumn&&(this.endColumn=H-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}var Fc=f(76161);function $s(u,i,a){return(i=ud(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function ud(u){var i=hm(u,"string");return typeof i=="symbol"?i:i+""}function hm(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class ql extends Fc.f{constructor(i){let{calculationTypes:a,viewportHeight:d,scrollOffset:w,totalRows:p,defaultRowHeight:T,rowHeightFn:H,overrideFn:z,horizontalScrollbarHeight:te}=i;super(a),$s(this,"viewportHeight",0),$s(this,"scrollOffset",0),$s(this,"zeroBasedScrollOffset",0),$s(this,"totalRows",0),$s(this,"rowHeightFn",null),$s(this,"rowHeight",0),$s(this,"overrideFn",null),$s(this,"horizontalScrollbarHeight",0),$s(this,"innerViewportHeight",0),$s(this,"totalCalculatedHeight",0),$s(this,"startPositions",[]),$s(this,"needReverse",!0),this.defaultHeight=T,this.viewportHeight=d,this.scrollOffset=w,this.zeroBasedScrollOffset=Math.max(w,0),this.totalRows=p,this.rowHeightFn=H,this.overrideFn=z,this.horizontalScrollbarHeight=te!=null?te:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let i=0;i<this.totalRows;i++)if(this.rowHeight=this.getRowHeight(i),this._process(i,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(i){const a=this.rowHeightFn(i);return isNaN(a)?this.defaultHeight:a}}var Hl=f(39097);class qo{constructor(i,a,d,w,p){this.dataAccessObject=i,this.wot=i.wot,this.instance=this.wot,this.domBindings=a,this.wtSettings=d,this.wtTable=p,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new gh:new og],["fullyVisible",()=>new cm],["partiallyVisible",()=>new xr]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Hc:new ld],["fullyVisible",()=>new mh],["partiallyVisible",()=>new Pl]]),this.eventManager=w,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const i=this.domBindings.rootDocument,a=this.dataAccessObject.topOverlayTrimmingContainer;let d=0;return a===this.domBindings.rootWindow?d=i.documentElement.clientHeight:d=(0,I.outerHeight)(a)>0&&a.clientHeight>0?a.clientHeight:1/0,d}getViewportHeight(){let i=this.getWorkspaceHeight();if(i===1/0)return i;const a=this.getColumnHeaderHeight();return a>0&&(i-=a),i}getWorkspaceWidth(){const{rootDocument:i,rootWindow:a}=this.domBindings,d=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let w;if(d===a){const p=this.wtSettings.getSetting("totalColumns");w=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,p)>w&&(w=i.documentElement.clientWidth)}else w=d.clientWidth;return w}getViewportWidth(){const i=this.getWorkspaceWidth();if(i===1/0)return i;const a=this.getRowHeaderWidth();return a>0?i-a:i}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const p=this.domBindings.rootDocument.documentElement;return p.scrollHeight>p.clientHeight}const{holder:i,hider:a}=this.wtTable,d=i.clientHeight,w=a.offsetHeight;return d<w?!0:w>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const p=this.domBindings.rootDocument.documentElement;return p.scrollWidth>p.clientWidth}const{holder:i,hider:a}=this.wtTable,d=i.clientWidth,w=a.offsetWidth;return d<w?!0:w>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(i,a){let d=0,w=i;for(;w<a;)d+=this.wtTable.getColumnWidth(w),w+=1;return d}getWorkspaceOffset(){return(0,I.offset)(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,I.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const i=this.wtSettings.getSetting("rowHeaderWidth"),a=this.wtSettings.getSetting("rowHeaders");if(i){this.rowHeaderWidth=0;for(let d=0,w=a.length;d<w;d++)this.rowHeaderWidth+=i[d]||i}if(isNaN(this.rowHeaderWidth))if(a.length){let d=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let w=0,p=a.length;w<p;w++)d?(this.rowHeaderWidth+=(0,I.outerWidth)(d),d=d.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:a,wtTable:d}=this;let w=this.getViewportHeight(),p,T;this.rowHeaderWidth=NaN;let H=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const z=a.getSetting("fixedRowsTop"),te=a.getSetting("fixedRowsBottom"),we=a.getSetting("totalRows");return z&&H>=0&&(T=this.dataAccessObject.topOverlay.sumCellSizes(0,z),H+=T,w-=T),te&&this.dataAccessObject.bottomOverlay.clone&&(T=this.dataAccessObject.bottomOverlay.sumCellSizes(we-te,we),w-=T),d.holder.clientHeight===d.holder.offsetHeight?p=0:p=(0,I.getScrollbarWidth)(this.domBindings.rootDocument),new ql({calculationTypes:i.map(Ie=>[Ie,this.rowsCalculatorTypes.get(Ie)()]),viewportHeight:w,scrollOffset:H,totalRows:a.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:Ie=>d.getRowHeight(Ie),overrideFn:a.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:p})}createColumnsCalculator(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:a,wtTable:d}=this;let w=this.getViewportWidth(),p=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const T=a.getSetting("fixedColumnsStart");if(T&&p>=0){const H=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,T);p+=H,w-=H}return d.holder.clientWidth!==d.holder.offsetWidth&&(w-=(0,I.getScrollbarWidth)(this.domBindings.rootDocument)),new Hl.E({calculationTypes:i.map(H=>[H,this.columnsCalculatorTypes.get(H)()]),viewportWidth:w,scrollOffset:p,totalColumns:a.getSetting("totalColumns"),columnWidthFn:H=>d.getColumnWidth(H),overrideFn:a.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:a}=this,d=this.createRowsCalculator(),w=this.createColumnsCalculator();if(i&&!a.getSetting("renderAllRows")){const p=d.getResultsFor("fullyVisible");i=this.areAllProposedVisibleRowsAlreadyRendered(p)}if(i&&!a.getSetting("renderAllColumns")){const p=w.getResultsFor("fullyVisible");i=this.areAllProposedVisibleColumnsAlreadyRendered(p)}return i||(this.rowsRenderCalculator=d.getResultsFor("rendered"),this.columnsRenderCalculator=w.getResultsFor("rendered")),this.rowsVisibleCalculator=d.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=w.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=d.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=w.getResultsFor("partiallyVisible"),i}createVisibleCalculators(){const i=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),a=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=a.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=a.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(i){if(!this.rowsVisibleCalculator)return!1;let{startRow:a,endRow:d}=i;if(a===null&&d===null){if(!i.isVisibleInTrimmingContainer)return!0;a=this.rowsPartiallyVisibleCalculator.startRow,d=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:w,endRow:p,rowStartOffset:T,rowEndOffset:H}=this.rowsRenderCalculator,z=this.wtSettings.getSetting("totalRows")-1,te=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(te)&&te>0?(a=Math.max(0,a-Math.min(T,te)),d=Math.min(z,d+Math.min(H,te))):te==="auto"&&(a=Math.max(0,a-Math.ceil(T/2)),d=Math.min(z,d+Math.ceil(H/2))),a<w||a===w&&a>0?!1:!(d>p||d===p&&d<z)}areAllProposedVisibleColumnsAlreadyRendered(i){if(!this.columnsVisibleCalculator)return!1;let{startColumn:a,endColumn:d}=i;if(a===null&&d===null){if(!i.isVisibleInTrimmingContainer)return!0;a=this.columnsPartiallyVisibleCalculator.startColumn,d=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:w,endColumn:p,columnStartOffset:T,columnEndOffset:H}=this.columnsRenderCalculator,z=this.wtSettings.getSetting("totalColumns")-1,te=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(te)&&te>0?(a=Math.max(0,a-Math.min(T,te)),d=Math.min(z,d+Math.min(H,te))):te==="auto"&&(a=Math.max(0,a-Math.ceil(T/2)),d=Math.min(z,d+Math.ceil(H/2))),a<w||a===w&&a>0?!1:!(d>p||d===p&&d<z)}resetHasOversizedColumnHeadersMarked(){(0,Be.objectEach)(this.hasOversizedColumnHeadersMarked,(i,a,d)=>{d[a]=void 0})}}var cd=qo,yp=f(25799);function af(u,i){_u(u,i),i.add(u)}function ph(u,i,a){_u(u,i),i.set(u,a)}function _u(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pi(u,i){return u.get(ea(u,i))}function Wo(u,i,a){return u.set(ea(u,i),a),a}function ea(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var Ya=new WeakMap,ui=new WeakMap,da=new WeakSet;class ys{constructor(){af(this,da),ph(this,Ya,void 0),ph(this,ui,void 0)}setActiveOverlay(i){return Wo(ui,this,i),this}setActiveSelection(i){return Wo(Ya,this,i),this}scan(){const i=Pi(Ya,this).settings.selectionType,a=new Set;return i==="active-header"?(this.scanColumnsInHeadersRange(d=>a.add(d)),this.scanRowsInHeadersRange(d=>a.add(d))):i==="area"?this.scanCellsRange(d=>a.add(d)):i==="focus"?(this.scanColumnsInHeadersRange(d=>a.add(d)),this.scanRowsInHeadersRange(d=>a.add(d)),this.scanCellsRange(d=>a.add(d))):i==="fill"?this.scanCellsRange(d=>a.add(d)):i==="header"?(this.scanColumnsInHeadersRange(d=>a.add(d)),this.scanRowsInHeadersRange(d=>a.add(d))):i==="row"?(this.scanRowsInHeadersRange(d=>a.add(d)),this.scanRowsInCellsRange(d=>a.add(d))):i==="column"&&(this.scanColumnsInHeadersRange(d=>a.add(d)),this.scanColumnsInCellsRange(d=>a.add(d))),a}scanColumnsInHeadersRange(i){const[a,d,w,p]=Pi(Ya,this).getCorners(),{wtTable:T}=Pi(ui,this),H=T.getRenderedColumnsCount(),z=T.getColumnHeadersCount();let te=0;for(let we=-T.getRowHeadersCount();we<H;we++){const Ie=T.columnFilter.renderedToSource(we);if(!(Ie<d||Ie>p)){for(let De=-z;De<0;De++){if(De<a||De>w)continue;const Le=De+z;let ut=T.getColumnHeader(Ie,Le);const Bt=Pi(ui,this).getSetting("onBeforeHighlightingColumnHeader",Ie,Le,{selectionType:Pi(Ya,this).settings.selectionType,columnCursor:te,selectionWidth:p-d+1});Bt!==null&&(Bt!==Ie&&(ut=T.getColumnHeader(Bt,Le)),i(ut))}te+=1}}}scanRowsInHeadersRange(i){const[a,d,w,p]=Pi(Ya,this).getCorners(),{wtTable:T}=Pi(ui,this),H=T.getRenderedRowsCount(),z=T.getRowHeadersCount();let te=0;for(let we=-T.getColumnHeadersCount();we<H;we++){const Ie=T.rowFilter.renderedToSource(we);if(!(Ie<a||Ie>w)){for(let De=-z;De<0;De++){if(De<d||De>p)continue;const Le=De+z;let ut=T.getRowHeader(Ie,Le);const Bt=Pi(ui,this).getSetting("onBeforeHighlightingRowHeader",Ie,Le,{selectionType:Pi(Ya,this).settings.selectionType,rowCursor:te,selectionHeight:w-a+1});Bt!==null&&(Bt!==Ie&&(ut=T.getRowHeader(Bt,Le)),i(ut))}te+=1}}}scanCellsRange(i){const{wtTable:a}=Pi(ui,this);ea(da,this,Ll).call(this,(d,w)=>{const p=a.getCell(Pi(ui,this).createCellCoords(d,w)),T=Pi(ui,this).getSetting("onAfterDrawSelection",d,w,Pi(Ya,this).settings.layerLevel);typeof T=="string"&&(0,I.addClass)(p,T),i(p)})}scanRowsInCellsRange(i){const[a,,d]=Pi(Ya,this).getCorners(),{wtTable:w}=Pi(ui,this);ea(da,this,oc).call(this,(p,T)=>{if(p>=a&&p<=d){const H=w.getCell(Pi(ui,this).createCellCoords(p,T));i(H)}})}scanColumnsInCellsRange(i){const[,a,,d]=Pi(Ya,this).getCorners(),{wtTable:w}=Pi(ui,this);ea(da,this,oc).call(this,(p,T)=>{if(T>=a&&T<=d){const H=w.getCell(Pi(ui,this).createCellCoords(p,T));i(H)}})}}function Ll(u){let[i,a,d,w]=Pi(Ya,this).getCorners();if(i<0&&d<0||a<0&&w<0)return;const{wtTable:p}=Pi(ui,this),T=i!==d||a!==w;if(a=Math.max(a,0),w=Math.max(w,0),i=Math.max(i,0),d=Math.max(d,0),T){if(a=Math.max(a,p.getFirstRenderedColumn()),w=Math.min(w,p.getLastRenderedColumn()),i=Math.max(i,p.getFirstRenderedRow()),d=Math.min(d,p.getLastRenderedRow()),w<a||d<i)return}else{const H=p.getCell(Pi(ui,this).createCellCoords(i,a));if(!(0,I.isHTMLElement)(H))return}for(let H=i;H<=d;H+=1)for(let z=a;z<=w;z+=1)u(H,z)}function oc(u){const{wtTable:i}=Pi(ui,this),a=i.getRenderedRowsCount(),d=i.getRenderedColumnsCount();for(let w=0;w<a;w+=1){const p=i.rowFilter.renderedToSource(w);for(let T=0;T<d;T+=1)u(p,i.columnFilter.renderedToSource(T))}}class co{constructor(i,a){a&&(this.eventManager=i.eventManager,this.instance=i,this.wot=i,this.settings=a,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ea(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(a),this.registerListeners())}registerListeners(){const i=this.wot.rootDocument.body;this.eventManager.addEventListener(i,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(i,"mouseup",()=>this.onMouseUp());for(let a=0,d=this.main.childNodes.length;a<d;a++){const w=this.main.childNodes[a];this.eventManager.addEventListener(w,"mouseenter",p=>this.onMouseEnter(p,this.main.childNodes[a]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(i,a){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;i.preventDefault(),(0,ve.stopImmediatePropagation)(i);const d=this,w=this.wot.rootDocument.body,p=a.getBoundingClientRect();a.style.display="none";function T(z){if(z.clientY<Math.floor(p.top)||z.clientY>Math.ceil(p.top+p.height)||z.clientX<Math.floor(p.left)||z.clientX>Math.ceil(p.left+p.width))return!0}function H(z){T(z)&&(d.eventManager.removeEventListener(w,"mousemove",H),a.style.display="block")}this.eventManager.addEventListener(w,"mousemove",H)}createBorders(i){const{rootDocument:a}=this.wot;this.main=a.createElement("div");const d=["top","start","bottom","end","corner"];let w=this.main.style;w.position="absolute",w.top=0,w.left=0;for(let H=0;H<5;H++){const z=d[H],te=a.createElement("div");te.className=`wtBorder ${this.settings.className||""}`,this.settings[z]&&this.settings[z].hide&&(te.className+=" hidden"),w=te.style,w.backgroundColor=this.settings[z]&&this.settings[z].color?this.settings[z].color:i.border.color,w.height=this.settings[z]&&this.settings[z].width?`${this.settings[z].width}px`:`${i.border.width}px`,w.width=this.settings[z]&&this.settings[z].width?`${this.settings[z].width}px`:`${i.border.width}px`,this.main.appendChild(te)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,de.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:p}=this.wot;let T=p.bordersHolder;T||(T=a.createElement("div"),T.className="htBorders",p.bordersHolder=T,p.spreader.appendChild(T)),T.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:i,stylesHandler:a}=this.wot,d=a.getCSSVariableValue("cell-mobile-handle-size"),w=a.getCSSVariableValue("cell-mobile-handle-border-radius"),p=a.getCSSVariableValue("cell-mobile-handle-background-color"),T=a.getCSSVariableValue("cell-mobile-handle-border-width"),H=a.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:i.createElement("DIV"),topHitArea:i.createElement("DIV"),bottom:i.createElement("DIV"),bottomHitArea:i.createElement("DIV")};const z=10,te=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const we={position:"absolute",height:`${te}px`,width:`${te}px`,"border-radius":`${parseInt(te/1.5,10)}px`};(0,Be.objectEach)(we,(De,Le)=>{this.selectionHandles.styles.bottomHitArea[Le]=De,this.selectionHandles.styles.topHitArea[Le]=De});const Ie=a.isClassicTheme()?{position:"absolute",height:`${z}px`,width:`${z}px`,"border-radius":`${parseInt(z/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${d}px`,width:`${d}px`,"border-radius":`${w}px`,background:`${p}`,border:`${T}px solid ${H}`};(0,Be.objectEach)(Ie,(De,Le)=>{this.selectionHandles.styles.bottom[Le]=De,this.selectionHandles.styles.top[Le]=De}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(i,a){const d=this.wot.selectionManager.getAreaSelection();return!!(d.cellRange&&(i!==d.cellRange.to.row||a!==d.cellRange.to.col))}updateMultipleSelectionHandlesPosition(i,a,d,w,p,T){const z=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:te,topHitArea:we,bottom:Ie,bottomHitArea:De}=this.selectionHandles.styles,Le=parseInt(te.borderWidth,10),ut=parseInt(te.width,10),Bt=parseInt(we.width,10),zn=this.wot.wtTable.getWidth(),Mn=this.wot.wtTable.getHeight();te.top=`${parseInt(d-ut-1,10)}px`,te[z]=`${parseInt(w-ut-1,10)}px`,we.top=`${parseInt(d-Bt/4*3,10)}px`,we[z]=`${parseInt(w-Bt/4*3,10)}px`;const _t=Math.min(parseInt(w+p,10),zn-ut-Le*2),Ci=Math.min(parseInt(w+p-Bt/4,10),zn-Bt-Le*2);Ie[z]=`${_t}px`,De[z]=`${Ci}px`;const mi=Math.min(parseInt(d+T,10),Mn-ut-Le*2),ss=Math.min(parseInt(d+T-Bt/4,10),Mn-Bt-Le*2);Ie.top=`${mi}px`,De.top=`${ss}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(te.display="block",we.display="block",this.isPartRange(i,a)?(Ie.display="none",De.display="none"):(Ie.display="block",De.display="block")):(te.display="none",Ie.display="none",we.display="none",De.display="none"),i===this.wot.wtSettings.getSetting("fixedRowsTop")||a===this.wot.wtSettings.getSetting("fixedColumnsStart")?(te.zIndex="9999",we.zIndex="9999"):(te.zIndex="",we.zIndex="")}appear(i){if(this.disabled)return;let[a,d,w,p]=i;if(a<0&&w<0||d<0&&p<0){this.disappear();return}const{wtTable:T,rootDocument:H,rootWindow:z}=this.wot,te=a!==w||d!==p,we=T.getFirstRenderedRow(),Ie=T.getLastRenderedRow(),De=T.getFirstRenderedColumn(),Le=T.getLastRenderedColumn();if(De<0&&Le<0||we<0&&Ie<0){this.disappear();return}let ut;if(te){if(d=Math.max(d,De),p=Math.min(p,Le),a=Math.max(a,we),w=Math.min(w,Ie),p<d||w<a){this.disappear();return}ut=T.getCell(this.wot.createCellCoords(a,d))}else if(ut=T.getCell(this.wot.createCellCoords(a,d)),!(0,I.isHTMLElement)(ut)){this.disappear();return}const Bt=te?T.getCell(this.wot.createCellCoords(w,p)):ut,zn=(0,I.offset)(ut),Mn=te?(0,I.offset)(Bt):zn,_t=(0,I.offset)(T.TABLE),Ci=zn.top,mi=zn.left,ss=this.wot.wtSettings.getSetting("rtlMode");let si=0,Ti=0;if(ss){const fl=(0,I.outerWidth)(T.TABLE),qa=(0,I.outerWidth)(ut),xo=z.innerWidth-_t.left-fl;Ti=mi+qa-Mn.left,si=z.innerWidth-mi-qa-xo-1}else Ti=Mn.left+(0,I.outerWidth)(Bt)-mi,si=mi-_t.left-1;if(this.isEntireColumnSelected(a,w)){const fl=a,qa=this.getDimensionsFromHeader("columns",d,p,fl,_t);let xo=null;qa&&([xo,si,Ti]=qa),xo&&(ut=xo)}let Qa=Ci-_t.top-1,Kr=Mn.top+(0,I.outerHeight)(Bt)-Ci;if(this.isEntireRowSelected(d,p)){const fl=d,qa=this.getDimensionsFromHeader("rows",a,w,fl,_t);let xo=null;qa&&([xo,Qa,Kr]=qa),xo&&(ut=xo)}const Du=z.getComputedStyle(ut);parseInt(Du.borderTopWidth,10)>0&&(Qa+=1,Kr=Kr>0?Kr-1:0),parseInt(Du[ss?"borderRightWidth":"borderLeftWidth"],10)>0&&(si+=1,Ti=Ti>0?Ti-1:0);const Hh=ss?"right":"left";this.topStyle.top=`${Qa}px`,this.topStyle[Hh]=`${si}px`,this.topStyle.width=`${Ti}px`,this.topStyle.display="block",this.startStyle.top=`${Qa}px`,this.startStyle[Hh]=`${si}px`,this.startStyle.height=`${Kr}px`,this.startStyle.display="block";const Rg=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Qa+Kr-Rg}px`,this.bottomStyle[Hh]=`${si}px`,this.bottomStyle.width=`${Ti}px`,this.bottomStyle.display="block",this.endStyle.top=`${Qa}px`,this.endStyle[Hh]=`${si+Ti-Rg}px`,this.endStyle.height=`${Kr+1}px`,this.endStyle.display="block";let Lh=this.settings.border.cornerVisible;Lh=typeof Lh=="function"?Lh(this.settings.layerLevel):Lh;const Tg=this.wot.getSetting("onModifyGetCellCoords",w,p,!1,"render");let[Mg,Og]=[w,p];if(Tg&&Array.isArray(Tg)&&([,,Mg,Og]=Tg),(0,de.isMobileBrowser)()||!Lh||this.isPartRange(Mg,Og))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Qa+Kr+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Hh]=`${si+Ti+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let fl=(0,I.getTrimmingContainer)(T.TABLE);const qa=fl===z;qa&&(fl=H.documentElement);const xo=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Bm=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Vo=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(p===this.wot.getSetting("totalColumns")-1){const U=qa?Bt.getBoundingClientRect().left:Bt.offsetLeft;let ne=!1,me=0;ss?(me=U-parseInt(this.cornerDefaultStyle.width,10)/2,ne=me<0):(me=U+(0,I.outerWidth)(Bt)+parseInt(this.cornerDefaultStyle.width,10)/2,ne=me>=(0,I.innerWidth)(fl)),ne&&(this.cornerStyle[Hh]=`${Math.floor(si+Ti+this.cornerCenterPointOffset-Bm-xo)}px`,this.cornerStyle[ss?"borderLeftWidth":"borderRightWidth"]=0)}if(w===this.wot.getSetting("totalRows")-1){const me=(qa?Bt.getBoundingClientRect().top:Bt.offsetTop)+(0,I.outerHeight)(Bt)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,I.innerHeight)(fl),$e=this.wot.stylesHandler.isClassicTheme();if(me){const it=Math.floor(Qa+Kr+this.cornerCenterPointOffset-Vo-xo);$e?(this.cornerStyle.top=`${it}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${it-1}px`}}this.cornerStyle.display="block"}(0,de.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(w,p,Qa,si,Ti,Kr)}isEntireColumnSelected(i,a){return i===this.wot.wtTable.getFirstRenderedRow()&&a===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(i,a){return i===this.wot.wtTable.getFirstRenderedColumn()&&a===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(i,a,d,w,p){const{wtTable:T}=this.wot,H=T.wtRootElement.parentNode;let z=null,te=null,we=null,Ie=null,De=null,Le=null,ut=null,Bt=null;switch(i){case"rows":z=function(){return T.getRowHeader(...arguments)},te=function(){return(0,I.outerHeight)(...arguments)},we="ht__selection--rows",Le="top";break;case"columns":z=function(){return T.getColumnHeader(...arguments)},te=function(){return(0,I.outerWidth)(...arguments)},we="ht__selection--columns",Le="left";break;default:}if(H.classList.contains(we)){const zn=this.wot.getSetting("columnHeaders").length;if(ut=z(a,zn-w),Bt=z(d,zn-w),!ut||!Bt)return!1;const Mn=(0,I.offset)(ut),_t=(0,I.offset)(Bt);return ut&&Bt&&(Ie=Mn[Le]-p[Le]-1,De=_t[Le]+te(Bt)-Mn[Le]),[ut,Ie,De]}return!1}changeBorderStyle(i,a){const d=this[i].style,w=a[i];!w||w.hide?(0,I.addClass)(this[i],"hidden"):((0,I.hasClass)(this[i],"hidden")&&(0,I.removeClass)(this[i],"hidden"),d.backgroundColor=w.color,(i==="top"||i==="bottom")&&(d.height=`${w.width}px`),(i==="start"||i==="end")&&(d.width=`${w.width}px`))}changeBorderToDefaultStyle(i){const a={width:1,color:"#000"},d=this[i].style;d.backgroundColor=a.color,d.width=`${a.width}px`,d.height=`${a.width}px`}toggleHiddenClass(i,a){this.changeBorderToDefaultStyle(i),a?(0,I.addClass)(this[i],"hidden"):(0,I.removeClass)(this[i],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,de.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var ac=co;function Wi(u,i){vh(u,i),i.add(u)}function Ds(u,i,a){vh(u,i),i.set(u,a)}function vh(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(u,i){return u.get(ho(u,i))}function ta(u,i,a){return u.set(ho(u,i),a),a}function ho(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var bi=new WeakMap,us=new WeakMap,Ma=new WeakMap,Fl=new WeakMap,hd=new WeakMap,Wl=new WeakMap,lc=new WeakSet;class dd{constructor(i){Wi(this,lc),Ds(this,bi,void 0),Ds(this,us,void 0),Ds(this,Ma,new ys),Ds(this,Fl,new WeakMap),Ds(this,hd,new WeakSet),Ds(this,Wl,new Map),ta(us,this,i)}setActiveOverlay(i){return ta(bi,this,i),Br(Ma,this).setActiveOverlay(Br(bi,this)),Br(Fl,this).has(Br(bi,this))||Br(Fl,this).set(Br(bi,this),new Set),this}getFocusSelection(){return Br(us,this)!==null?Br(us,this).getFocus():null}getAreaSelection(){return Br(us,this)!==null?Br(us,this).createLayeredArea():null}getBorderInstance(i){if(!i.settings.border)return null;if(Br(Wl,this).has(i)){const d=Br(Wl,this).get(i);if(d.has(Br(bi,this)))return d.get(Br(bi,this));const w=new ac(Br(bi,this),i.settings);return d.set(Br(bi,this),w),w}const a=new ac(Br(bi,this),i.settings);return Br(Wl,this).set(i,new Map([[Br(bi,this),a]])),a}getBorderInstances(i){var a,d;return Array.from((a=(d=Br(Wl,this).get(i))===null||d===void 0?void 0:d.values())!==null&&a!==void 0?a:[])}destroyBorders(i){Br(Wl,this).get(i).forEach(a=>a.destroy()),Br(Wl,this).delete(i)}render(i){if(Br(us,this)===null)return;i&&ho(lc,this,cs).call(this);const a=Array.from(Br(us,this)),d=new Map,w=new Map;for(let p=0;p<a.length;p++){const T=a[p],{className:H,headerAttributes:z,createLayers:te,selectionType:we}=T.settings;Br(hd,this).has(T)||(Br(hd,this).add(T),T.addLocalHook("destroy",()=>this.destroyBorders(T)));const Ie=this.getBorderInstance(T);if(T.isEmpty()){Ie==null||Ie.disappear();continue}H&&Br(Ma,this).setActiveSelection(T).scan().forEach(ut=>{if(d.has(ut)){const Bt=d.get(ut);Bt.has(H)&&te===!0?Bt.set(H,Bt.get(H)+1):Bt.set(H,1)}else d.set(ut,new Map([[H,1]]));z&&(w.has(ut)||w.set(ut,[]),ut.nodeName==="TH"&&w.get(ut).push(...z))});const De=T.getCorners();Br(bi,this).getSetting("onBeforeDrawBorders",De,we),Ie==null||Ie.appear(De)}d.forEach((p,T)=>{var H;const z=Array.from(p).map(te=>{let[we,Ie]=te;return Ie===1?we:[we,...Array.from({length:Ie-1},(De,Le)=>`${we}-${Le+1}`)]}).flat();z.forEach(te=>Br(Fl,this).get(Br(bi,this)).add(te)),(0,I.addClass)(T,z),T.nodeName==="TD"&&Array.isArray((H=Br(us,this).options)===null||H===void 0?void 0:H.cellAttributes)&&(0,I.setAttribute)(T,Br(us,this).options.cellAttributes)}),Array.from(w.keys()).forEach(p=>{(0,I.setAttribute)(p,[...w.get(p)])})}}function cs(){const u=Br(Fl,this).get(Br(bi,this)),i=Br(bi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(i))for(let a=0;a<i.length;a++)u.add(i[a]);u.forEach(a=>{var d,w;const p=Br(bi,this).wtTable.TABLE.querySelectorAll(`.${a}`);let T=[];Array.isArray((d=Br(us,this).options)===null||d===void 0?void 0:d.cellAttributes)&&(T=Br(us,this).options.cellAttributes.map(H=>H[0])),Array.isArray((w=Br(us,this).options)===null||w===void 0?void 0:w.headerAttributes)&&(T=[...T,...Br(us,this).options.headerAttributes.map(H=>H[0])]);for(let H=0,z=p.length;H<z;H++)(0,I.removeClass)(p[H],a),(0,I.removeAttribute)(p[H],T)}),u.clear()}function na(u,i){Oa(u,i),i.add(u)}function Bl(u,i,a){Oa(u,i),i.set(u,a)}function Oa(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ts(u,i){return u.get(Ut(u,i))}function fa(u,i,a){return u.set(Ut(u,i),a),a}function Ut(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}const lf=23;var Ar=new WeakMap,to=new WeakMap,ei=new WeakMap,Ia=new WeakMap,Ss=new WeakMap,bu=new WeakMap,uc=new WeakMap,ra=new WeakSet;class Bi{constructor(i){na(this,ra),Bl(this,Ar,void 0),Bl(this,to,void 0),Bl(this,ei,void 0),Bl(this,Ia,void 0),Bl(this,Ss,!0),Bl(this,bu,{}),Bl(this,uc,{}),fa(to,this,i.rootTable.parentElement.parentElement),fa(Ia,this,i.rootDocument)}isClassicTheme(){return ts(Ss,this)}getCSSVariableValue(i){var a;if(ts(Ss,this))return null;if(ts(bu,this)[`--ht-${i}`])return ts(bu,this)[`--ht-${i}`];const d=(a=Ut(ra,this,cc).call(this,`--ht-${i}`))!==null&&a!==void 0?a:Ut(ra,this,ga).call(this,`--ht-${i}`);if(d!==null)return ts(bu,this)[`--ht-${i}`]=d,d}getStyleForTD(i){var a;return(a=ts(uc,this))===null||a===void 0?void 0:a.td[i]}getDefaultRowHeight(){if(ts(Ss,this))return lf;const i=Ut(ra,this,al).call(this);return!i&&(0,I.hasClass)(ts(to,this),"ht-wrapper")?((0,hn.ZK)(`The "${ts(Ar,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),fa(Ss,this,!0),this.useTheme(),lf):i}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(i){if(!i){Ut(ra,this,Pa).call(this),fa(Ss,this,!0),fa(Ar,this,i||void 0);return}i&&i!==ts(Ar,this)&&(ts(Ar,this)&&Ut(ra,this,wh).call(this),fa(Ar,this,i),fa(Ss,this,!1),Ut(ra,this,Ch).call(this),Ut(ra,this,Pa).call(this))}getThemeName(){return ts(Ar,this)}removeClassNames(){(0,I.hasClass)(ts(to,this),ts(Ar,this))&&(0,I.removeClass)(ts(to,this),ts(Ar,this))}}function al(){const u=this.getCSSVariableValue("line-height"),i=this.getCSSVariableValue("cell-vertical-padding"),a=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return u===null||i===null||isNaN(a)?null:u+2*i+a}function Ch(){(0,I.removeClass)(ts(to,this),/ht-theme-.*/g),(0,I.addClass)(ts(to,this),ts(Ar,this))}function Pa(){this.isClassicTheme()||fa(ei,this,getComputedStyle(ts(to,this)));const u=Ut(ra,this,ns).call(this,["box-sizing","border-bottom-width"]);ts(uc,this).td=Gl(hi({},ts(uc,this).td),{"box-sizing":u["box-sizing"],"border-bottom-width":u["border-bottom-width"]})}function ns(u){const i=ts(Ia,this),a=ts(to,this),d=i.createElement("table"),w=i.createElement("tbody"),p=i.createElement("tr"),T=i.createElement("tr"),H=i.createElement("td");T.appendChild(H),w.appendChild(p),w.appendChild(T),d.appendChild(w),a.appendChild(d);const z=getComputedStyle(H),te={};return u.forEach(we=>{te[we]=z.getPropertyValue(we)}),a.removeChild(d),te}function cc(u){const i=Math.ceil(parseFloat(Ut(ra,this,ga).call(this,u)));return Number.isNaN(i)?null:i}function ga(u){const i=ts(ei,this).getPropertyValue(u);return i===""?null:i}function wh(){fa(uc,this,{}),fa(bu,this,{}),fa(Ss,this,!0)}class eu extends rd{constructor(i,a){super(i,new dh(a)),this.stylesHandler=new Bi(this.domBindings);const d=this.wtSettings.getSetting("facade",this);this.wtTable=new Ks(this.getTableDao(),d,this.domBindings,this.wtSettings),this.wtViewport=new cd(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new dd(this.wtSettings.getSetting("selections")),this.wtEvent=new Ke(d,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new rc(this,d,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],d=[];(0,Be.objectEach)(i,(w,p)=>{this.wtSettings.getSetting(p).length&&d.push(w),a.push(w)}),(0,I.removeClass)(this.wtTable.wtRootElement.parentNode,a),(0,I.addClass)(this.wtTable.wtRootElement.parentNode,d)}getOverlayByName(i){var a;if(!Rl.includes(i))return null;const d=i.replace(/_([a-z])/g,w=>w[1].toUpperCase());return(a=this.wtOverlays[`${d}Overlay`])!==null&&a!==void 0?a:null}getViewportDao(){const i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}class tu{constructor(i){i instanceof rd?this._wot=i:this._initFromSettings(i)}_initFromSettings(i){i.facade=a=>{const d=new tu(a);return()=>d},this._wot=new eu(i.table,i)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(i){this._wot.drawn=i}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(i){this._wot.drawInterrupted=i}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(i){this._wot.lastMouseOver=i}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(i){this._wot.momentumScrolling=i}get touchApplied(){return this._wot.touchApplied}set touchApplied(i){this._wot.touchApplied=i}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(i){this._wot.eventListeners=i}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(i,a){return this._wot.createCellCoords(i,a)}createCellRange(i,a,d){return this._wot.createCellRange(i,a,d)}draw(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(i),this}getCell(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(i,a)}scrollViewport(i,a,d){return this._wot.scrollViewport(i,a,d)}scrollViewportHorizontally(i,a){return this._wot.scrollViewportHorizontally(i,a)}scrollViewportVertically(i,a){return this._wot.scrollViewportVertically(i,a)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(i){return this._wot.getOverlayByName(i)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(i,a){return this._wot.wtSettings.update(i,a),this}getSetting(i,a,d,w,p){return this._wot.wtSettings.getSetting(i,a,d,w,p)}hasSetting(i){return this._wot.wtSettings.hasSetting(i)}destroy(){this._wot.destroy()}}function hc(u){let{isShiftKey:i,isLeftClick:a,isRightClick:d,coords:w,selection:p,controller:T,cellCoordsFactory:H}=u;const z=p.isSelected()?p.getSelectedRange().current():null,te=p.isSelectedByCorner(),we=p.isSelectedByRowHeader();if(p.markSource("mouse"),i&&z)w.row>=0&&w.col>=0&&!T.cell?p.setRangeEnd(w):(te||we)&&w.row>=0&&w.col>=0&&!T.cell?p.setRangeEnd(H(w.row,w.col)):te&&w.row<0&&!T.column?p.setRangeEnd(H(z.to.row,w.col)):we&&w.col<0&&!T.row?p.setRangeEnd(H(w.row,z.to.col)):(!te&&!we&&w.col<0||te&&w.col<0)&&!T.row?p.selectRows(Math.max(z.from.row,0),w.row,w.col):(!te&&!we&&w.row<0||we&&w.row<0)&&!T.column&&p.selectColumns(Math.max(z.from.col,0),w.col,w.row);else{const Ie=!p.inInSelection(w),De=a||d&&Ie;w.row<0&&w.col>=0&&!T.column?De&&p.selectColumns(w.col,w.col,w.row):w.col<0&&w.row>=0&&!T.row?De&&p.selectRows(w.row,w.row,w.col):w.col>=0&&w.row>=0&&!T.cell?De&&p.setRangeStart(w):w.col<0&&w.row<0&&p.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}p.markEndSource()}function fd(u){let{isLeftClick:i,coords:a,selection:d,controller:w,cellCoordsFactory:p}=u;if(!i)return;const T=d.isSelectedByRowHeader(),H=d.isSelectedByColumnHeader(),z=d.tableProps.countCols(),te=d.tableProps.countRows();d.markSource("mouse"),H&&!w.column?d.setRangeEnd(p(te-1,a.col)):T&&!w.row?d.setRangeEnd(p(a.row,z-1)):w.cell||d.setRangeEnd(a),d.markEndSource()}const gd=new Map([["mousedown",hc],["mouseover",fd],["touchstart",hc]]);function ma(u,i){let{coords:a,selection:d,controller:w,cellCoordsFactory:p}=i;gd.get(u.type)({coords:a,selection:d,controller:w,cellCoordsFactory:p,isShiftKey:u.shiftKey,isLeftClick:(0,ve.isLeftClick)(u)||u.type==="touchstart",isRightClick:(0,ve.isRightClick)(u)})}const Eu=new WeakMap,yh=Symbol("rootInstance");function dc(u){Eu.set(u,!0)}function md(u){return u===yh}function Wc(u){return Eu.has(u)}function ag(u,i){fc(u,i),i.add(u)}function ll(u,i,a){fc(u,i),i.set(u,a)}function fc(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(u,i,a){return(i=lg(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function lg(u){var i=Bc(u,"string");return typeof i=="symbol"?i:i+""}function Bc(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function _s(u,i){return u.get(Ru(u,i))}function Hs(u,i,a){return u.set(Ru(u,i),a),a}function Ru(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var pd=new WeakMap,Sh=new WeakMap,_h=new WeakMap,ul=new WeakMap,xa=new WeakMap,ru=new WeakMap,bh=new WeakMap,Bo=new WeakMap,cl=new WeakSet;class dm{constructor(i){ag(this,cl),nu(this,"hot",void 0),nu(this,"eventManager",void 0),nu(this,"settings",void 0),nu(this,"THEAD",void 0),nu(this,"TBODY",void 0),nu(this,"_wt",void 0),nu(this,"activeWt",void 0),ll(this,pd,0),ll(this,Sh,0),nu(this,"postponedAdjustElementsSize",!1),ll(this,_h,!1),ll(this,ul,void 0),ll(this,xa,void 0),ll(this,ru,0),ll(this,bh,0),ll(this,Bo,null),this.hot=i,this.eventManager=new Se.Z(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const i=this.hot.forceFullRender;this.hot.runHooks("beforeRender",i),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!i),Ru(cl,this,ug).call(this),this.hot.runHooks("afterRender",i),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(i,a){const d=this._wt.getCell(i,a);return d<0?null:d}scrollViewport(i,a,d){return this._wt.scrollViewport(i,a,d)}scrollViewportHorizontally(i,a){return this._wt.scrollViewportHorizontally(i,a)}scrollViewportVertically(i,a){return this._wt.scrollViewportVertically(i,a)}createElements(){const{rootElement:i,rootDocument:a}=this.hot,d=i.getAttribute("style");d&&i.setAttribute("data-originalstyle",d),(0,I.addClass)(i,"handsontable"),Hs(xa,this,a.createElement("TABLE")),(0,I.addClass)(_s(xa,this),"htCore"),this.hot.getSettings().tableClassName&&(0,I.addClass)(_s(xa,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,I.setAttribute)(_s(xa,this),[(0,x.Rn)()]),(0,I.setAttribute)(i,[(0,x.nO)(),(0,x.a2)(-1),(0,x.Wv)(this.hot.countCols()),(0,x.qt)()])),this.THEAD=a.createElement("THEAD"),_s(xa,this).appendChild(this.THEAD),this.TBODY=a.createElement("TBODY"),_s(xa,this).appendChild(this.TBODY),this.hot.table=_s(xa,this),this.hot.container.insertBefore(_s(xa,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:i,rootDocument:a,selection:d,rootWindow:w}=this.hot,p=a.documentElement;this.eventManager.addEventListener(i,"mousedown",H=>{Hs(_h,this,!0),this.isTextSelectionAllowed(H.target)||((0,I.clearTextSelection)(w),H.preventDefault(),w.focus())}),this.eventManager.addEventListener(i,"mouseup",()=>{Hs(_h,this,!1)}),this.eventManager.addEventListener(i,"mousemove",H=>{_s(_h,this)&&!this.isTextSelectionAllowed(H.target)&&(this.settings.fragmentSelection&&(0,I.clearTextSelection)(w),H.preventDefault())}),this.eventManager.addEventListener(p,"keyup",H=>{d.isInProgress()&&!H.shiftKey&&d.finish()}),this.eventManager.addEventListener(p,"mouseup",H=>{d.isInProgress()&&(0,ve.isLeftClick)(H)&&d.finish(),Hs(ul,this,!1);const z=(0,I.isOutsideInput)(a.activeElement);(0,I.isInput)(a.activeElement)&&!z||(z||!d.isSelected()&&!d.isSelectedByAnyHeader()&&!i.contains(H.target)&&!(0,ve.isRightClick)(H))&&this.hot.unlisten()}),this.eventManager.addEventListener(p,"contextmenu",H=>{d.isInProgress()&&(0,ve.isRightClick)(H)&&(d.finish(),Hs(ul,this,!1))}),this.eventManager.addEventListener(p,"touchend",()=>{d.isInProgress()&&d.finish(),Hs(ul,this,!1)}),this.eventManager.addEventListener(p,"mousedown",H=>{const z=H.target,te=H.x||H.clientX,we=H.y||H.clientY;let Ie=H.target;if(_s(ul,this)||!i||!this.hot.view)return;const{holder:De}=this._wt.wtTable;if(Ie===De){const ut=(0,I.getScrollbarWidth)(a);if(a.elementFromPoint(te+ut,we)!==De||a.elementFromPoint(te,we+ut)!==De)return}else for(;Ie!==p;){if(Ie===null){if(H.isTargetWebComponent)break;return}if(Ie===i)return;Ie=Ie.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(z):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let T=(0,I.getParentWindow)(w);for(;T!==null;)this.eventManager.addEventListener(T.document.documentElement,"click",()=>{this.hot.unlisten()}),T=(0,I.getParentWindow)(T);this.eventManager.addEventListener(_s(xa,this),"selectstart",H=>{this.settings.fragmentSelection||(0,I.isInput)(H.target)||H.preventDefault()})}translateFromRenderableToVisualCoords(i){let{row:a,col:d}=i;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(a,d))}translateFromRenderableToVisualIndex(i,a){let d=i>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(i):i,w=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;return d===null&&(d=i),w===null&&(w=a),[d,w]}countRenderableIndexes(i,a){const d=Math.min(i.getNotTrimmedIndexesLength(),a),w=i.getNearestNotHiddenIndex(d-1,-1);return w===null?0:i.getRenderableFromVisualIndex(w)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(i,a){return this.countNotHiddenIndexes(i,a,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(i,a){return this.countNotHiddenIndexes(i,a,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(i,a,d,w){if(isNaN(i)||i<0)return 0;const p=d.getNearestNotHiddenIndex(i,a),T=d.getRenderableFromVisualIndex(p);if(!Number.isInteger(T))return 0;let H=0;return a<0?H=T+1:a>0&&(H=w-T),H}countNotHiddenFixedColumnsStart(){const i=this.hot.countCols(),a=Math.min(parseInt(this.settings.fixedColumnsStart,10),i)-1;return this.countNotHiddenColumnIndexes(a,-1)}countNotHiddenFixedRowsTop(){const i=this.hot.countRows(),a=Math.min(parseInt(this.settings.fixedRowsTop,10),i)-1;return this.countNotHiddenRowIndexes(a,-1)}countNotHiddenFixedRowsBottom(){const i=this.hot.countRows(),a=Math.max(i-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(a,1)}countRenderableColumnsInRange(i,a){let d=0;for(let w=i;w<=a;w++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(w)!==null&&(d+=1);return d}countRenderableRowsInRange(i,a){let d=0;for(let w=i;w<=a;w++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(w)!==null&&(d+=1);return d}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(i){var a;const d=(a=this.hot.rootElement.parentNode)===null||a===void 0?void 0:a.querySelector(".hot-display-license-info");d&&(0,I.addClass)(d,i)}removeClassNameFromLicenseElement(i){var a;const d=(a=this.hot.rootElement.parentNode)===null||a===void 0?void 0:a.querySelector(".hot-display-license-info");d&&(0,I.removeClass)(d,i)}isMainTableNotFullyCoveredByOverlays(){const i=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),a=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>i&&this.hot.countRenderedCols()>a}initializeWalkontable(){const i={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_s(xa,this),isDataViewInstance:()=>Wc(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(p,T)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(p,T)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||i.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||i.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const p=[];return this.hot.hasRowHeaders()&&p.push((T,H)=>{const z=T>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(T):T;this.appendRowHeader(z,H)}),this.hot.runHooks("afterGetRowHeaderRenderers",p),Hs(Sh,this,p.length),this.hot.getSettings().ariaTags&&Ru(cl,this,gc).call(this)===this.hot.countCols()&&Ru(cl,this,uf).call(this,_s(Sh,this)),p},columnHeaders:()=>{const p=[];return this.hot.hasColHeaders()&&p.push((T,H)=>{const z=T>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(T):T;this.appendColHeader(z,H)}),this.hot.runHooks("afterGetColumnHeaderRenderers",p),Hs(pd,this,p.length),p},columnWidth:p=>{const T=this.hot.columnIndexMapper.getVisualFromRenderableIndex(p);return this.hot.getColWidth(T===null?p:T)},rowHeight:p=>{const T=this.hot.rowIndexMapper.getVisualFromRenderableIndex(p);return this.hot.getRowHeight(T===null?p:T)},rowHeightByOverlayName:(p,T)=>{const H=this.hot.rowIndexMapper.getVisualFromRenderableIndex(p),z=H===null?p:H;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(z),z,T)},cellRenderer:(p,T,H)=>{const[z,te]=this.translateFromRenderableToVisualIndex(p,T),we=this.hot.runHooks("modifyGetCellCoords",z,te,!1,"meta");let Ie=z,De=te;Array.isArray(we)&&([Ie,De]=we);const Le=this.hot.getCellMeta(Ie,De),ut=this.hot.colToProp(De);let Bt=this.hot.getDataAtRowProp(Ie,ut);this.hot.hasHook("beforeValueRender")&&(Bt=this.hot.runHooks("beforeValueRender",Bt,Le)),this.hot.runHooks("beforeRenderer",H,z,te,ut,Bt,Le),this.hot.getCellRenderer(Le)(this.hot,H,z,te,ut,Bt,Le),this.hot.runHooks("afterRenderer",H,z,te,ut,Bt,Le)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,I.isVisible)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(p,T,H,z)=>{const te=this.translateFromRenderableToVisualCoords(T),we={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=z,Hs(ul,this,!0),Hs(Bo,this,{x:p.clientX,y:p.clientY}),this.hot.runHooks("beforeOnCellMouseDown",p,te,H,we),!(0,ve.isImmediatePropagationStopped)(p)&&(ma(p,{coords:te,selection:this.hot.selection,controller:we,cellCoordsFactory:(Ie,De)=>this.hot._createCellCoords(Ie,De)}),this.hot.runHooks("afterOnCellMouseDown",p,te,H),this.activeWt=this._wt)},onCellContextMenu:(p,T,H,z)=>{const te=this.translateFromRenderableToVisualCoords(T);this.activeWt=z,Hs(ul,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",p,te,H),!(0,ve.isImmediatePropagationStopped)(p)&&(this.hot.runHooks("afterOnCellContextMenu",p,te,H),this.activeWt=this._wt)},onCellMouseOut:(p,T,H,z)=>{const te=this.translateFromRenderableToVisualCoords(T);this.activeWt=z,this.hot.runHooks("beforeOnCellMouseOut",p,te,H),!(0,ve.isImmediatePropagationStopped)(p)&&(this.hot.runHooks("afterOnCellMouseOut",p,te,H),this.activeWt=this._wt)},onCellMouseOver:(p,T,H,z)=>{const te=this.translateFromRenderableToVisualCoords(T),we={row:!1,column:!1,cell:!1};this.activeWt=z,this.hot.runHooks("beforeOnCellMouseOver",p,te,H,we),!(0,ve.isImmediatePropagationStopped)(p)&&(_s(ul,this)&&(!_s(Bo,this)||_s(Bo,this).x!==p.clientX||_s(Bo,this).y!==p.clientY)&&ma(p,{coords:te,selection:this.hot.selection,controller:we,cellCoordsFactory:(Ie,De)=>this.hot._createCellCoords(Ie,De)}),this.hot.runHooks("afterOnCellMouseOver",p,te,H),this.activeWt=this._wt,Hs(Bo,this,null))},onCellMouseUp:(p,T,H,z)=>{const te=this.translateFromRenderableToVisualCoords(T);this.activeWt=z,this.hot.runHooks("beforeOnCellMouseUp",p,te,H),!((0,ve.isImmediatePropagationStopped)(p)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",p,te,H),this.activeWt=this._wt)},onCellCornerMouseDown:p=>{p.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",p)},onCellCornerDblClick:p=>{p.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",p)},beforeDraw:(p,T)=>this.beforeRender(p,T),onDraw:p=>this.afterRender(p),onBeforeViewportScrollVertically:(p,T)=>{const H=this.hot.rowIndexMapper,z=p<0;let te=p;return!z&&(te=H.getVisualFromRenderableIndex(p),te===null)?p:(te=this.hot.runHooks("beforeViewportScrollVertically",te,T),this.hot.runHooks("beforeViewportScroll"),z?te:H.getRenderableFromVisualIndex(te))},onBeforeViewportScrollHorizontally:(p,T)=>{const H=this.hot.columnIndexMapper,z=p<0;let te=p;return!z&&(te=H.getVisualFromRenderableIndex(p),te===null)?p:(te=this.hot.runHooks("beforeViewportScrollHorizontally",te,T),this.hot.runHooks("beforeViewportScroll"),z?te:H.getRenderableFromVisualIndex(te))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(p,T,H)=>{const z=this.hot.rowIndexMapper,te=p<0;let we=p;te||(we=z.getVisualFromRenderableIndex(p));const Ie=this.hot.runHooks("beforeHighlightingRowHeader",we,T,H);return te?Ie:z.getRenderableFromVisualIndex(z.getNearestNotHiddenIndex(Ie,1))},onBeforeHighlightingColumnHeader:(p,T,H)=>{const z=this.hot.columnIndexMapper,te=p<0;let we=p;te||(we=z.getVisualFromRenderableIndex(p));const Ie=this.hot.runHooks("beforeHighlightingColumnHeader",we,T,H);return te?Ie:z.getRenderableFromVisualIndex(z.getNearestNotHiddenIndex(Ie,1))},onAfterDrawSelection:(p,T,H)=>{let z;const[te,we]=this.translateFromRenderableToVisualIndex(p,T),Ie=this.hot.selection.getSelectedRange();if(Ie.size()>0){const Le=Ie.peekByIndex(H!=null?H:0);z=[Le.from.row,Le.from.col,Le.to.row,Le.to.col]}return this.hot.runHooks("afterDrawSelection",te,we,z,H)},onBeforeDrawBorders:(p,T)=>{const[H,z,te,we]=p,Ie=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(H),this.hot.columnIndexMapper.getVisualFromRenderableIndex(z),this.hot.rowIndexMapper.getVisualFromRenderableIndex(te),this.hot.columnIndexMapper.getVisualFromRenderableIndex(we)];return this.hot.runHooks("beforeDrawBorders",Ie,T)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:p=>this.hot.runHooks("modifyRowHeaderWidth",p),onModifyGetCellCoords:(p,T,H,z)=>{const te=this.hot.rowIndexMapper,we=this.hot.columnIndexMapper,Ie=T>=0?we.getVisualFromRenderableIndex(T):T,De=p>=0?te.getVisualFromRenderableIndex(p):p,Le=this.hot.runHooks("modifyGetCellCoords",De,Ie,H,z);if(Array.isArray(Le)){const[ut,Bt,zn,Mn]=Le;return[ut>=0?te.getRenderableFromVisualIndex(te.getNearestNotHiddenIndex(ut,1)):ut,Bt>=0?we.getRenderableFromVisualIndex(we.getNearestNotHiddenIndex(Bt,1)):Bt,zn>=0?te.getRenderableFromVisualIndex(te.getNearestNotHiddenIndex(zn,-1)):zn,Mn>=0?we.getRenderableFromVisualIndex(we.getNearestNotHiddenIndex(Mn,-1)):Mn]}},onModifyGetCoordsElement:(p,T)=>{const H=this.hot.rowIndexMapper,z=this.hot.columnIndexMapper,te=T>=0?z.getVisualFromRenderableIndex(T):T,we=p>=0?H.getVisualFromRenderableIndex(p):p,Ie=this.hot.runHooks("modifyGetCoordsElement",we,te);if(Array.isArray(Ie)){const[De,Le]=Ie;return[De>=0?H.getRenderableFromVisualIndex(H.getNearestNotHiddenIndex(De,1)):De,Le>=0?z.getRenderableFromVisualIndex(z.getNearestNotHiddenIndex(Le,1)):Le]}},viewportRowCalculatorOverride:p=>{let T=this.settings.viewportRowRenderingOffset;if(T==="auto"&&this.settings.fixedRowsTop&&(T=10),T>0||T==="auto"){const H=this.countRenderableRows(),z=p.startRow,te=p.endRow;if(typeof T=="number")p.startRow=Math.max(z-T,0),p.endRow=Math.min(te+T,H-1);else if(T==="auto"){const we=Math.max(1,Math.ceil(te/H*12));p.startRow=Math.max(z-we,0),p.endRow=Math.min(te+we,H-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",p)},viewportColumnCalculatorOverride:p=>{let T=this.settings.viewportColumnRenderingOffset;if(T==="auto"&&this.settings.fixedColumnsStart&&(T=10),T>0||T==="auto"){const H=this.countRenderableColumns(),z=p.startColumn,te=p.endColumn;if(typeof T=="number"&&(p.startColumn=Math.max(z-T,0),p.endColumn=Math.min(te+T,H-1)),T==="auto"){const we=Math.max(1,Math.ceil(te/H*6));p.startColumn=Math.max(z-we,0),p.endColumn=Math.min(te+we,H-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",p)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const p=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||p}};this.hot.runHooks("beforeInitWalkontable",i),this._wt=new tu(i),this.activeWt=this._wt;const a=this._wt.wtTable.spreader,{width:d,height:w}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(d,w),this.eventManager.addEventListener(a,"mousedown",p=>{p.target===a&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(a,"contextmenu",p=>{p.target===a&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(i){if((0,I.isInput)(i))return!0;const a=(0,I.isChildOf)(i,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&a||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&a||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _s(ul,this)}isSelectedOnlyCell(){var i,a;return(i=(a=this.hot.getSelectedRangeLast())===null||a===void 0?void 0:a.isSingleCell())!==null&&i!==void 0?i:!1}isCellEdited(){const i=this.hot.getActiveEditor();return i&&i.isOpened()}beforeRender(i,a){i&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,a)}afterRender(i){i&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(i,a){if(a.firstChild){const d=a.firstChild;if(!(0,I.hasClass)(d,"relative")){(0,I.empty)(a),this.appendRowHeader(i,a);return}this.updateCellHeader(d.querySelector(".rowHeader"),i,this.hot.getRowHeader)}else{const{rootDocument:d,getRowHeader:w}=this.hot,p=d.createElement("div"),T=d.createElement("span");p.className="relative",T.className="rowHeader",this.updateCellHeader(T,i,w),p.appendChild(T),a.appendChild(p)}this.hot.runHooks("afterGetRowHeader",i,a)}appendColHeader(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const p=()=>{const T=i>=0?this.hot.getColumnMeta(i).headerClassName:null;return T?T.split(" "):[]};if(a.firstChild){const T=a.firstChild;(0,I.hasClass)(T,"relative")?(this.updateCellHeader(T.querySelector(".colHeader"),i,d,w),T.className="",(0,I.addClass)(T,["relative",...p()])):((0,I.empty)(a),this.appendColHeader(i,a,d,w))}else{const{rootDocument:T}=this.hot,H=T.createElement("div"),z=T.createElement("span"),te=p();H.classList.add("relative",...te),z.className="colHeader",this.settings.ariaTags&&((0,I.setAttribute)(H,...(0,x.Rn)()),(0,I.setAttribute)(z,...(0,x.Rn)())),this.updateCellHeader(z,i,d,w),H.appendChild(z),a.appendChild(H)}this.hot.runHooks("afterGetColHeader",i,a,w)}updateCellHeader(i,a,d){let w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,p=a;const T=this._wt.wtOverlays.getParentOverlay(i)||this._wt;i.parentNode&&((0,I.hasClass)(i,"colHeader")?p=T.wtTable.columnFilter.sourceToRendered(a):(0,I.hasClass)(i,"rowHeader")&&(p=T.wtTable.rowFilter.sourceToRendered(a))),p>-1?(0,I.fastInnerHTML)(i,d(a,w)):((0,I.fastInnerText)(i,"\xA0"),(0,I.addClass)(i,"cornerHeader"))}maximumVisibleElementWidth(i){const d=this._wt.wtViewport.getWorkspaceWidth()-i;return d>0?d:0}maximumVisibleElementHeight(i){const d=this._wt.wtViewport.getWorkspaceHeight()-i;return d>0?d:0}setLastSize(i,a){Hs(ru,this,i),Hs(bh,this,a)}getLastSize(){return{width:_s(ru,this),height:_s(bh,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return i.getNearestNotHiddenIndex(a!=null?a:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return i.getNearestNotHiddenIndex(a!=null?a:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return i.getNearestNotHiddenIndex(a!=null?a:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return i.getNearestNotHiddenIndex(a!=null?a:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _s(pd,this)}getRowHeadersCount(){return _s(Sh,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(i){var a;return((a=this._wt.wtOverlays.getParentOverlay(i))!==null&&a!==void 0?a:this._wt).wtTable.name}getOverlayByName(i){return this._wt.getOverlayByName(i)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function gc(){return parseInt(this.hot.rootElement.getAttribute((0,x.Wv)()[0]),10)}function uf(u){const i=Ru(cl,this,gc).call(this)+u;(0,I.setAttribute)(this.hot.rootElement,...(0,x.Wv)(i))}function ug(){const u=this.hot.rootElement;this.hasVerticalScroll()?(0,I.addClass)(u,"htHasScrollY"):(0,I.removeClass)(u,"htHasScrollY"),this.hasHorizontalScroll()?(0,I.addClass)(u,"htHasScrollX"):(0,I.removeClass)(u,"htHasScrollX")}var cg=dm,v=f(71050);function b(u,i,a){return(i=D(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function D(u){var i=F(u,"string");return typeof i=="symbol"?i:i+""}function F(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class c{constructor(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];b(this,"hot",void 0),b(this,"data",void 0),b(this,"dataType","array"),b(this,"colToProp",()=>{}),b(this,"propToCol",()=>{}),this.hot=i,this.data=a}modifyRowData(i){let a;return this.hot.hasHook("modifyRowData")&&(a=this.hot.runHooks("modifyRowData",i)),a!==void 0&&!Number.isInteger(a)?a:this.data[i]}getData(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,i)}setData(i){this.data=i}getAtColumn(i){const a=[];return(0,mn.arrayEach)(this.data,(d,w)=>{const p=this.getAtCell(w,i);a.push(p)}),a}getAtRow(i,a,d){let w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const p=a===void 0&&d===void 0,{dataDotNotation:T}=this.hot.getSettings();let H=null,z=null;if(H=this.modifyRowData(i),Array.isArray(H))z=[],p?H.forEach((te,we)=>{z[we]=this.getAtPhysicalCell(i,we,H)}):(0,pr.rangeEach)(a,d,te=>{z[te-a]=this.getAtPhysicalCell(i,te,H)});else if((0,Be.isObject)(H)||(0,V.isFunction)(H))if(w?z=[]:z={},!p||w){const we=this.countFirstRowKeys()-1;(0,pr.rangeEach)(0,we,Ie=>{const De=this.colToProp(Ie);if(Ie>=(a||0)&&Ie<=(d||we)&&!Number.isInteger(De)){const Le=this.getAtPhysicalCell(i,De,H);w?z.push(Le):T?(0,Be.setProperty)(z,De,Le):z[De]=Le}})}else(0,Be.objectEach)(H,(te,we)=>{const Ie=this.getAtPhysicalCell(i,we,H);T?(0,Be.setProperty)(z,we,Ie):z[we]=Ie});return z}setAtCell(i,a,d){if(!(i>=this.countRows()||a>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const w=(0,Be.createObjectPropListener)(d);this.hot.runHooks("modifySourceData",i,a,w,"set"),w.isTouched()&&(d=w.value)}["__proto__","constructor","prototype"].includes(i)||(Number.isInteger(a)?this.data[i][a]=d:(0,Be.setProperty)(this.data[i],a,d))}}getAtPhysicalCell(i,a,d){let w=null;if(d)if(typeof a=="string"){const{dataDotNotation:p}=this.hot.getSettings();w=p?(0,Be.getProperty)(d,a):d[a]}else typeof a=="function"?w=a(d):w=d[a];if(this.hot.hasHook("modifySourceData")){const p=(0,Be.createObjectPropListener)(w);this.hot.runHooks("modifySourceData",i,a,p,"get"),p.isTouched()&&(w=p.value)}return w}getAtCell(i,a){const d=this.modifyRowData(i);return this.getAtPhysicalCell(i,this.colToProp(a),d)}getByRange(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,w=!1,p=null,T=null,H=null,z=null;i===null||a===null?(w=!0,p=0,H=this.countRows()-1):(p=Math.min(i.row,a.row),T=Math.min(i.col,a.col),H=Math.max(i.row,a.row),z=Math.max(i.col,a.col));const te=[];return(0,pr.rangeEach)(p,H,we=>{te.push(w?this.getAtRow(we,void 0,void 0,d):this.getAtRow(we,T,z,d))}),te}countRows(){if(this.hot.hasHook("modifySourceLength")){const i=this.hot.runHooks("modifySourceLength");if(Number.isInteger(i))return i}return this.data.length}countFirstRowKeys(){return(0,v.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}var m=c,E=f(5499),R=f(85231),L=f(67822),ae=f(2135),Ce=f(26665),_e=f(55556),Ge=f(55315);const ht=new Map([["hiding",L.o],["index",ae.n],["linkedPhysicalIndexToValue",Ce.A],["physicalIndexToValue",_e.L],["trimming",Ge.n]]);function Dt(u){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ht.has(u))throw new Error(`The provided map type ("${u}") does not exist.`);return new(ht.get(u))(i)}var Ht=f(85738),tr=f(56218);function cr(u,i,a){return(i=An(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function An(u){var i=lt(u,"string");return typeof i=="symbol"?i:i+""}function lt(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Nt extends tr.f{constructor(i,a){super(),cr(this,"mergedValuesCache",[]),cr(this,"aggregationFunction",void 0),cr(this,"fallbackValue",void 0),this.aggregationFunction=i,this.fallbackValue=a}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const a=(0,mn.arrayMap)(this.get(),p=>p.getValues()),d=[],w=(0,q.isDefined)(a[0])&&a[0].length||0;for(let p=0;p<w;p+=1){const T=[];for(let H=0;H<this.getLength();H+=1)T.push(a[H][p]);d.push(T)}return(0,mn.arrayMap)(d,this.aggregationFunction)}getMergedValueAtIndex(i,a){const d=this.getMergedValues(a)[i];return(0,q.isDefined)(d)?d:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var At=f(25506);function vn(u,i,a){qn(u,i),i.set(u,a)}function qn(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(u,i,a){return u.set(dn(u,i),a),a}function Qt(u,i){return u.get(dn(u,i))}function dn(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var ar=new WeakMap;class ai{constructor(){vn(this,ar,[])}subscribe(i){return this.addLocalHook("change",i),this._write(Qt(ar,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(i){return i.length>0&&this.runLocalHooks("change",i),this}_writeInitialChanges(i){hr(ar,this,i)}}(0,Be.mixin)(ai,At.Z);function ti(u,i){const a=[];let d=0,w=0;for(;d<u.length&&w<i.length;d++,w++)u[d]!==i[w]&&a.push({op:"replace",index:w,oldValue:u[d],newValue:i[w]});for(;d<i.length;d++)a.push({op:"insert",index:d,oldValue:void 0,newValue:i[d]});for(;w<u.length;w++)a.push({op:"remove",index:w,oldValue:u[w],newValue:void 0});return a}function Ei(u,i,a){bs(u,i),i.set(u,a)}function bs(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $n(u,i){return u.get(lr(u,i))}function ni(u,i,a){return u.set(lr(u,i),a),a}function lr(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var Ls=new WeakMap,Tu=new WeakMap,kc=new WeakMap,ri=new WeakMap,iu=new WeakMap;class mc{constructor(){let{initialIndexValue:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ei(this,Ls,new Set),Ei(this,Tu,[]),Ei(this,kc,[]),Ei(this,ri,!1),Ei(this,iu,!1),ni(iu,this,i!=null?i:!1)}createObserver(){const i=new ai;return $n(Ls,this).add(i),i.addLocalHook("unsubscribe",()=>{$n(Ls,this).delete(i)}),i._writeInitialChanges(ti($n(Tu,this),$n(kc,this))),i}emit(i){let a=$n(kc,this);(!$n(ri,this)||$n(Tu,this).length!==i.length)&&(i.length===0?i=new Array(a.length).fill($n(iu,this)):ni(Tu,this,new Array(i.length).fill($n(iu,this))),$n(ri,this)||(ni(ri,this,!0),a=$n(Tu,this)));const d=ti(a,i);$n(Ls,this).forEach(w=>w._write(d)),ni(kc,this,i)}}function ia(u,i,a){return(i=fm(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function fm(u){var i=Aa(u,"string");return typeof i=="symbol"?i:i+""}function Aa(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}const hg=new Set;class kl{constructor(){ia(this,"indexesSequence",new R.b),ia(this,"trimmingMapsCollection",new Nt(i=>i.some(a=>a===!0),!1)),ia(this,"hidingMapsCollection",new Nt(i=>i.some(a=>a===!0),!1)),ia(this,"variousMapsCollection",new tr.f),ia(this,"hidingChangesObservable",new mc({initialIndexValue:!1})),ia(this,"notTrimmedIndexesCache",[]),ia(this,"notHiddenIndexesCache",[]),ia(this,"isBatched",!1),ia(this,"indexesSequenceChanged",!1),ia(this,"indexesChangeSource",void 0),ia(this,"trimmedIndexesChanged",!1),ia(this,"hiddenIndexesChanged",!1),ia(this,"renderablePhysicalIndexesCache",[]),ia(this,"fromPhysicalToVisualIndexesCache",new Map),ia(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",i=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",i,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",i=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",i,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",i=>{this.runLocalHooks("change",i,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(i){if(i!=="hiding")throw new Error(`Unsupported index map type "${i}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(i,a,d){return this.registerMap(i,Dt(a,d))}registerMap(i,a){if(this.trimmingMapsCollection.get(i)||this.hidingMapsCollection.get(i)||this.variousMapsCollection.get(i))throw Error(`Map with name "${i}" has been already registered.`);a instanceof Ge.n?this.trimmingMapsCollection.register(i,a):a instanceof L.o?this.hidingMapsCollection.register(i,a):this.variousMapsCollection.register(i,a);const d=this.getNumberOfIndexes();return d>0&&a.init(d),a}unregisterMap(i){this.trimmingMapsCollection.unregister(i),this.hidingMapsCollection.unregister(i),this.variousMapsCollection.unregister(i)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(i){const a=this.notTrimmedIndexesCache[i];return(0,q.isDefined)(a)?a:null}getPhysicalFromRenderableIndex(i){const a=this.renderablePhysicalIndexesCache[i];return(0,q.isDefined)(a)?a:null}getVisualFromPhysicalIndex(i){const a=this.fromPhysicalToVisualIndexesCache.get(i);return(0,q.isDefined)(a)?a:null}getVisualFromRenderableIndex(i){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(i))}getRenderableFromVisualIndex(i){const a=this.fromVisualToRenderableIndexesCache.get(i);return(0,q.isDefined)(a)?a:null}getNearestNotHiddenIndex(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(i)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(i))return i;const p=Array.from(this.fromVisualToRenderableIndexesCache.keys());let T=-1;return a>0?T=p.findIndex(H=>H>i):T=p.reverse().findIndex(H=>H<i),T===-1?d?this.getNearestNotHiddenIndex(i,-a,!1):null:p[T]}initToLength(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(i).keys()],this.notHiddenIndexesCache=[...new Array(i).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(i),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(i),this.variousMapsCollection.initEvery(i),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(i){const a=this.getNumberOfIndexes();if(i<a){const d=[...Array(this.getNumberOfIndexes()-i).keys()].map(w=>w+i);this.removeIndexes(d)}else this.insertIndexes(a,i-a)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(i){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(i),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(d=>this.isTrimmed(d)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(d=>this.isHidden(d)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(d=>this.isHidden(d)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(i,a){typeof i=="number"&&(i=[i]);const d=(0,mn.arrayMap)(i,te=>this.getPhysicalFromVisualIndex(te)),w=this.getNotTrimmedIndexesLength(),p=i.length,T=(0,Ht.t)(this.getIndexesSequence(),d),H=T.filter(te=>this.isTrimmed(te)===!1);let z=T.indexOf(H[H.length-1])+1;if(a+p<w){const te=H[a];z=T.indexOf(te)}this.indexesChangeSource="move",this.setIndexesSequence((0,Ht.S)(T,z,d)),this.indexesChangeSource=void 0}isTrimmed(i){return this.trimmingMapsCollection.getMergedValueAtIndex(i)}isHidden(i){return this.hidingMapsCollection.getMergedValueAtIndex(i)}insertIndexes(i,a){const d=this.getNotTrimmedIndexes()[i],w=(0,q.isDefined)(d)?d:this.getNumberOfIndexes(),p=this.getIndexesSequence().includes(d)?this.getIndexesSequence().indexOf(d):this.getNumberOfIndexes(),T=(0,mn.arrayMap)(new Array(a).fill(w),(H,z)=>H+z);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(p,T),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(p,T),this.hidingMapsCollection.insertToEvery(p,T),this.variousMapsCollection.insertToEvery(p,T),this.resumeOperations()}removeIndexes(i){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(i),this.hidingMapsCollection.removeFromEvery(i),this.variousMapsCollection.removeFromEvery(i),this.resumeOperations()}updateCache(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const a=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(i===!0||this.isBatched===!1&&a===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const i=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let a=0;a<i;a+=1){const d=this.getPhysicalFromVisualIndex(a);this.fromPhysicalToVisualIndexesCache.set(d,a)}}cacheFromVisualToRenderableIndexes(){const i=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let a=0;a<i;a+=1){const d=this.getPhysicalFromRenderableIndex(a),w=this.getVisualFromPhysicalIndex(d);this.fromVisualToRenderableIndexesCache.set(w,a)}}}(0,Be.mixin)(kl,At.Z);var ko=f(58955);function Mu(u,i){return(0,Be.objectEach)(i,(a,d)=>{(0,q.isUndefined)(u[d])&&(u[d]=a)}),u}function gm(u,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i,[w,p]=[a,d];return u>i&&([w,p]=[p,w]),`${w}-${p}`}function Eh(u){const a=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(u);return a?`${a[1].toLowerCase()}-${a[2].toUpperCase()}`:u}function Ne(u){(0,q.isDefined)(u)&&(0,hn.vU)((0,Tt.e)`Language with code "${u}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}var We=f(80534);function Rt(u,i){return Array.isArray(u)&&Number.isInteger(i)?u[i]:u}const{register:ln,getValues:Xt}=(0,We.Z)("phraseFormatters");function rn(u,i){ln(u,i)}function fn(){return Xt()}rn("pluralize",Rt);var gt=f(38826);var Lt={languageCode:"en-US",[gt.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[gt.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[gt.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[gt.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[gt.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[gt.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[gt.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[gt.CONTEXTMENU_ITEMS_UNDO]:"Undo",[gt.CONTEXTMENU_ITEMS_REDO]:"Redo",[gt.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[gt.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[gt.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[gt.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[gt.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[gt.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[gt.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[gt.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[gt.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[gt.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[gt.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[gt.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[gt.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[gt.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[gt.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[gt.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[gt.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[gt.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[gt.CONTEXTMENU_ITEMS_COPY]:"Copy",[gt.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[gt.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[gt.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[gt.CONTEXTMENU_ITEMS_CUT]:"Cut",[gt.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[gt.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[gt.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[gt.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[gt.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[gt.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[gt.FILTERS_CONDITIONS_NONE]:"None",[gt.FILTERS_CONDITIONS_EMPTY]:"Is empty",[gt.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[gt.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[gt.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[gt.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[gt.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[gt.FILTERS_CONDITIONS_CONTAINS]:"Contains",[gt.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[gt.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[gt.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[gt.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[gt.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[gt.FILTERS_CONDITIONS_BETWEEN]:"Is between",[gt.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[gt.FILTERS_CONDITIONS_AFTER]:"After",[gt.FILTERS_CONDITIONS_BEFORE]:"Before",[gt.FILTERS_CONDITIONS_TODAY]:"Today",[gt.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[gt.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[gt.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[gt.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[gt.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[gt.FILTERS_LABELS_CONJUNCTION]:"And",[gt.FILTERS_LABELS_DISJUNCTION]:"Or",[gt.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[gt.FILTERS_BUTTONS_CLEAR]:"Clear",[gt.FILTERS_BUTTONS_OK]:"OK",[gt.FILTERS_BUTTONS_CANCEL]:"Cancel",[gt.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[gt.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[gt.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[gt.CHECKBOX_CHECKED]:"Checked",[gt.CHECKBOX_UNCHECKED]:"Unchecked"};const wn=gt,Dn=Lt.languageCode,{register:Nn,getItem:wr,hasItem:Zr,getValues:rs}=(0,We.Z)("languagesDictionaries");ki(Lt);function ki(u,i){let a=u,d=i;return(0,Be.isObject)(u)&&(d=u,a=d.languageCode),Na(a,d),Nn(a,(0,Be.deepClone)(d)),(0,Be.deepClone)(d)}function Na(u,i){u!==Dn&&Mu(i,wr(Dn))}function fo(u){return Da(u)?(0,Be.deepClone)(wr(u)):null}function Da(u){return Zr(u)}function Ga(){return DEFAULT_DICTIONARY}function Vc(){return rs()}function Ou(u,i,a){const d=fo(u);if(d===null)return null;const w=d[i];if((0,q.isUndefined)(w))return null;const p=$a(w,a);return Array.isArray(p)?p[0]:p}function $a(u,i){let a=u;return(0,mn.arrayEach)(fn(),d=>{a=d(u,i)}),a}function su(u){let i=Eh(u);return Da(i)||(i=Dn,Ne(u)),i}var sa=f(99450);class cf{constructor(i,a){this.settings=i,this.cellRange=a||null}isEmpty(){return this.cellRange===null}add(i){return this.isEmpty()?this.cellRange=this.settings.createCellRange(i):this.cellRange.expand(i),this}replace(i,a){if(!this.isEmpty()){if(this.cellRange.from.isEqual(i))return this.cellRange.from=a,!0;if(this.cellRange.to.isEqual(i))return this.cellRange.to=a,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const i=this.cellRange.getOuterTopStartCorner(),a=this.cellRange.getOuterBottomEndCorner();return[i.row,i.col,a.row,a.col]}destroy(){this.runLocalHooks("destroy")}}(0,Be.mixin)(cf,At.Z);var Qv=cf;function mm(u,i,a){return(i=qv(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function qv(u){var i=wy(u,"string");return typeof i=="symbol"?i:i+""}function wy(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Sp extends Qv{constructor(i,a){super(i,null),mm(this,"visualCellRange",null),this.visualCellRange=a||null,this.commit()}add(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(i){let{from:a,to:d}=i,w=this.getNearestNotHiddenCoords(a,1),p=this.getNearestNotHiddenCoords(d,-1);return w===null||p===null?null:((w.row>p.row||w.col>p.col)&&(w=a,p=d),this.settings.createCellRange(w,w,p))}getNearestNotHiddenCoords(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a;const w=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,i.row,a);if(w===null)return null;const p=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,i.col,d);return p===null?null:this.settings.createCellCoords(w,p)}getNearestNotHiddenIndex(i,a,d){return a<0?a:i.getNearestNotHiddenIndex(a,d)}commit(){if(this.visualCellRange===null)return this;const i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}syncWith(i){const a=i.from.clone().normalize(),d=i.getVerticalDirection()==="N-S"?1:-1,w=i.getHorizontalDirection()==="W-E"?1:-1,p=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let T=null;if((p===null||p.col===null||p.row===null)&&(T=this.getNearestNotHiddenCoords(a,d,w)),T!==null&&i.overlaps(T)){const H=i.highlight.clone();if(H.row>=0&&(H.row=T.row),H.col>=0&&(H.col=T.col),this.cellRange===null){const z=this.settings.visualToRenderableCoords(H);this.cellRange=this.settings.createCellRange(z)}i.setHighlight(H)}return this.settings.selectionType==="focus"&&p!==null&&T===null&&i.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:i,to:a}=this.cellRange;return[Math.min(i.row,a.row),Math.min(i.col,a.col),Math.max(i.row,a.row),Math.max(i.col,a.col)]}getVisualCorners(){const i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),a=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,a.row,a.col]}createRenderableCellRange(i,a){const d=this.settings.visualToRenderableCoords(i),w=this.settings.visualToRenderableCoords(a);return d.row===null||d.col===null||w.row===null||w.col===null?null:this.settings.createCellRange(d,d,w)}}var jc=Sp;function _p(u){let d=u,{activeHeaderClassName:i}=d,a=Xu(d,["activeHeaderClassName"]);return new jc(Gl(hi({className:i},a),{selectionType:sa.CD}))}function bp(u){let d=u,{areaCornerVisible:i}=d,a=Xu(d,["areaCornerVisible"]);return new jc(Gl(hi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:i}},a),{selectionType:sa.AI}))}function hf(u){let i=Xu(u,[]);return new jc(Gl(hi({className:"highlight"},i),{selectionType:sa.AI}))}function yy(u){let d=u,{columnClassName:i}=d,a=Xu(d,["columnClassName"]);return new jc(Gl(hi({className:i},a),{selectionType:sa.BA}))}function eC(u){let d=u,{cellCornerVisible:i}=d,a=Xu(d,["cellCornerVisible"]);return new jc(Gl(hi({className:"current",headerAttributes:[(0,x.Ak)()],border:{width:2,color:"#4b89ff",cornerVisible:i}},a),{selectionType:sa.t8}))}function df(u){let w=u,{border:i,visualCellRange:a}=w,d=Xu(w,["border","visualCellRange"]);return new jc(Gl(hi(hi({},i),d),{selectionType:sa.$7}),a)}function pm(u){let i=Xu(u,[]);return new jc(Gl(hi({className:"fill",border:{width:1,color:"#ff0000"}},i),{selectionType:sa.P$}))}function tC(u){let d=u,{headerClassName:i}=d,a=Xu(d,["headerClassName"]);return new jc(Gl(hi({className:i},a),{selectionType:sa.Nc}))}function ff(u){let d=u,{rowClassName:i}=d,a=Xu(d,["rowClassName"]);return new jc(Gl(hi({className:i},a),{selectionType:sa.Os}))}function nC(u,i){rC(u,i),i.add(u)}function rC(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function is(u,i,a){return(i=vd(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function vd(u){var i=Uc(u,"string");return typeof i=="symbol"?i:i+""}function Uc(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function Iu(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var pc=new WeakSet;class Sy{constructor(i){nC(this,pc),is(this,"options",void 0),is(this,"layerLevel",0),is(this,"focus",void 0),is(this,"fill",void 0),is(this,"layeredAreas",new Map),is(this,"areas",new Map),is(this,"rowHeaders",new Map),is(this,"columnHeaders",new Map),is(this,"activeRowHeaders",new Map),is(this,"activeColumnHeaders",new Map),is(this,"activeCornerHeaders",new Map),is(this,"rowHighlights",new Map),is(this,"columnHighlights",new Map),is(this,"customSelections",[]),this.options=i,this.focus=eC(i),this.fill=pm(i)}isEnabledFor(i,a){let d=i;i===sa.t8&&(d="current");let w=this.options.disabledCellSelection(a.row,a.col);return typeof w=="string"&&(w=[w]),w===!1||Array.isArray(w)&&!w.includes(d)}useLayerLevel(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=i,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Iu(pc,this,zc).call(this,this.layeredAreas,bp)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Iu(pc,this,zc).call(this,this.areas,hf)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Iu(pc,this,zc).call(this,this.rowHeaders,tC)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Iu(pc,this,zc).call(this,this.columnHeaders,tC)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Iu(pc,this,zc).call(this,this.activeRowHeaders,_p)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Iu(pc,this,zc).call(this,this.activeColumnHeaders,_p)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Iu(pc,this,zc).call(this,this.activeCornerHeaders,_p)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Iu(pc,this,zc).call(this,this.rowHighlights,ff)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Iu(pc,this,zc).call(this,this.columnHighlights,yy)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(i){this.customSelections.push(df(hi(hi({},this.options),i)))}clear(){this.focus.clear(),this.fill.clear(),(0,mn.arrayEach)(this.areas.values(),i=>void i.clear()),(0,mn.arrayEach)(this.layeredAreas.values(),i=>void i.clear()),(0,mn.arrayEach)(this.rowHeaders.values(),i=>void i.clear()),(0,mn.arrayEach)(this.columnHeaders.values(),i=>void i.clear()),(0,mn.arrayEach)(this.activeRowHeaders.values(),i=>void i.clear()),(0,mn.arrayEach)(this.activeColumnHeaders.values(),i=>void i.clear()),(0,mn.arrayEach)(this.activeCornerHeaders.values(),i=>void i.clear()),(0,mn.arrayEach)(this.rowHighlights.values(),i=>void i.clear()),(0,mn.arrayEach)(this.columnHighlights.values(),i=>void i.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function zc(u,i){const a=this.layerLevel;if(u.has(a))return u.get(a);const d=i(hi({layerLevel:a},this.options));return u.set(a,d),d}var Cd=Sy;function iC(u,i,a){return(i=_y(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function _y(u){var i=by(u,"string");return typeof i=="symbol"?i:i+""}function by(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Ey{constructor(i){iC(this,"ranges",[]),iC(this,"createCellRange",void 0),this.createCellRange=i}isEmpty(){return this.size()===0}set(i){return this.clear(),this.ranges.push(this.createCellRange(i)),this}add(i){return this.ranges.push(this.createCellRange(i)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(i){return this.ranges.some(a=>a.includes(i))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a;return i>=0&&i<this.size()&&(a=this.ranges[i]),a}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var Rh=Ey;function Ry(u,i){Rp(u,i),i.add(u)}function Ep(u,i,a){Rp(u,i),i.set(u,a)}function Rp(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ri(u,i){return u.get(Xs(u,i))}function vm(u,i,a){return u.set(Xs(u,i),a),a}function Xs(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var gf=new WeakMap,Ms=new WeakMap,Xa=new WeakMap,go=new WeakSet;class Cm{constructor(i,a){Ry(this,go),Ep(this,gf,void 0),Ep(this,Ms,void 0),Ep(this,Xa,{x:0,y:0}),vm(gf,this,i),vm(Ms,this,a)}transformStart(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const w=Ri(Ms,this).createCellCoords(i,a);let p=Ri(gf,this).current().highlight;const T=Ri(Ms,this).visualToRenderableCoords(p);let H=0,z=0;if(this.runLocalHooks("beforeTransformStart",w),T.row!==null&&T.col!==null){const{width:te,height:we}=Xs(go,this,Tp).call(this),{row:Ie,col:De}=Xs(go,this,oC).call(this,p),Le=Ri(Ms,this).fixedRowsBottom(),ut=Ri(Ms,this).minSpareRows(),Bt=Ri(Ms,this).minSpareCols(),zn=Ri(Ms,this).autoWrapRow(),Mn=Ri(Ms,this).autoWrapCol(),_t=Ri(Ms,this).createCellCoords(Ie+w.row,De+w.col);if(_t.row>=we){const ss=(0,Be.createObjectPropListener)(d&&ut>0&&Le===0),si=_t.col+1,Ti=Ri(Ms,this).createCellCoords(_t.row-we,si>=te?si-te:si);this.runLocalHooks("beforeColumnWrap",ss,Xs(go,this,Kc).call(this,Ti),si>=te),ss.value?this.runLocalHooks("insertRowRequire",Ri(Ms,this).countRenderableRows()):Mn&&_t.assign(Ti)}else if(_t.row<0){const ss=(0,Be.createObjectPropListener)(Mn),si=_t.col-1,Ti=Ri(Ms,this).createCellCoords(we+_t.row,si<0?te+si:si);this.runLocalHooks("beforeColumnWrap",ss,Xs(go,this,Kc).call(this,Ti),si<0),Mn&&_t.assign(Ti)}if(_t.col>=te){const ss=(0,Be.createObjectPropListener)(d&&Bt>0),si=_t.row+1,Ti=Ri(Ms,this).createCellCoords(si>=we?si-we:si,_t.col-te);this.runLocalHooks("beforeRowWrap",ss,Xs(go,this,Kc).call(this,Ti),si>=we),ss.value?this.runLocalHooks("insertColRequire",Ri(Ms,this).countRenderableColumns()):zn&&_t.assign(Ti)}else if(_t.col<0){const ss=(0,Be.createObjectPropListener)(zn),si=_t.row-1,Ti=Ri(Ms,this).createCellCoords(si<0?we+si:si,te+_t.col);this.runLocalHooks("beforeRowWrap",ss,Xs(go,this,Kc).call(this,Ti),si<0),zn&&_t.assign(Ti)}const{rowDir:Ci,colDir:mi}=Xs(go,this,sC).call(this,_t);H=Ci,z=mi,p=Xs(go,this,Kc).call(this,_t)}return this.runLocalHooks("afterTransformStart",p,H,z),p}transformEnd(i,a){const d=Ri(Ms,this).createCellCoords(i,a),w=Ri(gf,this).current(),p=Ri(Ms,this).visualToRenderableCoords(w.highlight),T=Xs(go,this,wm).call(this,w.to.row,w.from.row),H=Xs(go,this,Pu).call(this,w.to.col,w.from.col),z=w.to.clone();let te=0,we=0;if(this.runLocalHooks("beforeTransformEnd",d),p.row!==null&&p.col!==null&&T!==null&&H!==null){const{row:Ie,col:De}=Xs(go,this,oC).call(this,w.highlight),Le=Ri(Ms,this).createCellCoords(T+d.row,H+d.col),ut=w.getTopStartCorner(),Bt=w.getTopEndCorner(),zn=w.getBottomEndCorner();if(d.col<0&&H>=De&&Le.col<De){const mi=Le.col-De;Le.col=Xs(go,this,Pu).call(this,ut.col,Bt.col)+mi}else if(d.col>0&&H<=De&&Le.col>De){const mi=Xs(go,this,Pu).call(this,Bt.col,ut.col),ss=Math.max(Le.col-mi,1);Le.col=mi+ss}if(d.row<0&&T>=Ie&&Le.row<Ie){const mi=Le.row-Ie;Le.row=Xs(go,this,wm).call(this,ut.row,zn.row)+mi}else if(d.row>0&&T<=Ie&&Le.row>Ie){const mi=Xs(go,this,wm).call(this,zn.row,ut.row),ss=Math.max(Le.row-mi,1);Le.row=mi+ss}const{rowDir:Mn,colDir:_t}=Xs(go,this,sC).call(this,Le);te=Mn,we=_t;const Ci=Xs(go,this,Kc).call(this,Le);d.row===0&&d.col!==0?z.col=Ci.col:d.row!==0&&d.col===0?z.row=Ci.row:(z.row=Ci.row,z.col=Ci.col)}return this.runLocalHooks("afterTransformEnd",z,te,we),z}setOffsetSize(i){let{x:a,y:d}=i;vm(Xa,this,{x:a,y:d})}resetOffsetSize(){vm(Xa,this,{x:0,y:0})}}function sC(u){const{width:i,height:a}=Xs(go,this,Tp).call(this);let d=0,w=0;return u.row<0?(d=-1,u.row=0):u.row>0&&u.row>=a&&(d=1,u.row=a-1),u.col<0?(w=-1,u.col=0):u.col>0&&u.col>=i&&(w=1,u.col=i-1),{rowDir:d,colDir:w}}function Tp(){return{width:Ri(Xa,this).x+Ri(Ms,this).countRenderableColumns(),height:Ri(Xa,this).y+Ri(Ms,this).countRenderableRows()}}function wm(u,i){const a=Ri(Ms,this).findFirstNonHiddenRenderableRow(u,i);return a===null?null:Ri(Xa,this).y+a}function Pu(u,i){const a=Ri(Ms,this).findFirstNonHiddenRenderableColumn(u,i);return a===null?null:Ri(Xa,this).x+a}function oC(u){const{row:i,col:a}=Ri(Ms,this).visualToRenderableCoords(u);if(i===null||a===null)throw new Error("Renderable coords are not visible.");return Ri(Ms,this).createCellCoords(Ri(Xa,this).y+i,Ri(Xa,this).x+a)}function Kc(u){const i=u.clone();return i.col=u.col-Ri(Xa,this).x,i.row=u.row-Ri(Xa,this).y,Ri(Ms,this).renderableToVisualCoords(i)}(0,Be.mixin)(Cm,At.Z);var ym=Cm,Yc=f(11043);function Th(u,i,a){Mp(u,i),i.set(u,a)}function Mp(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vc(u,i,a){return(i=Sm(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Sm(u){var i=_m(u,"string");return typeof i=="symbol"?i:i+""}function _m(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function Os(u,i){return u.get(aC(u,i))}function mo(u,i,a){return u.set(aC(u,i),a),a}function aC(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var Zs=new WeakMap,wd=new WeakMap,vi=new WeakMap,Vl=new WeakMap,yd=new WeakMap,xu=new WeakMap;class mf{constructor(i,a){var d=this;vc(this,"settings",void 0),vc(this,"tableProps",void 0),vc(this,"inProgress",!1),vc(this,"selectedRange",new Rh((w,p,T)=>this.tableProps.createCellRange(w,p,T))),vc(this,"highlight",void 0),Th(this,Zs,void 0),Th(this,wd,void 0),vc(this,"selectedByRowHeader",new Set),vc(this,"selectedByColumnHeader",new Set),Th(this,vi,!1),Th(this,Vl,!1),Th(this,yd,"unknown"),Th(this,xu,-1),this.settings=i,this.tableProps=a,this.highlight=new Cd({headerClassName:i.currentHeaderClassName,activeHeaderClassName:i.activeHeaderClassName,rowClassName:i.currentRowClassName,columnClassName:i.currentColClassName,cellAttributes:[(0,x.Ak)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(w,p)=>this.tableProps.isDisabledCellSelection(w,p),cellCornerVisible:function(){return d.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return d.isAreaCornerVisible(...arguments)},visualToRenderableCoords:w=>this.tableProps.visualToRenderableCoords(w),renderableToVisualCoords:w=>this.tableProps.renderableToVisualCoords(w),createCellCoords:(w,p)=>this.tableProps.createCellCoords(w,p),createCellRange:(w,p,T)=>this.tableProps.createCellRange(w,p,T)}),mo(Zs,this,new ym(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:w=>this.tableProps.visualToRenderableCoords(w),renderableToVisualCoords:w=>this.tableProps.renderableToVisualCoords(w),findFirstNonHiddenRenderableRow:function(){return d.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return d.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(w,p)=>this.tableProps.createCellCoords(w,p),fixedRowsBottom:()=>i.fixedRowsBottom,minSpareRows:()=>i.minSpareRows,minSpareCols:()=>i.minSpareCols,autoWrapRow:()=>i.autoWrapRow,autoWrapCol:()=>i.autoWrapCol})),mo(wd,this,new ym(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const w=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,w.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const w=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,w.getOuterBottomEndCorner().col)},visualToRenderableCoords:w=>this.tableProps.visualToRenderableCoords(w),renderableToVisualCoords:w=>this.tableProps.renderableToVisualCoords(w),findFirstNonHiddenRenderableRow:function(){return d.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return d.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(w,p)=>this.tableProps.createCellCoords(w,p),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Os(Zs,this).addLocalHook("beforeTransformStart",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("beforeModifyTransformStart",...p)}),Os(Zs,this).addLocalHook("afterTransformStart",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("afterModifyTransformStart",...p)}),Os(Zs,this).addLocalHook("beforeTransformEnd",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("beforeModifyTransformEnd",...p)}),Os(Zs,this).addLocalHook("afterTransformEnd",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("afterModifyTransformEnd",...p)}),Os(Zs,this).addLocalHook("insertRowRequire",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("insertRowRequire",...p)}),Os(Zs,this).addLocalHook("insertColRequire",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("insertColRequire",...p)}),Os(Zs,this).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("beforeRowWrap",...p)}),Os(Zs,this).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("beforeColumnWrap",...p)}),Os(wd,this).addLocalHook("beforeTransformStart",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("beforeModifyTransformFocus",...p)}),Os(wd,this).addLocalHook("afterTransformStart",function(){for(var w=arguments.length,p=new Array(w),T=0;T<w;T++)p[T]=arguments[T];return d.runLocalHooks("afterModifyTransformFocus",...p)})}getSelectedRange(){return this.selectedRange}markSource(i){mo(yd,this,i)}markEndSource(){mo(yd,this,"unknown")}getSelectionSource(){return Os(yd,this)}setExpectedLayers(i){mo(xu,this,i)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,mo(xu,this,-1)}isInProgress(){return this.inProgress}setRangeStart(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;const p=this.settings.selectionMode==="multiple",T=(0,q.isUndefined)(a)?this.tableProps.getShortcutManager().isCtrlPressed():a,H=i.clone();mo(vi,this,!1),this.runLocalHooks(`beforeSetRangeStart${d?"Only":""}`,H),(!p||p&&!T&&(0,q.isUndefined)(a))&&this.selectedRange.clear(),this.selectedRange.add(H).current().setHighlight(w.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),d||this.setRangeEnd(i)}setRangeStartOnly(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i;this.setRangeStart(i,a,!0,d)}setRangeEnd(i){if(this.selectedRange.isEmpty())return;const a=i.clone(),d=this.tableProps.countRows(),w=this.tableProps.countCols(),p=this.selectedRange.current().clone().setTo(i).isSingleHeader();if((d>0||w>0)&&(d===0&&a.col<0&&!p||w===0&&a.row<0&&!p))return;this.runLocalHooks("beforeSetRangeEnd",a),this.begin();const T=this.selectedRange.current();if(this.settings.navigableHeaders||T.highlight.normalize(),this.settings.selectionMode==="single")T.setFrom(T.highlight),T.setTo(T.highlight);else{const z=T.getHorizontalDirection(),te=T.getVerticalDirection(),we=this.isMultiple();T.setTo(a),we&&(z!==T.getHorizontalDirection()||T.getWidth()===1&&!T.includes(T.highlight))&&T.from.assign({col:T.highlight.col}),we&&(te!==T.getVerticalDirection()||T.getHeight()===1&&!T.includes(T.highlight))&&T.from.assign({row:T.highlight.row})}d>0&&w>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!T.isSingleHeader())&&T.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const H=Os(xu,this)===-1||this.selectedRange.size()===Os(xu,this);this.runLocalHooks("afterSetRangeEnd",i,H)}applyAndCommit(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const d=this.tableProps.countRows(),w=this.tableProps.countCols();a<this.highlight.layerLevel&&((0,mn.arrayEach)(this.highlight.getAreas(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getLayeredAreas(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getRowHeaders(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getColumnHeaders(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getActiveRowHeaders(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getActiveColumnHeaders(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getActiveCornerHeaders(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getRowHighlights(),ut=>void ut.clear()),(0,mn.arrayEach)(this.highlight.getColumnHighlights(),ut=>void ut.clear())),this.highlight.useLayerLevel(a);const p=this.highlight.createArea(),T=this.highlight.createLayeredArea(),H=this.highlight.createRowHeader(),z=this.highlight.createColumnHeader(),te=this.highlight.createActiveRowHeader(),we=this.highlight.createActiveColumnHeader(),Ie=this.highlight.createActiveCornerHeader(),De=this.highlight.createRowHighlight(),Le=this.highlight.createColumnHighlight();if(p.clear(),T.clear(),H.clear(),z.clear(),te.clear(),we.clear(),Ie.clear(),De.clear(),Le.clear(),this.highlight.isEnabledFor(sa.AI,i.highlight)&&(this.isMultiple()||a>=1)&&(p.add(i.from).add(i.to).commit(),T.add(i.from).add(i.to).commit(),a===1)){const ut=this.selectedRange.previous();this.highlight.useLayerLevel(a-1),this.highlight.createArea().add(ut.from).commit().syncWith(ut),this.highlight.createLayeredArea().add(ut.from).commit().syncWith(ut),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(sa.Nc,i.highlight)){if(!i.isSingleHeader()){const zn=this.tableProps.createCellCoords(Math.max(i.from.row,0),-1),Mn=this.tableProps.createCellCoords(i.to.row,-1),_t=this.tableProps.createCellCoords(-1,Math.max(i.from.col,0)),Ci=this.tableProps.createCellCoords(-1,i.to.col);this.settings.selectionMode==="single"?(H.add(zn).commit(),z.add(_t).commit(),De.add(zn).commit(),Le.add(_t).commit()):(H.add(zn).add(Mn).commit(),z.add(_t).add(Ci).commit(),De.add(zn).add(Mn).commit(),Le.add(_t).add(Ci).commit())}const ut=!Os(Vl,this)&&this.isEntireRowSelected()&&(w>0&&w===i.getWidth()||w===0&&this.isSelectedByRowHeader()),Bt=!Os(Vl,this)&&this.isEntireColumnSelected()&&(d>0&&d===i.getHeight()||d===0&&this.isSelectedByColumnHeader());ut&&te.add(this.tableProps.createCellCoords(Math.max(i.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(i.to.row,0),-1)).commit(),Bt&&we.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(i.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(i.to.col,0))).commit(),ut&&Bt&&Ie.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(i){if(this.selectedRange.isEmpty())return;const a=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",i);const d=this.highlight.getFocus();d.clear(),a.setHighlight(i),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(sa.t8,a.highlight)&&d.add(a.highlight).commit().syncWith(a),this.inProgress||(mo(vi,this,!0),this.runLocalHooks("afterSetFocus",a.highlight))}transformStart(i,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Os(Zs,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Os(Zs,this).resetOffsetSize(),this.setRangeStart(Os(Zs,this).transformStart(i,a,d))}transformEnd(i,a){this.settings.navigableHeaders?Os(Zs,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Os(Zs,this).resetOffsetSize(),this.setRangeEnd(Os(Zs,this).transformEnd(i,a))}transformFocus(i,a){const d=this.selectedRange.current(),{row:w,col:p}=d.getOuterTopStartCorner(),T=this.tableProps.countRenderableColumnsInRange(0,p-1),H=this.tableProps.countRenderableRowsInRange(0,w-1);d.highlight.isHeader()?Os(wd,this).setOffsetSize({x:p<0?Math.abs(p):-T,y:w<0?Math.abs(w):-H}):Os(wd,this).setOffsetSize({x:p<0?0:-T,y:w<0?0:-H});const z=Os(wd,this).transformStart(i,a);this.setRangeFocus(z.normalize())}shiftRows(i,a){if(!this.isSelected())return;const d=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||d.getOuterTopStartCorner().row>=i){const{from:w,to:p,highlight:T}=d,H=this.tableProps.countRows(),z=this.isSelectedByRowHeader(),te=this.isSelectedByColumnHeader(),we=te?-1:0,Ie=te?0:a;this.getSelectedRange().pop();const De=this.tableProps.createCellCoords((0,pr.clamp)(w.row+Ie,we,H-1),w.col),Le=this.tableProps.createCellCoords((0,pr.clamp)(p.row+a,we,H-1),p.col);this.markSource("shift"),T.row>=i?this.setRangeStartOnly(De,!0,this.tableProps.createCellCoords((0,pr.clamp)(T.row+a,0,H-1),T.col)):this.setRangeStartOnly(De,!0),z&&this.selectedByRowHeader.add(this.getLayerLevel()),te&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(Le),this.markEndSource()}}shiftColumns(i,a){if(!this.isSelected())return;const d=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||d.getOuterTopStartCorner().col>=i){const{from:w,to:p,highlight:T}=d,H=this.tableProps.countCols(),z=this.isSelectedByRowHeader(),te=this.isSelectedByColumnHeader(),we=z?-1:0,Ie=z?0:a;this.getSelectedRange().pop();const De=this.tableProps.createCellCoords(w.row,(0,pr.clamp)(w.col+Ie,we,H-1)),Le=this.tableProps.createCellCoords(p.row,(0,pr.clamp)(p.col+a,we,H-1));this.markSource("shift"),T.col>=i?this.setRangeStartOnly(De,!0,this.tableProps.createCellCoords(T.row,(0,pr.clamp)(T.col+a,0,H-1))):this.setRangeStartOnly(De,!0),z&&this.selectedByRowHeader.add(this.getLayerLevel()),te&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(Le),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const i=(0,Be.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",i),i.value}isFocusSelectionChanged(){return this.isSelected()&&Os(vi,this)}isSelectedByRowHeader(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(i)&&(i===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(i))}isEntireRowSelected(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const a=w=>{const{col:p}=w.getOuterTopStartCorner(),T=this.tableProps.countRowHeaders(),H=this.tableProps.countCols();return(T>0&&p<0||T===0)&&w.getWidth()===H};if(i===-1)return Array.from(this.selectedRange).some(w=>a(w));const d=this.selectedRange.peekByIndex(i);return d?a(d):!1}isSelectedByColumnHeader(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(i===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(i))}isEntireColumnSelected(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const a=w=>{const{row:p}=w.getOuterTopStartCorner(),T=this.tableProps.countColHeaders(),H=this.tableProps.countRows();return(T>0&&p<0||T===0)&&w.getHeight()===H};if(i===-1)return Array.from(this.selectedRange).some(w=>a(w));const d=this.selectedRange.peekByIndex(i);return d?a(d):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(i){return this.selectedRange.includes(i)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(i){const a=this.tableProps.visualToRenderableCoords(i);return a.row!==null&&a.col!==null}isAreaCornerVisible(i){return Number.isInteger(i)&&i!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var i;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const p=this.tableProps.countRows(),T=this.tableProps.countCols(),H=this.tableProps.countRowHeaders(),z=this.tableProps.countColHeaders(),te=d?-z:0,we=a?-H:0;if(te===0&&we===0&&(p===0||T===0))return;let Ie=(i=this.getSelectedRange().current())===null||i===void 0?void 0:i.highlight;const{focusPosition:De,disableHeadersHighlight:Le}=w;mo(Vl,this,Le),De&&Number.isInteger(De==null?void 0:De.row)&&Number.isInteger(De==null?void 0:De.col)&&(Ie=this.tableProps.createCellCoords((0,pr.clamp)(De.row,te,p-1),(0,pr.clamp)(De.col,we,T-1)));const ut=this.tableProps.createCellCoords(te,we),Bt=this.tableProps.createCellCoords(p-1,T-1);this.clear(),this.setRangeStartOnly(ut,void 0,Ie),we<0&&this.selectedByRowHeader.add(this.getLayerLevel()),te<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(Bt),this.finish(),mo(Vl,this,!1)}selectCells(i){var a=this;const d=(0,Yc.AV)(i);if(d===Yc.gk)return!1;if(d===Yc.Kk)throw new Error((0,Tt.e)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const w=(0,Yc.S5)(d,{createCellCoords:function(){return a.tableProps.createCellCoords(...arguments)},createCellRange:function(){return a.tableProps.createCellRange(...arguments)},propToCol:z=>this.tableProps.propToCol(z),keepDirection:!0}),p=this.settings.navigableHeaders,T={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:p?this.tableProps.countRowHeaders():0,countColHeaders:p?this.tableProps.countColHeaders():0},H=!i.some(z=>{const te=w(z),we=te.isValid(T);return!(we&&!te.containsHeaders()||we&&te.containsHeaders()&&te.isSingleHeader())});return H&&(this.clear(),this.setExpectedLayers(i.length),(0,mn.arrayEach)(i,z=>{const{from:te,to:we}=w(z);this.setRangeStartOnly(te.clone(),!1),this.setRangeEnd(we.clone())}),this.finish()),H}selectColumns(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const w=typeof i=="string"?this.tableProps.propToCol(i):i,p=typeof a=="string"?this.tableProps.propToCol(a):a,T=this.tableProps.countRows(),H=this.tableProps.countCols(),z=this.tableProps.countColHeaders(),te=z===0?0:-z,we=this.tableProps.createCellCoords(te,w),Ie=this.tableProps.createCellCoords(T-1,p),De=this.tableProps.createCellRange(we,we,Ie).isValid({countRows:T,countCols:H,countRowHeaders:0,countColHeaders:z});if(De){let Le=0,ut=0;Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)?(Le=(0,pr.clamp)(d.row,te,T-1),ut=(0,pr.clamp)(d.col,Math.min(w,p),Math.max(w,p))):(Le=(0,pr.clamp)(d,te,T-1),ut=w);const Bt=this.tableProps.createCellCoords(Le,ut),zn=z===0?0:(0,pr.clamp)(Bt.row,te,-1),Mn=T-1,_t=this.tableProps.createCellCoords(zn,w),Ci=this.tableProps.createCellCoords(Mn,p);this.runLocalHooks("beforeSelectColumns",_t,Ci,Bt),_t.row=zn,Ci.row=Mn,this.setRangeStartOnly(_t,void 0,Bt),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(Ci),this.runLocalHooks("afterSelectColumns",_t,Ci,Bt),this.finish()}return De}selectRows(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const w=this.tableProps.countRows(),p=this.tableProps.countCols(),T=this.tableProps.countRowHeaders(),H=T===0?0:-T,z=this.tableProps.createCellCoords(i,H),te=this.tableProps.createCellCoords(a,p-1),we=this.tableProps.createCellRange(z,z,te).isValid({countRows:w,countCols:p,countRowHeaders:T,countColHeaders:0});if(we){let Ie=0,De=0;Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)?(Ie=(0,pr.clamp)(d.row,Math.min(i,a),Math.max(i,a)),De=(0,pr.clamp)(d.col,H,p-1)):(Ie=i,De=(0,pr.clamp)(d,H,p-1));const Le=this.tableProps.createCellCoords(Ie,De),ut=T===0?0:(0,pr.clamp)(Le.col,H,-1),Bt=p-1,zn=this.tableProps.createCellCoords(i,ut),Mn=this.tableProps.createCellCoords(a,Bt);this.runLocalHooks("beforeSelectRows",zn,Mn,Le),zn.col=ut,Mn.col=Bt,this.setRangeStartOnly(zn,void 0,Le),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(Mn),this.runLocalHooks("afterSelectRows",zn,Mn,Le),this.finish()}return we}refresh(){if(!this.isSelected())return;const i=this.tableProps.countRows(),a=this.tableProps.countCols();if(i===0||a===0){this.deselect();return}const d=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:w,to:p,highlight:T}=d;this.clear(),T.assign({row:(0,pr.clamp)(T.row,-1/0,i-1),col:(0,pr.clamp)(T.col,-1/0,a-1)}),w.assign({row:(0,pr.clamp)(w.row,-1/0,i-1),col:(0,pr.clamp)(w.col,-1/0,a-1)}),p.assign({row:(0,pr.clamp)(p.row,0,i-1),col:(0,pr.clamp)(p.col,0,a-1)}),this.selectedRange.ranges.push(d),this.highlight.isEnabledFor(sa.t8,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(T).commit().syncWith(d),this.applyAndCommit(d)}commit(){if(this.highlight.getCustomSelections().forEach(w=>{w.commit()}),!this.isSelected())return;const a=this.getLayerLevel(),d=this.selectedRange.current();this.highlight.isEnabledFor(sa.t8,d.highlight)&&this.highlight.getFocus().commit().syncWith(d);for(let w=0;w<this.selectedRange.size();w+=1){this.highlight.useLayerLevel(w);const p=this.highlight.createArea(),T=this.highlight.createLayeredArea(),H=this.highlight.createRowHeader(),z=this.highlight.createColumnHeader(),te=this.highlight.createActiveRowHeader(),we=this.highlight.createActiveColumnHeader(),Ie=this.highlight.createActiveCornerHeader(),De=this.highlight.createRowHighlight(),Le=this.highlight.createColumnHighlight();p.commit(),T.commit(),H.commit(),z.commit(),te.commit(),we.commit(),Ie.commit(),De.commit(),Le.commit()}this.highlight.useLayerLevel(a)}}(0,Be.mixin)(mf,At.Z);var Gc=mf,Au=f(49312);function Mh(u,i){var a;return u==="CELL_TYPE"?!1:((a=i._automaticallyAssignedMetaProps)===null||a===void 0?void 0:a.has(u))||!(0,Be.hasOwnProperty)(i,u)}function Sd(u,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u;const d=typeof i.type=="string"?(0,Au.DA)(i.type):i.type;if(u._automaticallyAssignedMetaProps&&(0,Be.objectEach)(i,(p,T)=>void u._automaticallyAssignedMetaProps.delete(T)),!(0,Be.isObject)(d))return;a===u&&!u._automaticallyAssignedMetaProps&&(u._automaticallyAssignedMetaProps=new Set);const w={};(0,Be.objectEach)(d,(p,T)=>{if(Mh(T,a)){var H;w[T]=p,(H=u._automaticallyAssignedMetaProps)===null||H===void 0||H.add(T)}}),(0,Be.extend)(u,w)}function pf(u){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function a(){}(0,Be.inherit)(a,u);for(let d=0;d<i.length;d++)a.prototype[i[d]]=void 0;return a}function Cc(u){return Number.isInteger(u)&&u>=0}function bm(u,i){if(!u())throw new Error(`Assertion failed: ${i}`)}function vf(u){return u==null}var lC=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(u){let i,a,d;for(i=0,a=this.countRows();i<a;i++)if(d=this.getDataAtCell(i,u),(0,q.isEmpty)(d)===!1)return!1;return!0},isEmptyRow(u){let i,a,d,w;for(i=0,a=this.countCols();i<a;i++)if(d=this.getDataAtCell(u,i),(0,q.isEmpty)(d)===!1)return typeof d=="object"?(w=this.getCellMeta(u,i),(0,Be.isObjectEqual)(this.getSchema()[w.prop],d)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function uC(u,i,a){return(i=Ty(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Ty(u){var i=My(u,"string");return typeof i=="symbol"?i:i+""}function My(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function cC(){return class{}}class Op{constructor(i){uC(this,"metaCtor",cC()),uC(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,Be.extend)(this.meta,lC()),this.meta.instance=i}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(i){var a;(0,Be.extend)(this.meta,i),Sd(this.meta,Gl(hi({},i),{type:(a=i.type)!==null&&a!==void 0?a:this.meta.type}),i)}}function ii(u,i,a){return(i=Oy(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Oy(u){var i=Iy(u,"string");return typeof i=="symbol"?i:i+""}function Iy(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Py{constructor(i){ii(this,"meta",void 0);const a=i.getMetaConstructor();this.meta=new a}getMeta(){return this.meta}updateMeta(i){(0,Be.extend)(this.meta,i),Sd(this.meta,i,i)}}function Em(u,i,a){return(i=xy(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function xy(u){var i=Oh(u,"string");return typeof i=="symbol"?i:i+""}function Oh(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Nu{constructor(i){Em(this,"valueFactory",void 0),Em(this,"data",[]),Em(this,"index",[]),Em(this,"holes",new Set),this.valueFactory=i}obtain(i){bm(()=>Cc(i),"Expecting an unsigned number.");const a=this._getStorageIndexByKey(i);let d;if(a>=0)d=this.data[a],d===void 0&&(d=this.valueFactory(i),this.data[a]=d);else if(d=this.valueFactory(i),this.holes.size>0){const w=this.holes.values().next().value;this.holes.delete(w),this.data[w]=d,this.index[i]=w}else this.data.push(d),this.index[i]=this.data.length-1;return d}insert(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;bm(()=>Cc(i)||vf(i),"Expecting an unsigned number or null/undefined argument.");const d=[],w=this.data.length;for(let T=0;T<a;T++)d.push(w+T),this.data.push(void 0);const p=vf(i)?this.index.length:i;this.index=[...this.index.slice(0,p),...d,...this.index.slice(p)]}remove(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;bm(()=>Cc(i)||vf(i),"Expecting an unsigned number or null/undefined argument.");const d=this.index.splice(vf(i)?this.index.length-a:i,a);for(let w=0;w<d.length;w++){const p=d[w];typeof p=="number"&&this.holes.add(p)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((i,a)=>i!==void 0&&!this.holes.has(a))[Symbol.iterator]()}entries(){const i=[];for(let d=0;d<this.data.length;d++){const w=this._getKeyByStorageIndex(d);w!==-1&&this.data[d]!==void 0&&i.push([w,this.data[d]])}let a=0;return{next:()=>{if(a<i.length){const d=i[a];return a+=1,{value:d,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(i){return this.index.length>i?this.index[i]:-1}_getKeyByStorageIndex(i){return this.index.indexOf(i)}[Symbol.iterator](){return this.entries()}}function hC(u,i,a){return(i=dC(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function dC(u){var i=Rm(u,"string");return typeof i=="symbol"?i:i+""}function Rm(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}const dg=["data","width"];class Ay{constructor(i){hC(this,"globalMeta",void 0),hC(this,"metas",new Nu(()=>this._createMeta())),this.globalMeta=i,this.metas=new Nu(()=>this._createMeta())}updateMeta(i,a){const d=this.getMeta(i);(0,Be.extend)(d,a),Sd(d,a)}createColumn(i,a){this.metas.insert(i,a)}removeColumn(i,a){this.metas.remove(i,a)}getMeta(i){return this.metas.obtain(i)}getMetaConstructor(i){return this.metas.obtain(i).constructor}clearCache(){this.metas.clear()}_createMeta(){return pf(this.globalMeta.getMetaConstructor(),dg).prototype}}function fC(u,i,a){return(i=Ny(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Ny(u){var i=Cf(u,"string");return typeof i=="symbol"?i:i+""}function Cf(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class gC{constructor(i){fC(this,"columnMeta",void 0),fC(this,"metas",new Nu(()=>this._createRow())),this.columnMeta=i}updateMeta(i,a,d){const w=this.getMeta(i,a);(0,Be.extend)(w,d),Sd(w,d)}createRow(i,a){this.metas.insert(i,a)}createColumn(i,a){for(let d=0;d<this.metas.size();d++)this.metas.obtain(d).insert(i,a)}removeRow(i,a){this.metas.remove(i,a)}removeColumn(i,a){for(let d=0;d<this.metas.size();d++)this.metas.obtain(d).remove(i,a)}getMeta(i,a,d){const w=this.metas.obtain(i).obtain(a);return d===void 0?w:w[d]}setMeta(i,a,d,w){var p;const T=this.metas.obtain(i).obtain(a);(p=T._automaticallyAssignedMetaProps)===null||p===void 0||p.delete(d),T[d]=w}removeMeta(i,a,d){const w=this.metas.obtain(i).obtain(a);delete w[d]}getMetas(){const i=[],a=Array.from(this.metas.values());for(let d=0;d<a.length;d++)(0,q.isDefined)(a[d])&&i.push(...a[d].values());return i}getMetasAtRow(i){bm(()=>Cc(i),"Expecting an unsigned number.");const a=new Map(this.metas);return a.has(i)?Array.from(a.get(i).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Nu(i=>this._createMeta(i))}_createMeta(i){const a=this.columnMeta.getMetaConstructor(i);return new a}}class Ip{constructor(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=i,this.globalMeta=new Op(i),this.tableMeta=new Py(this.globalMeta),this.columnMeta=new Ay(this.globalMeta),this.cellMeta=new gC(this.columnMeta),d.forEach(w=>new w(this)),this.globalMeta.updateMeta(a)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(i){this.globalMeta.updateMeta(i)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(i){this.tableMeta.updateMeta(i)}getColumnMeta(i){return this.columnMeta.getMeta(i)}updateColumnMeta(i,a){this.columnMeta.updateMeta(i,a)}getCellMeta(i,a,d){const w=this.cellMeta.getMeta(i,a);return w.visualRow=d.visualRow,w.visualCol=d.visualColumn,w.row=i,w.col=a,d.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",w),w}getCellMetaKeyValue(i,a,d){if(typeof d!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(i,a,d)}setCellMeta(i,a,d,w){this.cellMeta.setMeta(i,a,d,w)}updateCellMeta(i,a,d){this.cellMeta.updateMeta(i,a,d)}removeCellMeta(i,a,d){this.cellMeta.removeMeta(i,a,d)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(i){return this.cellMeta.getMetasAtRow(i)}createRow(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(i,a)}removeRow(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(i,a)}createColumn(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(i,a),this.columnMeta.createColumn(i,a)}removeColumn(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(i,a),this.columnMeta.removeColumn(i,a)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,Be.mixin)(Ip,At.Z);function mC(u,i,a){return(i=pC(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function pC(u){var i=$c(u,"string");return typeof i=="symbol"?i:i+""}function $c(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Jr{constructor(i){var a=this;mC(this,"metaManager",void 0),mC(this,"metaSyncMemo",new Map),this.metaManager=i,i.addLocalHook("afterGetCellMeta",function(){return a.extendCellMeta(...arguments)}),ko.P.getSingleton().add("beforeRender",d=>{d&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(i){var a;const{row:d,col:w}=i;if((a=this.metaSyncMemo.get(d))!==null&&a!==void 0&&a.has(w))return;const{visualRow:p,visualCol:T}=i,H=this.metaManager.hot,z=H.colToProp(T);i.prop=z,H.runHooks("beforeGetCellMeta",p,T,i);const te=(0,Be.hasOwnProperty)(i,"type")?i.type:null;let we=(0,V.isFunction)(i.cells)?i.cells(d,w,z):null;if(te)if(we){var Ie;we.type=(Ie=we.type)!==null&&Ie!==void 0?Ie:te}else we={type:te};we&&this.metaManager.updateCellMeta(d,w,we),H.runHooks("afterGetCellMeta",p,T,i),this.metaSyncMemo.has(d)||this.metaSyncMemo.set(d,new Set),this.metaSyncMemo.get(d).add(w)}}function hl(u,i,a){fg(u,i),i.set(u,a)}function fg(u,i){if(i.has(u))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pp(u,i,a){return(i=wc(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function wc(u){var i=wf(u,"string");return typeof i=="symbol"?i:i+""}function wf(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}function vC(u,i){return u.get(Tm(u,i))}function Tm(u,i,a){if(typeof u=="function"?u===i:u.has(i))return arguments.length<3?i:a;throw new TypeError("Private element is not present on this object")}var yf=new WeakMap;class Mm{constructor(i){Pp(this,"metaManager",void 0),Pp(this,"usageTracker",new Set),Pp(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(a){if(this.metaManager.hot.isRtl()&&a==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),hl(this,yf,(a,d,w)=>{if(!w)throw new Error(`The \`${a}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=i,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((i,a)=>{const{initOnly:d,target:w,onChange:p}=i,T=typeof w=="string",H=T?w:a,z=`_${H}`;this.metaManager.globalMeta.meta[z]=this.metaManager.globalMeta.meta[H],p?(this.installPropWatcher(a,z,p),T&&this.installPropWatcher(w,z,p)):d&&(this.installPropWatcher(a,z,vC(yf,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(a))})}installPropWatcher(i,a,d){const w=this;Object.defineProperty(this.metaManager.globalMeta.meta,i,{get(){return this[a]},set(p){const T=!w.usageTracker.has(i);w.usageTracker.add(i),d.call(w,i,p,T),this[a]=p},enumerable:!0,configurable:!0})}}var Vi=f(4338);function po(u,i,a){return(i=Om(i))in u?Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[i]=a,u}function Om(u){var i=gg(u,"string");return typeof i=="symbol"?i:i+""}function gg(u,i){if(typeof u!="object"||!u)return u;var a=u[Symbol.toPrimitive];if(a!==void 0){var d=a.call(u,i||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(u)}class Ih{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(i,a,d){po(this,"hot",void 0),po(this,"metaManager",void 0),po(this,"tableMeta",void 0),po(this,"dataSource",void 0),po(this,"duckSchema",void 0),po(this,"colToPropCache",void 0),po(this,"propToColCache",void 0),this.hot=i,this.metaManager=d,this.tableMeta=d.getTableMeta(),this.dataSource=a,this.refreshDuckSchema(),this.createMap()}createMap(){const i=this.getSchema();if(typeof i=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const a=this.tableMeta.columns;let d;if(this.colToPropCache=[],this.propToColCache=new Map,a){let w=0,p=0,T=!1;if(typeof a=="function"){const H=(0,Be.deepObjectSize)(i);w=H>0?H:this.countFirstRowKeys(),T=!0}else{const H=this.tableMeta.maxCols;w=Math.min(H,a.length)}for(d=0;d<w;d++){const H=T?a(d):a[d];if((0,Be.isObject)(H)){if(typeof H.data!="undefined"){const z=T?p:d;this.colToPropCache[z]=H.data,this.propToColCache.set(H.data,z)}p+=1}}}else this.recursiveDuckColumns(i)}countFirstRowKeys(){return(0,v.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(i,a,d){let w=a,p=d,T;return typeof w=="undefined"&&(w=0,p=""),typeof i=="object"&&!Array.isArray(i)&&(0,Be.objectEach)(i,(H,z)=>{H===null?(T=p+z,this.colToPropCache.push(T),this.propToColCache.set(T,w),w+=1):w=this.recursiveDuckColumns(H,w,`${z}.`)}),w}colToProp(i){if(Number.isInteger(i)===!1)return i;const a=this.hot.toPhysicalColumn(i);return a===null?i:this.colToPropCache&&(0,q.isDefined)(this.colToPropCache[a])?this.colToPropCache[a]:a}propToCol(i){const a=this.propToColCache.get(i);if((0,q.isDefined)(a))return this.hot.toVisualColumn(a);const d=this.hot.toVisualColumn(i);return d===null?i:d}getSchema(){const i=this.tableMeta.dataSchema;return i?typeof i=="function"?i():i:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,Be.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:d,mode:w="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const p=this.hot.countSourceRows();let T=p,H=0,z=i;if((typeof z!="number"||z>=p)&&(z=p),z<this.hot.countRows()&&(T=this.hot.toPhysicalRow(z)),this.hot.runHooks("beforeCreateRow",z,a,d)===!1||T===null)return{delta:0};const we=this.tableMeta.maxRows,Ie=this.getSchema().length,De=[];for(;H<a&&p+H<we;){let ut=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?ut=(0,Be.deepClone)(this.getSchema()):(ut=[],(0,pr.rangeEach)(Ie-1,()=>ut.push(null))):this.hot.dataType==="function"?ut=this.tableMeta.dataSchema(z+H):(ut={},(0,Be.deepExtend)(ut,this.getSchema())),De.push(ut),H+=1}this.hot.rowIndexMapper.insertIndexes(z,H),w==="below"&&(T=Math.min(T+1,p)),this.spliceData(T,0,De);const Le=this.hot.toVisualRow(T);return this.hot.countSourceRows()===De.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),H>0&&(i==null?this.metaManager.createRow(null,H):d!=="auto"&&this.metaManager.createRow(T,a)),this.hot.runHooks("afterCreateRow",Le,H,d),{delta:H,startPhysicalIndex:T}}createCol(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:d,mode:w="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const p=this.dataSource,T=this.tableMeta.maxCols,H=this.hot.countSourceCols();let z=i;if((typeof z!="number"||z>=H)&&(z=H),this.hot.runHooks("beforeCreateCol",z,a,d)===!1)return{delta:0};let we=H;z<this.hot.countCols()&&(we=this.hot.toPhysicalColumn(z));const Ie=this.hot.countSourceRows();let De=this.hot.countCols(),Le=0,ut=we;w==="end"&&(ut=Math.min(ut+1,H));const Bt=ut;for(;Le<a&&De<T;){if(typeof z!="number"||z>=De)if(Ie>0)for(let Mn=0;Mn<Ie;Mn+=1)typeof p[Mn]=="undefined"&&(p[Mn]=[]),p[Mn].push(null);else p.push([null]);else for(let Mn=0;Mn<Ie;Mn++)p[Mn].splice(ut,0,null);Le+=1,ut+=1,De+=1}this.hot.columnIndexMapper.insertIndexes(z,Le),Le>0&&(i==null?this.metaManager.createColumn(null,Le):d!=="auto"&&this.metaManager.createColumn(Bt,a));const zn=this.hot.toVisualColumn(Bt);return this.hot.runHooks("afterCreateCol",zn,Le,d),this.refreshDuckSchema(),{delta:Le,startPhysicalIndex:Bt}}removeRow(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,d=arguments.length>2?arguments[2]:void 0,w=Number.isInteger(i)?i:-a;const p=this.visualRowsToPhysical(w,a),T=this.hot.countSourceRows();if(w=(T+w)%T,this.hot.runHooks("beforeRemoveRow",w,p.length,p,d)===!1)return!1;const z=p.length;if(this.filterData(w,z,p),w<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(p);const we=(0,q.isDefined)(this.tableMeta.columns)||(0,q.isDefined)(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!we&&this.hot.columnIndexMapper.setIndexesSequence([])}return p.slice(0).sort((we,Ie)=>Ie-we).forEach(we=>{this.metaManager.removeRow(we,1)}),this.hot.runHooks("afterRemoveRow",w,z,p,d),!0}removeCol(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,d=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let w=typeof i!="number"?-a:i;w=(this.hot.countCols()+w)%this.hot.countCols();const p=this.visualColumnsToPhysical(w,a),T=p.slice(0).sort((Ie,De)=>De-Ie);if(this.hot.runHooks("beforeRemoveCol",w,a,p,d)===!1)return!1;let z=!0;const te=T.length,we=this.dataSource;for(let Ie=0;Ie<te;Ie++)z&&p[0]!==p[Ie]-Ie&&(z=!1);if(z)for(let Ie=0,De=this.hot.countSourceRows();Ie<De;Ie++)we[Ie].splice(p[0],a),Ie===0&&this.metaManager.removeColumn(p[0],a);else for(let Ie=0,De=this.hot.countSourceRows();Ie<De;Ie++)for(let Le=0;Le<te;Le++)we[Ie].splice(T[Le],1),Ie===0&&this.metaManager.removeColumn(T[Le],1);return w<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(p),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",w,a,p,d),this.refreshDuckSchema(),!0}spliceCol(i,a,d){const w=this.hot.getDataAtCol(i),p=w.slice(a,a+d),T=w.slice(a+d);for(var H=arguments.length,z=new Array(H>3?H-3:0),te=3;te<H;te++)z[te-3]=arguments[te];(0,mn.extendArray)(z,T);let we=0;for(;we<d;)z.push(null),we+=1;return(0,mn.to2dArray)(z),this.hot.populateFromArray(a,i,z,null,null,"spliceCol"),p}spliceRow(i,a,d){const w=this.hot.getSourceDataAtRow(i),p=w.slice(a,a+d),T=w.slice(a+d);for(var H=arguments.length,z=new Array(H>3?H-3:0),te=3;te<H;te++)z[te-3]=arguments[te];(0,mn.extendArray)(z,T);let we=0;for(;we<d;)z.push(null),we+=1;return this.hot.populateFromArray(i,a,[z],null,null,"spliceRow"),p}spliceData(i,a,d){if(this.hot.runHooks("beforeDataSplice",i,a,d)!==!1){const p=[...this.dataSource.slice(0,i),...d,...this.dataSource.slice(i)];this.dataSource.length=0,p.forEach(T=>this.dataSource.push(T))}}filterData(i,a,d){let w=this.hot.runHooks("filterData",i,a,d);Array.isArray(w)===!1&&(w=this.dataSource.filter((p,T)=>d.indexOf(T)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,w)}get(i,a){const d=this.hot.toPhysicalRow(i);let w=this.dataSource[d];const p=this.hot.runHooks("modifyRowData",d);w=isNaN(p)?p:w;const{dataDotNotation:T}=this.hot.getSettings();let H=null;if(w&&w.hasOwnProperty&&(0,Be.hasOwnProperty)(w,a))H=w[a];else if(T&&typeof a=="string"&&a.indexOf(".")>-1){let z=w;if(!z)return null;const te=a.split(".");for(let we=0,Ie=te.length;we<Ie;we++)if(z=z[te[we]],typeof z=="undefined")return null;H=z}else typeof a=="function"&&(H=a(this.dataSource.slice(d,d+1)[0]));if(this.hot.hasHook("modifyData")){const z=(0,Be.createObjectPropListener)(H);this.hot.runHooks("modifyData",d,this.propToCol(a),z,"get"),z.isTouched()&&(H=z.value)}return H}getCopyable(i,a){return this.hot.getCellMeta(i,this.propToCol(a)).copyable?this.get(i,a):""}set(i,a,d){const w=this.hot.toPhysicalRow(i);let p=d,T=this.dataSource[w];const H=this.hot.runHooks("modifyRowData",w);if(T=isNaN(H)?H:T,this.hot.hasHook("modifyData")){const te=(0,Be.createObjectPropListener)(p);this.hot.runHooks("modifyData",w,this.propToCol(a),te,"set"),te.isTouched()&&(p=te.value)}const{dataDotNotation:z}=this.hot.getSettings();if(T&&T.hasOwnProperty&&(0,Be.hasOwnProperty)(T,a))T[a]=p;else if(z&&typeof a=="string"&&a.indexOf(".")>-1){let te=T,we=0,Ie;const De=a.split(".");for(we=0,Ie=De.length-1;we<Ie;we++){if(De[we]==="__proto__"||De[we]==="constructor"||De[we]==="prototype")return;typeof te[De[we]]=="undefined"&&(te[De[we]]={}),te=te[De[we]]}te[De[we]]=p}else if(typeof a=="function")a(this.dataSource.slice(w,w+1)[0],p);else{if(a==="__proto__"||a==="constructor"||a==="prototype")return;T[a]=p}}visualRowsToPhysical(i,a){const d=this.hot.countSourceRows(),w=[];let p=(d+i)%d,T=a,H;for(;p<d&&T;)H=this.hot.toPhysicalRow(p),w.push(H),T-=1,p+=1;return w}visualColumnsToPhysical(i,a){const d=this.hot.countCols(),w=[];let p=(d+i)%d,T=a;for(;p<d&&T;){const H=this.hot.toPhysicalColumn(p);w.push(H),T-=1,p+=1}return w}clear(){for(let i=0;i<this.hot.countSourceRows();i++)for(let a=0;a<this.hot.countCols();a++)this.set(i,this.colToProp(a),"")}getLength(){const i=this.tableMeta.maxRows;let a;i<0||i===0?a=0:a=i||1/0;const d=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,a)}getAll(){const i={row:0,col:0},a={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return i.row-a.row===0&&!this.hot.countSourceRows()?[]:this.getRange(i,a,Ih.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(i,a,d){const w=[];let p,T,H;const z=this.tableMeta.maxRows,te=this.tableMeta.maxCols;if(z===0||te===0)return[];const we=d===Ih.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,Ie=Math.min(Math.max(z-1,0),Math.max(i.row,a.row)),De=Math.min(Math.max(te-1,0),Math.max(i.col,a.col));for(p=Math.min(i.row,a.row);p<=Ie;p++){H=[];const Le=p>=0?this.hot.toPhysicalRow(p):p;for(T=Math.min(i.col,a.col);T<=De&&Le!==null;T++)H.push(we.call(this,p,this.colToProp(T)));Le!==null&&w.push(H)}return w}getText(i,a){return(0,Vi.P)(this.getRange(i,a,Ih.DESTINATION_RENDERER))}getCopyableText(i,a){return(0,Vi.P)(this.getRange(i,a,Ih.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var mg=Ih;function Za(u,i,a,d){const{hotInstance:w,dataMap:p,dataSource:T,internalSource:H,source:z,metaManager:te,firstRun:we}=d,Ie=(0,Oi.toUpperCaseFirst)(H),De=w.getSettings();Array.isArray(De.dataSchema)?w.dataType="array":(0,V.isFunction)(De.dataSchema)?w.dataType="function":w.dataType="object",p&&p.destroy(),u=w.runHooks(`before${Ie}`,u,we,z);const Le=new mg(w,u,te);if(i(Le),typeof u=="object"&&u!==null)u.push&&u.splice||(u=[u]);else if(u===null){const ut=Le.getSchema();u=[];let Bt,zn=0,Mn=0;for(zn=0,Mn=De.startRows;zn<Mn;zn++)if((w.dataType==="object"||w.dataType==="function")&&De.dataSchema)Bt=(0,Be.deepClone)(ut),u.push(Bt);else if(w.dataType==="array")Bt=(0,Be.deepClone)(ut[0]),u.push(Bt);else{Bt=[];for(let _t=0,Ci=De.startCols;_t<Ci;_t++)Bt.push(null);u.push(Bt)}}else throw new Error(`${H} only accepts array of objects or array of arrays (${typeof u} given)`);Array.isArray(u[0])&&(w.dataType="array"),De.data=u,Le.dataSource=u,T.data=u,T.dataType=w.dataType,T.colToProp=Le.colToProp.bind(Le),T.propToCol=Le.propToCol.bind(Le),T.countCachedColumns=Le.countCachedColumns.bind(Le),a(Le),w.runHooks(`after${Ie}`,u,we,z),we||(w.runHooks("afterChange",null,H),w.render()),w.getSettings().ariaTags&&(0,I.setAttribute)(w.rootElement,[(0,x.a2)(-1),(0,x.Wv)(w.countCols()+(w.view?w.countRowHeaders():0))])}function _d(u){(0,I.isHTMLElement)(u)&&u.scrollIntoView({block:"nearest",inline:"nearest"})}function pg(u){const{selection:i,view:a}=u,d=u.getSelectedRangeLast(),w=i.getSelectionSource(),p=a.getFirstFullyVisibleColumn(),T=a.getLastFullyVisibleColumn(),H=d.getTopStartCorner().col,z=d.getBottomEndCorner().col,te=H<=p,we=z>=T,Ie=a.getFirstFullyVisibleRow(),De=a.getLastFullyVisibleRow(),Le=d.getTopStartCorner().row,ut=d.getBottomEndCorner().row,Bt=Le<=Ie,zn=ut>=De;return{getComputedColumnTarget(Mn){return w==="mouse"||w==="keyboard"?Mn.col:te&&we?d.highlight.col:te?H:we?z:Mn.col},getComputedRowTarget(Mn){return w==="mouse"||w==="keyboard"?Mn.row:Bt&&zn?d.highlight.row:Bt?Le:zn?ut:Mn.row}}}function Dy(u){return i=>{const a=pg(u).getComputedColumnTarget(i);u.scrollViewportTo({col:a},()=>{const d=!!u.getSettings().colHeaders;_d(u.getCell(d?-1:0,a,!0))})}}function Hy(){return()=>{}}function Ly(u){return i=>{u.scrollViewportTo(i.toObject(),()=>{const{row:a,col:d}=u.getSelectedRangeLast().highlight;_d(u.getCell(a,d,!0))})}}function Fy(u){return i=>{const a=pg(u),d={row:a.getComputedRowTarget(i),col:a.getComputedColumnTarget(i)};u.scrollViewportTo(d,()=>{const{row:w,col:p}=d;_d(u.getCell(w,p,!0))})}}function Wy(u){return i=>{const a=pg(u),d={row:a.getComputedRowTarget(i),col:a.getComputedColumnTarget(i)};u.scrollViewportTo(d,()=>{const{row:w,col:p}=d;_d(u.getCell(w,p,!0))})}}function By(u){return i=>{const a=pg(u).getComputedRowTarget(i);u.scrollViewportTo({row:a},()=>{const d=!!u.getSettings().rowHeaders;_d(u.getCell(a,d?-1:0,!0))})}}function ky(u){return i=>{const a=u.selection.getSelectionSource(),{row:d,col:w}=i,p=()=>{_d(u.getCell(d,w,!0))};if(d<0&&w>=0)u.scrollViewportTo({col:w},p);else if(w<0&&d>=0)u.scrollViewportTo({row:d},p);else{if(a==="mouse"&&(w===u.view.getLastPartiallyVisibleColumn()||d===u.view.getLastPartiallyVisibleRow()))return;u.scrollViewportTo({row:d,col:w},p)}}}function CC(u){const{selection:i}=u;let a=!1,d=!1;return{resume(){d=!1},suspend(){d=!0},skipNextScrollCycle(){a=!0},scrollTo(w){var p;if(a||d){a=!1;return}let T;i.isFocusSelectionChanged()?T=Ly(u):i.isSelectedByCorner()?T=Hy(u):i.isSelectedByRowHeader()?T=By(u):i.isSelectedByColumnHeader()?T=Dy(u):i.getSelectedRange().size()===1&&i.isMultiple()?T=Fy(u):i.getSelectedRange().size()===1&&!i.isMultiple()?T=ky(u):i.getSelectedRange().size()>1&&(T=Wy(u)),(p=T)===null||p===void 0||p(w)}}}var Im=f(95188);function xp(u){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=u.rootElement,d=Vy(u),w=Vy(u);return d.addEventListener("focus",()=>i==null?void 0:i.onFocusFromTop()),w.addEventListener("focus",()=>i==null?void 0:i.onFocusFromBottom()),a.firstChild.before(d),a.lastChild.after(w),{activate(){u._registerTimeout(()=>{d.tabIndex=0,w.tabIndex=0},10)},deactivate(){u._registerTimeout(()=>{d.tabIndex=-1,w.tabIndex=-1},10)}}}function Vy(u){const a=u.rootDocument.createElement("input");return a.type="text",a.name="__htFocusCatcher",a.classList.add("htFocusCatcher"),u.getSettings().ariaTags&&(0,I.setAttribute)(a,[(0,x.QK)("Focus catcher")]),a}function Ap(u){const i=wC(u);let a;const{activate:d,deactivate:w}=xp(u,{onFocusFromTop(){var Ie;const De=(Ie=i(a))!==null&&Ie!==void 0?Ie:Np(u);De&&(u.runHooks("modifyFocusOnTabNavigation","from_above",De),u.selectCell(De.row,De.col)),u.listen()},onFocusFromBottom(){var Ie;const De=(Ie=i(a))!==null&&Ie!==void 0?Ie:Ph(u);De&&(u.runHooks("modifyFocusOnTabNavigation","from_below",De),u.selectCell(De.row,De.col)),u.listen()}}),p={wrapped:!1,flipped:!1};let T=!0,H=!1,z=!1;u.addHook("afterListen",()=>w()),u.addHook("afterUnlisten",()=>d()),u.addHook("afterSelection",(Ie,De,Le,ut,Bt)=>{if(H&&(p.wrapped&&p.flipped||z)&&(z=!1,Bt.value=!0),T){var zn;a=(zn=u.getSelectedRangeLast())===null||zn===void 0?void 0:zn.highlight}}),u.addHook("beforeRowWrap",(Ie,De,Le)=>{p.wrapped=!0,p.flipped=Le});function te(){p.wrapped=!1,p.flipped=!1,u.deselectCell(),u.unlisten()}const we={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Im.W,group:"focusCatcher"};u.getShortcutManager().getContext("grid").addShortcuts([Gl(hi({},we),{callback:()=>{const{tabNavigation:Ie}=u.getSettings();H=!0,u.getSelectedRangeLast()&&!Ie&&(T=!1),Ie||(z=!0)},position:"before"}),Gl(hi({},we),{callback:Ie=>{const{tabNavigation:De,autoWrapRow:Le}=u.getSettings();if(H=!1,T=!0,!De||!u.selection.isSelected()||Le&&p.wrapped&&p.flipped||!Le&&p.wrapped)return Le&&p.wrapped&&p.flipped&&(a=Ie.shiftKey?Np(u):Ph(u)),te(),!1;Ie.preventDefault()},position:"after"})])}function Np(u){const{rowIndexMapper:i,columnIndexMapper:a}=u,{navigableHeaders:d}=u.getSettings();let w=d&&u.countColHeaders()>0?-u.countColHeaders():0,p=d&&u.countRowHeaders()>0?-u.countRowHeaders():0;return w===0&&(w=i.getVisualFromRenderableIndex(w)),p===0&&(p=a.getVisualFromRenderableIndex(p)),w===null||p===null?null:u._createCellCoords(w,p)}function Ph(u){var i,a;const{rowIndexMapper:d,columnIndexMapper:w}=u,{navigableHeaders:p}=u.getSettings();let T=d.getRenderableIndexesLength()-1,H=w.getRenderableIndexesLength()-1;if(T<0){if(!p||u.countColHeaders()===0)return null;T=-1}if(H<0){if(!p||u.countColHeaders()===0)return null;H=-1}return u._createCellCoords((i=d.getVisualFromRenderableIndex(T))!==null&&i!==void 0?i:T,(a=w.getVisualFromRenderableIndex(H))!==null&&a!==void 0?a:H)}function wC(u){return i=>{if(!i)return null;const a=Np(u),d=Ph(u);return i.col<a.col&&(i.col=a.col),i.col>d.col&&(i.col=d.col),i.row<a.row&&(i.row=a.row),i.row>d.row&&(i.row=d.row),i}}var Pm=f(98407);const jl=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),vg=u=>u.map(i=>{const a=i.toLowerCase();return jl.has(a)?jl.get(a):a}).sort().join("+"),xm=u=>u.split("+"),yC=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),bd=u=>{let{which:i,key:a}=u;if(yC.has(i))return yC.get(i);const d=String.fromCharCode(i).toLowerCase();return/^[a-z0-9]$/.test(d)?d:a.toLowerCase()},Am=Symbol("shortcut-context");function Sf(u){return(0,Be.isObject)(u)&&u.__kindOf===Am}const SC=u=>{const i=(0,Pm.I)({errorIdExists:z=>`The "${z}" shortcut is already registered in the "${u}" context.`}),a=function(){let{keys:z,callback:te,group:we,runOnlyIf:Ie=()=>!0,captureCtrl:De=!1,preventDefault:Le=!0,stopPropagation:ut=!1,relativeToGroup:Bt,position:zn,forwardToContext:Mn}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if((0,q.isUndefined)(we))throw new Error("You need to define the shortcut's group.");if((0,V.isFunction)(te)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(z)===!1)throw new Error((0,Tt.e)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _t={callback:te,group:we,runOnlyIf:Ie,captureCtrl:De,preventDefault:Le,stopPropagation:ut};(0,q.isDefined)(Bt)&&(_t.relativeToGroup=Bt,_t.position=zn),Sf(Mn)&&(_t.forwardToContext=Mn),z.forEach(Ci=>{const mi=vg(Ci);if(i.hasItem(mi)){const si=i.getItem(mi);let Ti=si.findIndex(Qa=>Qa.group===Bt);Ti!==-1?zn==="before"?Ti-=1:Ti+=1:Ti=si.length,si.splice(Ti,0,_t)}else i.addItem(mi,[_t])})},d=function(z){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};z.forEach(we=>{(0,Be.objectEach)(te,(Ie,De)=>{Object.prototype.hasOwnProperty.call(we,De)===!1&&(we[De]=te[De])}),a(we)})},w=z=>{const te=vg(z);i.removeItem(te)};return{__kindOf:Am,addShortcut:a,addShortcuts:d,getShortcuts:z=>{const te=vg(z),we=i.getItem(te);return(0,q.isDefined)(we)?we.slice():[]},hasShortcut:z=>{const te=vg(z);return i.hasItem(te)},removeShortcutsByKeys:w,removeShortcutsByGroup:z=>{i.getItems().forEach(we=>{let[Ie,De]=we;const Le=De.filter(ut=>ut.group!==z);Le.length===0?w(xm(Ie)):(De.length=0,De.push(...Le))})}}};function Cg(){const u=new Set;return{press(i){u.add(i)},release(i){u.delete(i)},releaseAll(){u.clear()},isPressed(i){return u.has(i)}}}const Dp=["meta","alt","shift","control"],xh=Cg(),wg=[];let Xc=0;function _f(u,i,a,d,w){const p=Le=>Dp.includes(Le),T=function(Le){let ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const Bt=[];return Le.altKey&&Bt.push("alt"),ut&&(Le.ctrlKey||Le.metaKey)?Bt.push("control/meta"):(Le.ctrlKey&&Bt.push("control"),Le.metaKey&&Bt.push("meta")),Le.shiftKey&&Bt.push("shift"),Bt},H=Le=>{if(i(Le)===!1||a(Le)===!1||Le.keyCode===229||typeof Le.key!="string"||(0,ve.isImmediatePropagationStopped)(Le))return;const Bt=bd(Le);let zn=[];p(Bt)||(zn=T(Le));const Mn=[Bt].concat(zn);!w(Le,Mn)&&((0,de.isMacOS)()&&zn.includes("meta")||!(0,de.isMacOS)()&&zn.includes("control"))&&w(Le,[Bt].concat(T(Le,!0))),d(Le)},z=Le=>{if(typeof Le.key=="string"){const ut=bd(Le);p(ut)&&xh.press(ut)}},te=Le=>{if(typeof Le.key=="string"){const ut=bd(Le);p(ut)&&xh.release(ut)}},we=()=>{xh.releaseAll()};return{mount:()=>{let Le=u;for(Xc+=1;Le;)Xc===1&&(Le.document.documentElement.addEventListener("keydown",z),wg.push({event:"keydown",listener:z}),Le.document.documentElement.addEventListener("keyup",te),wg.push({event:"keyup",listener:te})),Le.document.documentElement.addEventListener("keydown",H),Le.document.documentElement.addEventListener("blur",we),Le=(0,I.getParentWindow)(Le)},unmount:()=>{let Le=u;for(Xc-=1;Le;){if(Xc===0){for(let ut=0;ut<wg.length;ut++){const{event:Bt,listener:zn}=wg[ut];Le.document.documentElement.removeEventListener(Bt,zn)}wg.length=0}Le.document.documentElement.removeEventListener("keydown",H),Le.document.documentElement.removeEventListener("blur",we),Le=(0,I.getParentWindow)(Le)}},isPressed:Le=>xh.isPressed(Le),releasePressedKeys:()=>xh.releaseAll()}}const jy=u=>{let{ownerWindow:i,handleEvent:a,beforeKeyDown:d,afterKeyDown:w}=u;const p=(0,Pm.I)({errorIdExists:ut=>`The "${ut}" context name is already registered.`});let T="grid";const H=ut=>{const Bt=SC(ut);return p.addItem(ut,Bt),Bt},z=()=>T,te=ut=>p.getItem(ut),we=ut=>{if(!p.hasItem(ut))throw new Error((0,Tt.e)`You've tried to activate the "${ut}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);T=ut};let Ie=!1;const De=function(ut,Bt){let zn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:z();const Mn=Sf(zn)?zn:te(zn);let _t=!1;if(!Mn.hasShortcut(Bt))return _t;const Ci=Mn.getShortcuts(Bt);for(let mi=0;mi<Ci.length;mi++){const{callback:ss,runOnlyIf:si,preventDefault:Ti,stopPropagation:Qa,captureCtrl:Kr,forwardToContext:Du}=Ci[mi];if(si(ut)===!0){if(Ie=Kr,_t=ss(ut,Bt)===!1,Ie=!1,Ti&&ut.preventDefault(),Qa&&((0,ve.stopImmediatePropagation)(ut),ut.stopPropagation()),_t)break;Du&&De(ut,Bt,Du)}}return _t},Le=_f(i,a,d,w,De);return Le.mount(),{addContext:H,getActiveContextName:z,getContext:te,setActiveContextName:we,isCtrlPressed:()=>!Ie&&(Le.isPressed("control")||Le.isPressed("meta")),releasePressedKeys:()=>Le.releasePressedKeys(),destroy:()=>Le.unmount()}},yc={name:"editorCloseAndSave",callback(u){u._getEditorManager().closeEditorAndSaveChanges()}};var _C=f(78848);const yg={name:"editorCloseAndSaveByArrowKeys",callback(u,i,a){const d=u._getEditorManager(),w=d.getActiveEditor();w.isInFullEditMode()&&w.state===_C.ed.EDITING||(d.closeEditorAndSaveChanges(),u.getSelected()&&(a.includes("arrowdown")?u.selection.transformStart(1,0):a.includes("arrowup")?u.selection.transformStart(-1,0):a.includes("arrowleft")?u.selection.transformStart(0,-1*u.getDirectionFactor()):a.includes("arrowright")&&u.selection.transformStart(0,u.getDirectionFactor())),i.preventDefault())}},Uy={name:"editorCloseAndSaveByEnter",callback(u,i){const a=u._getEditorManager();a.closeEditorAndSaveChanges(i.ctrlKey||i.metaKey),a.moveSelectionAfterEnter(i)}},Nm={name:"editorCloseWithoutSaving",callback(u){const i=u._getEditorManager();i.closeEditorAndRestoreOriginalValue(u.getShortcutManager().isCtrlPressed()),i.activeEditor.focus()}},zy={name:"editorFastOpen",callback(u,i){const{highlight:a}=u.getSelectedRangeLast();a.isHeader()||u._getEditorManager().openEditor(null,i,!0)}},Sg={name:"editorOpen",callback(u,i,a){const d=u._getEditorManager(),w=u.getSelectedRangeLast(),{highlight:p}=w;if(u.selection.isMultiple()&&!w.isHeader()&&u.countRenderedCols()>0&&u.countRenderedRows()>0){const T=u.getSettings(),H=typeof T.enterMoves=="function"?T.enterMoves(i):T.enterMoves;a.includes("shift")?u.selection.transformFocus(-H.row,-H.col):u.selection.transformFocus(H.row,H.col);return}p.isHeader()||(u.getSettings().enterBeginsEditing?d.cellProperties.readOnly?d.moveSelectionAfterEnter(i):d.openEditor(null,i,!0):d.moveSelectionAfterEnter(i),(0,ve.stopImmediatePropagation)(i))}};function Ky(){return[yc,yg,Uy,Nm,zy,Sg]}const Dm={name:"extendCellsSelectionDown",callback(u){const{selection:i}=u,{highlight:a}=u.getSelectedRangeLast();!i.isSelectedByColumnHeader()&&!i.isSelectedByCorner()&&(a.isCell()||a.isHeader()&&i.isSelectedByRowHeader())&&(i.markSource("keyboard"),i.transformEnd(1,0),i.markEndSource())}},Yy={name:"extendCellsSelectionDownByViewportHeight",callback(u){const{selection:i,rowIndexMapper:a}=u,{to:d}=u.getSelectedRangeLast(),w=Math.min(d.row+u.countVisibleRows(),u.countRows()-1),p=a.getNearestNotHiddenIndex(w,-1);if(p!==null){const T=u._createCellCoords(p,d.col),H=d.row-u.getFirstFullyVisibleRow(),z=Math.min(T.row-H,u.countRows()-1);i.markSource("keyboard"),i.setRangeEnd(T),i.markEndSource(),u.scrollViewportTo({row:z,verticalSnap:"top",horizontalSnap:"start"})}}},bC={name:"extendCellsSelectionLeft",callback(u){const{selection:i}=u,{highlight:a}=u.getSelectedRangeLast();!i.isSelectedByRowHeader()&&!i.isSelectedByCorner()&&(a.isCell()||a.isHeader()&&i.isSelectedByColumnHeader())&&(i.markSource("keyboard"),i.transformEnd(0,-1*u.getDirectionFactor()),i.markEndSource())}},EC={name:"extendCellsSelectionRight",callback(u){const{selection:i}=u,{highlight:a}=u.getSelectedRangeLast();!i.isSelectedByRowHeader()&&!i.isSelectedByCorner()&&(a.isCell()||a.isHeader()&&i.isSelectedByColumnHeader())&&(i.markSource("keyboard"),i.transformEnd(0,u.getDirectionFactor()),i.markEndSource())}},RC={name:"extendCellsSelectionToColumns",callback(u){const{selection:i}=u,{highlight:a,from:d,to:w}=u.getSelectedRangeLast();i.markSource("keyboard"),i.isSelectedByRowHeader()?i.selectAll(!0,!0):u.selectColumns(d.col,w.col,a),i.markEndSource()}},n_={name:"extendCellsSelectionToMostBottom",callback(u){const{selection:i,rowIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast(),T=d.isHeader()&&i.isSelectedByRowHeader();if(d.isCell()||T){const H=a.getNearestNotHiddenIndex(u.countRows()-1,-1),z=w.clone();z.row=d.row,i.markSource("keyboard"),i.setRangeStart(z,void 0,!1,d.clone()),T&&i.selectedByRowHeader.add(i.getLayerLevel()),i.setRangeEnd(u._createCellCoords(H,p.col)),i.markEndSource()}}},Ah={name:"extendCellsSelectionToMostInlineEnd",callback(u){const{selection:i,columnIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast();if(!i.isSelectedByRowHeader()&&!i.isSelectedByCorner()&&d.isCell()){const T=a.getNearestNotHiddenIndex(u.countCols()-1,-1),H=w.clone();H.col=d.col,i.markSource("keyboard"),i.setRangeStart(H,void 0,!1,d.clone()),i.setRangeEnd(u._createCellCoords(p.row,T)),i.markEndSource()}}},bf={name:"extendCellsSelectionToMostInlineStart",callback(u){const{selection:i,columnIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast();if(!i.isSelectedByRowHeader()&&!i.isSelectedByCorner()&&d.isCell()){const T=parseInt(u.getSettings().fixedColumnsStart,10),H=a.getNearestNotHiddenIndex(T,1),z=w.clone();z.col=d.col,i.markSource("keyboard"),i.setRangeStart(z,void 0,!1,d.clone()),i.setRangeEnd(u._createCellCoords(p.row,H)),i.markEndSource()}}},Gy={name:"extendCellsSelectionToMostLeft",callback(u){const{selection:i,columnIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast(),T=d.isHeader()&&i.isSelectedByColumnHeader();if(d.isCell()||T){const H=a.getNearestNotHiddenIndex(...u.isRtl()?[u.countCols()-1,-1]:[0,1]),z=w.clone();z.col=d.col,i.markSource("keyboard"),i.setRangeStart(z,void 0,!1,d.clone()),T&&i.selectedByColumnHeader.add(i.getLayerLevel()),i.setRangeEnd(u._createCellCoords(p.row,H)),i.markEndSource()}}},Hp={name:"extendCellsSelectionToMostRight",callback(u){const{selection:i,columnIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast(),T=d.isHeader()&&i.isSelectedByColumnHeader();if(d.isCell()||T){const H=a.getNearestNotHiddenIndex(...u.isRtl()?[0,1]:[u.countCols()-1,-1]),z=w.clone();z.col=d.col,i.markSource("keyboard"),i.setRangeStart(z,void 0,!1,d.clone()),T&&i.selectedByColumnHeader.add(i.getLayerLevel()),i.setRangeEnd(u._createCellCoords(p.row,H)),i.markEndSource()}}},$y={name:"extendCellsSelectionToMostTop",callback(u){const{selection:i,rowIndexMapper:a}=u,{highlight:d,from:w,to:p}=u.getSelectedRangeLast(),T=d.isHeader()&&i.isSelectedByRowHeader();if(d.isCell()||T){const H=a.getNearestNotHiddenIndex(0,1),z=w.clone();z.row=d.row,i.markSource("keyboard"),i.setRangeStart(z,void 0,!1,d.clone()),T&&i.selectedByRowHeader.add(i.getLayerLevel()),i.setRangeEnd(u._createCellCoords(H,p.col)),i.markEndSource()}}},Nh={name:"extendCellsSelectionToRows",callback(u){const{selection:i}=u,{highlight:a,from:d,to:w}=u.getSelectedRangeLast();i.markSource("keyboard"),i.isSelectedByColumnHeader()?i.selectAll(!0,!0):u.selectRows(d.row,w.row,a),i.markEndSource()}},TC={name:"extendCellsSelectionUp",callback(u){const{selection:i}=u,{highlight:a}=u.getSelectedRangeLast();!i.isSelectedByColumnHeader()&&!i.isSelectedByCorner()&&(a.isCell()||a.isHeader()&&i.isSelectedByRowHeader())&&(i.markSource("keyboard"),i.transformEnd(-1,0),i.markEndSource())}},Xy={name:"extendCellsSelectionUpByViewportHeight",callback(u){const{selection:i,rowIndexMapper:a}=u,{to:d}=u.getSelectedRangeLast(),w=Math.max(d.row-u.countVisibleRows(),0),p=a.getNearestNotHiddenIndex(w,1);if(p!==null){const T=u._createCellCoords(p,d.col),H=d.row-u.getFirstFullyVisibleRow(),z=Math.max(T.row-H,0);i.markSource("keyboard"),i.setRangeEnd(T),i.markEndSource(),u.scrollViewportTo({row:z,verticalSnap:"top",horizontalSnap:"start"})}}};function Dh(){return[Dm,Yy,bC,EC,RC,n_,Ah,bf,Gy,Hp,$y,Nh,TC,Xy]}const _g={name:"moveCellSelectionDown",callback(u){let{selection:i}=u;i.markSource("keyboard"),i.transformStart(1,0),i.markEndSource()}},Hm={name:"moveCellSelectionDownByViewportHeight",callback(u){const{selection:i}=u,{navigableHeaders:a}=u.getSettings(),d=a?u.countColHeaders():0,{row:w}=u.getSelectedRangeLast().highlight;let p=u.countVisibleRows()+d;p=p===0?1:p,w===u.countRows()-1?p=1:w+p>u.countRows()&&(p=u.countRows()-w-1),i.markSource("keyboard"),i.transformStart(p,0),i.markEndSource(),u.getSelectedRangeLast().highlight.row<0&&u.scrollViewportTo({row:0})}},zr={name:"moveCellSelectionInlineEnd",callback(u,i){const{selection:a}=u,d=u.getSettings(),w=u.getSelectedRangeLast(),p=typeof d.tabMoves=="function"?d.tabMoves(i):d.tabMoves;a.markSource("keyboard"),a.isMultiple()&&!w.isHeader()&&u.countRenderedCols()>0&&u.countRenderedRows()>0?a.transformFocus(-p.row,-p.col):a.transformStart(-p.row,-p.col),a.markEndSource()}},Lm={name:"moveCellSelectionInlineStart",callback(u,i){const{selection:a}=u,d=u.getSettings(),w=u.getSelectedRangeLast(),p=typeof d.tabMoves=="function"?d.tabMoves(i):d.tabMoves;a.markSource("keyboard"),a.isMultiple()&&!w.isHeader()&&u.countRenderedCols()>0&&u.countRenderedRows()>0?a.transformFocus(p.row,p.col):a.transformStart(p.row,p.col),a.markEndSource()}},Lp={name:"moveCellSelectionLeft",callback(u){const{selection:i}=u;i.markSource("keyboard"),i.transformStart(0,-1*u.getDirectionFactor()),i.markEndSource()}},Ja={name:"moveCellSelectionRight",callback(u){const{selection:i}=u;i.markSource("keyboard"),i.transformStart(0,u.getDirectionFactor()),i.markEndSource()}},Ha={name:"moveCellSelectionToMostBottom",callback(u){const{selection:i}=u,{col:a}=u.getSelectedRangeLast().highlight;let d=u.rowIndexMapper.getNearestNotHiddenIndex(u.countRows()-1,-1);d===null&&(d=-1),i.setRangeStart(u._createCellCoords(d,a))}},dl={name:"moveCellSelectionToMostBottomInlineEnd",callback(u){const{selection:i,rowIndexMapper:a,columnIndexMapper:d}=u,w=parseInt(u.getSettings().fixedRowsBottom,10),p=a.getNearestNotHiddenIndex(u.countRows()-w-1,-1),T=d.getNearestNotHiddenIndex(u.countCols()-1,-1);i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(p,T)),i.markEndSource()}},Fp={name:"moveCellSelectionToMostInlineEnd",callback(u){const{selection:i,columnIndexMapper:a}=u;i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(u.getSelectedRangeLast().highlight.row,a.getNearestNotHiddenIndex(u.countCols()-1,-1))),i.markEndSource()}},Ef={name:"moveCellSelectionToMostInlineStart",callback(u){const{selection:i,columnIndexMapper:a}=u,d=parseInt(u.getSettings().fixedColumnsStart,10),w=u.getSelectedRangeLast().highlight.row,p=a.getNearestNotHiddenIndex(d,1);i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(w,p)),i.markEndSource()}},Zy={name:"moveCellSelectionToMostLeft",callback(u){const{selection:i,columnIndexMapper:a}=u,d=u.getSelectedRangeLast().highlight.row;let w=a.getNearestNotHiddenIndex(...u.isRtl()?[u.countCols()-1,-1]:[0,1]);w===null&&(w=u.isRtl()?-1:-u.countRowHeaders()),i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(d,w)),i.markEndSource()}},Wp={name:"moveCellSelectionToMostRight",callback(u){const{selection:i,columnIndexMapper:a}=u,{row:d}=u.getSelectedRangeLast().highlight;let w=a.getNearestNotHiddenIndex(...u.isRtl()?[0,1]:[u.countCols()-1,-1]);w===null&&(w=u.isRtl()?-u.countRowHeaders():-1),i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(d,w)),i.markEndSource()}},Jy={name:"moveCellSelectionToMostTop",callback(u){const{selection:i}=u,{col:a}=u.getSelectedRangeLast().highlight;let d=u.rowIndexMapper.getNearestNotHiddenIndex(0,1);d===null&&(d=-u.countColHeaders()),i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(d,a)),i.markEndSource()}},Bp={name:"moveCellSelectionToMostTopInlineStart",callback(u){const{selection:i,rowIndexMapper:a,columnIndexMapper:d}=u,w=parseInt(u.getSettings().fixedRowsTop,10),p=parseInt(u.getSettings().fixedColumnsStart,10),T=a.getNearestNotHiddenIndex(w,1),H=d.getNearestNotHiddenIndex(p,1);i.markSource("keyboard"),i.setRangeStart(u._createCellCoords(T,H)),i.markEndSource()}},kp={name:"moveCellSelectionUp",callback(u){let{selection:i}=u;i.markSource("keyboard"),i.transformStart(-1,0),i.markEndSource()}},bg={name:"moveCellSelectionUpByViewportHight",callback(u){const{selection:i}=u,{navigableHeaders:a}=u.getSettings(),d=a?u.countColHeaders():0,{row:w}=u.getSelectedRangeLast().highlight;let p=u.countVisibleRows()+d;p=p===0?-1:-p,w===-d?p=-1:w+p<d&&(p=-(w+d)),i.markSource("keyboard"),i.transformStart(p,0),i.markEndSource(),u.getSelectedRangeLast().highlight.row<0&&u.scrollViewportTo({row:0})}};function MC(){return[_g,Hm,zr,Lm,Lp,Ja,Ha,dl,Fp,Ef,Zy,Wp,Jy,Bp,kp,bg]}const Vp={name:"emptySelectedCells",callback(u){u.emptySelectedCells(),u._getEditorManager().prepareEditor()}},Qy={name:"scrollToFocusedCell",callback(u){const{highlight:i}=u.getSelectedRangeLast(),a=u.getFirstFullyVisibleRow()-1,d=u.getFirstFullyVisibleColumn()-1,w=u.getLastFullyVisibleRow()+1,p=u.getLastFullyVisibleColumn()+1,T=u._createCellCoords(a,d),H=u._createCellCoords(w,p);if(!u._createCellRange(T,T,H).includes(i)&&(i.row>=0||i.col>=0)){const te={};if(i.col>=0){const we=Math.floor(u.countVisibleCols()/2);te.col=Math.max(i.col-we,0)}if(i.row>=0){const we=Math.floor(u.countVisibleRows()/2);te.row=Math.max(i.row-we,0)}u.scrollViewportTo(Gl(hi({},te),{verticalSnap:"top",horizontalSnap:"start"}))}}},jp={name:"selectAllCells",callback(u){let{selection:i}=u;i.markSource("keyboard"),i.selectAll(!0,!0,{disableHeadersHighlight:!0}),i.markEndSource()}},qy={name:"selectAllCellsAndHeaders",callback(u){let{selection:i}=u;i.markSource("keyboard"),i.selectAll(!0,!0,{disableHeadersHighlight:!1}),i.markEndSource()}},Up={name:"populateSelectedCellsData",callback(u){const i=u.getSelectedRange(),{row:a,col:d}=i[i.length-1].highlight.normalize(),w=u.getDataAtCell(a,d),p=new Map;for(let T=0;T<i.length;T++)i[T].forAll((H,z)=>{if(H>=0&&z>=0&&(H!==a||z!==d)){const{readOnly:te}=u.getCellMeta(H,z);te||p.set(`${H}x${z}`,[H,z,w])}});u.setDataAtCell(Array.from(p.values()))}},OC=[...Ky(),...Dh(),...MC(),Vp,Qy,jp,qy,Up];function Fm(u){const i={};return OC.forEach(a=>{let{name:d,callback:w}=a;i[d]=function(){for(var p=arguments.length,T=new Array(p),H=0;H<p;H++)T[H]=arguments[H];return w(u,...T)}}),i}function e0(u){const i=u.getShortcutManager().addContext("editor"),a=Fm(u),d={group:Im.I};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(w,p)=>a.editorCloseAndSaveByEnter(w,p)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(w,p)=>a.editorCloseAndSaveByEnter(w,p)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:u.getShortcutManager().getContext("grid"),callback:(w,p)=>a.editorCloseAndSave(w,p)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(w,p)=>a.editorCloseAndSaveByArrowKeys(w,p)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>a.editorCloseWithoutSaving()}],d)}function Rf(u){const i=u.getShortcutManager().addContext("grid"),a=Fm(u),d={runOnlyIf:()=>{const{navigableHeaders:w}=u.getSettings();return(0,q.isDefined)(u.getSelected())&&(w||!w&&u.countRenderedRows()>0&&u.countRenderedCols()>0)},group:Im.W};i.addShortcuts([{keys:[["F2"]],callback:w=>a.editorFastOpen(w)},{keys:[["Enter"],["Enter","Shift"]],callback:(w,p)=>a.editorOpen(w,p)},{keys:[["Backspace"],["Delete"]],callback:()=>a.emptySelectedCells()}],{group:Im.I,runOnlyIf:()=>(0,q.isDefined)(u.getSelected())}),i.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>a.selectAllCells(),runOnlyIf:()=>{var w;return!((w=u.getSelectedRangeLast())!==null&&w!==void 0&&w.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var w;return(w=u.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>a.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>a.populateSelectedCellsData(),runOnlyIf:()=>{var w,p;return!((w=u.getSelectedRangeLast())!==null&&w!==void 0&&w.highlight.isHeader())&&((p=u.getSelectedRangeLast())===null||p===void 0?void 0:p.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>a.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>a.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>a.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>a.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>a.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(u.selection.isSelectedByCorner()||u.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>a.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>a.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>a.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(u.selection.isSelectedByCorner()||u.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>a.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>a.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>a.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(u.selection.isSelectedByCorner()||u.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>a.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>a.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>a.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(u.selection.isSelectedByCorner()||u.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>u.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>a.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>u.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>u.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>a.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>a.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>u.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>a.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>a.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>a.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>a.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:w=>a.moveCellSelectionInlineStart(w)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:w=>a.moveCellSelectionInlineEnd(w)},{keys:[["Control/Meta","Backspace"]],callback:()=>a.scrollToFocusedCell()}],d)}function IC(u){[Rf,e0].forEach(i=>i(u))}function PC(u){const{classNames:i}=(0,I.findFirstParentWithClass)(u,/ht-theme-[a-zA-Z0-9_-]+/);return i.pop()}let Wm=null;const Eg=new Map,xC=new Set;function zp(u,i){var a,d=this;let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=this;const T=new Se.Z(p);let H,z,te,we,Ie,De,Le=!0;md(w)&&dc(this),this.rootElement=u,this.rootDocument=u.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const ut=(a=i==null?void 0:i.layoutDirection)!==null&&a!==void 0?a:"inherit",Bt=["rtl","ltr"].includes(ut)?ut:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",Bt),this.isRtl=function(){return Bt==="rtl"},this.isLtr=function(){return!p.isRtl()},this.getDirectionFactor=function(){return p.isLtr()?1:-1},i.language=su(i.language);const zn=Object.fromEntries(Object.entries(i).filter(U=>{let[ne]=U;return!(ko.P.getSingleton().isRegistered(ne)||ko.P.getSingleton().isDeprecated(ne))})),Mn=new Ip(p,zn,[Jr,Mm]),_t=Mn.getTableMeta(),Ci=Mn.getGlobalMeta(),mi=(0,Pm.I)();this.container=this.rootDocument.createElement("div"),u.insertBefore(this.container,u.firstChild),Wc(this)&&((0,q._injectProductInfo)(i.licenseKey,u),(0,I.addClass)(u,"ht-wrapper")),this.guid=`ht_${(0,Oi.randomString)()}`,Eg.set(this.guid,this),this.columnIndexMapper=new kl,this.rowIndexMapper=new kl,this.columnIndexMapper.addLocalHook("indexesSequenceChange",U=>{p.runHooks("afterColumnSequenceChange",U)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",U=>{p.runHooks("afterRowSequenceChange",U)}),T.addEventListener(this.rootDocument.documentElement,"compositionstart",U=>{p.runHooks("beforeCompositionStart",U)}),z=new m(p),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const ss=U=>{const{row:ne,col:me}=U;return p._createCellCoords(ne>=0?p.rowIndexMapper.getRenderableFromVisualIndex(ne):ne,me>=0?p.columnIndexMapper.getRenderableFromVisualIndex(me):me)},si=U=>{const{row:ne,col:me}=U;return p._createCellCoords(ne>=0?p.rowIndexMapper.getVisualFromRenderableIndex(ne):ne,me>=0?p.columnIndexMapper.getVisualFromRenderableIndex(me):me)},Ti=(U,ne)=>{const me=ne>U?1:-1,$e=Math.min(U,ne),it=Math.max(U,ne),vt=p.rowIndexMapper.getNearestNotHiddenIndex(U,me);return vt===null||me===1&&vt>it||me===-1&&vt<$e?null:vt>=0?p.rowIndexMapper.getRenderableFromVisualIndex(vt):vt},Qa=(U,ne)=>{const me=ne>U?1:-1,$e=Math.min(U,ne),it=Math.max(U,ne),vt=p.columnIndexMapper.getNearestNotHiddenIndex(U,me);return vt===null||me===1&&vt>it||me===-1&&vt<$e?null:vt>=0?p.columnIndexMapper.getRenderableFromVisualIndex(vt):vt};let Kr=new Gc(_t,{rowIndexMapper:p.rowIndexMapper,columnIndexMapper:p.columnIndexMapper,countCols:()=>p.countCols(),countRows:()=>p.countRows(),propToCol:U=>H.propToCol(U),isEditorOpened:()=>p.getActiveEditor()?p.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return d.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return d.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>p.getShortcutManager(),createCellCoords:(U,ne)=>p._createCellCoords(U,ne),createCellRange:(U,ne,me)=>p._createCellRange(U,ne,me),visualToRenderableCoords:ss,renderableToVisualCoords:si,findFirstNonHiddenRenderableRow:Ti,findFirstNonHiddenRenderableColumn:Qa,isDisabledCellSelection:(U,ne)=>U<0||ne<0?p.getSettings().disableVisualSelection:p.getCellMeta(U,ne).disableVisualSelection});this.selection=Kr;const Du=U=>{let{hiddenIndexesChanged:ne}=U;this.forceFullRender=!0,ne&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Du),this.rowIndexMapper.addLocalHook("cacheUpdated",Du),this.selection.addLocalHook("afterSetRangeEnd",(U,ne)=>{const me=(0,Be.createObjectPropListener)(!1),$e=this.selection.getSelectedRange(),{from:it,to:vt}=$e.current(),qt=$e.size()-1;this.runHooks("afterSelection",it.row,it.col,vt.row,vt.col,me,qt),this.runHooks("afterSelectionByProp",it.row,p.colToProp(it.col),vt.row,p.colToProp(vt.col),me,qt),ne&&(!me.isTouched()||me.isTouched()&&!me.value)&&De.scrollTo(U);const sn=Kr.isSelectedByRowHeader(),nr=Kr.isSelectedByColumnHeader();sn&&nr?(0,I.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):sn?((0,I.removeClass)(this.rootElement,"ht__selection--columns"),(0,I.addClass)(this.rootElement,"ht__selection--rows")):nr?((0,I.removeClass)(this.rootElement,"ht__selection--rows"),(0,I.addClass)(this.rootElement,"ht__selection--columns")):(0,I.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),Kr.getSelectionSource()!=="shift"&&we.closeEditor(null),p.view.render(),we.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",U=>{this.runHooks("beforeSelectionFocusSet",U.row,U.col)}),this.selection.addLocalHook("afterSetFocus",U=>{const ne=(0,Be.createObjectPropListener)(!1);this.runHooks("afterSelectionFocusSet",U.row,U.col,ne),(!ne.isTouched()||ne.isTouched()&&!ne.value)&&De.scrollTo(U),we.closeEditor(),p.view.render(),we.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",U=>{const ne=U.length-1,{from:me,to:$e}=U[ne];this.runHooks("afterSelectionEnd",me.row,me.col,$e.row,$e.col,ne),this.runHooks("afterSelectionEndByProp",me.row,p.colToProp(me.col),$e.row,p.colToProp($e.col),ne)}),this.selection.addLocalHook("afterIsMultipleSelection",U=>{const ne=this.runHooks("afterIsMultipleSelection",U.value);U.value&&(U.value=ne)}),this.selection.addLocalHook("afterDeselect",()=>{we.closeEditor(),p.view.render(),(0,I.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeSetRangeStart",...ne)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeSetRangeStartOnly",...ne)}).addLocalHook("beforeSetRangeEnd",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeSetRangeEnd",...ne)}).addLocalHook("beforeSelectColumns",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeSelectColumns",...ne)}).addLocalHook("afterSelectColumns",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("afterSelectColumns",...ne)}).addLocalHook("beforeSelectRows",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeSelectRows",...ne)}).addLocalHook("afterSelectRows",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("afterSelectRows",...ne)}).addLocalHook("beforeModifyTransformStart",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("modifyTransformStart",...ne)}).addLocalHook("afterModifyTransformStart",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("afterModifyTransformStart",...ne)}).addLocalHook("beforeModifyTransformFocus",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("modifyTransformFocus",...ne)}).addLocalHook("afterModifyTransformFocus",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("afterModifyTransformFocus",...ne)}).addLocalHook("beforeModifyTransformEnd",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("modifyTransformEnd",...ne)}).addLocalHook("afterModifyTransformEnd",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("afterModifyTransformEnd",...ne)}).addLocalHook("beforeRowWrap",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeRowWrap",...ne)}).addLocalHook("beforeColumnWrap",function(){for(var U=arguments.length,ne=new Array(U),me=0;me<U;me++)ne[me]=arguments[me];return d.runHooks("beforeColumnWrap",...ne)}).addLocalHook("insertRowRequire",U=>this.alter("insert_row_above",U,1,"auto")).addLocalHook("insertColRequire",U=>this.alter("insert_col_start",U,1,"auto")),te={alter(U,ne){let me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,$e=arguments.length>3?arguments[3]:void 0,it=arguments.length>4?arguments[4]:void 0;const vt=qt=>{if(qt.length===0)return[];const sn=[...qt];return sn.sort((er,nn)=>{let[pi]=er,[$i]=nn;return pi===$i?0:pi>$i?1:-1}),(0,mn.arrayReduce)(sn,(er,nn)=>{let[pi,$i]=nn;const Xi=er[er.length-1],[La,Js]=Xi,vo=La+Js;if(pi<=vo){const gl=Math.max($i-(vo-pi),0);Xi[1]+=gl}else er.push([pi,$i]);return er},[sn[0]])};switch(U){case"insert_row_below":case"insert_row_above":const qt=p.countSourceRows();if(_t.maxRows===qt)return;const sn=U==="insert_row_below"?"below":"above";ne=ne!=null?ne:sn==="below"?qt:0;const{delta:nr,startPhysicalIndex:er}=H.createRow(ne,me,{source:$e,mode:sn});Kr.shiftRows(p.toVisualRow(er),nr);break;case"insert_col_start":case"insert_col_end":const nn=U==="insert_col_end"?"end":"start";ne=ne!=null?ne:nn==="end"?p.countSourceCols():0;const{delta:pi,startPhysicalIndex:$i}=H.createCol(ne,me,{source:$e,mode:nn});if(pi){if(Array.isArray(_t.colHeaders)){const Js=[p.toVisualColumn($i),0];Js.length+=pi,Array.prototype.splice.apply(_t.colHeaders,Js)}Kr.shiftColumns(p.toVisualColumn($i),pi)}break;case"remove_row":const Xi=Js=>{let vo=0;(0,mn.arrayEach)(Js,gl=>{let[no,oa]=gl;const Bs=(0,q.isEmpty)(no)?p.countRows()-1:Math.max(no-vo,0);if(Number.isInteger(no)&&(no=Math.max(no-vo,0)),!H.removeRow(no,oa,$e))return;if(Kr.isSelected()){const{row:Jc}=p.getSelectedRangeLast().highlight;Jc>=no&&Jc<=no+oa-1&&we.closeEditor(!0)}const jo=p.countRows(),ou=_t.fixedRowsTop;ou>=Bs+1&&(_t.fixedRowsTop-=Math.min(oa,ou-Bs));const Zc=_t.fixedRowsBottom;Zc&&Bs>=jo-Zc&&(_t.fixedRowsBottom-=Math.min(oa,Zc)),jo===0?Kr.deselect():$e==="ContextMenu.removeRow"?Kr.refresh():Kr.shiftRows(no,-oa),vo+=oa})};Array.isArray(ne)?Xi(vt(ne)):Xi([[ne,me]]);break;case"remove_col":const La=Js=>{let vo=0;(0,mn.arrayEach)(Js,gl=>{let[no,oa]=gl;const Bs=(0,q.isEmpty)(no)?p.countCols()-1:Math.max(no-vo,0);let pa=p.toPhysicalColumn(Bs);if(Number.isInteger(no)&&(no=Math.max(no-vo,0)),!H.removeCol(no,oa,$e))return;if(Kr.isSelected()){const{col:Jc}=p.getSelectedRangeLast().highlight;Jc>=no&&Jc<=no+oa-1&&we.closeEditor(!0)}p.countCols()===0?Kr.deselect():$e==="ContextMenu.removeColumn"?Kr.refresh():Kr.shiftColumns(no,-oa);const Zc=_t.fixedColumnsStart;Zc>=Bs+1&&(_t.fixedColumnsStart-=Math.min(oa,Zc-Bs)),Array.isArray(_t.colHeaders)&&(typeof pa=="undefined"&&(pa=-1),_t.colHeaders.splice(pa,oa)),vo+=oa})};Array.isArray(ne)?La(vt(ne)):La([[ne,me]]);break;default:throw new Error(`There is no such action "${U}"`)}it||te.adjustRowsAndCols(),p.view.render(),p.view.adjustElementsSize()},adjustRowsAndCols(){const U=_t.minRows,ne=_t.minSpareRows,me=_t.minCols,$e=_t.minSpareCols;if(U){const it=p.countRows();it<U&&H.createRow(it,U-it,{source:"auto"})}if(ne){const it=p.countEmptyRows(!0);if(it<ne){const vt=ne-it,qt=Math.min(vt,_t.maxRows-p.countSourceRows());H.createRow(p.countRows(),qt,{source:"auto"})}}{let it;(me||$e)&&(it=p.countEmptyCols(!0));let vt=p.countCols();if(me&&!_t.columns&&vt<me){const qt=me-vt;it+=qt,H.createCol(vt,qt,{source:"auto"})}if($e&&!_t.columns&&p.dataType==="array"&&it<$e){vt=p.countCols();const qt=$e-it,sn=Math.min(qt,_t.maxCols-vt);H.createCol(vt,sn,{source:"auto"})}}},populateFromArray(U,ne,me,$e,it){let vt,qt,sn,nr;const er=[],nn={},pi=[],$i=U.row,Xi=U.col;if(qt=ne.length,qt===0)return!1;let La=0,Js=0;switch((0,Be.isObject)(me)&&(La=me.col-Xi+1,Js=me.row-$i+1),it){case"shift_down":const vo=(0,mn.pivot)(ne),gl=vo.length,no=Math.max(gl,La),oa=p.getData().slice($i),Bs=(0,mn.pivot)(oa).slice(Xi,Xi+no);for(sn=0;sn<no;sn+=1)if(sn<gl){for(vt=0,qt=vo[sn].length;vt<Js-qt;vt+=1)vo[sn].push(vo[sn][vt%qt]);sn<Bs.length?pi.push(vo[sn].concat(Bs[sn])):pi.push(vo[sn].concat(new Array(oa.length).fill(null)))}else pi.push(vo[sn%gl].concat(Bs[sn]));p.populateFromArray($i,Xi,(0,mn.pivot)(pi));break;case"shift_right":const pa=ne.length,jo=Math.max(pa,Js),ou=p.getData().slice($i).map(au=>au.slice(Xi));for(vt=0;vt<jo;vt+=1)if(vt<pa){for(sn=0,nr=ne[vt].length;sn<La-nr;sn+=1)ne[vt].push(ne[vt][sn%nr]);if(vt<ou.length)for(let au=0;au<ou[vt].length;au+=1)ne[vt].push(ou[vt][au]);else ne[vt].push(...new Array(ou[0].length).fill(null))}else ne.push(ne[vt%qt].slice(0,jo).concat(ou[vt]));p.populateFromArray($i,Xi,ne);break;case"overwrite":default:nn.row=U.row,nn.col=U.col;let Zc=0,Jc=0,Tf=!0,Ed;const Ig=function(Wh){let Hu=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Bh=ne[Wh%ne.length];return Hu!==null?Bh[Hu%Bh.length]:Bh},km=ne.length,Fh=me?me.row-U.row+1:0;for(me?qt=Fh:qt=Math.max(km,Fh),vt=0;vt<qt&&!(me&&nn.row>me.row&&Fh>km||!_t.allowInsertRow&&nn.row>p.countRows()-1||nn.row>=_t.maxRows);vt++){const au=vt-Zc,Wh=Ig(au).length,Hu=me?me.col-U.col+1:0;if(me?nr=Hu:nr=Math.max(Wh,Hu),nn.col=U.col,Ed=p.getCellMeta(nn.row,nn.col),($e==="CopyPaste.paste"||$e==="Autofill.fill")&&Ed.skipRowOnPaste){Zc+=1,nn.row+=1,qt+=1;continue}for(Jc=0,sn=0;sn<nr&&!(me&&nn.col>me.col&&Hu>Wh||!_t.allowInsertColumn&&nn.col>p.countCols()-1||nn.col>=_t.maxCols);sn++){if(Ed=p.getCellMeta(nn.row,nn.col),($e==="CopyPaste.paste"||$e==="Autofill.fill")&&Ed.skipColumnOnPaste){Jc+=1,nn.col+=1,nr+=1;continue}if(Ed.readOnly&&$e!=="UndoRedo.undo"){nn.col+=1;continue}const Bh=sn-Jc;let ro=Ig(au,Bh),Sc=p.getDataAtCell(nn.row,nn.col);if(ro!==null&&typeof ro=="object")if(Array.isArray(ro)&&Sc===null&&(Sc=[]),Sc===null||typeof Sc!="object")Tf=!1;else{const Kp=(0,Be.duckSchema)(Array.isArray(Sc)?Sc:Sc[0]||Sc),AC=(0,Be.duckSchema)(Array.isArray(ro)?ro:ro[0]||ro);(0,Be.isObjectEqual)(Kp,AC)||Array.isArray(Kp)&&Array.isArray(AC)?ro=(0,Be.deepClone)(ro):Tf=!1}else Sc!==null&&typeof Sc=="object"&&(Tf=!1);Tf&&er.push([nn.row,nn.col,ro]),Tf=!0,nn.col+=1}nn.row+=1}p.setDataAtCell(er,null,null,$e||"populateFromArray");break}}};function Hh(U){const ne=Eh(U);Da(ne)?(p.runHooks("beforeLanguageChange",ne),Ci.language=ne,p.runHooks("afterLanguageChange",ne)):Ne(U)}function Rg(U,ne){const me=U==="className"?p.rootElement:p.table;if(Le)(0,I.addClass)(me,ne);else{let $e=[],it=[];Ci[U]&&($e=Array.isArray(Ci[U])?Ci[U]:(0,mn.stringToArray)(Ci[U])),ne&&(it=Array.isArray(ne)?ne:(0,mn.stringToArray)(ne));const vt=(0,mn.getDifferenceOfArrays)($e,it),qt=(0,mn.getDifferenceOfArrays)(it,$e);vt.length&&(0,I.removeClass)(me,vt),qt.length&&(0,I.addClass)(me,qt)}Ci[U]=ne}this.init=function(){z.setData(_t.data),p.runHooks("beforeInit"),((0,de.isMobileBrowser)()||(0,de.isIpadOS)())&&(0,I.addClass)(p.rootElement,"mobile"),this.updateSettings(i,!0),this.view=new cg(this);const U=_t.themeName||PC(p.rootElement);p.useTheme(U),p.view.addClassNameToLicenseElement(p.getCurrentThemeName()),we=Ye.getInstance(p,_t,Kr),De=CC(p),Ie=new br(p),Wc(this)&&Ap(p),p.runHooks("init"),this.render(),Le&&p.rootElement.offsetParent===null&&(0,I.observeVisibilityChangeOnce)(p.rootElement,()=>{p.view._wt.wtOverlays.updateLastSpreaderSize(),p.render(),p.view.adjustElementsSize()}),typeof Le=="object"&&(p.runHooks("afterChange",Le[0],Le[1]),Le=!1),p.runHooks("afterInit")};function Lh(){let U=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,U=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&U===!1&&(U=!0,this.onQueueEmpty(this.valid))}}}function Tg(U){const ne=U.replace(",",".");return isNaN(parseFloat(ne))===!1?parseFloat(ne):U}function Mg(U,ne,me){if(!U.length){me();return}const $e=p.getActiveEditor(),it=new Lh;let vt=!0;it.onQueueEmpty=()=>{$e&&vt&&$e.cancelChanges(),me()};for(let qt=U.length-1;qt>=0;qt--){const[sn,nr]=U[qt],er=H.propToCol(nr);let nn;Number.isInteger(er)?nn=p.getCellMeta(sn,er):nn=hi(hi({},Object.getPrototypeOf(_t)),_t),p.getCellValidator(nn)&&(it.addValidatorToQueue(),p.validateCell(U[qt][3],nn,function(pi,$i){return function(Xi){if(typeof Xi!="boolean")throw new Error("Validation error: result is not boolean");Xi===!1&&$i.allowInvalid===!1&&(vt=!1,U.splice(pi,1),$i.valid=!0),it.removeValidatorFormQueue()}}(qt,nn),ne))}it.checkIfQueueIsEmpty()}function Og(U,ne){for(let $e=U.length-1;$e>=0;$e--){let it=!1;if(U[$e]===null){U.splice($e,1);continue}if(!((U[$e][2]===null||U[$e][2]===void 0)&&(U[$e][3]===null||U[$e][3]===void 0))){if(_t.allowInsertRow)for(;U[$e][0]>p.countRows()-1;){const{delta:vt}=H.createRow(void 0,void 0,{source:"auto"});if(vt===0){it=!0;break}}if(p.dataType==="array"&&(!_t.columns||_t.columns.length===0)&&_t.allowInsertColumn)for(;H.propToCol(U[$e][1])>p.countCols()-1;){const{delta:vt}=H.createCol(void 0,void 0,{source:"auto"});if(vt===0){it=!0;break}}it||H.set(U[$e][0],U[$e][1],U[$e][3])}}if(U.length>0){te.adjustRowsAndCols(),p.runHooks("beforeChangeRender",U,ne),we.closeEditor(),p.render(),we.prepareEditor(),p.view.adjustElementsSize(),p.runHooks("afterChange",U,ne||"edit");const $e=p.getActiveEditor();$e&&(0,q.isDefined)($e.refreshValue)&&$e.refreshValue()}else p.render()}this._createCellCoords=function(U,ne){return p.view._wt.createCellCoords(U,ne)},this._createCellRange=function(U,ne,me){return p.view._wt.createCellRange(U,ne,me)},this.validateCell=function(U,ne,me,$e){let it=p.getCellValidator(ne);function vt(qt){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||ne.hidden===!0){me(qt);return}const nr=ne.visualCol,er=ne.visualRow,nn=p.getCell(er,nr,!0);if(nn&&nn.nodeName!=="TH"){const pi=p.rowIndexMapper.getRenderableFromVisualIndex(er),$i=p.columnIndexMapper.getRenderableFromVisualIndex(nr);p.view._wt.getSetting("cellRenderer",pi,$i,nn)}me(qt)}(0,q.isRegExp)(it)&&(it=function(qt){return function(sn,nr){nr(qt.test(sn))}}(it)),(0,V.isFunction)(it)?(U=p.runHooks("beforeValidate",U,ne.visualRow,ne.prop,$e),p._registerImmediate(()=>{it.call(ne,U,qt=>{p&&(qt=p.runHooks("afterValidate",qt,U,ne.visualRow,ne.prop,$e),ne.valid=qt,vt(qt),p.runHooks("postAfterValidate",qt,U,ne.visualRow,ne.prop,$e))})})):p._registerImmediate(()=>{ne.valid=!0,vt(ne.valid,!1)})};function fl(U,ne,me){return Array.isArray(U)?U:[[U,ne,me]]}function qa(U,ne){const me=p.runHooks("beforeChange",U,ne||"edit"),$e=U.filter(vt=>vt!==null);if(me===!1||$e.length===0){var it;return(it=p.getActiveEditor())===null||it===void 0||it.cancelChanges(),[]}for(let vt=$e.length-1;vt>=0;vt--){const[qt,sn,,nr]=$e[vt],er=H.propToCol(sn);let nn;Number.isInteger(er)?nn=p.getCellMeta(qt,er):nn=hi(hi({},Object.getPrototypeOf(_t)),_t);const{type:pi,checkedTemplate:$i,uncheckedTemplate:Xi}=nn;if(pi==="numeric"&&typeof nr=="string"&&(0,pr.isNumericLike)(nr)&&($e[vt][3]=Tg(nr)),pi==="checkbox"){const La=(0,q.stringify)(nr),Js=La===(0,q.stringify)($i),vo=La===(0,q.stringify)(Xi);(Js||vo)&&($e[vt][3]=Js?$i:Xi)}}return $e}this.setDataAtCell=function(U,ne,me,$e){const it=fl(U,ne,me),vt=[];let qt=$e,sn,nr,er;for(sn=0,nr=it.length;sn<nr;sn++){if(typeof it[sn]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof it[sn][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");it[sn][1]>=this.countCols()?er=it[sn][1]:er=H.colToProp(it[sn][1]),vt.push([it[sn][0],er,z.getAtCell(this.toPhysicalRow(it[sn][0]),it[sn][1]),it[sn][2]])}!qt&&typeof U=="object"&&(qt=ne);const nn=qa(vt,qt);p.runHooks("afterSetDataAtCell",nn,qt),Mg(nn,qt,()=>{Og(nn,qt)})},this.setDataAtRowProp=function(U,ne,me,$e){const it=fl(U,ne,me),vt=[];let qt=$e,sn,nr;for(sn=0,nr=it.length;sn<nr;sn++)vt.push([it[sn][0],it[sn][1],z.getAtCell(this.toPhysicalRow(it[sn][0]),it[sn][1]),it[sn][2]]);!qt&&typeof U=="object"&&(qt=ne);const er=qa(vt,$e);p.runHooks("afterSetDataAtRowProp",er,qt),Mg(er,qt,()=>{Og(er,qt)})},this.listen=function(){p&&!p.isListening()&&(Eg.forEach(U=>{p!==U&&U.unlisten()}),Wm=p.guid,p.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Wm=null,p.runHooks("afterUnlisten"))},this.isListening=function(){return Wm===p.guid},this.destroyEditor=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;we.closeEditor(U),p.view.render(),ne&&Kr.isSelected()&&we.prepareEditor()},this.populateFromArray=function(U,ne,me,$e,it,vt,qt){if(!(typeof me=="object"&&typeof me[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const sn=typeof $e=="number"?p._createCellCoords($e,it):null;return te.populateFromArray(p._createCellCoords(U,ne),me,sn,vt,qt)},this.spliceCol=function(U,ne,me){for(var $e=arguments.length,it=new Array($e>3?$e-3:0),vt=3;vt<$e;vt++)it[vt-3]=arguments[vt];return H.spliceCol(U,ne,me,...it)},this.spliceRow=function(U,ne,me){for(var $e=arguments.length,it=new Array($e>3?$e-3:0),vt=3;vt<$e;vt++)it[vt-3]=arguments[vt];return H.spliceRow(U,ne,me,...it)},this.getSelected=function(){if(Kr.isSelected())return(0,mn.arrayMap)(Kr.getSelectedRange(),U=>{let{from:ne,to:me}=U;return[ne.row,ne.col,me.row,me.col]})},this.getSelectedLast=function(){const U=this.getSelected();let ne;return U&&U.length>0&&(ne=U[U.length-1]),ne},this.getSelectedRange=function(){if(Kr.isSelected())return Array.from(Kr.getSelectedRange())},this.getSelectedRangeLast=function(){const U=this.getSelectedRange();let ne;return U&&U.length>0&&(ne=U[U.length-1]),ne},this.emptySelectedCells=function(U){if(!Kr.isSelected()||this.countRows()===0||this.countCols()===0)return;const ne=[];(0,mn.arrayEach)(Kr.getSelectedRange(),me=>{if(me.isSingleHeader())return;const $e=me.getTopStartCorner(),it=me.getBottomEndCorner();(0,pr.rangeEach)($e.row,it.row,vt=>{(0,pr.rangeEach)($e.col,it.col,qt=>{this.getCellMeta(vt,qt).readOnly||ne.push([vt,qt,null])})})}),ne.length>0&&this.setDataAtCell(ne,U)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const U=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(U,0),!this.isRenderSuspended()&&U===this.renderSuspendedCounter&&p.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||p.view.render())},this.batchRender=function(U){this.suspendRender();const ne=U();return this.resumeRender(),ne},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const ne=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(ne,0),(!this.isExecutionSuspended()&&ne===this.executionSuspendedCounter||U)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const me=U();return this.resumeExecution(ne),me},this.batch=function(U){this.suspendRender(),this.suspendExecution();const ne=U();return this.resumeExecution(),this.resumeRender(),ne},this.refreshDimensions=function(){if(!p.view)return;const U=p.view,{width:ne,height:me}=U.getLastSize(),{width:$e,height:it}=p.rootElement.getBoundingClientRect(),vt=$e!==ne||it!==me;p.runHooks("beforeRefreshDimensions",{width:ne,height:me},{width:$e,height:it},vt)!==!1&&((vt||U._wt.wtOverlays.scrollableElement===p.rootWindow)&&(U.setLastSize($e,it),p.render(),U.adjustElementsSize()),p.runHooks("afterRefreshDimensions",{width:ne,height:me},{width:$e,height:it},vt))},this.updateData=function(U,ne){Za(U,me=>{H=me},me=>{H=me,p.columnIndexMapper.fitToLength(this.getInitialColumnCount()),p.rowIndexMapper.fitToLength(this.countSourceRows()),te.adjustRowsAndCols(),Kr.refresh()},{hotInstance:p,dataMap:H,dataSource:z,internalSource:"updateData",source:ne,metaManager:Mn,firstRun:Le})},this.loadData=function(U,ne){Za(U,me=>{H=me},()=>{Mn.clearCellsCache(),p.initIndexMappers(),te.adjustRowsAndCols(),Kr.refresh(),Le&&(Le=[null,"loadData"])},{hotInstance:p,dataMap:H,dataSource:z,internalSource:"loadData",source:ne,metaManager:Mn,firstRun:Le})},this.getInitialColumnCount=function(){const U=_t.columns;let ne=0;if(Array.isArray(U))ne=U.length;else if((0,V.isFunction)(U))if(p.dataType==="array"){const me=this.countSourceCols();for(let $e=0;$e<me;$e+=1)U($e)&&(ne+=1)}else(p.dataType==="object"||p.dataType==="function")&&(ne=H.colToPropCache.length);else if((0,q.isDefined)(_t.dataSchema)){const me=H.getSchema();ne=Array.isArray(me)?me.length:(0,Be.deepObjectSize)(me)}else ne=this.countSourceCols();return ne},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(U,ne,me,$e){return(0,q.isUndefined)(U)?H.getAll():H.getRange(p._createCellCoords(U,ne),p._createCellCoords(me,$e),H.DESTINATION_RENDERER)},this.getCopyableText=function(U,ne,me,$e){return H.getCopyableText(p._createCellCoords(U,ne),p._createCellCoords(me,$e))},this.getCopyableData=function(U,ne){return H.getCopyable(U,H.colToProp(ne))},this.getSchema=function(){return H.getSchema()},this.updateSettings=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const me=(Le?p.loadData:p.updateData).bind(this);let $e=!1,it,vt;if((0,q.isDefined)(U.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,q.isDefined)(U.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,q.isDefined)(U.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');U.language&&Hh(U.language);for(it in U)if(!(it==="data"||it==="language"))if(it==="className")Rg("className",U.className);else if(it==="tableClassName"&&p.table)Rg("tableClassName",U.tableClassName),p.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ko.P.getSingleton().isRegistered(it)||ko.P.getSingleton().isDeprecated(it)){const nn=U[it];(0,V.isFunction)(nn)?(ko.P.getSingleton().addAsFixed(it,nn,p),_t[it]=nn):Array.isArray(nn)&&(ko.P.getSingleton().add(it,nn,p),_t[it]=nn)}else!ne&&(0,Be.hasOwnProperty)(U,it)&&(Ci[it]=U[it]);U.data===void 0&&_t.data===void 0?me(null,"updateSettings"):U.data!==void 0?me(U.data,"updateSettings"):U.columns!==void 0&&(H.createMap(),p.initIndexMappers());const qt=p.countCols(),sn=_t.columns;if(sn&&(0,V.isFunction)(sn)&&($e=!0),(U.cell!==void 0||U.cells!==void 0||U.columns!==void 0)&&Mn.clearCache(),qt>0)for(it=0,vt=0;it<qt;it++){if(sn){const nn=$e?sn(it):sn[vt];nn&&Mn.updateColumnMeta(vt,nn)}vt+=1}(0,q.isDefined)(U.cell)&&(0,Be.objectEach)(U.cell,nn=>{p.setCellMetaObject(nn.row,nn.col,nn)}),p.runHooks("afterCellMetaReset");let nr=p.rootElement.style.height;nr!==""&&(nr=parseInt(p.rootElement.style.height,10));let er=U.height;if((0,V.isFunction)(er)&&(er=er()),ne&&p.rootElement.getAttribute("style")&&p.rootElement.setAttribute("data-initialstyle",p.rootElement.getAttribute("style")),er===null){const nn=p.rootElement.getAttribute("data-initialstyle");nn&&(nn.indexOf("height")>-1||nn.indexOf("overflow")>-1)?p.rootElement.setAttribute("style",nn):(p.rootElement.style.height="",p.rootElement.style.overflow="")}else er!==void 0&&(p.rootElement.style.height=isNaN(er)?`${er}`:`${er}px`,p.rootElement.style.overflow="hidden");if(typeof U.width!="undefined"){let nn=U.width;(0,V.isFunction)(nn)&&(nn=nn()),p.rootElement.style.width=isNaN(nn)?`${nn}`:`${nn}px`}if(!ne){if(p.view){p.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),p.view._wt.exportSettingsAsClassNames();const nn=p.getCurrentThemeName(),pi=(0,Be.hasOwnProperty)(U,"themeName");nn&&pi&&nn!==U.themeName&&(p.view.getStylesHandler().removeClassNames(),p.view.removeClassNameFromLicenseElement(nn));const $i=pi&&U.themeName||PC(p.rootElement);p.useTheme($i),p.view.addClassNameToLicenseElement(p.getCurrentThemeName())}p.runHooks("afterUpdateSettings",U)}te.adjustRowsAndCols(),p.view&&!Le&&(p.render(),p.view._wt.wtOverlays.adjustElementsSize()),!ne&&p.view&&(nr===""||er===""||er===void 0)&&nr!==er&&p.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const U=p.getSelectedLast();if(_t.getValue){if((0,V.isFunction)(_t.getValue))return _t.getValue.call(p);if(U)return p.getData()[U[0][0]][_t.getValue]}else if(U)return p.getDataAtCell(U[0],U[1])},this.getSettings=function(){return _t},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(U,ne,me,$e,it){te.alter(U,ne,me,$e,it)},this.getCell=function(U,ne){let me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,$e=ne,it=U;if(ne>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(ne)))return null;$e=this.columnIndexMapper.getRenderableFromVisualIndex(ne)}if(U>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(U)))return null;it=this.rowIndexMapper.getRenderableFromVisualIndex(U)}return it===null||$e===null||it===void 0||$e===void 0?null:p.view.getCellAtCoords(p._createCellCoords(it,$e),me)},this.getCoords=function(U){const ne=this.view._wt.wtTable.getCoords(U);if(ne===null)return null;const{row:me,col:$e}=ne;let it=me,vt=$e;return me>=0&&(it=this.rowIndexMapper.getVisualFromRenderableIndex(me)),$e>=0&&(vt=this.columnIndexMapper.getVisualFromRenderableIndex($e)),p._createCellCoords(it,vt)},this.colToProp=function(U){return H.colToProp(U)},this.propToCol=function(U){return H.propToCol(U)},this.toVisualRow=U=>this.rowIndexMapper.getVisualFromPhysicalIndex(U),this.toVisualColumn=U=>this.columnIndexMapper.getVisualFromPhysicalIndex(U),this.toPhysicalRow=U=>this.rowIndexMapper.getPhysicalFromVisualIndex(U),this.toPhysicalColumn=U=>this.columnIndexMapper.getPhysicalFromVisualIndex(U),this.getDataAtCell=function(U,ne){return H.get(U,H.colToProp(ne))},this.getDataAtRowProp=function(U,ne){return H.get(U,ne)},this.getDataAtCol=function(U){const ne=[],me=H.getRange(p._createCellCoords(0,U),p._createCellCoords(_t.data.length-1,U),H.DESTINATION_RENDERER);for(let $e=0;$e<me.length;$e+=1)for(let it=0;it<me[$e].length;it+=1)ne.push(me[$e][it]);return ne},this.getDataAtProp=function(U){const ne=[],me=H.getRange(p._createCellCoords(0,H.propToCol(U)),p._createCellCoords(_t.data.length-1,H.propToCol(U)),H.DESTINATION_RENDERER);for(let $e=0;$e<me.length;$e+=1)for(let it=0;it<me[$e].length;it+=1)ne.push(me[$e][it]);return ne},this.getSourceData=function(U,ne,me,$e){let it;return U===void 0?it=z.getData():it=z.getByRange(p._createCellCoords(U,ne),p._createCellCoords(me,$e)),it},this.getSourceDataArray=function(U,ne,me,$e){let it;return U===void 0?it=z.getData(!0):it=z.getByRange(p._createCellCoords(U,ne),p._createCellCoords(me,$e),!0),it},this.getSourceDataAtCol=function(U){return z.getAtColumn(U)},this.setSourceDataAtCell=function(U,ne,me,$e){const it=fl(U,ne,me),vt=this.hasHook("afterSetSourceDataAtCell"),qt=[];vt&&(0,mn.arrayEach)(it,nr=>{let[er,nn,pi]=nr;qt.push([er,nn,z.getAtCell(er,nn),pi])}),(0,mn.arrayEach)(it,nr=>{let[er,nn,pi]=nr;z.setAtCell(er,nn,pi)}),vt&&this.runHooks("afterSetSourceDataAtCell",qt,$e),this.render();const sn=p.getActiveEditor();sn&&(0,q.isDefined)(sn.refreshValue)&&sn.refreshValue()},this.getSourceDataAtRow=function(U){return z.getAtRow(U)},this.getSourceDataAtCell=function(U,ne){return z.getAtCell(U,ne)},this.getDataAtRow=function(U){return H.getRange(p._createCellCoords(U,0),p._createCellCoords(U,this.countCols()-1),H.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(U,ne,me,$e){const it=U===void 0?[0,0,this.countRows(),this.countCols()]:[U,ne,me,$e],[vt,qt]=it;let[,,sn,nr]=it,er=null,nn=null;sn===void 0&&(sn=vt),nr===void 0&&(nr=qt);let pi="mixed";return(0,pr.rangeEach)(Math.max(Math.min(vt,sn),0),Math.max(vt,sn),$i=>{let Xi=!0;return(0,pr.rangeEach)(Math.max(Math.min(qt,nr),0),Math.max(qt,nr),La=>(nn=this.getCellMeta($i,La).type,er?Xi=er===nn:er=nn,Xi)),pi=Xi?nn:"mixed",Xi}),pi},this.removeCellMeta=function(U,ne,me){const[$e,it]=[this.toPhysicalRow(U),this.toPhysicalColumn(ne)];let vt=Mn.getCellMetaKeyValue($e,it,me);p.runHooks("beforeRemoveCellMeta",U,ne,me,vt)!==!1&&(Mn.removeCellMeta($e,it,me),p.runHooks("afterRemoveCellMeta",U,ne,me,vt)),vt=null},this.spliceCellsMeta=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var me=arguments.length,$e=new Array(me>2?me-2:0),it=2;it<me;it++)$e[it-2]=arguments[it];if($e.length>0&&!Array.isArray($e[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");ne>0&&Mn.removeRow(this.toPhysicalRow(U),ne),$e.length>0&&(0,mn.arrayEach)($e.reverse(),vt=>{Mn.createRow(this.toPhysicalRow(U)),(0,mn.arrayEach)(vt,(qt,sn)=>this.setCellMetaObject(U,sn,qt))}),p.render()},this.setCellMetaObject=function(U,ne,me){typeof me=="object"&&(0,Be.objectEach)(me,($e,it)=>{this.setCellMeta(U,ne,it,$e)})},this.setCellMeta=function(U,ne,me,$e){if(p.runHooks("beforeSetCellMeta",U,ne,me,$e)===!1)return;let vt=U,qt=ne;U<this.countRows()&&(vt=this.toPhysicalRow(U)),ne<this.countCols()&&(qt=this.toPhysicalColumn(ne)),Mn.setCellMeta(vt,qt,me,$e),p.runHooks("afterSetCellMeta",U,ne,me,$e)},this.getCellsMeta=function(){return Mn.getCellsMeta()},this.getCellMeta=function(U,ne){let me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},$e=this.toPhysicalRow(U),it=this.toPhysicalColumn(ne);return $e===null&&($e=U),it===null&&(it=ne),Mn.getCellMeta($e,it,hi({visualRow:U,visualColumn:ne},me))},this.getColumnMeta=function(U){return Mn.getColumnMeta(this.toPhysicalColumn(U))},this.getCellMetaAtRow=function(U){return Mn.getCellsMetaAtRow(U)},this.isColumnModificationAllowed=function(){return!(p.dataType==="object"||_t.columns)},this.getCellRenderer=function(U,ne){const me=typeof U=="number"?p.getCellMeta(U,ne).renderer:U.renderer;return typeof me=="string"?(0,_o.Bp)(me):(0,q.isUndefined)(me)?(0,_o.Bp)("text"):me},this.getCellEditor=function(U,ne){const me=typeof U=="number"?p.getCellMeta(U,ne).editor:U.editor;return typeof me=="string"?(0,pe.y$)(me):(0,q.isUndefined)(me)?(0,pe.y$)("text"):me},this.getCellValidator=function(U,ne){const me=typeof U=="number"?p.getCellMeta(U,ne).validator:U.validator;return typeof me=="string"?(0,Hn.Te)(me):me},this.validateCells=function(U){this._validateCells(U)},this.validateRows=function(U,ne){if(!Array.isArray(U))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(ne,U)},this.validateColumns=function(U,ne){if(!Array.isArray(U))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(ne,void 0,U)},this._validateCells=function(U,ne,me){const $e=new Lh;U&&($e.onQueueEmpty=U);let it=p.countRows()-1;for(;it>=0;){if(ne!==void 0&&ne.indexOf(it)===-1){it-=1;continue}let vt=p.countCols()-1;for(;vt>=0;){if(me!==void 0&&me.indexOf(vt)===-1){vt-=1;continue}$e.addValidatorToQueue(),p.validateCell(p.getDataAtCell(it,vt),p.getCellMeta(it,vt),qt=>{if(typeof qt!="boolean")throw new Error("Validation error: result is not boolean");qt===!1&&($e.valid=!1),$e.removeValidatorFormQueue()},"validateCells"),vt-=1}it-=1}$e.checkIfQueueIsEmpty()},this.getRowHeader=function(U){let ne=_t.rowHeaders,me=U;return me!==void 0&&(me=p.runHooks("modifyRowHeader",me)),me===void 0?(ne=[],(0,pr.rangeEach)(p.countRows()-1,$e=>{ne.push(p.getRowHeader($e))})):Array.isArray(ne)&&ne[me]!==void 0?ne=ne[me]:(0,V.isFunction)(ne)?ne=ne(me):ne&&typeof ne!="string"&&typeof ne!="number"&&(ne=me+1),ne},this.hasRowHeaders=function(){return!!_t.rowHeaders},this.hasColHeaders=function(){if(_t.colHeaders!==void 0&&_t.colHeaders!==null)return!!_t.colHeaders;for(let U=0,ne=p.countCols();U<ne;U++)if(p.getColHeader(U))return!0;return!1},this.getColHeader=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const me=p.runHooks("modifyColHeader",U);if(me===void 0){const sn=[],nr=p.countCols();for(let er=0;er<nr;er++)sn.push(p.getColHeader(er));return sn}let $e=_t.colHeaders;const it=function(sn){const nr=[],er=p.countCols();let nn=0;for(;nn<er;nn++)(0,V.isFunction)(_t.columns)&&_t.columns(nn)&&nr.push(nn);return nr[sn]},vt=p.toPhysicalColumn(me),qt=it(vt);return _t.colHeaders===!1?$e=null:_t.columns&&(0,V.isFunction)(_t.columns)&&_t.columns(qt)&&_t.columns(qt).title?$e=_t.columns(qt).title:_t.columns&&_t.columns[vt]&&_t.columns[vt].title?$e=_t.columns[vt].title:Array.isArray(_t.colHeaders)&&_t.colHeaders[vt]!==void 0?$e=_t.colHeaders[vt]:(0,V.isFunction)(_t.colHeaders)?$e=_t.colHeaders(vt):_t.colHeaders&&typeof _t.colHeaders!="string"&&typeof _t.colHeaders!="number"&&($e=(0,v.spreadsheetColumnLabel)(me)),$e=p.runHooks("modifyColumnHeaderValue",$e,U,ne),$e},this._getColWidthFromSettings=function(U){let ne;if(U>=0&&(ne=p.getCellMeta(0,U).width),(ne===void 0||ne===_t.width)&&(ne=_t.colWidths),ne!=null){switch(typeof ne){case"object":ne=ne[U];break;case"function":ne=ne(U);break;default:break}typeof ne=="string"&&(ne=parseInt(ne,10))}return ne},this.getColWidth=function(U,ne){let me=p._getColWidthFromSettings(U);return me=p.runHooks("modifyColWidth",me,U,ne),me===void 0&&(me=Hl.$),me},this._getRowHeightFromSettings=function(U){const ne=this.view.getDefaultRowHeight();let me=_t.rowHeights;if(me!=null){switch(typeof me){case"object":me=me[U];break;case"function":me=me(U);break;default:break}typeof me=="string"&&(me=parseInt(me,10))}return me!=null&&me<ne?ne:me},this.getRowHeight=function(U,ne){let me=p._getRowHeightFromSettings(U);return me=p.runHooks("modifyRowHeight",me,U,ne),me},this.countSourceRows=function(){return z.countRows()},this.countSourceCols=function(){return z.countFirstRowKeys()},this.countRows=function(){return H.getLength()},this.countCols=function(){const U=_t.maxCols,ne=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(U,ne)},this.countRenderedRows=function(){return p.view._wt.drawn?p.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return p.view._wt.drawn?p.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return p.view._wt.drawn?p.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return p.view._wt.drawn?p.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ne=0;return(0,pr.rangeEachReverse)(p.countRows()-1,me=>{if(p.isEmptyRow(me))ne+=1;else if(U===!0)return!1}),ne},this.countEmptyCols=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ne=0;return(0,pr.rangeEachReverse)(p.countCols()-1,me=>{if(p.isEmptyCol(me))ne+=1;else if(U===!0)return!1}),ne},this.isEmptyRow=function(U){return _t.isEmptyRow.call(p,U)},this.isEmptyCol=function(U){return _t.isEmptyCol.call(p,U)},this.selectCell=function(U,ne,me,$e){let it=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,vt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return(0,q.isUndefined)(U)||(0,q.isUndefined)(ne)?!1:this.selectCells([[U,ne,me,$e]],it,vt)},this.selectCells=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ne===!1&&De.suspend();const $e=Kr.selectCells(U);return $e&&me&&p.listen(),De.resume(),$e},this.selectColumns=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,me=arguments.length>2?arguments[2]:void 0;return Kr.selectColumns(U,ne,me)},this.selectRows=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,me=arguments.length>2?arguments[2]:void 0;return Kr.selectRows(U,ne,me)},this.deselectCell=function(){Kr.deselect()},this.selectAll=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,me=arguments.length>2?arguments[2]:void 0;De.skipNextScrollCycle(),Kr.selectAll(U,ne,me)};const xo=(U,ne)=>U.getNearestNotHiddenIndex(ne,1,!0);this.scrollViewportTo=function(U,ne){if(typeof U=="number"){var me;U={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(me=arguments[4])!==null&&me!==void 0?me:!0}}const{row:$e,col:it,considerHiddenIndexes:vt}=U!=null?U:{};let qt=$e,sn=it;if((0,V.isFunction)(ne)&&this.addHookOnce("afterScroll",ne),vt===void 0||vt){const pi=Number.isInteger($e)&&$e>=0,$i=Number.isInteger(it)&&it>=0,Xi=pi?xo(this.rowIndexMapper,$e):void 0,La=$i?xo(this.columnIndexMapper,it):void 0;if(Xi===null||La===null)return!1;qt=pi?p.rowIndexMapper.getRenderableFromVisualIndex(Xi):$e,sn=$i?p.columnIndexMapper.getRenderableFromVisualIndex(La):it}const nr=Number.isInteger(qt),er=Number.isInteger(sn);let nn=!1;return nr&&qt>=0&&er&&sn>=0?nn=p.view.scrollViewport(p._createCellCoords(qt,sn),U.horizontalSnap,U.verticalSnap):nr&&qt>=0&&(er&&sn<0||!er)?nn=p.view.scrollViewportVertically(qt,U.verticalSnap):er&&sn>=0&&(nr&&qt<0||!nr)&&(nn=p.view.scrollViewportHorizontally(sn,U.horizontalSnap)),(0,V.isFunction)(ne)&&(nn?this.view.render():(this.removeHook("afterScroll",ne),this._registerMicrotask(()=>ne()))),nn},this.scrollToFocusedCell=function(U){if(!this.selection.isSelected())return!1;(0,V.isFunction)(U)&&this.addHookOnce("afterScroll",U);const{highlight:ne}=this.getSelectedRangeLast(),me=this.scrollViewportTo(ne.toObject());return me?this.view.render():(0,V.isFunction)(U)&&(this.removeHook("afterScroll",U),this._registerMicrotask(()=>U())),me},this.destroy=function(){if(p._clearTimeouts(),p._clearImmediates(),p.view&&p.view.destroy(),z&&z.destroy(),z=null,this.getShortcutManager().destroy(),Mn.clearCache(),Eg.delete(this.guid),Wc(p)){const U=this.rootDocument.querySelector(".hot-display-license-info");U&&U.parentNode.removeChild(U)}(0,I.empty)(p.rootElement),T.destroy(),we&&we.destroy(),p.batchExecution(()=>{p.rowIndexMapper.unregisterAll(),p.columnIndexMapper.unregisterAll(),mi.getItems().forEach(U=>{let[,ne]=U;ne.destroy()}),mi.clear(),p.runHooks("afterDestroy")},!0),ko.P.getSingleton().destroy(p),(0,Be.objectEach)(p,(U,ne,me)=>{(0,V.isFunction)(U)?me[ne]=Bm(ne):ne!=="guid"&&(me[ne]=null)}),p.isDestroyed=!0,H&&H.destroy(),H=null,te=null,Kr=null,we=null,p=null};function Bm(U){return()=>{throw new Error(`The "${U}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return we.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return p.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return p.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return p.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return p.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return p.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return p.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return p.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return p.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return p.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return p.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return p.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return p.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(U){return mi.getItem((0,Oi.toUpperCaseFirst)(U))},this.getPluginName=function(U){return U===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:mi.getId(U)},this.getInstance=function(){return p},this.addHook=function(U,ne,me){ko.P.getSingleton().add(U,ne,p,me)},this.hasHook=function(U){return ko.P.getSingleton().has(U,p)||ko.P.getSingleton().has(U)},this.addHookOnce=function(U,ne,me){ko.P.getSingleton().once(U,ne,p,me)},this.removeHook=function(U,ne){ko.P.getSingleton().remove(U,ne,p)},this.runHooks=function(U,ne,me,$e,it,vt,qt){return ko.P.getSingleton().run(p,U,ne,me,$e,it,vt,qt)},this.getTranslatedPhrase=function(U,ne){return Ou(_t.language,U,ne)},this.toHTML=()=>(0,Rs.instanceToHTML)(this),this.toTableElement=()=>{const U=this.rootDocument.createElement("div");return U.insertAdjacentHTML("afterbegin",(0,Rs.instanceToHTML)(this)),U.firstElementChild},this.timeouts=[],this.useTheme=U=>{this.view.getStylesHandler().useTheme(U),this.runHooks("afterSetTheme",U,!!Le)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(U){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,me=U;typeof me=="function"&&(me=setTimeout(me,ne)),this.timeouts.push(me)},this._clearTimeouts=function(){(0,mn.arrayEach)(this.timeouts,U=>{clearTimeout(U)})},this.immediates=[],this._registerImmediate=function(U){this.immediates.push(setImmediate(U))},this._clearImmediates=function(){(0,mn.arrayEach)(this.immediates,U=>{clearImmediate(U)})},this._registerMicrotask=function(U){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||U()})},this._getEditorManager=function(){return we};const Vo=jy({handleEvent(){return p.isListening()},beforeKeyDown:U=>this.runHooks("beforeKeyDown",U),afterKeyDown:U=>{this.isDestroyed||p.runHooks("afterDocumentKeyDown",U)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",U=>{U.ctrlKey===!1&&U.metaKey===!1&&Vo.releasePressedKeys()}),this.getShortcutManager=function(){return Vo},this.getFocusManager=function(){return Ie},(0,Mi.a9)().forEach(U=>{const ne=(0,Mi.s3)(U);mi.addItem(U,new ne(this))}),IC(p),Vo.setActiveContextName("grid"),ko.P.getSingleton().run(p,"construct")}var t0=f(71547);(0,Au.xN)(t0.n),Ul.editors={BaseEditor:_C.Hf};function Ul(u,i){const a=new zp(u,i||{},yh);return a.init(),a}Ul.Core=function(u){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new zp(u,i,yh)},Ul.DefaultSettings=lC(),Ul.hooks=ko.P.getSingleton(),Ul.CellCoords=Kd.Z,Ul.CellRange=Pc.Z,Ul.packageName="handsontable",Ul.buildDate="24/04/2025 10:59:00",Ul.version="15.3.0",Ul.languages={dictionaryKeys:wn,getLanguageDictionary:fo,getLanguagesDictionaries:Vc,registerLanguageDictionary:ki,getTranslatedPhrase:Ou};var n0=Ul},49312:function($,ie,f){"use strict";f.d(ie,{DA:function(){return ee},V1:function(){return ce},pH:function(){return Y},xN:function(){return le}});var C=f(29297),_=f.n(C),B=f(80534),K=f(15227),k=f(70959),Q=f(72095);const{register:X,getItem:N,hasItem:ce,getNames:Y,getValues:Z}=(0,B.Z)("cellTypes");function ee(J){if(!ce(J))throw Error(`You declared cell type "${J}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return N(J)}function le(J,W){typeof J!="string"&&(W=J,J=W.CELL_TYPE);const{editor:I,renderer:V,validator:q}=W;I&&(0,K.qm)(J,I),V&&(0,k.zn)(J,V),q&&(0,Q.Ie)(J,q),X(J,W)}},71547:function($,ie,f){"use strict";f.d(ie,{n:function(){return K}});var C=f(18475),_=f(64258);const K={CELL_TYPE:"text",editor:C.H,renderer:_.V}},58955:function($,ie,f){"use strict";f.d(ie,{P:function(){return Ae}});var C=f(29297),_=f(25813),B=f(11981),K=f(22492),k=f(40674),Q=f(8767),X=f(27122);const N=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],ce=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Y=new Map([[]]);var Z=f(80686),ee=f(71441),le=f(31702),J=f(89050),W=f(16110),I=f(8274),V=f(64109),q=f(92128),de=f(48442),ue=f(78127),ve=f(11174),pe=f(97487);function Se(Et,Qe){He(Et,Qe),Qe.add(Et)}function Ee(Et,Qe,an){He(Et,Qe),Qe.set(Et,an)}function He(Et,Qe){if(Qe.has(Et))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(Et,Qe,an){return Et.set(Oe(Et,Qe),an),an}function et(Et,Qe){return Et.get(Oe(Et,Qe))}function Oe(Et,Qe,an){if(typeof Et=="function"?Et===Qe:Et.has(Qe))return arguments.length<3?Qe:an;throw new TypeError("Private element is not present on this object")}const ct=100;var ze=new WeakMap,dt=new WeakMap,It=new WeakMap,Sn=new WeakSet;class jt{constructor(){Se(this,Sn),Ee(this,ze,new Map),Ee(this,dt,new Map),Ee(this,It,new Set),N.forEach(Qe=>Oe(Sn,this,Ye).call(this,Qe))}getHooks(Qe){var an;return(an=et(ze,this).get(Qe))!==null&&an!==void 0?an:[]}add(Qe,an){let Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};et(ze,this).has(Qe)||(Oe(Sn,this,Ye).call(this,Qe),N.push(Qe));const Cn=et(ze,this).get(Qe);if(Cn.find(ir=>ir.callback===an))return;const bn=Number.isInteger(Mt.orderIndex)?Mt.orderIndex:0,mr=!!Mt.runOnce,br=!!Mt.initialHook;let qr=!1;if(br){const ir=Cn.find(Qn=>Qn.initialHook);ir&&(ir.callback=an,qr=!0)}if(!qr){Cn.push({callback:an,orderIndex:bn,runOnce:mr,initialHook:br,skip:!1});let ir=et(It,this).has(Qe);!ir&&bn!==0&&(ir=!0,et(It,this).add(Qe)),ir&&Cn.length>1&&et(ze,this).set(Qe,Cn.toSorted((Qn,kr)=>Qn.orderIndex-kr.orderIndex))}}has(Qe){return et(ze,this).has(Qe)&&et(ze,this).get(Qe).length>0}remove(Qe,an){if(!et(ze,this).has(Qe))return!1;const Mt=et(ze,this).get(Qe),Cn=Mt.find(bn=>bn.callback===an);if(Cn){let bn=et(dt,this).get(Qe);return Cn.skip=!0,bn+=1,bn>ct&&(et(ze,this).set(Qe,Mt.filter(mr=>!mr.skip)),bn=0),et(dt,this).set(Qe,bn),!0}return!1}destroy(){et(ze,this).clear(),et(dt,this).clear(),Fe(ze,this,null),Fe(dt,this,null)}}function Ye(Et){et(ze,this).set(Et,[]),et(dt,this).set(Et,0)}function Be(Et,Qe,an){return(Qe=hn(Qe))in Et?Object.defineProperty(Et,Qe,{value:an,enumerable:!0,configurable:!0,writable:!0}):Et[Qe]=an,Et}function hn(Et){var Qe=Je(Et,"string");return typeof Qe=="symbol"?Qe:Qe+""}function Je(Et,Qe){if(typeof Et!="object"||!Et)return Et;var an=Et[Symbol.toPrimitive];if(an!==void 0){var Mt=an.call(Et,Qe||"default");if(typeof Mt!="object")return Mt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Qe==="string"?String:Number)(Et)}const mt=(0,Q.e)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Ae{constructor(){Be(this,"globalBucket",new jt)}static getSingleton(){return Ft()}getBucket(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Qe?(Qe.pluginHookBucket||(Qe.pluginHookBucket=new jt),Qe.pluginHookBucket):this.globalBucket}add(Qe,an){let Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,Cn=arguments.length>3?arguments[3]:void 0;return Array.isArray(an)?(0,B.arrayEach)(an,bn=>this.add(Qe,bn,Mt)):(ce.has(Qe)&&(0,k.ZK)((0,K.substitute)(mt,{hookName:Qe,removedInVersion:ce.get(Qe)})),Y.has(Qe)&&(0,k.ZK)(Y.get(Qe)),this.getBucket(Mt).add(Qe,an,{orderIndex:Cn,runOnce:!1})),this}once(Qe,an){let Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,Cn=arguments.length>3?arguments[3]:void 0;return Array.isArray(an)?(0,B.arrayEach)(an,bn=>this.once(Qe,bn,Mt)):this.getBucket(Mt).add(Qe,an,{orderIndex:Cn,runOnce:!0}),this}addAsFixed(Qe,an){let Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(an)?(0,B.arrayEach)(an,Cn=>this.addAsFixed(Qe,Cn,Mt)):this.getBucket(Mt).add(Qe,an,{initialHook:!0}),this}remove(Qe,an){let Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(Mt).remove(Qe,an)}has(Qe){let an=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(an).has(Qe)}run(Qe,an,Mt,Cn,bn,mr,br,qr){{const ir=this.getBucket().getHooks(an),Qn=ir?ir.length:0;let kr=0;if(Qn)for(;kr<Qn;){if(!ir[kr]||ir[kr].skip){kr+=1;continue}const mn=(0,X.fastCall)(ir[kr].callback,Qe,Mt,Cn,bn,mr,br,qr);mn!==void 0&&(Mt=mn),ir[kr]&&ir[kr].runOnce&&this.remove(an,ir[kr].callback),kr+=1}}{const ir=this.getBucket(Qe).getHooks(an),Qn=ir?ir.length:0;let kr=0;if(Qn)for(;kr<Qn;){if(!ir[kr]||ir[kr].skip){kr+=1;continue}const mn=(0,X.fastCall)(ir[kr].callback,Qe,Mt,Cn,bn,mr,br,qr);mn!==void 0&&(Mt=mn),ir[kr]&&ir[kr].runOnce&&this.remove(an,ir[kr].callback,Qe),kr+=1}}return Mt}destroy(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(Qe).destroy()}register(Qe){this.isRegistered(Qe)||N.push(Qe)}deregister(Qe){this.isRegistered(Qe)&&N.splice(N.indexOf(Qe),1)}isDeprecated(Qe){return Y.has(Qe)||ce.has(Qe)}isRegistered(Qe){return N.indexOf(Qe)>=0}getRegistered(){return N}}const rt=new Ae;function Ft(){return rt}var zt=null},78848:function($,ie,f){"use strict";f.d(ie,{Hf:function(){return W},ed:function(){return J}});var C=f(29297),_=f(13617),B=f(33987),K=f(25813),k=f(11981);const Q="hooksRefRegisterer",X={_hooksStorage:Object.create(null),addHook(I,V){return this._hooksStorage[I]||(this._hooksStorage[I]=[]),this.hot.addHook(I,V),this._hooksStorage[I].push(V),this},removeHooksByKey(I){(0,k.arrayEach)(this._hooksStorage[I]||[],V=>{this.hot.removeHook(I,V)})},clearHooks(){(0,B.objectEach)(this._hooksStorage,(I,V)=>this.removeHooksByKey(V)),this._hooksStorage={}}};(0,B.defineGetter)(X,"MIXIN_NAME",Q,{writable:!1,enumerable:!1});var N=X,ce=f(88555);function Y(I,V,q){return(V=Z(V))in I?Object.defineProperty(I,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):I[V]=q,I}function Z(I){var V=ee(I,"string");return typeof V=="symbol"?V:V+""}function ee(I,V){if(typeof I!="object"||!I)return I;var q=I[Symbol.toPrimitive];if(q!==void 0){var de=q.call(I,V||"default");if(typeof de!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(I)}const le="base",J=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class W{static get EDITOR_TYPE(){return le}constructor(V){Y(this,"hot",void 0),Y(this,"state",J.VIRGIN),Y(this,"_opened",!1),Y(this,"_fullEditMode",!1),Y(this,"_closeCallback",null),Y(this,"TD",null),Y(this,"row",null),Y(this,"col",null),Y(this,"prop",null),Y(this,"originalValue",null),Y(this,"cellProperties",null),this.hot=V,this.init()}_fireCallbacks(V){this._closeCallback&&(this._closeCallback(V),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(V,q,de,ue,ve,pe){this.TD=ue,this.row=V,this.col=q,this.prop=de,this.originalValue=ve,this.cellProperties=pe,this.state=this.isOpened()?this.state:J.VIRGIN}extend(){return class extends this.constructor{}}saveValue(V,q){let de,ue,ve,pe;if(q){const Ee=this.hot.getSelectedLast();de=Math.max(Math.min(Ee[0],Ee[2]),0),ue=Math.max(Math.min(Ee[1],Ee[3]),0),ve=Math.max(Ee[0],Ee[2]),pe=Math.max(Ee[1],Ee[3])}else[de,ue,ve,pe]=[this.row,this.col,null,null];const Se=this.hot.runHooks("modifyGetCellCoords",de,ue,!1,"meta");Array.isArray(Se)&&([de,ue]=Se),this.hot.populateFromArray(de,ue,V,ve,pe,"edit")}beginEditing(V,q){if(this.state!==J.VIRGIN)return;const de=this.hot,ue=de.rowIndexMapper.getRenderableFromVisualIndex(this.row),ve=de.columnIndexMapper.getRenderableFromVisualIndex(this.col),pe=()=>{if(this.state=J.EDITING,this.isInFullEditMode()){const Ee=typeof V=="string"?V:(0,_.stringify)(this.originalValue);this.setValue(Ee)}this.open(q),this._opened=!0,this.focus(),de.view.render(),de.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",pe),de.view.scrollViewport(de._createCellCoords(ue,ve))||(this.hot.removeHook("afterScroll",pe),pe())}finishEditing(V,q,de){let ue;if(de){const ve=this._closeCallback;this._closeCallback=pe=>{ve&&ve(pe),de(pe),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===J.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===J.EDITING){if(V){this.cancelChanges(),this.hot.view.render();return}const ve=this.getValue();this.cellProperties.trimWhitespace?ue=[[typeof ve=="string"?String.prototype.trim.call(ve||""):ve]]:ue=[[ve]],this.state=J.WAITING,this.saveValue(ue,q),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",pe=>{this.state=J.FINISHED,this.discardEditor(pe)}):(this.state=J.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=J.FINISHED,this.discardEditor()}discardEditor(V){this.state===J.FINISHED&&(V===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=J.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=J.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===J.WAITING}getEditedCellRect(){var V;const q=this.getEditedCell();if(!q)return;const{wtOverlays:de,wtViewport:ue}=this.hot.view._wt,ve=this.hot.rootWindow,pe=(0,ce.offset)(q),Se=(0,ce.outerWidth)(q),Ee=(0,ce.offset)(this.hot.rootElement),He=(0,ce.outerWidth)(this.hot.rootElement),Fe=de.topOverlay.holder,et=de.inlineStartOverlay.holder,Oe=Fe!==ve?Fe.scrollTop:0,ct=et!==ve?et.scrollLeft:0,ze=ve.innerWidth-Ee.left-He,{wtTable:dt}=(V=de.getParentOverlay(q))!==null&&V!==void 0?V:this.hot.view._wt,It=dt.name,Sn=["master","inline_start"].includes(It)?Oe:0,jt=["master","top","bottom"].includes(It)?ct:0,Ye=pe.top===Ee.top?0:1;let Be=pe.top-Ee.top-Ye-Sn,hn=0;this.hot.isRtl()?hn=ve.innerWidth-pe.left-Se-ze-1+jt:hn=pe.left-Ee.left-1-jt,["top","top_inline_start_corner"].includes(It)&&(Be+=de.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(It)&&(hn+=Math.abs(de.inlineStartOverlay.getOverlayOffset()));const Je=this.hot.hasColHeaders(),mt=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Ae=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Ft=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(Je&&mt<=0||mt===Ft)&&(Be+=1),Ae<=0&&(hn+=1);const zt=ue.rowsRenderCalculator.startPosition,Et=ue.columnsRenderCalculator.startPosition,Qe=Math.abs(de.inlineStartOverlay.getScrollPosition()),an=de.topOverlay.getScrollPosition(),Mt=(0,ce.getScrollbarWidth)(this.hot.rootDocument);let Cn=q.offsetTop;if(["inline_start","master"].includes(It)&&(Cn+=zt-an),["bottom","bottom_inline_start_corner"].includes(It)){const{wtViewport:Hn,wtTable:Oi}=de.bottomOverlay.clone;Cn+=Hn.getWorkspaceHeight()-Oi.getHeight()-Mt}let bn=q.offsetLeft;this.hot.isRtl()?(bn>=0?bn=dt.getWidth()-q.offsetLeft:bn=Math.abs(bn),bn+=Et-Qe-Se):["top","master","bottom"].includes(It)&&(bn+=Et-Qe);const mr=ve.getComputedStyle(this.TD),br=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",qr=parseInt(mr[br],10)>0?0:1,ir=parseInt(mr.borderTopWidth,10)>0?0:1,Qn=(0,ce.outerWidth)(q)+qr,kr=(0,ce.outerHeight)(q)+ir,mn=(0,ce.hasVerticalScrollbar)(Fe)?Mt:0,Rs=(0,ce.hasHorizontalScrollbar)(et)?Mt:0,Mi=this.hot.view.maximumVisibleElementWidth(bn)-mn+qr,_o=Math.max(this.hot.view.maximumVisibleElementHeight(Cn)-Rs+ir,this.hot.view.getDefaultRowHeight());return{top:Be,start:hn,height:kr,maxHeight:_o,width:Qn,maxWidth:Mi}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const V=this.hot.countRows();let q="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?q="top-inline-start-corner":q="top":this.hot.getSettings().fixedRowsBottom&&this.row>=V-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?q="bottom-inline-start-corner":q="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(q="inline-start"),q}}(0,B.mixin)(W,N)},15227:function($,ie,f){"use strict";f.d(ie,{Jq:function(){return ee},Wu:function(){return N},_f:function(){return ce},qm:function(){return J},y$:function(){return le}});var C=f(29297),_=f.n(C),B=f(58955),K=f(80534);const k=new WeakMap,{register:Q,getItem:X,hasItem:N,getNames:ce,getValues:Y}=(0,K.Z)("editors");function Z(W){const I={},V=W;this.getConstructor=function(){return W},this.getInstance=function(q){return q.guid in I||(I[q.guid]=new V(q)),I[q.guid]},B.P.getSingleton().add("afterDestroy",function(){I[this.guid]=null})}function ee(W,I){let V;if(typeof W=="function")k.get(W)||J(null,W),V=k.get(W);else if(typeof W=="string")V=X(W);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!V)throw Error(`No editor registered under name "${W}"`);return V.getInstance(I)}function le(W){if(typeof W=="function")return W;if(!N(W))throw Error(`No registered editor found under "${W}" name`);return X(W).getConstructor()}function J(W,I){W&&typeof W!="string"&&(I=W,W=I.EDITOR_TYPE);const V=new Z(I);typeof W=="string"&&Q(W,V),k.set(I,V)}},18475:function($,ie,f){"use strict";f.d(ie,{H:function(){return q}});var C=f(29297),_=f(78848),B=f(63955),K=f(94070),k=f(88555),Q=f(46495),X=f(76745),N=f(13617);function ce(de,ue){const ve=(0,k.getCaretPosition)(ue),pe=ue.value.split(`
`);let Se=ve,Ee=0;for(let He=0;He<pe.length;He++){const Fe=pe[He];He!==0&&(Ee+=pe[He-1].length+1);const et=Ee+Fe.length;if(de==="home"?Se=Ee:de==="end"&&(Se=et),ve<=et)break}(0,k.setCaretPosition)(ue,Se)}var Y=f(40629);function Z(de,ue,ve){return(ue=ee(ue))in de?Object.defineProperty(de,ue,{value:ve,enumerable:!0,configurable:!0,writable:!0}):de[ue]=ve,de}function ee(de){var ue=le(de,"string");return typeof ue=="symbol"?ue:ue+""}function le(de,ue){if(typeof de!="object"||!de)return de;var ve=de[Symbol.toPrimitive];if(ve!==void 0){var pe=ve.call(de,ue||"default");if(typeof pe!="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ue==="string"?String:Number)(de)}const J="ht_editor_visible",W="ht_editor_hidden",I="textEditor",V="text";class q extends _.Hf{static get EDITOR_TYPE(){return V}constructor(ue){super(ue),Z(this,"eventManager",new B.Z(this)),Z(this,"autoResize",(0,X.x)(this.hot.rootDocument)),Z(this,"TEXTAREA",void 0),Z(this,"textareaStyle",void 0),Z(this,"TEXTAREA_PARENT",void 0),Z(this,"textareaParentStyle",void 0),Z(this,"layerClass",void 0),this.eventManager=new B.Z(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(ue){this.TEXTAREA.value=ue}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,k.isInternalElement)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(ue,ve,pe,Se,Ee,He){const Fe=this.state;if(super.prepare(ue,ve,pe,Se,Ee,He),!He.readOnly){this.refreshDimensions(!0);const{allowInvalid:et}=He;et&&!this.isOpened()&&(this.TEXTAREA.value=""),Fe!==_.ed.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(ue,ve){this.state===_.ed.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(ue,ve))}focus(){this.TEXTAREA.select(),(0,k.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:ue}=this.hot;this.TEXTAREA=ue.createElement("TEXTAREA"),(0,k.setAttribute)(this.TEXTAREA,[["data-hot-input",""],(0,Y.Qk)(-1)]),(0,k.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=ue.createElement("DIV"),(0,k.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,k.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,k.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,k.addClass)(this.TEXTAREA_PARENT,W),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,K.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,k.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,k.addClass)(this.TEXTAREA_PARENT,W)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const ue=this.TEXTAREA_PARENT.childNodes;let ve=!1;(0,Q.rangeEach)(ue.length-1,pe=>{const Se=ue[pe];if((0,k.hasClass)(Se,"handsontableEditor"))return ve=!0,!1}),(0,k.hasClass)(this.TEXTAREA_PARENT,W)&&(0,k.removeClass)(this.TEXTAREA_PARENT,W),ve?(this.layerClass=J,(0,k.addClass)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),(0,k.addClass)(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const ue=this.hot.toPhysicalRow(this.row),ve=this.hot.getSourceDataAtCell(ue,this.col);this.originalValue=ve,this.setValue(ve),this.refreshDimensions()}refreshDimensions(){let ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==_.ed.EDITING&&!ue)return;if(this.TD=this.getEditedCell(),!this.TD){ue||this.close();return}const{top:ve,start:pe,width:Se,maxWidth:Ee,height:He,maxHeight:Fe}=this.getEditedCellRect();this.textareaParentStyle.top=`${ve}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${pe}px`,this.showEditableElement();const et=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=et.fontSize,this.TEXTAREA.style.fontFamily=et.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(Se,Ee),minHeight:Math.min(He,Fe),maxWidth:Ee,maxHeight:Fe},!0)}bindEvents(){(0,K.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===_.ed.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===_.ed.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const ve=this.hot.getShortcutManager().getContext("editor"),pe={runOnlyIf:()=>(0,N.isDefined)(this.hot.getSelected()),group:I},Se=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};ve.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(Se(),!1),runOnlyIf:Ee=>!this.hot.selection.isMultiple()&&!Ee.altKey},{keys:[["Meta","Enter"]],callback:()=>(Se(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(Se(),!1)},{keys:[["Home"]],callback:(Ee,He)=>{let[Fe]=He;ce(Fe,this.TEXTAREA)}},{keys:[["End"]],callback:(Ee,He)=>{let[Fe]=He;ce(Fe,this.TEXTAREA)}}],pe)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(I)}}},63955:function($,ie,f){"use strict";f.d(ie,{k:function(){return ee}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(76909);function Q(le,J,W){return(J=X(J))in le?Object.defineProperty(le,J,{value:W,enumerable:!0,configurable:!0,writable:!0}):le[J]=W,le}function X(le){var J=N(le,"string");return typeof J=="symbol"?J:J+""}function N(le,J){if(typeof le!="object"||!le)return le;var W=le[Symbol.toPrimitive];if(W!==void 0){var I=W.call(le,J||"default");if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(J==="string"?String:Number)(le)}let ce=0;class Y{constructor(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Q(this,"context",void 0),this.context=J||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(J,W,I){let V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function q(de){I.call(this,Z(de))}return this.context.eventListeners.push({element:J,event:W,callback:I,callbackProxy:q,options:V,eventManager:this}),J.addEventListener(W,q,V),ce+=1,()=>{this.removeEventListener(J,W,I)}}removeEventListener(J,W,I){let V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,q=this.context.eventListeners.length,de;for(;q;)if(q-=1,de=this.context.eventListeners[q],de.event===W&&de.element===J){if(I&&I!==de.callback||V&&de.eventManager!==this)continue;this.context.eventListeners.splice(q,1),de.element.removeEventListener(de.event,de.callbackProxy,de.options),ce-=1}}clearEvents(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let W=this.context.eventListeners.length;for(;W;){W-=1;const I=this.context.eventListeners[W];J&&I.eventManager!==this||(this.context.eventListeners.splice(W,1),I.element.removeEventListener(I.event,I.callbackProxy,I.options),ce-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(J,W){let I=J.document,V=J;I||(I=J.ownerDocument?J.ownerDocument:J,V=I.defaultView);const q={bubbles:!0,cancelable:W!=="mousemove",view:V,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let de;I.createEvent?(de=I.createEvent("MouseEvents"),de.initMouseEvent(W,q.bubbles,q.cancelable,q.view,q.detail,q.screenX,q.screenY,q.clientX,q.clientY,q.ctrlKey,q.altKey,q.shiftKey,q.metaKey,q.button,q.relatedTarget||I.body.parentNode)):de=I.createEventObject(),J.dispatchEvent?J.dispatchEvent(de):J.fireEvent(`on${W}`,de)}}function Z(le){const J=le.stopImmediatePropagation;return le.stopImmediatePropagation=function(){J.apply(this),(0,k.stopImmediatePropagation)(this)},le}ie.Z=Y;function ee(){return ce}},40629:function($,ie,f){"use strict";f.d(ie,{Ak:function(){return Sn},Ct:function(){return Q},DT:function(){return mt},Ez:function(){return hn},JV:function(){return Oe},LO:function(){return ee},Ng:function(){return X},Nl:function(){return J},Nr:function(){return q},Pn:function(){return It},Pp:function(){return V},QK:function(){return de},Qk:function(){return C},Qz:function(){return K},Rn:function(){return B},Up:function(){return Je},Wv:function(){return He},a2:function(){return Ee},a6:function(){return le},cV:function(){return ue},d:function(){return Ye},d5:function(){return Fe},f3:function(){return N},fv:function(){return Se},gw:function(){return ve},iJ:function(){return I},iL:function(){return k},jH:function(){return Ae},l_:function(){return ct},nO:function(){return _},nT:function(){return Be},qt:function(){return pe},rQ:function(){return Y},tm:function(){return ce},w1:function(){return dt},wt:function(){return W},ys:function(){return Z},yz:function(){return et},zR:function(){return ze},zV:function(){return jt}});const C=rt=>["tabindex",rt],_=()=>["role","treegrid"],B=()=>["role","presentation"],K=()=>["role","gridcell"],k=()=>["role","rowheader"],Q=()=>["role","rowgroup"],X=()=>["role","columnheader"],N=()=>["role","row"],ce=()=>["role","menu"],Y=()=>["role","menuitem"],Z=()=>["role","menuitemcheckbox"],ee=()=>["role","combobox"],le=()=>["role","listbox"],J=()=>["role","option"],W=()=>["role","checkbox"],I=()=>["scope","col"],V=()=>["scope","row"],q=()=>["type","text"],de=rt=>["aria-label",rt],ue=()=>["aria-hidden","true"],ve=()=>["aria-disabled","true"],pe=()=>["aria-multiselectable","true"],Se=rt=>["aria-haspopup",rt],Ee=rt=>["aria-rowcount",rt],He=rt=>["aria-colcount",rt],Fe=rt=>["aria-rowindex",rt],et=rt=>["aria-colindex",rt],Oe=rt=>["aria-expanded",rt],ct=rt=>["aria-sort",rt],ze=()=>["aria-readonly","true"],dt=()=>["aria-invalid","true"],It=rt=>["aria-checked",rt],Sn=()=>["aria-selected","true"],jt=()=>["aria-autocomplete","list"],Ye=rt=>["aria-controls",rt],Be=rt=>["aria-activedescendant",rt],hn=rt=>["aria-live",rt],Je=rt=>["aria-relevant",rt],mt=rt=>["aria-setsize",rt],Ae=rt=>["aria-posinset",rt]},11981:function($,ie,f){"use strict";f.r(ie),f.d(ie,{arrayAvg:function(){return dt},arrayEach:function(){return et},arrayFilter:function(){return He},arrayFlatten:function(){return It},arrayMap:function(){return Fe},arrayMax:function(){return ct},arrayMin:function(){return ze},arrayReduce:function(){return Ee},arraySum:function(){return Oe},arrayUnique:function(){return Sn},extendArray:function(){return pe},getDifferenceOfArrays:function(){return jt},getIntersectionOfArrays:function(){return Ye},getUnionOfArrays:function(){return Be},pivot:function(){return Se},stringToArray:function(){return hn},to2dArray:function(){return ve}});var C=f(25813),_=f.n(C),B=f(71441),K=f.n(B),k=f(31702),Q=f.n(k),X=f(89050),N=f.n(X),ce=f(16110),Y=f.n(ce),Z=f(8274),ee=f.n(Z),le=f(64109),J=f.n(le),W=f(92128),I=f.n(W),V=f(48442),q=f.n(V),de=f(78127),ue=f.n(de);function ve(Je){const mt=Je.length;let Ae=0;for(;Ae<mt;)Je[Ae]=[Je[Ae]],Ae+=1}function pe(Je,mt){const Ae=mt.length;let rt=0;for(;rt<Ae;)Je.push(mt[rt]),rt+=1}function Se(Je){const mt=[];if(!Je||Je.length===0||!Je[0]||Je[0].length===0)return mt;const Ae=Je.length,rt=Je[0].length;for(let Ft=0;Ft<Ae;Ft++)for(let zt=0;zt<rt;zt++)mt[zt]||(mt[zt]=[]),mt[zt][Ft]=Je[Ft][zt];return mt}function Ee(Je,mt,Ae,rt){let Ft=-1,zt=Je,Et=Ae;Array.isArray(Je)||(zt=Array.from(Je));const Qe=zt.length;for(rt&&Qe&&(Ft+=1,Et=zt[Ft]),Ft+=1;Ft<Qe;)Et=mt(Et,zt[Ft],Ft,zt),Ft+=1;return Et}function He(Je,mt){let Ae=0,rt=Je;Array.isArray(Je)||(rt=Array.from(Je));const Ft=rt.length,zt=[];let Et=-1;for(;Ae<Ft;){const Qe=rt[Ae];mt(Qe,Ae,rt)&&(Et+=1,zt[Et]=Qe),Ae+=1}return zt}function Fe(Je,mt){let Ae=0,rt=Je;Array.isArray(Je)||(rt=Array.from(Je));const Ft=rt.length,zt=[];let Et=-1;for(;Ae<Ft;){const Qe=rt[Ae];Et+=1,zt[Et]=mt(Qe,Ae,rt),Ae+=1}return zt}function et(Je,mt){let Ae=0,rt=Je;Array.isArray(Je)||(rt=Array.from(Je));const Ft=rt.length;for(;Ae<Ft&&mt(rt[Ae],Ae,rt)!==!1;)Ae+=1;return Je}function Oe(Je){return Ee(Je,(mt,Ae)=>mt+Ae,0)}function ct(Je){return Ee(Je,(mt,Ae)=>mt>Ae?mt:Ae,Array.isArray(Je)?Je[0]:void 0)}function ze(Je){return Ee(Je,(mt,Ae)=>mt<Ae?mt:Ae,Array.isArray(Je)?Je[0]:void 0)}function dt(Je){return Je.length?Oe(Je)/Je.length:0}function It(Je){return Ee(Je,(mt,Ae)=>mt.concat(Array.isArray(Ae)?It(Ae):Ae),[])}function Sn(Je){const mt=[];return et(Je,Ae=>{mt.indexOf(Ae)===-1&&mt.push(Ae)}),mt}function jt(){for(var Je=arguments.length,mt=new Array(Je),Ae=0;Ae<Je;Ae++)mt[Ae]=arguments[Ae];const[rt,...Ft]=[...mt];let zt=rt;return et(Ft,Et=>{zt=zt.filter(Qe=>!Et.includes(Qe))}),zt}function Ye(){for(var Je=arguments.length,mt=new Array(Je),Ae=0;Ae<Je;Ae++)mt[Ae]=arguments[Ae];const[rt,...Ft]=[...mt];let zt=rt;return et(Ft,Et=>{zt=zt.filter(Qe=>Et.includes(Qe))}),zt}function Be(){for(var Je=arguments.length,mt=new Array(Je),Ae=0;Ae<Je;Ae++)mt[Ae]=arguments[Ae];const[rt,...Ft]=[...mt],zt=new Set(rt);return et(Ft,Et=>{et(Et,Qe=>{zt.has(Qe)||zt.add(Qe)})}),Array.from(zt)}function hn(Je){let mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return Je.split(mt)}},94070:function($,ie,f){"use strict";f.r(ie),f.d(ie,{isChrome:function(){return N},isChromeWebKit:function(){return ce},isEdge:function(){return le},isEdgeWebKit:function(){return J},isFirefox:function(){return Y},isFirefoxWebKit:function(){return Z},isIOS:function(){return I},isIpadOS:function(){return V},isLinuxOS:function(){return ue},isMacOS:function(){return de},isMobileBrowser:function(){return W},isSafari:function(){return ee},isWindowsOS:function(){return q},setBrowserMeta:function(){return Q},setPlatformMeta:function(){return X}});var C=f(33987),_=f(54883);const B=ve=>{const pe={value:!1};return pe.test=(Se,Ee)=>{pe.value=ve(Se,Ee)},pe},K={chrome:B((ve,pe)=>/Chrome/.test(ve)&&/Google/.test(pe)),chromeWebKit:B(ve=>/CriOS/.test(ve)),edge:B(ve=>/Edge/.test(ve)),edgeWebKit:B(ve=>/EdgiOS/.test(ve)),firefox:B(ve=>/Firefox/.test(ve)),firefoxWebKit:B(ve=>/FxiOS/.test(ve)),mobile:B(ve=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ve)),safari:B((ve,pe)=>/Safari/.test(ve)&&/Apple Computer/.test(pe))},k={mac:B(ve=>/^Mac/.test(ve)),win:B(ve=>/^Win/.test(ve)),linux:B(ve=>/^Linux/.test(ve)),ios:B(ve=>/iPhone|iPad|iPod/i.test(ve))};function Q(){let{userAgent:ve=navigator.userAgent,vendor:pe=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,C.objectEach)(K,Se=>{let{test:Ee}=Se;return void Ee(ve,pe)})}function X(){let{platform:ve=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,C.objectEach)(k,pe=>{let{test:Se}=pe;return void Se(ve)})}(0,_.isCSR)()&&(Q(),X());function N(){return K.chrome.value}function ce(){return K.chromeWebKit.value}function Y(){return K.firefox.value}function Z(){return K.firefoxWebKit.value}function ee(){return K.safari.value}function le(){return K.edge.value}function J(){return K.edgeWebKit.value}function W(){return K.mobile.value}function I(){return k.ios.value}function V(){let{maxTouchPoints:ve}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return ve>2&&k.mac.value}function q(){return k.win.value}function de(){return k.mac.value}function ue(){return k.linux.value}},40674:function($,ie,f){"use strict";f.d(ie,{ZK:function(){return B},vU:function(){return k}});var C=f(13617);function _(){isDefined(console)&&console.log(...arguments)}function B(){(0,C.isDefined)(console)&&console.warn(...arguments)}function K(){isDefined(console)&&console.info(...arguments)}function k(){(0,C.isDefined)(console)&&console.error(...arguments)}},71050:function($,ie,f){"use strict";f.r(ie),f.d(ie,{countFirstRowKeys:function(){return q},createEmptySpreadsheetData:function(){return I},createSpreadsheetData:function(){return J},createSpreadsheetObjectData:function(){return W},dataRowToChangesArray:function(){return V},isArrayOfArrays:function(){return de},isArrayOfObjects:function(){return ue},spreadsheetColumnIndex:function(){return le},spreadsheetColumnLabel:function(){return ee}});var C=f(25813),_=f.n(C),B=f(48442),K=f.n(B),k=f(49691),Q=f.n(k),X=f(97487),N=f.n(X),ce=f(33987);const Y="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Z=Y.length;function ee(ve){let pe=ve+1,Se="",Ee;for(;pe>0;)Ee=(pe-1)%Z,Se=String.fromCharCode(65+Ee)+Se,pe=parseInt((pe-Ee)/Z,10);return Se}function le(ve){let pe=0;if(ve)for(let Se=0,Ee=ve.length-1;Se<ve.length;Se+=1,Ee-=1)pe+=jT(Z,Ee)*(Y.indexOf(ve[Se])+1);return pe-=1,pe}function J(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const Se=[];let Ee,He;for(Ee=0;Ee<ve;Ee++){const Fe=[];for(He=0;He<pe;He++)Fe.push(ee(He)+(Ee+1));Se.push(Fe)}return Se}function W(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const Se=[];let Ee,He;for(Ee=0;Ee<ve;Ee++){const Fe={};for(He=0;He<pe;He++)Fe[`prop${He}`]=ee(He)+(Ee+1);Se.push(Fe)}return Se}function I(ve,pe){const Se=[];let Ee;for(let He=0;He<ve;He++){Ee=[];for(let Fe=0;Fe<pe;Fe++)Ee.push("");Se.push(Ee)}return Se}function V(ve){let pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Se=ve;const Ee=[];return(!Array.isArray(ve)||!Array.isArray(ve[0]))&&(Se=[ve]),Se.forEach((He,Fe)=>{Array.isArray(He)?He.forEach((et,Oe)=>{Ee.push([Fe+pe,Oe,et])}):Object.keys(He).forEach(et=>{Ee.push([Fe+pe,et,He[et]])})}),Ee}function q(ve){let pe=0;return Array.isArray(ve)&&(ve[0]&&Array.isArray(ve[0])?pe=ve[0].length:ve[0]&&(0,ce.isObject)(ve[0])&&(pe=(0,ce.deepObjectSize)(ve[0]))),pe}function de(ve){return!!(Array.isArray(ve)&&ve.length&&ve.every(pe=>Array.isArray(pe)))}function ue(ve){return!!(Array.isArray(ve)&&ve.length&&ve.every(pe=>typeof pe=="object"&&!Array.isArray(pe)&&pe!==null))}},95742:function($,ie,f){"use strict";f.r(ie),f.d(ie,{getNormalizedDate:function(){return C}});function C(_){const B=new Date(_);return isNaN(new Date(`${_}T00:00`).getDate())?B:new Date(B.getTime()+B.getTimezoneOffset()*6e4)}},88555:function($,ie,f){"use strict";f.r(ie),f.d(ie,{HTML_CHARACTERS:function(){return Sn},addClass:function(){return et},addEvent:function(){return ir},clearTextSelection:function(){return Mi},closest:function(){return q},closestDown:function(){return de},empty:function(){return It},fastInnerHTML:function(){return jt},fastInnerText:function(){return Ye},findFirstParentWithClass:function(){return ue},getCaretPosition:function(){return kr},getCssTransform:function(){return yn},getFrameElement:function(){return W},getMaximumScrollLeft:function(){return Qe},getMaximumScrollTop:function(){return Et},getParent:function(){return le},getParentWindow:function(){return I},getScrollLeft:function(){return Ft},getScrollTop:function(){return rt},getScrollableElement:function(){return zt},getScrollbarWidth:function(){return pr},getSelectionEndPosition:function(){return mn},getSelectionText:function(){return Rs},getStyle:function(){return Mt},getTrimmingContainer:function(){return an},getWindowScrollLeft:function(){return Ae},getWindowScrollTop:function(){return mt},hasAccessToParentWindow:function(){return V},hasClass:function(){return Fe},hasHorizontalScrollbar:function(){return Qi},hasVerticalScrollbar:function(){return Vs},hasZeroHeight:function(){return hn},index:function(){return pe},innerHeight:function(){return br},innerWidth:function(){return qr},isChildOf:function(){return ve},isDetached:function(){return en},isHTMLElement:function(){return as},isInput:function(){return In},isInternalElement:function(){return J},isOutsideInput:function(){return un},isVisible:function(){return Be},makeElementContentEditableAndSelectItsContent:function(){return di},matchesCSSRules:function(){return Cn},observeVisibilityChangeOnce:function(){return Vr},offset:function(){return Je},outerHeight:function(){return mr},outerWidth:function(){return bn},overlayContainsElement:function(){return Se},removeAttribute:function(){return ze},removeClass:function(){return Oe},removeContentEditableFromElementAndDeselect:function(){return Mr},removeEvent:function(){return Qn},removeTextNodes:function(){return dt},resetCssTransform:function(){return qi},runWithSelectedContendEditableElement:function(){return js},selectElementIfAllowed:function(){return Xn},setAttribute:function(){return ct},setCaretPosition:function(){return _o},setOverlayPosition:function(){return Ln}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(48442),Q=f.n(k),X=f(78127),N=f.n(X),ce=f(97487),Y=f.n(ce),Z=f(22492),ee=f(40629);function le(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,St=-1,Ke=null,Gt=Te;for(;Gt!==null;){if(St===tt){Ke=Gt;break}Gt.host&&Gt.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Gt=Gt.host:(St+=1,Gt=Gt.parentNode)}return Ke}function J(Te,tt){const St=Te.closest(".handsontable");return!!St&&(St.parentNode===tt||St===tt)}function W(Te){return Object.getPrototypeOf(Te.parent)&&Te.frameElement}function I(Te){return W(Te)&&Te.parent}function V(Te){return!!Object.getPrototypeOf(Te.parent)}function q(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],St=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:Ke,DOCUMENT_FRAGMENT_NODE:Gt}=Node;let Vn=Te;for(;Vn!=null&&Vn!==St;){const{nodeType:$r,nodeName:Ur}=Vn;if($r===Ke&&(tt.includes(Ur)||tt.includes(Vn)))return Vn;const{host:sr}=Vn;sr&&$r===Gt?Vn=sr:Vn=Vn.parentNode}return null}function de(Te,tt,St){const Ke=[];let Gt=Te;for(;Gt&&(Gt=q(Gt,tt,St),!(!Gt||St&&!St.contains(Gt)));)Ke.push(Gt),Gt.host&&Gt.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Gt=Gt.host:Gt=Gt.parentNode;const Vn=Ke.length;return Vn?Ke[Vn-1]:null}function ue(Te,tt){const St={element:void 0,classNames:[]};let Ke=Te;for(;Ke!==null&&Ke!==Te.ownerDocument.documentElement&&!St.element;){if(typeof tt=="string"&&Ke.classList.contains(tt))St.element=Ke,St.classNames.push(tt);else if(tt instanceof RegExp){const Gt=Array.from(Ke.classList).filter(Vn=>tt.test(Vn));Gt.length&&(St.element=Ke,St.classNames.push(...Gt))}Ke=Ke.parentElement}return St}function ve(Te,tt){let St=Te.parentNode,Ke=[];for(typeof tt=="string"?Te.defaultView?Ke=Array.prototype.slice.call(Te.querySelectorAll(tt),0):Ke=Array.prototype.slice.call(Te.ownerDocument.querySelectorAll(tt),0):Ke.push(tt);St!==null;){if(Ke.indexOf(St)>-1)return!0;St=St.parentNode}return!1}function pe(Te){let tt=0,St=Te;if(St.previousSibling)for(;St=St.previousSibling;)tt+=1;return tt}function Se(Te,tt,St){const Ke=St.parentElement.querySelector(`.ht_clone_${Te}`);return Ke?Ke.contains(tt):null}function Ee(Te){return!Te||!Te.length?[]:Te.filter(tt=>!!tt)}function He(Te,tt){if(!Te||!Te.length)return tt?{regexFree:[],regexes:[]}:[];const St=[],Ke=[];return Ke.push(...Te.filter(Gt=>{const Vn=Gt instanceof RegExp;return Vn&&tt&&St.push(Gt),!Vn})),tt?{regexFree:Ke,regexes:St}:Ke}function Fe(Te,tt){return Te.classList===void 0||typeof tt!="string"||tt===""?!1:Te.classList.contains(tt)}function et(Te,tt){typeof tt=="string"&&(tt=tt.split(" ")),tt=Ee(tt),tt.length>0&&Te.classList.add(...tt)}function Oe(Te,tt){typeof tt=="string"?tt=tt.split(" "):tt instanceof RegExp&&(tt=[tt]);let{regexFree:St,regexes:Ke}=He(tt,!0);St=Ee(St),St.length>0&&Te.classList.remove(...St),Ke.forEach(Gt=>{Te.classList.forEach(Vn=>{Gt.test(Vn)&&Te.classList.remove(Vn)})})}function ct(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],St=arguments.length>2?arguments[2]:void 0;Array.isArray(tt)||(tt=[[tt,St]]),tt.forEach(Ke=>{Array.isArray(Ke)&&Ke[0]!==""&&Te.setAttribute(...Ke)})}function ze(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof tt=="string"?tt=tt.split(" "):tt instanceof RegExp&&(tt=[tt]);const{regexFree:St,regexes:Ke}=He(tt,!0);St.forEach(Gt=>{Gt!==""&&Te.removeAttribute(Gt)}),Ke.forEach(Gt=>{Te.getAttributeNames().forEach(Vn=>{Gt.test(Vn)&&Te.removeAttribute(Vn)})})}function dt(Te){if(Te.nodeType===3)Te.parentNode.removeChild(Te);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(Te.nodeName)>-1){const tt=Te.childNodes;for(let St=tt.length-1;St>=0;St--)dt(tt[St])}}function It(Te){let tt;for(;tt=Te.lastChild;)Te.removeChild(tt)}const Sn=/(<(.*)>|&(.*);)/;function jt(Te,tt){let St=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Sn.test(tt)?Te.innerHTML=St?(0,Z.sanitize)(tt):tt:Ye(Te,tt)}function Ye(Te,tt){const St=Te.firstChild;St&&St.nodeType===3&&St.nextSibling===null?St.textContent=tt:(It(Te),Te.appendChild(Te.ownerDocument.createTextNode(tt)))}function Be(Te){const tt=Te.ownerDocument.documentElement,St=Te.ownerDocument.defaultView;let Ke=Te;for(;Ke!==tt;){if(Ke===null)return!1;if(Ke.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(Ke.host){if(Ke.host.impl)return Be(Ke.host.impl);if(Ke.host)return Be(Ke.host);throw new Error("Lost in Web Components world")}else return!1;else if(St.getComputedStyle(Ke).display==="none")return!1;Ke=Ke.parentNode}return!0}function hn(Te){const St=Te.ownerDocument.defaultView;let Ke=Te;for(;Ke.parentNode;){if(Ke.style.height==="0px"||Ke.style.height==="0")return St.getComputedStyle(Ke).overflow==="hidden";Ke=Ke.parentNode}return!1}function Je(Te){const tt=Te.ownerDocument,St=tt.defaultView,Ke=tt.documentElement;let Gt=Te,Vn,$r,Ur;for(Vn=Gt.offsetLeft,$r=Gt.offsetTop,Ur=Gt;(Gt=Gt.offsetParent)&&!(Gt===tt.body||!("offsetLeft"in Gt));)Vn+=Gt.offsetLeft,$r+=Gt.offsetTop,Ur=Gt;return Ur&&Ur.style.position==="fixed"&&(Vn+=St.pageXOffset||Ke.scrollLeft,$r+=St.pageYOffset||Ke.scrollTop),{left:Vn,top:$r}}function mt(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Ae(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function rt(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return Te===tt?mt(tt):Te.scrollTop}function Ft(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return Te===tt?Ae(tt):Te.scrollLeft}function zt(Te){let tt=Te.ownerDocument,St=tt?tt.defaultView:void 0;tt||(tt=Te.document?Te.document:Te,St=tt.defaultView);const Ke=["auto","scroll"];let Gt=Te.parentNode;for(;Gt&&Gt.style&&tt.body!==Gt;){let{overflow:Vn,overflowX:$r,overflowY:Ur}=Gt.style;if([Vn,$r,Ur].includes("scroll"))return Gt;if({overflow:Vn,overflowX:$r,overflowY:Ur}=St.getComputedStyle(Gt),Ke.includes(Vn)||Ke.includes($r)||Ke.includes(Ur)||Gt.clientHeight<=Gt.scrollHeight+1&&(Ke.includes(Ur)||Ke.includes(Vn))||Gt.clientWidth<=Gt.scrollWidth+1&&(Ke.includes($r)||Ke.includes(Vn)))return Gt;Gt=Gt.parentNode}return St}function Et(Te){return Te.scrollHeight-Te.clientHeight}function Qe(Te){return Te.scrollWidth-Te.clientWidth}function an(Te){const tt=Te.ownerDocument,St=tt.defaultView;let Ke=Te.parentNode;for(;Ke&&Ke.style&&tt.body!==Ke;){if(Ke.style.overflow!=="visible"&&Ke.style.overflow!=="")return Ke;const Gt=St.getComputedStyle(Ke),Vn=["scroll","hidden","auto"],$r=Gt.getPropertyValue("overflow"),Ur=Gt.getPropertyValue("overflow-y"),sr=Gt.getPropertyValue("overflow-x");if(Vn.includes($r)||Vn.includes(Ur)||Vn.includes(sr))return Ke;Ke=Ke.parentNode}return St}function Mt(Te,tt){let St=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(Te){if(Te===St)return tt==="width"?`${St.innerWidth}px`:tt==="height"?`${St.innerHeight}px`:void 0}else return;const Ke=Te.style[tt];if(Ke!==""&&Ke!==void 0)return Ke;const Gt=St.getComputedStyle(Te);if(Gt[tt]!==""&&Gt[tt]!==void 0)return Gt[tt]}function Cn(Te,tt){const{selectorText:St}=tt;let Ke=!1;return tt.type===CSSRule.STYLE_RULE&&St&&(Te.msMatchesSelector?Ke=Te.msMatchesSelector(St):Te.matches&&(Ke=Te.matches(St))),Ke}function bn(Te){return Te.offsetWidth}function mr(Te){return Te.offsetHeight}function br(Te){return Te.clientHeight||Te.innerHeight}function qr(Te){return Te.clientWidth||Te.innerWidth}function ir(Te,tt,St){Te.addEventListener(tt,St,!1)}function Qn(Te,tt,St){Te.removeEventListener(tt,St,!1)}function kr(Te){return Te.selectionStart?Te.selectionStart:0}function mn(Te){return Te.selectionEnd?Te.selectionEnd:0}function Rs(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const tt=Te.document;let St="";return Te.getSelection?St=Te.getSelection().toString():tt.selection&&tt.selection.type!=="Control"&&(St=tt.selection.createRange().text),St}function Mi(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;Te.getSelection&&(Te.getSelection().empty?Te.getSelection().empty():Te.getSelection().removeAllRanges&&Te.getSelection().removeAllRanges())}function _o(Te,tt,St){if(St===void 0&&(St=tt),Te.setSelectionRange){Te.focus();try{Te.setSelectionRange(tt,St)}catch(Ke){const Gt=Te.parentNode,Vn=Gt.style.display;Gt.style.display="block",Te.setSelectionRange(tt,St),Gt.style.display=Vn}}}let Hn;function Oi(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const tt=Te.createElement("div");tt.style.height="200px",tt.style.width="100%";const St=Te.createElement("div");St.style.boxSizing="content-box",St.style.height="150px",St.style.left="0px",St.style.overflow="hidden",St.style.position="absolute",St.style.top="0px",St.style.width="200px",St.style.visibility="hidden",St.appendChild(tt),(Te.body||Te.documentElement).appendChild(St);const Ke=tt.offsetWidth;St.style.overflow="scroll";let Gt=tt.offsetWidth;return Ke===Gt&&(Gt=St.clientWidth),(Te.body||Te.documentElement).removeChild(St),Ke-Gt}function pr(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Hn===void 0&&(Hn=Oi(Te)),Hn}function Vs(Te){return Te instanceof Window?Te.document.body.scrollHeight>Te.innerHeight:Te.offsetWidth!==Te.clientWidth}function Qi(Te){return Te instanceof Window?Te.document.body.scrollWidth>Te.innerWidth:Te.offsetHeight!==Te.clientHeight}function Ln(Te,tt,St){Te.style.transform=`translate3d(${tt},${St},0)`}function yn(Te){let tt;return Te.style.transform&&(tt=Te.style.transform)!==""?["transform",tt]:-1}function qi(Te){Te.style.transform&&Te.style.transform!==""&&(Te.style.transform="")}function In(Te){return Te&&(["INPUT","SELECT","TEXTAREA"].indexOf(Te.nodeName)>-1||Te.contentEditable==="true")}function un(Te){return In(Te)&&Te.hasAttribute("data-hot-input")===!1}function Xn(Te){const tt=Te.ownerDocument.activeElement;un(tt)||Te.select()}function en(Te){return!Te.parentNode}function Vr(Te,tt){new IntersectionObserver((Ke,Gt)=>{Ke.forEach(Vn=>{Vn.isIntersecting&&Te.offsetParent!==null&&(tt(),Gt.unobserve(Te))})},{root:Te.ownerDocument.body}).observe(Te)}function di(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,St=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const Ke=Te.ownerDocument,Gt=Ke.createRange(),Vn=Ke.defaultView.getSelection();ct(Te,"contenteditable",!0),St&&ct(Te,...(0,ee.cV)()),tt&&et(Te,"invisibleSelection"),Gt.selectNodeContents(Te),Vn.removeAllRanges(),Vn.addRange(Gt)}function Mr(Te){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const St=Te.ownerDocument.defaultView.getSelection();Te.hasAttribute("aria-hidden")&&Te.removeAttribute("aria-hidden"),St.removeAllRanges(),tt&&Oe(Te,"invisibleSelection"),Te.removeAttribute("contenteditable")}function js(Te,tt){let St=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;di(Te,St),tt(),Mr(Te,St)}function as(Te){var tt;const St=Te==null||(tt=Te.ownerDocument)===null||tt===void 0?void 0:tt.defaultView.Element;return!!(St&&St!==null&&Te instanceof St)}},76909:function($,ie,f){"use strict";f.r(ie),f.d(ie,{isImmediatePropagationStopped:function(){return B},isLeftClick:function(){return k},isRightClick:function(){return K},isTouchEvent:function(){return Q},offsetRelativeTo:function(){return X},stopImmediatePropagation:function(){return _}});var C=f(88555);function _(N){N.isImmediatePropagationEnabled=!1,N.cancelBubble=!0}function B(N){return N.isImmediatePropagationEnabled===!1}function K(N){return N.button===2}function k(N){return N.button===0}function Q(N){return N instanceof TouchEvent}function X(N,ce){const Y={x:N.offsetX,y:N.offsetY};let Z=N.target;if(!(0,C.isHTMLElement)(ce)||Z!==ce&&Z.contains(ce))return Y;for(;Z!==ce;)Y.x+=Z.offsetLeft,Y.y+=Z.offsetTop,Z=Z.offsetParent;return Y}},54883:function($,ie,f){"use strict";f.r(ie),f.d(ie,{cancelAnimationFrame:function(){return _},getComparisonFunction:function(){return Q},isCSR:function(){return K},isTouchSupported:function(){return B},requestAnimationFrame:function(){return C}});function C(X){return window.requestAnimationFrame(X)}function _(X){window.cancelAnimationFrame(X)}function B(){return"ontouchstart"in window}function K(){return typeof window!="undefined"}let k;function Q(X){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k||(typeof Intl=="object"?k=new Intl.Collator(X,N).compare:typeof String.prototype.localeCompare=="function"?k=(ce,Y)=>`${ce}`.localeCompare(Y):k=(ce,Y)=>ce===Y?0:ce>Y?-1:1,k)}},27122:function($,ie,f){"use strict";f.r(ie),f.d(ie,{curry:function(){return ce},curryRight:function(){return Y},debounce:function(){return Q},fastCall:function(){return Z},isFunction:function(){return B},partial:function(){return N},pipe:function(){return X},throttle:function(){return K},throttleAfterHits:function(){return k}});var C=f(11981),_=f(13617);function B(ee){return typeof ee=="function"}function K(ee){let le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,J=0;const W={lastCallThrottled:!0};let I=null;function V(){for(var q=arguments.length,de=new Array(q),ue=0;ue<q;ue++)de[ue]=arguments[ue];const ve=Date.now();let pe=!1;W.lastCallThrottled=!0,J||(J=ve,pe=!0);const Se=le-(ve-J);return pe?(W.lastCallThrottled=!1,ee.apply(this,de)):(I&&clearTimeout(I),I=setTimeout(()=>{W.lastCallThrottled=!1,ee.apply(this,de),J=0,I=void 0},Se)),W}return V}function k(ee){let le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const W=K(ee,le);let I=J;function V(){I=J}function q(){for(var de=arguments.length,ue=new Array(de),ve=0;ve<de;ve++)ue[ve]=arguments[ve];return I?(I-=1,ee.apply(this,ue)):W.apply(this,ue)}return q.clearHits=V,q}function Q(ee){let le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,J=null,W;function I(){for(var V=arguments.length,q=new Array(V),de=0;de<V;de++)q[de]=arguments[de];return J&&clearTimeout(J),J=setTimeout(()=>{W=ee.apply(this,q)},le),W}return I}function X(){for(var ee=arguments.length,le=new Array(ee),J=0;J<ee;J++)le[J]=arguments[J];const[W,...I]=le;return function(){for(var q=arguments.length,de=new Array(q),ue=0;ue<q;ue++)de[ue]=arguments[ue];return(0,C.arrayReduce)(I,(ve,pe)=>pe(ve),W.apply(this,de))}}function N(ee){for(var le=arguments.length,J=new Array(le>1?le-1:0),W=1;W<le;W++)J[W-1]=arguments[W];return function(){for(var V=arguments.length,q=new Array(V),de=0;de<V;de++)q[de]=arguments[de];return ee.apply(this,J.concat(q))}}function ce(ee){const le=ee.length;function J(W){return function(){for(var V=arguments.length,q=new Array(V),de=0;de<V;de++)q[de]=arguments[de];const ue=W.concat(q);let ve;return ue.length>=le?ve=ee.apply(this,ue):ve=J(ue),ve}}return J([])}function Y(ee){const le=ee.length;function J(W){return function(){for(var V=arguments.length,q=new Array(V),de=0;de<V;de++)q[de]=arguments[de];const ue=W.concat(q.reverse());let ve;return ue.length>=le?ve=ee.apply(this,ue):ve=J(ue),ve}}return J([])}function Z(ee,le,J,W,I,V,q,de){return(0,_.isDefined)(de)?ee.call(le,J,W,I,V,q,de):(0,_.isDefined)(q)?ee.call(le,J,W,I,V,q):(0,_.isDefined)(V)?ee.call(le,J,W,I,V):(0,_.isDefined)(I)?ee.call(le,J,W,I):(0,_.isDefined)(W)?ee.call(le,J,W):(0,_.isDefined)(J)?ee.call(le,J):ee.call(le)}},13617:function($,ie,f){"use strict";f.r(ie),f.d(ie,{_injectProductInfo:function(){return ue},isDefined:function(){return k},isEmpty:function(){return X},isRegExp:function(){return N},isUndefined:function(){return Q},stringify:function(){return K}});var C=f(11333),_=f.n(C),B=f(8767);function K(pe){let Se;switch(typeof pe){case"string":case"number":Se=`${pe}`;break;case"object":Se=pe===null?"":pe.toString();break;case"undefined":Se="";break;default:Se=pe.toString();break}return Se}function k(pe){return typeof pe!="undefined"}function Q(pe){return typeof pe=="undefined"}function X(pe){return pe===null||pe===""||Q(pe)}function N(pe){return Object.prototype.toString.call(pe)==="[object RegExp]"}const ce="length",Y=pe=>parseInt(pe,16),Z=pe=>parseInt(pe,10),ee=(pe,Se,Ee)=>pe.substr(Se,Ee),le=pe=>pe.codePointAt(0)-65,J=pe=>`${pe}`.replace(/\-/g,""),W=pe=>Y(ee(J(pe),Y("12"),le("F")))/(Y(ee(J(pe),le("B"),~~![][ce]))||9),I=()=>typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let V=!1;const q={invalid:()=>(0,B.e)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:pe=>{let{keyValidityDate:Se,hotVersion:Ee}=pe;return(0,B.e)`
    The license key for Handsontable expired on ${Se}, and is not valid for the installed\x20
    version ${Ee}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${Se}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,B.e)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},de={invalid:()=>(0,B.e)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:pe=>{let{keyValidityDate:Se,hotVersion:Ee}=pe;return(0,B.e)`
    The license key for Handsontable expired on ${Se}, and is not valid for the installed\x20
    version ${Ee}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${Se}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,B.e)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ue(pe,Se){const Ee=!X(pe),He=typeof pe=="string"&&pe.toLowerCase()==="non-commercial-and-evaluation",Fe="15.3.0";let et,Oe="invalid",ct="invalid";pe=J(pe||"");const ze=ve(pe);if(Ee||He||ze)if(ze){const dt=_()("29/04/2025","DD/MM/YYYY"),It=Math.floor(dt.toDate().getTime()/864e5),Sn=W(pe);et=_()((Sn+1)*864e5,"x").format("MMMM DD, YYYY"),It>Sn?(Oe="expired",ct="expired"):(Oe="valid",ct="valid")}else He?(Oe="non_commercial",ct="valid"):(Oe="invalid",ct="invalid");else Oe="missing",ct="missing";if(I()&&(Oe="valid",ct="valid"),!V&&Oe!=="valid"&&(q[Oe]({keyValidityDate:et,hotVersion:Fe})&&console[Oe==="non_commercial"?"info":"warn"](q[Oe]({keyValidityDate:et,hotVersion:Fe})),V=!0),ct!=="valid"&&Se.parentNode&&de[ct]({keyValidityDate:et,hotVersion:Fe})){const It=document.createElement("div");It.className="handsontable hot-display-license-info",It.innerHTML=de[ct]({keyValidityDate:et,hotVersion:Fe}),Se.parentNode.insertBefore(It,Se.nextSibling)}}function ve(pe){let Se=[][ce],Ee=Se;if(pe[ce]!==le("Z"))return!1;for(let He="",Fe="B<H4P+".split(""),et=le(Fe.shift());et;et=le(Fe.shift()||"A"))--et<""[ce]?Ee=Ee|(Z(`${Z(Y(He)+(Y(ee(pe,Math.abs(et),2))+[]).padStart(2,"0"))}`)%97||2)>>1:He=ee(pe,et,et?Fe[ce]===1?9:8:6);return Ee===Se}},46495:function($,ie,f){"use strict";f.r(ie),f.d(ie,{clamp:function(){return Ee},isNumeric:function(){return de},isNumericLike:function(){return ue},rangeEach:function(){return ve},rangeEachReverse:function(){return pe},valueAccordingPercent:function(){return Se}});var C=f(71441),_=f.n(C),B=f(31702),K=f.n(B),k=f(89050),Q=f.n(k),X=f(16110),N=f.n(X),ce=f(8274),Y=f.n(ce),Z=f(64109),ee=f.n(Z),le=f(92128),J=f.n(le),W=f(48442),I=f.n(W),V=f(73190),q=f.n(V);function de(He){let Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const et=typeof He;if(et==="number")return!isNaN(He)&&isFinite(He);if(et==="string"){if(He.length===0)return!1;if(He.length===1)return/\d/.test(He);const Oe=Array.from(new Set([".",...Fe])).map(ct=>`\\${ct}`).join("|");return new RegExp(`^[+-]?(((${Oe})?\\d+((${Oe})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(He.trim())}else if(et==="object")return!!He&&typeof He.valueOf()=="number"&&!(He instanceof Date);return!1}function ue(He){return de(He,[","])}function ve(He,Fe,et){let Oe=-1;for(typeof Fe=="function"?(et=Fe,Fe=He):Oe=He-1;++Oe<=Fe&&et(Oe)!==!1;);}function pe(He,Fe,et){let Oe=He+1;for(typeof Fe=="function"&&(et=Fe,Fe=0);--Oe>=Fe&&et(Oe)!==!1;);}function Se(He,Fe){return Fe=parseInt(Fe.toString().replace("%",""),10),Fe=isNaN(Fe)?0:Fe,parseInt(He*Fe/100,10)}function Ee(He,Fe,et){return Math.min(He,Fe)===He?Fe:Math.max(He,et)===He?et:He}},33987:function($,ie,f){"use strict";f.r(ie),f.d(ie,{clone:function(){return V},createObjectPropListener:function(){return Fe},deepClone:function(){return I},deepExtend:function(){return W},deepObjectSize:function(){return He},defineGetter:function(){return ve},duckSchema:function(){return ee},extend:function(){return J},getProperty:function(){return Se},hasOwnProperty:function(){return et},inherit:function(){return le},isObject:function(){return ue},isObjectEqual:function(){return de},mixin:function(){return q},objectEach:function(){return pe},setProperty:function(){return Ee}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(18601),Q=f.n(k),X=f(48442),N=f.n(X),ce=f(97487),Y=f.n(ce),Z=f(11981);function ee(Oe){let ct;return Array.isArray(Oe)?ct=Oe.length?new Array(Oe.length).fill(null):[]:(ct={},pe(Oe,(ze,dt)=>{dt!=="__children"&&(ze&&typeof ze=="object"&&!Array.isArray(ze)?ct[dt]=ee(ze):Array.isArray(ze)?ze.length&&typeof ze[0]=="object"&&!Array.isArray(ze[0])?ct[dt]=[ee(ze[0])]:ct[dt]=[]:ct[dt]=null)})),ct}function le(Oe,ct){return ct.prototype.constructor=ct,Oe.prototype=new ct,Oe.prototype.constructor=Oe,Oe}function J(Oe,ct,ze){const dt=Array.isArray(ze);return pe(ct,(It,Sn)=>{(dt===!1||ze.includes(Sn))&&(Oe[Sn]=It)}),Oe}function W(Oe,ct){pe(ct,(ze,dt)=>{ct[dt]&&typeof ct[dt]=="object"?(Oe[dt]||(Array.isArray(ct[dt])?Oe[dt]=[]:Object.prototype.toString.call(ct[dt])==="[object Date]"?Oe[dt]=ct[dt]:Oe[dt]={}),W(Oe[dt],ct[dt])):Oe[dt]=ct[dt]})}function I(Oe){return typeof Oe=="object"?JSON.parse(JSON.stringify(Oe)):Oe}function V(Oe){const ct={};return pe(Oe,(ze,dt)=>{ct[dt]=ze}),ct}function q(Oe){Oe.MIXINS||(Oe.MIXINS=[]);for(var ct=arguments.length,ze=new Array(ct>1?ct-1:0),dt=1;dt<ct;dt++)ze[dt-1]=arguments[dt];return(0,Z.arrayEach)(ze,It=>{Oe.MIXINS.push(It.MIXIN_NAME),pe(It,(Sn,jt)=>{if(Oe.prototype[jt]!==void 0)throw new Error(`Mixin conflict. Property '${jt}' already exist and cannot be overwritten.`);if(typeof Sn=="function")Oe.prototype[jt]=Sn;else{const Ye=function(Je,mt){const Ae=`_${Je}`,rt=Ft=>{let zt=Ft;return(Array.isArray(zt)||ue(zt))&&(zt=I(zt)),zt};return function(){return this[Ae]===void 0&&(this[Ae]=rt(mt)),this[Ae]}},Be=function(Je){const mt=`_${Je}`;return function(Ae){this[mt]=Ae}};Object.defineProperty(Oe.prototype,jt,{get:Ye(jt,Sn),set:Be(jt),configurable:!0})}})}),Oe}function de(Oe,ct){return JSON.stringify(Oe)===JSON.stringify(ct)}function ue(Oe){return Object.prototype.toString.call(Oe)==="[object Object]"}function ve(Oe,ct,ze,dt){dt.value=ze,dt.writable=dt.writable!==!1,dt.enumerable=dt.enumerable!==!1,dt.configurable=dt.configurable!==!1,Object.defineProperty(Oe,ct,dt)}function pe(Oe,ct){for(const ze in Oe)if((!Oe.hasOwnProperty||Oe.hasOwnProperty&&Object.prototype.hasOwnProperty.call(Oe,ze))&&ct(Oe[ze],ze,Oe)===!1)break;return Oe}function Se(Oe,ct){const ze=ct.split(".");let dt=Oe;return pe(ze,It=>{if(dt=dt[It],dt===void 0)return dt=void 0,!1}),dt}function Ee(Oe,ct,ze){if(typeof ct!="string")return;const dt=ct.split(".");let It=Oe;dt.forEach((Sn,jt)=>{Sn==="__proto__"||Sn==="constructor"||Sn==="prototype"||(jt!==dt.length-1?(et(It,Sn)||(It[Sn]={}),It=It[Sn]):It[Sn]=ze)})}function He(Oe){if(!ue(Oe))return 0;const ct=function(ze){let dt=0;return ue(ze)?pe(ze,(It,Sn)=>{Sn!=="__children"&&(dt+=ct(It))}):dt+=1,dt};return ct(Oe)}function Fe(Oe){let ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const ze=`_${ct}`,dt={_touched:!1,[ze]:Oe,isTouched(){return this._touched}};return Object.defineProperty(dt,ct,{get(){return this[ze]},set(It){this._touched=!0,this[ze]=It},enumerable:!0,configurable:!0}),dt}function et(Oe,ct){return Object.prototype.hasOwnProperty.call(Oe,ct)}},22492:function($,ie,f){"use strict";f.r(ie),f.d(ie,{equalsIgnoreCase:function(){return pr},isPercentValue:function(){return Qi},randomString:function(){return Vs},sanitize:function(){return qi},stripTags:function(){return yn},substitute:function(){return Ln},toUpperCaseFirst:function(){return Oi}});var C=f(25813);const{entries:_,setPrototypeOf:B,isFrozen:K,getPrototypeOf:k,getOwnPropertyDescriptor:Q}=Object;let{freeze:X,seal:N,create:ce}=Object,{apply:Y,construct:Z}=typeof Reflect!="undefined"&&Reflect;X||(X=function(un){return un}),N||(N=function(un){return un}),Y||(Y=function(un,Xn,en){return un.apply(Xn,en)}),Z||(Z=function(un,Xn){return new un(...Xn)});const ee=Fe(Array.prototype.forEach),le=Fe(Array.prototype.lastIndexOf),J=Fe(Array.prototype.pop),W=Fe(Array.prototype.push),I=Fe(Array.prototype.splice),V=Fe(String.prototype.toLowerCase),q=Fe(String.prototype.toString),de=Fe(String.prototype.match),ue=Fe(String.prototype.replace),ve=Fe(String.prototype.indexOf),pe=Fe(String.prototype.trim),Se=Fe(Object.prototype.hasOwnProperty),Ee=Fe(RegExp.prototype.test),He=et(TypeError);function Fe(In){return function(un){un instanceof RegExp&&(un.lastIndex=0);for(var Xn=arguments.length,en=new Array(Xn>1?Xn-1:0),Vr=1;Vr<Xn;Vr++)en[Vr-1]=arguments[Vr];return Y(In,un,en)}}function et(In){return function(){for(var un=arguments.length,Xn=new Array(un),en=0;en<un;en++)Xn[en]=arguments[en];return Z(In,Xn)}}function Oe(In,un){let Xn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:V;B&&B(In,null);let en=un.length;for(;en--;){let Vr=un[en];if(typeof Vr=="string"){const di=Xn(Vr);di!==Vr&&(K(un)||(un[en]=di),Vr=di)}In[Vr]=!0}return In}function ct(In){for(let un=0;un<In.length;un++)Se(In,un)||(In[un]=null);return In}function ze(In){const un=ce(null);for(const[Xn,en]of _(In))Se(In,Xn)&&(Array.isArray(en)?un[Xn]=ct(en):en&&typeof en=="object"&&en.constructor===Object?un[Xn]=ze(en):un[Xn]=en);return un}function dt(In,un){for(;In!==null;){const en=Q(In,un);if(en){if(en.get)return Fe(en.get);if(typeof en.value=="function")return Fe(en.value)}In=k(In)}function Xn(){return null}return Xn}const It=X(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Sn=X(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),jt=X(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ye=X(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Be=X(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hn=X(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Je=X(["#text"]),mt=X(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ae=X(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rt=X(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ft=X(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zt=N(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Et=N(/<%[\w\W]*|[\w\W]*%>/gm),Qe=N(/\$\{[\w\W]*/gm),an=N(/^data-[\-\w.\u00B7-\uFFFF]+$/),Mt=N(/^aria-[\-\w]+$/),Cn=N(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bn=N(/^(?:\w+script|data):/i),mr=N(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),br=N(/^html$/i),qr=N(/^[a-z][.\w]*(-[.\w]+)+$/i);var ir=Object.freeze({__proto__:null,ARIA_ATTR:Mt,ATTR_WHITESPACE:mr,CUSTOM_ELEMENT:qr,DATA_ATTR:an,DOCTYPE_NAME:br,ERB_EXPR:Et,IS_ALLOWED_URI:Cn,IS_SCRIPT_OR_DATA:bn,MUSTACHE_EXPR:zt,TMPLIT_EXPR:Qe});const Qn={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},kr=function(){return typeof window=="undefined"?null:window},mn=function(un,Xn){if(typeof un!="object"||typeof un.createPolicy!="function")return null;let en=null;const Vr="data-tt-policy-suffix";Xn&&Xn.hasAttribute(Vr)&&(en=Xn.getAttribute(Vr));const di="dompurify"+(en?"#"+en:"");try{return un.createPolicy(di,{createHTML(Mr){return Mr},createScriptURL(Mr){return Mr}})}catch(Mr){return console.warn("TrustedTypes policy "+di+" could not be created."),null}},Rs=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mi(){let In=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kr();const un=Gn=>Mi(Gn);if(un.version="3.2.6",un.removed=[],!In||!In.document||In.document.nodeType!==Qn.document||!In.Element)return un.isSupported=!1,un;let{document:Xn}=In;const en=Xn,Vr=en.currentScript,{DocumentFragment:di,HTMLTemplateElement:Mr,Node:js,Element:as,NodeFilter:Te,NamedNodeMap:tt=In.NamedNodeMap||In.MozNamedAttrMap,HTMLFormElement:St,DOMParser:Ke,trustedTypes:Gt}=In,Vn=as.prototype,$r=dt(Vn,"cloneNode"),Ur=dt(Vn,"remove"),sr=dt(Vn,"nextSibling"),Ps=dt(Vn,"childNodes"),ur=dt(Vn,"parentNode");if(typeof Mr=="function"){const Gn=Xn.createElement("template");Gn.content&&Gn.content.ownerDocument&&(Xn=Gn.content.ownerDocument)}let Hr,Rr="";const{implementation:bo,createNodeIterator:Kn,createDocumentFragment:zi,getElementsByTagName:Pr}=Xn,{importNode:gi}=en;let Lr=Rs();un.isSupported=typeof _=="function"&&typeof ur=="function"&&bo&&bo.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ps,ERB_EXPR:Ue,TMPLIT_EXPR:xt,DATA_ATTR:$t,ARIA_ATTR:_n,IS_SCRIPT_OR_DATA:Xr,ATTR_WHITESPACE:Er,CUSTOM_ELEMENT:Di}=ir;let{IS_ALLOWED_URI:fi}=ir,fr=null;const tl=Oe({},[...It,...Sn,...jt,...Be,...Je]);let li=null;const Eo=Oe({},[...mt,...Ae,...rt,...Ft]);let Wn=Object.seal(ce(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),vs=null,bl=null,xn=!0,tn=!0,Ko=!1,nl=!0,lo=!1,xs=!0,Yi=!1,ya=!1,ka=!1,ls=!1,dr=!1,se=!1,O=!0,x=!1;const re="user-content-";let he=!0,Me=!1,Xe={},nt=null;const Tt=Oe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let En=null;const Tn=Oe({},["audio","video","img","source","image","track"]);let pn=null;const vr=Oe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Cr="http://www.w3.org/1998/Math/MathML",Cs="http://www.w3.org/2000/svg",Gi="http://www.w3.org/1999/xhtml";let As=Gi,Ro=!1,Ns=null;const fe=Oe({},[Cr,Cs,Gi],q);let Do=Oe({},["mi","mo","mn","ms","mtext"]),Yn=Oe({},["annotation-xml"]);const Us=Oe({},["title","style","font","a","script"]);let To=null;const qs=["application/xhtml+xml","text/html"],Zu="text/html";let Si=null,Sa=null;const El=Xn.createElement("form"),or=function(je){return je instanceof RegExp||je instanceof Function},Ts=function(){let je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Sa&&Sa===je)){if((!je||typeof je!="object")&&(je={}),je=ze(je),To=qs.indexOf(je.PARSER_MEDIA_TYPE)===-1?Zu:je.PARSER_MEDIA_TYPE,Si=To==="application/xhtml+xml"?q:V,fr=Se(je,"ALLOWED_TAGS")?Oe({},je.ALLOWED_TAGS,Si):tl,li=Se(je,"ALLOWED_ATTR")?Oe({},je.ALLOWED_ATTR,Si):Eo,Ns=Se(je,"ALLOWED_NAMESPACES")?Oe({},je.ALLOWED_NAMESPACES,q):fe,pn=Se(je,"ADD_URI_SAFE_ATTR")?Oe(ze(vr),je.ADD_URI_SAFE_ATTR,Si):vr,En=Se(je,"ADD_DATA_URI_TAGS")?Oe(ze(Tn),je.ADD_DATA_URI_TAGS,Si):Tn,nt=Se(je,"FORBID_CONTENTS")?Oe({},je.FORBID_CONTENTS,Si):Tt,vs=Se(je,"FORBID_TAGS")?Oe({},je.FORBID_TAGS,Si):ze({}),bl=Se(je,"FORBID_ATTR")?Oe({},je.FORBID_ATTR,Si):ze({}),Xe=Se(je,"USE_PROFILES")?je.USE_PROFILES:!1,xn=je.ALLOW_ARIA_ATTR!==!1,tn=je.ALLOW_DATA_ATTR!==!1,Ko=je.ALLOW_UNKNOWN_PROTOCOLS||!1,nl=je.ALLOW_SELF_CLOSE_IN_ATTR!==!1,lo=je.SAFE_FOR_TEMPLATES||!1,xs=je.SAFE_FOR_XML!==!1,Yi=je.WHOLE_DOCUMENT||!1,ls=je.RETURN_DOM||!1,dr=je.RETURN_DOM_FRAGMENT||!1,se=je.RETURN_TRUSTED_TYPE||!1,ka=je.FORCE_BODY||!1,O=je.SANITIZE_DOM!==!1,x=je.SANITIZE_NAMED_PROPS||!1,he=je.KEEP_CONTENT!==!1,Me=je.IN_PLACE||!1,fi=je.ALLOWED_URI_REGEXP||Cn,As=je.NAMESPACE||Gi,Do=je.MATHML_TEXT_INTEGRATION_POINTS||Do,Yn=je.HTML_INTEGRATION_POINTS||Yn,Wn=je.CUSTOM_ELEMENT_HANDLING||{},je.CUSTOM_ELEMENT_HANDLING&&or(je.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Wn.tagNameCheck=je.CUSTOM_ELEMENT_HANDLING.tagNameCheck),je.CUSTOM_ELEMENT_HANDLING&&or(je.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Wn.attributeNameCheck=je.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),je.CUSTOM_ELEMENT_HANDLING&&typeof je.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Wn.allowCustomizedBuiltInElements=je.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),lo&&(tn=!1),dr&&(ls=!0),Xe&&(fr=Oe({},Je),li=[],Xe.html===!0&&(Oe(fr,It),Oe(li,mt)),Xe.svg===!0&&(Oe(fr,Sn),Oe(li,Ae),Oe(li,Ft)),Xe.svgFilters===!0&&(Oe(fr,jt),Oe(li,Ae),Oe(li,Ft)),Xe.mathMl===!0&&(Oe(fr,Be),Oe(li,rt),Oe(li,Ft))),je.ADD_TAGS&&(fr===tl&&(fr=ze(fr)),Oe(fr,je.ADD_TAGS,Si)),je.ADD_ATTR&&(li===Eo&&(li=ze(li)),Oe(li,je.ADD_ATTR,Si)),je.ADD_URI_SAFE_ATTR&&Oe(pn,je.ADD_URI_SAFE_ATTR,Si),je.FORBID_CONTENTS&&(nt===Tt&&(nt=ze(nt)),Oe(nt,je.FORBID_CONTENTS,Si)),he&&(fr["#text"]=!0),Yi&&Oe(fr,["html","head","body"]),fr.table&&(Oe(fr,["tbody"]),delete vs.tbody),je.TRUSTED_TYPES_POLICY){if(typeof je.TRUSTED_TYPES_POLICY.createHTML!="function")throw He('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof je.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw He('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Hr=je.TRUSTED_TYPES_POLICY,Rr=Hr.createHTML("")}else Hr===void 0&&(Hr=mn(Gt,Vr)),Hr!==null&&typeof Rr=="string"&&(Rr=Hr.createHTML(""));X&&X(je),Sa=je}},ua=Oe({},[...Sn,...jt,...Ye]),rl=Oe({},[...Be,...hn]),mu=function(je){let Wt=ur(je);(!Wt||!Wt.tagName)&&(Wt={namespaceURI:As,tagName:"template"});const Pn=V(je.tagName),Hi=V(Wt.tagName);return Ns[je.namespaceURI]?je.namespaceURI===Cs?Wt.namespaceURI===Gi?Pn==="svg":Wt.namespaceURI===Cr?Pn==="svg"&&(Hi==="annotation-xml"||Do[Hi]):!!ua[Pn]:je.namespaceURI===Cr?Wt.namespaceURI===Gi?Pn==="math":Wt.namespaceURI===Cs?Pn==="math"&&Yn[Hi]:!!rl[Pn]:je.namespaceURI===Gi?Wt.namespaceURI===Cs&&!Yn[Hi]||Wt.namespaceURI===Cr&&!Do[Hi]?!1:!rl[Pn]&&(Us[Pn]||!ua[Pn]):!!(To==="application/xhtml+xml"&&Ns[je.namespaceURI]):!1},zs=function(je){W(un.removed,{element:je});try{ur(je).removeChild(je)}catch(Wt){Ur(je)}},ws=function(je,Wt){try{W(un.removed,{attribute:Wt.getAttributeNode(je),from:Wt})}catch(Pn){W(un.removed,{attribute:null,from:Wt})}if(Wt.removeAttribute(je),je==="is")if(ls||dr)try{zs(Wt)}catch(Pn){}else try{Wt.setAttribute(je,"")}catch(Pn){}},Yo=function(je){let Wt=null,Pn=null;if(ka)je="<remove></remove>"+je;else{const _i=de(je,/^[\r\n\t ]+/);Pn=_i&&_i[0]}To==="application/xhtml+xml"&&As===Gi&&(je='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+je+"</body></html>");const Hi=Hr?Hr.createHTML(je):je;if(As===Gi)try{Wt=new Ke().parseFromString(Hi,To)}catch(_i){}if(!Wt||!Wt.documentElement){Wt=bo.createDocument(As,"template",null);try{Wt.documentElement.innerHTML=Ro?Rr:Hi}catch(_i){}}const es=Wt.body||Wt.documentElement;return je&&Pn&&es.insertBefore(Xn.createTextNode(Pn),es.childNodes[0]||null),As===Gi?Pr.call(Wt,Yi?"html":"body")[0]:Yi?Wt.documentElement:es},Go=function(je){return Kn.call(je.ownerDocument||je,je,Te.SHOW_ELEMENT|Te.SHOW_COMMENT|Te.SHOW_TEXT|Te.SHOW_PROCESSING_INSTRUCTION|Te.SHOW_CDATA_SECTION,null)},Mo=function(je){return je instanceof St&&(typeof je.nodeName!="string"||typeof je.textContent!="string"||typeof je.removeChild!="function"||!(je.attributes instanceof tt)||typeof je.removeAttribute!="function"||typeof je.setAttribute!="function"||typeof je.namespaceURI!="string"||typeof je.insertBefore!="function"||typeof je.hasChildNodes!="function")},Rl=function(je){return typeof js=="function"&&je instanceof js};function Va(Gn,je,Wt){ee(Gn,Pn=>{Pn.call(un,je,Wt,Sa)})}const Ho=function(je){let Wt=null;if(Va(Lr.beforeSanitizeElements,je,null),Mo(je))return zs(je),!0;const Pn=Si(je.nodeName);if(Va(Lr.uponSanitizeElement,je,{tagName:Pn,allowedTags:fr}),xs&&je.hasChildNodes()&&!Rl(je.firstElementChild)&&Ee(/<[/\w!]/g,je.innerHTML)&&Ee(/<[/\w!]/g,je.textContent)||je.nodeType===Qn.progressingInstruction||xs&&je.nodeType===Qn.comment&&Ee(/<[/\w]/g,je.data))return zs(je),!0;if(!fr[Pn]||vs[Pn]){if(!vs[Pn]&&pu(Pn)&&(Wn.tagNameCheck instanceof RegExp&&Ee(Wn.tagNameCheck,Pn)||Wn.tagNameCheck instanceof Function&&Wn.tagNameCheck(Pn)))return!1;if(he&&!nt[Pn]){const Hi=ur(je)||je.parentNode,es=Ps(je)||je.childNodes;if(es&&Hi){const _i=es.length;for(let Li=_i-1;Li>=0;--Li){const _a=$r(es[Li],!0);_a.__removalCount=(je.__removalCount||0)+1,Hi.insertBefore(_a,sr(je))}}}return zs(je),!0}return je instanceof as&&!mu(je)||(Pn==="noscript"||Pn==="noembed"||Pn==="noframes")&&Ee(/<\/no(script|embed|frames)/i,je.innerHTML)?(zs(je),!0):(lo&&je.nodeType===Qn.text&&(Wt=je.textContent,ee([ps,Ue,xt],Hi=>{Wt=ue(Wt,Hi," ")}),je.textContent!==Wt&&(W(un.removed,{element:je.cloneNode()}),je.textContent=Wt)),Va(Lr.afterSanitizeElements,je,null),!1)},Ju=function(je,Wt,Pn){if(O&&(Wt==="id"||Wt==="name")&&(Pn in Xn||Pn in El))return!1;if(!(tn&&!bl[Wt]&&Ee($t,Wt))){if(!(xn&&Ee(_n,Wt))){if(!li[Wt]||bl[Wt]){if(!(pu(je)&&(Wn.tagNameCheck instanceof RegExp&&Ee(Wn.tagNameCheck,je)||Wn.tagNameCheck instanceof Function&&Wn.tagNameCheck(je))&&(Wn.attributeNameCheck instanceof RegExp&&Ee(Wn.attributeNameCheck,Wt)||Wn.attributeNameCheck instanceof Function&&Wn.attributeNameCheck(Wt))||Wt==="is"&&Wn.allowCustomizedBuiltInElements&&(Wn.tagNameCheck instanceof RegExp&&Ee(Wn.tagNameCheck,Pn)||Wn.tagNameCheck instanceof Function&&Wn.tagNameCheck(Pn))))return!1}else if(!pn[Wt]){if(!Ee(fi,ue(Pn,Er,""))){if(!((Wt==="src"||Wt==="xlink:href"||Wt==="href")&&je!=="script"&&ve(Pn,"data:")===0&&En[je])){if(!(Ko&&!Ee(Xr,ue(Pn,Er,"")))){if(Pn)return!1}}}}}}return!0},pu=function(je){return je!=="annotation-xml"&&de(je,Di)},Lo=function(je){Va(Lr.beforeSanitizeAttributes,je,null);const{attributes:Wt}=je;if(!Wt||Mo(je))return;const Pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:li,forceKeepAttr:void 0};let Hi=Wt.length;for(;Hi--;){const es=Wt[Hi],{name:_i,namespaceURI:Li,value:_a}=es,Tl=Si(_i),ba=_a;let uo=_i==="value"?ba:pe(ba);if(Pn.attrName=Tl,Pn.attrValue=uo,Pn.keepAttr=!0,Pn.forceKeepAttr=void 0,Va(Lr.uponSanitizeAttribute,je,Pn),uo=Pn.attrValue,x&&(Tl==="id"||Tl==="name")&&(ws(_i,je),uo=re+uo),xs&&Ee(/((--!?|])>)|<\/(style|title)/i,uo)){ws(_i,je);continue}if(Pn.forceKeepAttr)continue;if(!Pn.keepAttr){ws(_i,je);continue}if(!nl&&Ee(/\/>/i,uo)){ws(_i,je);continue}lo&&ee([ps,Ue,xt],vu=>{uo=ue(uo,vu," ")});const Ml=Si(je.nodeName);if(!Ju(Ml,Tl,uo)){ws(_i,je);continue}if(Hr&&typeof Gt=="object"&&typeof Gt.getAttributeType=="function"&&!Li)switch(Gt.getAttributeType(Ml,Tl)){case"TrustedHTML":{uo=Hr.createHTML(uo);break}case"TrustedScriptURL":{uo=Hr.createScriptURL(uo);break}}if(uo!==ba)try{Li?je.setAttributeNS(Li,_i,uo):je.setAttribute(_i,uo),Mo(je)?zs(je):J(un.removed)}catch(vu){ws(_i,je)}}Va(Lr.afterSanitizeAttributes,je,null)},Fr=function Gn(je){let Wt=null;const Pn=Go(je);for(Va(Lr.beforeSanitizeShadowDOM,je,null);Wt=Pn.nextNode();)Va(Lr.uponSanitizeShadowNode,Wt,null),Ho(Wt),Lo(Wt),Wt.content instanceof di&&Gn(Wt.content);Va(Lr.afterSanitizeShadowDOM,je,null)};return un.sanitize=function(Gn){let je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Wt=null,Pn=null,Hi=null,es=null;if(Ro=!Gn,Ro&&(Gn="<!-->"),typeof Gn!="string"&&!Rl(Gn))if(typeof Gn.toString=="function"){if(Gn=Gn.toString(),typeof Gn!="string")throw He("dirty is not a string, aborting")}else throw He("toString is not a function");if(!un.isSupported)return Gn;if(ya||Ts(je),un.removed=[],typeof Gn=="string"&&(Me=!1),Me){if(Gn.nodeName){const _a=Si(Gn.nodeName);if(!fr[_a]||vs[_a])throw He("root node is forbidden and cannot be sanitized in-place")}}else if(Gn instanceof js)Wt=Yo("<!---->"),Pn=Wt.ownerDocument.importNode(Gn,!0),Pn.nodeType===Qn.element&&Pn.nodeName==="BODY"||Pn.nodeName==="HTML"?Wt=Pn:Wt.appendChild(Pn);else{if(!ls&&!lo&&!Yi&&Gn.indexOf("<")===-1)return Hr&&se?Hr.createHTML(Gn):Gn;if(Wt=Yo(Gn),!Wt)return ls?null:se?Rr:""}Wt&&ka&&zs(Wt.firstChild);const _i=Go(Me?Gn:Wt);for(;Hi=_i.nextNode();)Ho(Hi),Lo(Hi),Hi.content instanceof di&&Fr(Hi.content);if(Me)return Gn;if(ls){if(dr)for(es=zi.call(Wt.ownerDocument);Wt.firstChild;)es.appendChild(Wt.firstChild);else es=Wt;return(li.shadowroot||li.shadowrootmode)&&(es=gi.call(en,es,!0)),es}let Li=Yi?Wt.outerHTML:Wt.innerHTML;return Yi&&fr["!doctype"]&&Wt.ownerDocument&&Wt.ownerDocument.doctype&&Wt.ownerDocument.doctype.name&&Ee(br,Wt.ownerDocument.doctype.name)&&(Li="<!DOCTYPE "+Wt.ownerDocument.doctype.name+`>
`+Li),lo&&ee([ps,Ue,xt],_a=>{Li=ue(Li,_a," ")}),Hr&&se?Hr.createHTML(Li):Li},un.setConfig=function(){let Gn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ts(Gn),ya=!0},un.clearConfig=function(){Sa=null,ya=!1},un.isValidAttribute=function(Gn,je,Wt){Sa||Ts({});const Pn=Si(Gn),Hi=Si(je);return Ju(Pn,Hi,Wt)},un.addHook=function(Gn,je){typeof je=="function"&&W(Lr[Gn],je)},un.removeHook=function(Gn,je){if(je!==void 0){const Wt=le(Lr[Gn],je);return Wt===-1?void 0:I(Lr[Gn],Wt,1)[0]}return J(Lr[Gn])},un.removeHooks=function(Gn){Lr[Gn]=[]},un.removeAllHooks=function(){Lr=Rs()},un}var _o=Mi(),Hn=f(13617);function Oi(In){return In[0].toUpperCase()+In.substr(1)}function pr(){const In=[];for(var un=arguments.length,Xn=new Array(un),en=0;en<un;en++)Xn[en]=arguments[en];let Vr=Xn.length;for(;Vr;){Vr-=1;const di=(0,Hn.stringify)(Xn[Vr]).toLowerCase();In.indexOf(di)===-1&&In.push(di)}return In.length===1}function Vs(){function In(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return In()+In()+In()+In()}function Qi(In){return/^([0-9][0-9]?%$)|(^100%$)/.test(In)}function Ln(In){let un=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${In}`.replace(/(?:\\)?\[([^[\]]+)]/g,(Xn,en)=>Xn.charAt(0)==="\\"?Xn.substr(1,Xn.length-1):un[en]===void 0?"":un[en])}function yn(In){return qi(`${In}`,{ALLOWED_TAGS:[]})}function qi(In,un){return _o.sanitize(In,un)}},8767:function($,ie,f){"use strict";f.d(ie,{e:function(){return _}});var C=f(11981);function _(B){for(var K=arguments.length,k=new Array(K>1?K-1:0),Q=1;Q<K;Q++)k[Q-1]=arguments[Q];return(0,C.arrayReduce)(B,(N,ce,Y)=>{const Z=ce.replace(/\r?\n\s*/g,""),ee=k[Y]?k[Y]:"";return N+Z+ee},"").trim()}},40581:function($,ie,f){"use strict";f.r(ie),f.d(ie,{KEY_CODES:function(){return k},isCtrlKey:function(){return ce},isCtrlMetaKey:function(){return Y},isFunctionKey:function(){return N},isKey:function(){return Z},isPrintableChar:function(){return X}});var C=f(25813),_=f.n(C),B=f(11981),K=f(94070);const k={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,K.isFirefox)()?182:174,AUDIO_MUTE:(0,K.isFirefox)()?181:173,AUDIO_UP:(0,K.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Q=[k.ALT,k.ARROW_DOWN,k.ARROW_LEFT,k.ARROW_RIGHT,k.ARROW_UP,k.AUDIO_DOWN,k.AUDIO_MUTE,k.AUDIO_UP,k.BACKSPACE,k.CAPS_LOCK,k.DELETE,k.END,k.ENTER,k.ESCAPE,k.F1,k.F2,k.F3,k.F4,k.F5,k.F6,k.F7,k.F8,k.F9,k.F10,k.F11,k.F12,k.F13,k.F14,k.F15,k.F16,k.F17,k.F18,k.F19,k.HOME,k.INSERT,k.MEDIA_NEXT,k.MEDIA_PLAY_PAUSE,k.MEDIA_PREV,k.MEDIA_STOP,k.NULL,k.NUM_LOCK,k.PAGE_DOWN,k.PAGE_UP,k.PAUSE,k.SCROLL_LOCK,k.SHIFT,k.TAB];function X(ee){return ee===32||ee>=48&&ee<=57||ee>=96&&ee<=111||ee>=186&&ee<=192||ee>=219&&ee<=222||ee>=226||ee>=65&&ee<=90}function N(ee){return Q.includes(ee)}function ce(ee){const le=[];return(0,K.isMacOS)()?le.push(k.COMMAND_LEFT,k.COMMAND_RIGHT,k.COMMAND_FIREFOX):le.push(k.CONTROL),le.includes(ee)}function Y(ee){return[k.CONTROL,k.COMMAND_LEFT,k.COMMAND_RIGHT,k.COMMAND_FIREFOX].includes(ee)}function Z(ee,le){const J=le.split("|");let W=!1;return(0,B.arrayEach)(J,I=>{if(ee===k[I])return W=!0,!1}),W}},38826:function($,ie,f){"use strict";f.r(ie),f.d(ie,{CHECKBOX_CHECKED:function(){return $r},CHECKBOX_RENDERER_NAMESPACE:function(){return Vn},CHECKBOX_UNCHECKED:function(){return Ur},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Se},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return et},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return jt},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return ct},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return dt},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return Oe},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return Sn},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return ze},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return It},CONTEXTMENU_ITEMS_BORDERS:function(){return Ye},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return Je},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return mt},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return hn},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return Be},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return le},CONTEXTMENU_ITEMS_COPY:function(){return J},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return V},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return I},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return W},CONTEXTMENU_ITEMS_CUT:function(){return q},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return Ee},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return de},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return zt},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return Qe},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return Q},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return X},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return ve},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return Ft},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return rt},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return B},CONTEXTMENU_ITEMS_READ_ONLY:function(){return ee},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return Fe},CONTEXTMENU_ITEMS_REDO:function(){return Z},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return Ae},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return ce},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return He},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return N},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return K},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return k},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return Et},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return an},CONTEXTMENU_ITEMS_UNDO:function(){return Y},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return ue},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return pe},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return C},FILTERS_BUTTONS_CANCEL:function(){return tt},FILTERS_BUTTONS_CLEAR:function(){return as},FILTERS_BUTTONS_OK:function(){return Te},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return St},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return Gt},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return Ke},FILTERS_BUTTONS_SELECT_ALL:function(){return js},FILTERS_CONDITIONS_AFTER:function(){return Ln},FILTERS_CONDITIONS_BEFORE:function(){return yn},FILTERS_CONDITIONS_BEGINS_WITH:function(){return Qn},FILTERS_CONDITIONS_BETWEEN:function(){return Vs},FILTERS_CONDITIONS_BY_VALUE:function(){return Mi},FILTERS_CONDITIONS_CONTAINS:function(){return mn},FILTERS_CONDITIONS_EMPTY:function(){return mr},FILTERS_CONDITIONS_ENDS_WITH:function(){return kr},FILTERS_CONDITIONS_EQUAL:function(){return qr},FILTERS_CONDITIONS_GREATER_THAN:function(){return _o},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return Hn},FILTERS_CONDITIONS_LESS_THAN:function(){return Oi},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return pr},FILTERS_CONDITIONS_NAMESPACE:function(){return Cn},FILTERS_CONDITIONS_NONE:function(){return bn},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return Qi},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return Rs},FILTERS_CONDITIONS_NOT_EMPTY:function(){return br},FILTERS_CONDITIONS_NOT_EQUAL:function(){return ir},FILTERS_CONDITIONS_TODAY:function(){return qi},FILTERS_CONDITIONS_TOMORROW:function(){return In},FILTERS_CONDITIONS_YESTERDAY:function(){return un},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return Xn},FILTERS_DIVS_FILTER_BY_VALUE:function(){return en},FILTERS_LABELS_CONJUNCTION:function(){return Vr},FILTERS_LABELS_DISJUNCTION:function(){return di},FILTERS_NAMESPACE:function(){return Mt},FILTERS_VALUES_BLANK_CELLS:function(){return Mr}});const C="ContextMenu:items",_=C,B=`${_}.noItems`,K=`${_}.insertRowAbove`,k=`${_}.insertRowBelow`,Q=`${_}.insertColumnOnTheLeft`,X=`${_}.insertColumnOnTheRight`,N=`${_}.removeRow`,ce=`${_}.removeColumn`,Y=`${_}.undo`,Z=`${_}.redo`,ee=`${_}.readOnly`,le=`${_}.clearColumn`,J=`${_}.copy`,W=`${_}.copyWithHeaders`,I=`${_}.copyWithGroupHeaders`,V=`${_}.copyHeadersOnly`,q=`${_}.cut`,de=`${_}.freezeColumn`,ue=`${_}.unfreezeColumn`,ve=`${_}.mergeCells`,pe=`${_}.unmergeCells`,Se=`${_}.addComment`,Ee=`${_}.editComment`,He=`${_}.removeComment`,Fe=`${_}.readOnlyComment`,et=`${_}.align`,Oe=`${_}.align.left`,ct=`${_}.align.center`,ze=`${_}.align.right`,dt=`${_}.align.justify`,It=`${_}.align.top`,Sn=`${_}.align.middle`,jt=`${_}.align.bottom`,Ye=`${_}.borders`,Be=`${_}.borders.top`,hn=`${_}.borders.right`,Je=`${_}.borders.bottom`,mt=`${_}.borders.left`,Ae=`${_}.borders.remove`,rt=`${_}.nestedHeaders.insertChildRow`,Ft=`${_}.nestedHeaders.detachFromParent`,zt=`${_}.hideColumn`,Et=`${_}.showColumn`,Qe=`${_}.hideRow`,an=`${_}.showRow`,Mt="Filters:",Cn=`${Mt}conditions`,bn=`${Cn}.none`,mr=`${Cn}.isEmpty`,br=`${Cn}.isNotEmpty`,qr=`${Cn}.isEqualTo`,ir=`${Cn}.isNotEqualTo`,Qn=`${Cn}.beginsWith`,kr=`${Cn}.endsWith`,mn=`${Cn}.contains`,Rs=`${Cn}.doesNotContain`,Mi=`${Cn}.byValue`,_o=`${Cn}.greaterThan`,Hn=`${Cn}.greaterThanOrEqualTo`,Oi=`${Cn}.lessThan`,pr=`${Cn}.lessThanOrEqualTo`,Vs=`${Cn}.isBetween`,Qi=`${Cn}.isNotBetween`,Ln=`${Cn}.after`,yn=`${Cn}.before`,qi=`${Cn}.today`,In=`${Cn}.tomorrow`,un=`${Cn}.yesterday`,Xn=`${Mt}labels.filterByCondition`,en=`${Mt}labels.filterByValue`,Vr=`${Mt}labels.conjunction`,di=`${Mt}labels.disjunction`,Mr=`${Mt}values.blankCells`,js=`${Mt}buttons.selectAll`,as=`${Mt}buttons.clear`,Te=`${Mt}buttons.ok`,tt=`${Mt}buttons.cancel`,St=`${Mt}buttons.placeholder.search`,Ke=`${Mt}buttons.placeholder.value`,Gt=`${Mt}buttons.placeholder.secondValue`,Vn="CheckboxRenderer:",$r=`${Vn}checked`,Ur=`${Vn}unchecked`},73669:function($,ie,f){"use strict";f.r(ie),f.d(ie,{CellCoords:function(){return _.Z},CellRange:function(){return B.Z},default:function(){return hn}});var C=f(44307),_=f(958),B=f(6146),K=f(14366),k=f(63955),Q=f(56218),X=f(29297);function N(Je){const mt=typeof window=="undefined"?!1:window.jQuery;mt&&(mt.fn.handsontable=function(Ae){const rt=this.first();let Ft=rt.data("handsontable");if(typeof Ae!="string"){const Mt=Ae||{};return Ft?Ft.updateSettings(Mt):(Ft=new Je.Core(rt[0],Mt),rt.data("handsontable",Ft),Ft.init()),rt}let zt;if(Ft)if(typeof Ft[Ae]!="undefined"){for(var Et=arguments.length,Qe=new Array(Et>1?Et-1:0),an=1;an<Et;an++)Qe[an-1]=arguments[an];zt=Ft[Ae].call(Ft,...Qe),Ae==="destroy"&&rt.removeData()}else throw new Error(`Handsontable do not provide action: ${Ae}`);return zt})}var ce=f(46806),Y=f(67910),Z=f(11981),ee=f(94070),le=f(71050),J=f(95742),W=f(54883),I=f(27122),V=f(13617),q=f(46495),de=f(33987),ue=f(22492),ve=f(40581),pe=f(88555),Se=f(76909),Ee=f(15227),He=f(70959),Fe=f(72095),et=f(49312),Oe=f(59189),ct=f(80913),ze,dt,It,Sn,jt;(0,K.registerAllModules)(),N(C.ZP),C.ZP.__GhostTable=ce.Z,C.ZP._getListenersCounter=k.k,C.ZP._getRegisteredMapsCounter=Q.P,C.ZP.EventManager=k.Z;const Ye=[Z,ee,le,J,W,I,V,q,de,ue,ve,Y],Be=[pe,Se];C.ZP.helper={},C.ZP.dom={},Z.arrayEach(Ye,Je=>{Z.arrayEach(Object.getOwnPropertyNames(Je),mt=>{mt.charAt(0)!=="_"&&(C.ZP.helper[mt]=Je[mt])})}),Z.arrayEach(Be,Je=>{Z.arrayEach(Object.getOwnPropertyNames(Je),mt=>{mt.charAt(0)!=="_"&&(C.ZP.dom[mt]=Je[mt])})}),C.ZP.cellTypes=(ze=C.ZP.cellTypes)!==null&&ze!==void 0?ze:{},Z.arrayEach((0,et.pH)(),Je=>{C.ZP.cellTypes[Je]=(0,et.DA)(Je)}),C.ZP.cellTypes.registerCellType=et.xN,C.ZP.cellTypes.getCellType=et.DA,C.ZP.editors=(dt=C.ZP.editors)!==null&&dt!==void 0?dt:{},Z.arrayEach((0,Ee._f)(),Je=>{C.ZP.editors[`${ue.toUpperCaseFirst(Je)}Editor`]=(0,Ee.y$)(Je)}),C.ZP.editors.registerEditor=Ee.qm,C.ZP.editors.getEditor=Ee.y$,C.ZP.renderers=(It=C.ZP.renderers)!==null&&It!==void 0?It:{},Z.arrayEach((0,He.LX)(),Je=>{const mt=(0,He.Bp)(Je);Je==="base"&&(C.ZP.renderers.cellDecorator=mt),C.ZP.renderers[`${ue.toUpperCaseFirst(Je)}Renderer`]=mt}),C.ZP.renderers.registerRenderer=He.zn,C.ZP.renderers.getRenderer=He.Bp,C.ZP.validators=(Sn=C.ZP.validators)!==null&&Sn!==void 0?Sn:{},Z.arrayEach((0,Fe.k_)(),Je=>{C.ZP.validators[`${ue.toUpperCaseFirst(Je)}Validator`]=(0,Fe.Te)(Je)}),C.ZP.validators.registerValidator=Fe.Ie,C.ZP.validators.getValidator=Fe.Te,C.ZP.plugins=(jt=C.ZP.plugins)!==null&&jt!==void 0?jt:{},Z.arrayEach((0,Oe.a9)(),Je=>{C.ZP.plugins[Je]=(0,Oe.s3)(Je)}),C.ZP.plugins[`${ue.toUpperCaseFirst(ct.vq.PLUGIN_KEY)}Plugin`]=ct.vq,C.ZP.plugins.registerPlugin=Oe.fo,C.ZP.plugins.getPlugin=Oe.s3;var hn=C.ZP},25506:function($,ie,f){"use strict";var C=f(25813),_=f.n(C),B=f(33987),K=f(27122);const k="localHooks",Q={_localHooks:Object.create(null),addLocalHook(X,N){return this._localHooks[X]||(this._localHooks[X]=[]),this._localHooks[X].push(N),this},runLocalHooks(X,N,ce,Y,Z,ee,le){if(this._localHooks[X]){const J=this._localHooks[X].length;for(let W=0;W<J;W++)(0,K.fastCall)(this._localHooks[X][W],this,N,ce,Y,Z,ee,le)}},clearLocalHooks(){return this._localHooks={},this}};(0,B.defineGetter)(Q,"MIXIN_NAME",k,{writable:!1,enumerable:!1}),ie.Z=Q},80913:function($,ie,f){"use strict";f.d(ie,{Ur:function(){return Fe},vq:function(){return It}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(48442),Q=f.n(k),X=f(97487),N=f.n(X),ce=f(33987),Y=f(11981),Z=f(59189),ee=f(49312),le=f(15227),J=f(70959),W=f(72095),I=f(63955);function V(jt,Ye){de(jt,Ye),Ye.add(jt)}function q(jt,Ye,Be){de(jt,Ye),Ye.set(jt,Be)}function de(jt,Ye){if(Ye.has(jt))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ue(jt,Ye,Be){return(Ye=ve(Ye))in jt?Object.defineProperty(jt,Ye,{value:Be,enumerable:!0,configurable:!0,writable:!0}):jt[Ye]=Be,jt}function ve(jt){var Ye=pe(jt,"string");return typeof Ye=="symbol"?Ye:Ye+""}function pe(jt,Ye){if(typeof jt!="object"||!jt)return jt;var Be=jt[Symbol.toPrimitive];if(Be!==void 0){var hn=Be.call(jt,Ye||"default");if(typeof hn!="object")return hn;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Ye==="string"?String:Number)(jt)}function Se(jt,Ye){return jt.get(Ee(jt,Ye))}function Ee(jt,Ye,Be){if(typeof jt=="function"?jt===Ye:jt.has(Ye))return arguments.length<3?Ye:Be;throw new TypeError("Private element is not present on this object")}const He=new Map([["plugin",Z._j],["cell-type",ee.V1],["editor",le.Wu],["renderer",J.Y3],["validator",W.oh]]),Fe=Symbol("mainSetting"),et="base",Oe=[];let ct=null;var ze=new WeakMap,dt=new WeakSet;class It{static get PLUGIN_KEY(){return et}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(Ye){V(this,dt),ue(this,"eventManager",new I.Z(this)),ue(this,"pluginName",null),ue(this,"pluginsInitializedCallbacks",[]),ue(this,"isPluginsReady",!1),ue(this,"enabled",!1),ue(this,"initialized",!1),q(this,ze,{}),(0,ce.defineGetter)(this,"hot",Ye,{writable:!1}),ct=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",Be=>this.onUpdateSettings(Be)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const Ye=this.constructor.PLUGIN_DEPS,Be=Array.isArray(Ye)?Ye:[];if(Be.length>0){const Je=[];if(Be.forEach(mt=>{const[Ae,rt]=mt.split(":");if(!He.has(Ae))throw new Error(`Unknown plugin dependency type "${Ae}" was found.`);He.get(Ae)(rt)||Je.push(` - ${rt} (${Ae})`)}),Je.length>0){const mt=[`The ${this.pluginName} plugin requires the following modules:
`,`${Je.join(`
`)}
`].join("");Oe.push(mt)}}if(ct||(ct=(0,Z.a9)()),ct.indexOf(this.pluginName)>=0&&ct.splice(ct.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ct.length===0){if(Oe.length>0){const Je=[`${Oe.join(`
`)}
`,"You have to import and register them manually."].join("");throw Oe.length=0,new Error(Je)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var Ye;(Ye=this.eventManager)===null||Ye===void 0||Ye.clear(),this.clearHooks(),this.enabled=!1}getSetting(Ye){const Be=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(Ye===void 0)return Be;const hn=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(Be)||(0,ce.isObject)(Be))&&hn[Fe]===Ye){var Je;return Array.isArray(Be)?Be:(Je=Be[Ye])!==null&&Je!==void 0?Je:hn[Ye]}if((0,ce.isObject)(Be)){var mt;return(mt=Be[Ye])!==null&&mt!==void 0?mt:hn[Ye]}return hn[Ye]}addHook(Ye,Be,hn){Se(ze,this)[Ye]=Se(ze,this)[Ye]||[];const Je=Se(ze,this)[Ye];this.hot.addHook(Ye,Be,hn),Je.push(Be),Se(ze,this)[Ye]=Je}removeHooks(Ye){(0,Y.arrayEach)(Se(ze,this)[Ye]||[],Be=>{this.hot.removeHook(Ye,Be)})}clearHooks(){const Ye=Se(ze,this);(0,ce.objectEach)(Ye,(Be,hn)=>this.removeHooks(hn)),Ye.length=0}callOnPluginsReady(Ye){this.isPluginsReady?Ye():this.pluginsInitializedCallbacks.push(Ye)}onAfterPluginsInitialized(){(0,Y.arrayEach)(this.pluginsInitializedCallbacks,Ye=>Ye()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(Ye){const Be=Ee(dt,this,Sn).call(this,Ye);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&Be&&this.updatePlugin(Ye))}updatePlugin(){}destroy(){var Ye;(Ye=this.eventManager)===null||Ye===void 0||Ye.destroy(),this.clearHooks(),(0,ce.objectEach)(this,(Be,hn)=>{hn!=="hot"&&(this[hn]=null)}),delete this.t,delete this.hot}}function Sn(jt){if(!jt)return!1;const Ye=this.constructor.SETTING_KEYS;if(typeof Ye=="boolean")return Ye;for(let Be=0;Be<Ye.length;Be++)if(jt[Ye[Be]]!==void 0)return!0;return!1}},59189:function($,ie,f){"use strict";f.d(ie,{s3:function(){return ze},a9:function(){return ct},_j:function(){return dt},fo:function(){return It}});var C=f(29297),_=f(22492),B=f(48442),K=f(73190),k=f(46495),Q=f(27122);const X="asc",N="desc",ce=new Map([[X,[-1,1]],[N,[1,-1]]]),Y=Ye=>`The priority '${Ye}' is already declared in a map.`,Z=Ye=>`The priority '${Ye}' is not a number.`;function ee(){let{errorPriorityExists:Ye,errorPriorityNaN:Be}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const hn=new Map;Ye=(0,Q.isFunction)(Ye)?Ye:Y,Be=(0,Q.isFunction)(Be)?Be:Z;function Je(Ae,rt){if(!(0,k.isNumeric)(Ae))throw new Error(Be(Ae));if(hn.has(Ae))throw new Error(Ye(Ae));hn.set(Ae,rt)}function mt(){let Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X;const[rt,Ft]=ce.get(Ae)||ce.get(X);return[...hn].sort((zt,Et)=>zt[0]<Et[0]?rt:Ft).map(zt=>zt[1])}return{addItem:Je,getItems:mt}}var le=f(98407),J=f(71441),W=f(31702),I=f(89050),V=f(16110),q=f(8274),de=f(64109),ue=f(92128);const ve=Ye=>`'${Ye}' value is already declared in a unique set.`;function pe(){let{errorItemExists:Ye}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const Be=new Set;Ye=(0,Q.isFunction)(Ye)?Ye:ve;function hn(Ae){if(Be.has(Ae))throw new Error(Ye(Ae));Be.add(Ae)}function Je(){return[...Be]}function mt(){Be.clear()}return{addItem:hn,clear:mt,getItems:Je}}const Se=Ye=>`There is already registered "${Ye}" plugin.`,Fe=ee({errorPriorityExists:Ye=>`There is already registered plugin on priority "${Ye}".`,errorPriorityNaN:Ye=>`The priority "${Ye}" is not a number.`}),et=pe({errorItemExists:Se}),Oe=(0,le.I)({errorIdExists:Se});function ct(){return[...Fe.getItems(),...et.getItems()]}function ze(Ye){const Be=(0,_.toUpperCaseFirst)(Ye);return Oe.getItem(Be)}function dt(Ye){return!!ze(Ye)}function It(Ye,Be,hn){[Ye,Be,hn]=jt(Ye,Be,hn),ze(Ye)===void 0&&Sn(Ye,Be,hn)}function Sn(Ye,Be,hn){const Je=(0,_.toUpperCaseFirst)(Ye);if(Oe.hasItem(Je))throw new Error(Se(Je));hn===void 0?et.addItem(Je):Fe.addItem(hn,Je),Oe.addItem(Je,Be)}function jt(Ye,Be,hn){return typeof Ye=="function"&&(Be=Ye,Ye=Be.PLUGIN_KEY,hn=Be.PLUGIN_PRIORITY),[Ye,Be,hn]}},14366:function($,ie,f){"use strict";f.r(ie),f.d(ie,{registerAllCellTypes:function(){return ad},registerAllEditors:function(){return Xr},registerAllModules:function(){return $1},registerAllPlugins:function(){return u1},registerAllRenderers:function(){return Qd},registerAllValidators:function(){return dh}});var C=f(29297),_=f(25813),B=f(48442),K=f(78127),k=f(11174),Q=f(66515),X=f(18475),N=f(88555),ce=f(76909),Y=f(33987),Z=f(95188);const ee="handsontableEditor",le="handsontable";class J extends X.H{static get EDITOR_TYPE(){return le}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,N.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,s,l,g){super.prepare(e,t,r,s,l,g);const S=this,M={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(P,j){const oe=this.getSourceData(j.row,j.col);oe!==void 0&&S.setValue(oe),S.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,Y.extend)(M,g.handsontable),this.htOptions=M}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{if(!t){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:ee,relativeToGroup:Z.I,position:"before"},s=(l,g)=>{const S=this.htEditor;if(l!==void 0&&(l<0||S.flipped&&l>S.countRows()-1?S.deselectCell():S.selectCell(l,0),S.getData().length))return g.preventDefault(),(0,ce.stopImmediatePropagation)(g),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:l=>{const g=this.htEditor;let S,M;return!g.getSelectedLast()&&g.flipped?S=g.countRows()-1:g.getSelectedLast()&&(g.flipped?(M=g.getSelectedLast()[0],S=Math.max(0,M-1)):(M=g.getSelectedLast()[0],S=M-1)),s(S,l)},preventDefault:!1},{keys:[["ArrowDown"]],callback:l=>{const g=this.htEditor;let S,M;if(!g.getSelectedLast()&&!g.flipped)S=0;else if(g.getSelectedLast()){if(g.flipped)S=g.getSelectedLast()[0]+1;else if(!g.flipped){const P=g.countRows()-1;M=g.getSelectedLast()[0],S=Math.min(P,M+1)}}return s(S,l)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ee)}}var W=f(11981),I=f(13617),V=f(22492),q=f(40581),de=f(64258),ue=f(40629),ve=f(27122);function pe(n,e){Ee(n,e),e.add(n)}function Se(n,e,t){Ee(n,e),e.set(n,t)}function Ee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function He(n,e,t){return(e=Fe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fe(n){var e=et(n,"string");return typeof e=="symbol"?e:e+""}function et(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Oe(n,e){return n.get(ct(n,e))}function ct(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ze="autocomplete";var dt=new WeakMap,It=new WeakMap,Sn=new WeakSet;class jt extends J{constructor(){super(...arguments),pe(this,Sn),He(this,"query",null),He(this,"strippedChoices",[]),He(this,"rawChoices",[]),Se(this,dt,this.hot.guid.slice(0,9)),Se(this,It,(0,ve.debounce)(()=>{this.focus()},100)),He(this,"sortByRelevance",function(e,t,r){const s=[],l=[],g=e.length;let S=t.length,M,P,j,oe;if(g===0){for(j=0;j<S;j++)l.push(j);return l}for(j=0;j<S;j++){if(P=(0,V.stripTags)((0,I.stringify)(t[j])),r)oe=P.indexOf(e);else{const ye=this.cellProperties.locale;oe=P.toLocaleLowerCase(ye).indexOf(e.toLocaleLowerCase(ye))}oe!==-1&&(M=P.length-oe-g,s.push({baseIndex:j,index:oe,charsLeft:M,value:P}))}for(s.sort((ye,xe)=>{if(xe.index===-1)return-1;if(ye.index===-1)return 1;if(ye.index<xe.index)return-1;if(xe.index<ye.index)return 1;if(ye.index===xe.index){if(ye.charsLeft<xe.charsLeft)return-1;if(ye.charsLeft>xe.charsLeft)return 1}return 0}),j=0,S=s.length;j<S;j++)l.push(s[j].baseIndex);return l})}static get EDITOR_TYPE(){return ze}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return(0,I.isDefined)(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),(0,N.addClass)(this.htContainer,"autocompleteEditor"),(0,N.addClass)(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,N.setAttribute)(this.TEXTAREA,[(0,ue.Nr)(),(0,ue.LO)(),(0,ue.fv)("listbox"),(0,ue.zV)()])}prepare(e,t,r,s,l,g){super.prepare(e,t,r,s,l,g),this.hot.getSettings().ariaTags&&(0,N.setAttribute)(this.TEXTAREA,[(0,ue.JV)("false"),(0,ue.d)(`${Oe(dt,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=r==null?void 0:r.length,{row:l,col:g}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",S=>this.onBeforeKeyDown(S)),this.htEditor.addHook("afterScroll",Oe(It,this)),this.htEditor.updateSettings({colWidths:e?[(0,N.outerWidth)(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(S,M,P,j,oe,ye,xe)=>{(0,de.V)(S,M,P,j,oe,ye,xe);const{filteringCaseSensitive:Ze,allowHtml:Ct,locale:ot}=this.cellProperties,Jt=this.query;let Pt=(0,I.stringify)(ye),Un,gr;Pt&&!Ct&&(Un=Ze===!0?Pt.indexOf(Jt):Pt.toLocaleLowerCase(ot).indexOf(Jt.toLocaleLowerCase(ot)),Un!==-1&&(gr=Pt.substr(Un,Jt.length),Pt=Pt.replace(gr,`<strong>${gr}</strong>`))),t&&(0,N.setAttribute)(M,[(0,ue.Nl)(),...r?[(0,ue.DT)(s)]:[],...r?[(0,ue.jH)(r.indexOf(ye)+1)]:[],["id",`${this.htEditor.rootElement.id}_${P}-${j}`]]),M.innerHTML=Pt},afterSelectionEnd:(S,M)=>{if(t){const P=oe=>{(0,N.setAttribute)(oe,[(0,ue.Ak)()]),(0,N.setAttribute)(this.TEXTAREA,...(0,ue.nT)(oe.id))},j=this.htEditor.getCell(S,M,!0);j!==null?P(j):this.htEditor.addHookOnce("afterScrollVertically",()=>{const oe=this.htEditor.getCell(S,M,!0);P(oe)})}}}),t&&((0,N.setAttribute)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,ue.Rn)()),(0,N.setAttribute)(this.htEditor.rootElement,[(0,ue.a6)(),(0,ue.Ez)("polite"),(0,ue.Up)("text"),["id",`${Oe(dt,this)}-listbox-${l}-${g}`]]),(0,N.setAttribute)(this.TEXTAREA,...(0,ue.JV)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,N.setAttribute)(this.TEXTAREA,[(0,ue.JV)("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=(0,N.getCaretPosition)(this.TEXTAREA),r=(0,N.getSelectionEndPosition)(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter;let g=null,S=null,M=e;s&&(g=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),M,this.cellProperties.filteringCaseSensitive));const P=Array.isArray(g)?g.length:0;if(l===!1)P&&(S=g[0]);else{const j=[];for(let oe=0,ye=M.length;oe<ye&&!(s&&P<=oe);oe++)P?j.push(M[g[oe]]):j.push(M[oe]);S=0,M=j}this.strippedChoices=M,M.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,W.pivot)([M])),M.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(S)),this.hot.listen(),(0,N.setCaretPosition)(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),t=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const S=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+S,0)}const s=this.getHeight(),l=this.hot.view.getWorkspaceHeight()-r-t,g=s>l&&r>l+t;return g?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(g?r:l,s),g}limitDropdownIfNeeded(e,t){if(t>e){let r=0,s=0,l=0,g=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),r+=l,s+=1;while(r<e);g=r-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-g}px`),this.setDropdownHeight(r-l)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),ct(Sn,this,Ye).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),ct(Sn,this,Ye).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(l,g)=>g).reduce((l,g)=>{const S=this.htEditor.getRowHeight(g)||this.htEditor.view.getDefaultRowHeight();return l+S},0)+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=(0,W.arrayMap)(e,l=>(0,I.stringify)(l));return(0,W.arrayMap)(r,l=>t?l:(0,V.stripTags)(l))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let s=!1;return e===q.KEY_CODES.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(s=!0),e===q.KEY_CODES.ARROW_UP&&r.row>-1&&(s=!0),s}onBeforeKeyDown(e){if((0,q.isPrintableChar)(e.keyCode)||e.keyCode===q.KEY_CODES.BACKSPACE||e.keyCode===q.KEY_CODES.DELETE||e.keyCode===q.KEY_CODES.INSERT){let t=10;if(e.keyCode===q.KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}function Ye(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+(0,N.getScrollbarWidth)(this.hot.rootDocument)})}var Be=f(78848);const hn="checkbox";class Je extends Be.Hf{static get EDITOR_TYPE(){return hn}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');(0,N.hasClass)(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var mt=f(11333),Ae=f.n(mt);const rt=()=>window,Ft=()=>window.document,zt=(n,e)=>window.setTimeout(n,e),Et=function(n,e,t,r){n.addEventListener(e,t,!!r)},Qe=function(n,e,t,r){n.removeEventListener(e,t,!!r)},an=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},Mt=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Cn=function(n,e){Mt(n,e)||(n.className=n.className===""?e:n.className+" "+e)},bn=function(n,e){n.className=an((" "+n.className+" ").replace(" "+e+" "," "))},mr=function(n){return/Array/.test(Object.prototype.toString.call(n))},br=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},qr=function(n){let e=n.getDay();return e===0||e===6},ir=function(n){return n%4===0&&n%100!==0||n%400===0},Qn=function(n,e){return[31,ir(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},kr=function(n){br(n)&&n.setHours(0,0,0,0)},mn=function(n,e){return n.getTime()===e.getTime()},Rs=function(n,e,t){let r,s;for(r in e)s=n[r]!==void 0,s&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?br(e[r])?t&&(n[r]=new Date(e[r].getTime())):mr(e[r])?t&&(n[r]=e[r].slice(0)):n[r]=Rs({},e[r],t):(t||!s)&&(n[r]=e[r]);return n},Mi=function(n,e,t){let r=Ft().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Rs(r,t),n.dispatchEvent(r)},_o=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},Hn={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Oi=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},pr=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},Vs=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),r=n.getDay(),s=e,l=s-1,g=7,S=function(ye){return(ye+g-1)%g};n.setDate(t+l-S(r));let M=new Date(n.getFullYear(),0,s),P=24*60*60*1e3,j=(n.getTime()-M.getTime())/P;return 1+Math.round((j-l+S(M.getDay()))/g)},Qi=function(n,e,t,r,s){let l=new Date(r,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(l).isoWeek():Vs(l,s))+"</td>"},Ln=function(n,e,t,r){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},yn=function(n){return"<tbody>"+n.join("")+"</tbody>"},qi=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+Oi(n,e)+'">'+Oi(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},In=function(n,e,t,r,s,l){let g,S,M,P=n._o,j=t===P.minYear,oe=t===P.maxYear,ye='<div id="'+l+'" class="pika-title" role="heading" aria-live="polite">',xe,Ze,Ct=!0,ot=!0;for(M=[],g=0;g<12;g++)M.push('<option value="'+(t===s?g-e:12+g-e)+'"'+(g===r?' selected="selected"':"")+(j&&g<P.minMonth||oe&&g>P.maxMonth?' disabled="disabled"':"")+">"+P.i18n.months[g]+"</option>");for(xe='<div class="pika-label">'+P.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+M.join("")+"</select></div>",mr(P.yearRange)?(g=P.yearRange[0],S=P.yearRange[1]+1):(g=t-P.yearRange,S=1+t+P.yearRange),M=[];g<S&&g<=P.maxYear;g++)g>=P.minYear&&M.push('<option value="'+g+'"'+(g===t?' selected="selected"':"")+">"+g+"</option>");return Ze='<div class="pika-label">'+t+P.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+M.join("")+"</select></div>",P.showMonthAfterYear?ye+=Ze+xe:ye+=xe+Ze,j&&(r===0||P.minMonth>=r)&&(Ct=!1),oe&&(r===11||P.maxMonth<=r)&&(ot=!1),e===0&&(ye+='<button class="pika-prev'+(Ct?"":" is-disabled")+'" type="button">'+P.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(ye+='<button class="pika-next'+(ot?"":" is-disabled")+'" type="button">'+P.i18n.nextMonth+"</button>"),ye+="</div>"},un=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+qi(n)+yn(e)+"</table>"};function Xn(n){let e=this,t=e.config(n);e._onMouseDown=function(s){if(!e._v)return;s=s||rt().event;let l=s.target||s.srcElement;if(l)if(Mt(l,"is-disabled")||(Mt(l,"pika-button")&&!Mt(l,"is-empty")&&!Mt(l.parentNode,"is-disabled")?(e.setDate(new Date(l.getAttribute("data-pika-year"),l.getAttribute("data-pika-month"),l.getAttribute("data-pika-day"))),t.bound&&zt(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):Mt(l,"pika-prev")?e.prevMonth():Mt(l,"pika-next")&&e.nextMonth()),Mt(l,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||rt().event;let l=s.target||s.srcElement;l&&(Mt(l,"pika-select-month")?e.gotoMonth(l.value):Mt(l,"pika-select-year")&&e.gotoYear(l.value))},e._onKeyChange=function(s){if(s=s||rt().event,e.isVisible())switch(s.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let s=this.moment(t.field.value,t.format,t.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(s){let l;s.firedBy!==e&&(l=e._parseFieldValue(),br(l)&&e.setDate(l),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=Ft().activeElement;do if(Mt(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=zt(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||rt().event;let l=s.target||s.srcElement,g=l;if(l){!hasEventListeners&&Mt(l,"pika-select")&&(l.onchange||(l.setAttribute("onchange","return;"),Et(l,"change",e._onChange)));do if(Mt(g,"pika-single")||g===t.trigger)return;while(g=g.parentNode);e._v&&l!==t.trigger&&g!==t.trigger&&e.hide()}},e.el=Ft().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),Et(e.el,"mousedown",e._onMouseDown,!0),Et(e.el,"touchend",e._onMouseDown,!0),Et(e.el,"change",e._onChange),t.keyboardInput&&Et(Ft(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?Ft().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),Et(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let r=t.defaultDate;br(r)?t.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",Et(t.trigger,"click",e._onInputClick),Et(t.trigger,"focus",e._onInputFocus),Et(t.trigger,"blur",e._onInputBlur)):this.show()}Xn.prototype={config:function(n){this._o||(this._o=Rs({},Hn,!0));let e=Rs(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,br(e.minDate)||(e.minDate=!1),br(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),mr(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Hn.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,br(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return br(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",Mi(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!br(n))return;let t=this._o.minDate,r=this._o.maxDate;br(t)&&n<t?n=t:br(r)&&n>r&&(n=r),this._d=new Date(n.getTime()),kr(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Mi(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(br(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=n.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=s<t.getTime()||r.getTime()<s}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,s;n==="add"?s=new Date(t.valueOf()+r):n==="subtract"&&(s=new Date(t.valueOf()-r)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=_o(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=_o({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(kr(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=Hn.minDate,this._o.minYear=Hn.minYear,this._o.minMonth=Hn.minMonth,this._o.startRange=Hn.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(kr(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=Hn.maxDate,this._o.maxYear=Hn.maxYear,this._o.maxMonth=Hn.maxMonth,this._o.endRange=Hn.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,r=e.maxYear,s=e.minMonth,l=e.maxMonth,g="",S;this._y<=t&&(this._y=t,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=r&&(this._y=r,!isNaN(l)&&this._m>l&&(this._m=l));for(let M=0;M<e.numberOfMonths;M++)S="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),g+='<div class="pika-lendar">'+In(this,M,this.calendars[M].year,this.calendars[M].month,this.calendars[0].year,S)+this.render(this.calendars[M].year,this.calendars[M].month,S)+"</div>";this.el.innerHTML=g,e.bound&&e.field.type!=="hidden"&&zt(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,r,s,l,g,S,M,P,j;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,r=rt().innerWidth||Ft().documentElement.clientWidth,s=rt().innerHeight||Ft().documentElement.clientHeight,l=Ft().body.scrollTop||Ft().documentElement.scrollTop,P=!0,j=!0,M=n.getBoundingClientRect(),g=M.left+rt().pageXOffset,S=M.bottom+rt().pageYOffset,(this._o.reposition&&g+e>r||this._o.position.indexOf("right")>-1&&g-e+n.offsetWidth>0)&&(g=g-e+n.offsetWidth,P=!1),(this._o.reposition&&S+t>s+l||this._o.position.indexOf("top")>-1&&S-t-n.offsetHeight>0)&&(S=S-t-n.offsetHeight,j=!1),g<0&&(g=0),S<0&&(S=0),this.el.style.left=g+"px",this.el.style.top=S+"px",Cn(this.el,P?"left-aligned":"right-aligned"),Cn(this.el,j?"bottom-aligned":"top-aligned"),bn(this.el,P?"right-aligned":"left-aligned"),bn(this.el,j?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let r=this._o,s=new Date,l=Qn(n,e),g=new Date(n,e,1).getDay(),S=[],M=[];kr(s),r.firstDay>0&&(g-=r.firstDay,g<0&&(g+=7));let P=e===0?11:e-1,j=e===11?0:e+1,oe=e===0?n-1:n,ye=e===11?n+1:n,xe=Qn(oe,P),Ze=l+g,Ct=Ze;for(;Ct>7;)Ct-=7;Ze+=7-Ct;let ot=!1;for(let Jt=0,Pt=0;Jt<Ze;Jt++){let Un=new Date(n,e,1+(Jt-g)),gr=br(this._d)?mn(Un,this._d):!1,jn=mn(Un,s),Kt=r.events.indexOf(Un.toDateString())!==-1,Yt=Jt<g||Jt>=l+g,Sr=1+(Jt-g),oi=e,gn=n,Ui=r.startRange&&mn(r.startRange,Un),Qr=r.endRange&&mn(r.endRange,Un),Is=r.startRange&&r.endRange&&r.startRange<Un&&Un<r.endRange,So=r.minDate&&Un<r.minDate||r.maxDate&&Un>r.maxDate||r.disableWeekends&&qr(Un)||r.disableDayFn&&r.disableDayFn(Un);Yt&&(Jt<g?(Sr=xe+Sr,oi=P,gn=oe):(Sr=Sr-l,oi=j,gn=ye));let _l={day:Sr,month:oi,year:gn,hasEvent:Kt,isSelected:gr,isToday:jn,isDisabled:So,isEmpty:Yt,isStartRange:Ui,isEndRange:Qr,isInRange:Is,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&gr&&(ot=!0),M.push(pr(_l)),++Pt===7&&(r.showWeekNumber&&M.unshift(Qi(this,Jt-g,e,n,r.firstWeekOfYearMinDays)),S.push(Ln(M,r.isRTL,r.pickWholeWeek,ot)),M=[],Pt=0,ot=!1)}return un(r,S,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),bn(this.el,"is-hidden"),this._o.bound&&(Et(Ft(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Qe(Ft(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Cn(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Qe(this.el,"mousedown",this._onMouseDown,!0),Qe(this.el,"touchend",this._onMouseDown,!0),Qe(this.el,"change",this._onChange),n.keyboardInput&&Qe(Ft(),"keydown",this._onKeyChange),n.field&&(Qe(n.field,"change",this._onInputChange),n.bound&&(Qe(n.trigger,"click",this._onInputClick),Qe(n.trigger,"focus",this._onInputFocus),Qe(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};var en=f(94070);function Vr(n,e){di(n,e),e.add(n)}function di(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(n,e,t){return(e=js(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function js(n){var e=as(n,"string");return typeof e=="symbol"?e:e+""}function as(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Te(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const tt="date",St="dateEditor",Ke="DD/MM/YYYY";var Gt=new WeakSet;class Vn extends X.H{constructor(){super(...arguments),Vr(this,Gt),Mr(this,"parentDestroyed",!1),Mr(this,"$datePicker",null)}static get EDITOR_TYPE(){return tt}init(){if(typeof Ae()!="function")throw new Error("You need to include moment.js to your project.");if(typeof Xn!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||((0,N.removeClass)(this.datePicker,/ht-theme-.*/g),(0,N.addClass)(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,N.addClass)(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();(0,N.removeClass)(this.datePicker,/ht-theme-.*/g),(0,N.addClass)(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{(0,N.hasClass)(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,s,l,g){super.prepare(e,t,r,s,l,g)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:St})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(St),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=Te(Gt,this,$r).call(this),r=this.hot.view.isMouseDown(),s=e?(0,q.isFunctionKey)(e.keyCode):!1;let l;this.datePicker.style.display="block",this.$datePicker=new Xn(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Ae()),this.$datePicker._onInputFocus=function(){},this.originalValue?(l=this.originalValue,Ae()(l,t,!0).isValid()&&this.$datePicker.setMoment(Ae()(l,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!r&&this.setValue("")):this.cellProperties.defaultDate?(l=this.cellProperties.defaultDate,Ae()(l,t,!0).isValid()&&this.$datePicker.setMoment(Ae()(l,t),!0),!s&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,Y.deepExtend)(r,this.cellProperties.datePickerConfig);const s=r.onSelect,l=r.onClose;return r.field=t,r.trigger=t,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:Te(Gt,this,$r).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=g=>{let S=g;isNaN(S.getTime())||(S=Ae()(S).format(Te(Gt,this,$r).call(this))),this.setValue(S),s&&s(),(0,en.isMobileBrowser)()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),l&&l()},r}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==Be.ed.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:s}=this.hot,{wtOverlays:l}=this.hot.view._wt,{wtTable:g}=(t=l.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,S=r.getVisualFromRenderableIndex(g.getFirstPartiallyVisibleRow()),M=r.getVisualFromRenderableIndex(g.getLastPartiallyVisibleRow()),P=s.getVisualFromRenderableIndex(g.getFirstPartiallyVisibleColumn()),j=s.getVisualFromRenderableIndex(g.getLastPartiallyVisibleColumn());if(this.row>=S&&this.row<=M&&this.col>=P&&this.col<=j){const oe=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+oe.top+(0,N.outerHeight)(this.TD)}px`;let ye=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?ye+=oe.right-(0,N.outerWidth)(this.datePicker):ye+=oe.left,this.datePickerStyle.left=`${ye}px`}else this.hideDatepicker()}}function $r(){var n;return(n=this.cellProperties.dateFormat)!==null&&n!==void 0?n:Ke}const Ur="dropdown";class sr extends jt{static get EDITOR_TYPE(){return Ur}prepare(e,t,r,s,l,g){g.filter=!1,g.strict=!0,super.prepare(e,t,r,s,l,g)}}const Ps="numeric";class ur extends X.H{static get EDITOR_TYPE(){return Ps}}var Hr=f(76745);function Rr(n,e,t){return(e=bo(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bo(n){var e=Kn(n,"string");return typeof e=="symbol"?e:e+""}function Kn(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const zi="password";class Pr extends X.H{constructor(){super(...arguments),Rr(this,"autoResize",(0,Hr.x)(this.hot.rootDocument,{textContent:e=>"\u2022".repeat(e.value.length)}))}static get EDITOR_TYPE(){return zi}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,N.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const gi="ht_editor_visible",Lr="selectEditor",ps="select";class Ue extends Be.Hf{static get EDITOR_TYPE(){return ps}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...(0,ue.cV)()),e.appendChild(this.hot.rootDocument.createTextNode("\u25BC")),(0,N.addClass)(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",(0,N.hasClass)(this.selectWrapper,gi)&&(0,N.removeClass)(this.selectWrapper,gi),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,s,l,g){super.prepare(e,t,r,s,l,g);const S=this.cellProperties.selectOptions;let M;typeof S=="function"?M=this.prepareOptions(S(this.row,this.col,this.prop)):M=this.prepareOptions(S),(0,N.empty)(this.select),(0,Y.objectEach)(M,(P,j)=>{const oe=this.hot.rootDocument.createElement("OPTION");oe.value=j,(0,N.fastInnerHTML)(oe,P),this.select.appendChild(oe)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,s=e.length;r<s;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Be.ed.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:s}=this.getEditedCellRect(),l=this.selectWrapper.style;l.height=`${s}px`,l.width=`${r}px`,l.top=`${e}px`,l[this.hot.isRtl()?"right":"left"]=`${t}px`,l.margin="0px",(0,N.addClass)(this.selectWrapper,gi)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:Lr};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Lr)}}const xt="time";class $t extends X.H{static get EDITOR_TYPE(){return xt}prepare(e,t,r,s,l,g){super.prepare(e,t,r,s,l,g),this.TEXTAREA.dir="ltr"}}var _n=f(15227);function Xr(){(0,_n.qm)(Be.Hf),(0,_n.qm)(jt),(0,_n.qm)(Je),(0,_n.qm)(Vn),(0,_n.qm)(sr),(0,_n.qm)(J),(0,_n.qm)(ur),(0,_n.qm)(Pr),(0,_n.qm)(Ue),(0,_n.qm)(X.H),(0,_n.qm)($t)}var Er=f(50598);const Di="html";function fi(n,e,t,r,s,l,g){Er.Z.apply(this,[n,e,t,r,s,l,g]),(0,N.fastInnerHTML)(e,l==null?"":l,!1)}fi.RENDERER_TYPE=Di;var fr=f(63955);const tl="autocomplete";function li(n,e,t,r,s,l,g){const{rootDocument:S}=n,M=g.allowHtml?fi:de.V,P=S.createElement("DIV"),j=n.getSettings().ariaTags;if(P.className="htAutocompleteArrow",j&&P.setAttribute(...(0,ue.cV)()),P.appendChild(S.createTextNode("\u25BC")),M.apply(this,[n,e,t,r,s,l,g]),e.firstChild||e.appendChild(S.createTextNode("\xA0")),e.insertBefore(P,e.firstChild),(0,N.addClass)(e,"htAutocomplete"),!n.acArrowListener){const oe=new fr.Z(n);n.acArrowListener=function(ye){(0,N.hasClass)(ye.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},oe.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{oe.destroy()})}}li.RENDERER_TYPE=tl;const Eo="dropdown";function Wn(n,e,t,r,s,l,g){li.apply(this,[n,e,t,r,s,l,g])}Wn.RENDERER_TYPE=Eo;var vs=f(49691),bl=f(73190),xn=f(58955),tn=f(38826);const Ko=new WeakMap,nl=new WeakMap,lo="htBadValue",xs="data-row",Yi="data-col",ya="checkboxRenderer",ka="checkbox";xn.P.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:s,row:l,column:g,prop:S}=e;if(s===ka){if(r){const{value:M,property:P}=r;let j=t;if(M)j=typeof M=="function"?M(l,g,S,t):M;else if(P){const oe=this.getDataAtRowProp(l,P);j=oe!==null?oe:t}n=j}return n}});function ls(n,e,t,r,s,l,g){const{rootDocument:S}=n,M=n.getSettings().ariaTags;Er.Z.apply(this,[n,e,t,r,s,l,g]),dr(n);let P=se(S);const j=g.label;let oe=!1;if(typeof g.checkedTemplate=="undefined"&&(g.checkedTemplate=!0),typeof g.uncheckedTemplate=="undefined"&&(g.uncheckedTemplate=!1),(0,N.empty)(e),l===g.checkedTemplate||(0,I.stringify)(l).toLocaleLowerCase(g.locale)===(0,I.stringify)(g.checkedTemplate).toLocaleLowerCase(g.locale)?P.checked=!0:l===g.uncheckedTemplate||(0,I.stringify)(l).toLocaleLowerCase(g.locale)===(0,I.stringify)(g.uncheckedTemplate).toLocaleLowerCase(g.locale)?P.checked=!1:(0,I.isEmpty)(l)?(0,N.addClass)(P,"noValue"):(P.style.display="none",(0,N.addClass)(P,lo),oe=!0),(0,N.setAttribute)(P,[[xs,t],[Yi,r]]),M&&(0,N.setAttribute)(P,[(0,ue.QK)(P.checked?n.getTranslatedPhrase(tn.CHECKBOX_CHECKED):n.getTranslatedPhrase(tn.CHECKBOX_UNCHECKED)),(0,ue.Pn)(P.checked),(0,ue.wt)()]),!oe&&j){let Ct="";if(j.value)Ct=typeof j.value=="function"?j.value.call(this,t,r,s,l):j.value;else if(j.property){const Jt=n.getDataAtRowProp(t,j.property);Ct=Jt!==null?Jt:""}const ot=O(S,Ct,j.separated!==!0);j.position==="before"?j.separated?(e.appendChild(ot),e.appendChild(P)):(ot.appendChild(P),P=ot):(!j.position||j.position==="after")&&(j.separated?(e.appendChild(P),e.appendChild(ot)):(ot.insertBefore(P,ot.firstChild),P=ot))}(!j||j&&!j.separated)&&e.appendChild(P),oe&&e.appendChild(S.createTextNode("#bad-value#")),Ko.has(n)||(Ko.set(n,!0),ye());function ye(){const ot=n.getShortcutManager().getContext("grid"),Jt={group:ya,relativeToGroup:Z.I,position:"before"};ot.addShortcuts([{keys:[["space"]],callback:()=>(xe(),!Ze()),runOnlyIf:()=>{var Pt;return(Pt=n.getSelectedRangeLast())===null||Pt===void 0?void 0:Pt.highlight.isCell()}},{keys:[["enter"]],callback:()=>(xe(),!Ze()),runOnlyIf:()=>{const Pt=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&(Pt==null?void 0:Pt.highlight.isCell())&&!n.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(xe(!0),!Ze()),runOnlyIf:()=>{var Pt;return(Pt=n.getSelectedRangeLast())===null||Pt===void 0?void 0:Pt.highlight.isCell()}}],Jt)}function xe(){let Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const ot=n.getSelectedRange(),Jt=[],Pt=new Map;let Un=[],gr=0;if(ot){for(let jn=0;jn<ot.length;jn++){const{row:Kt,col:Yt}=ot[jn].getTopStartCorner(),{row:Sr,col:oi}=ot[jn].getBottomEndCorner();for(let gn=Kt;gn<=Sr;gn+=1)for(let Ui=Yt;Ui<=oi;Ui+=1){const Qr=n.getCellMeta(gn,Ui);if(Qr.hidden)continue;const Is={checkedTemplate:Qr.checkedTemplate,uncheckedTemplate:Qr.uncheckedTemplate};if(Qr.type!=="checkbox"){Ct===!0&&!Qr.readOnly&&(Pt.has(Jt.length)?Pt.set(Jt.length,[...Pt.get(Jt.length),[gn,Ui,null]]):Pt.set(Jt.length,[[gn,Ui,null]]));continue}if(Qr.readOnly===!0)continue;typeof Qr.checkedTemplate=="undefined"&&(Qr.checkedTemplate=!0),typeof Qr.uncheckedTemplate=="undefined"&&(Qr.uncheckedTemplate=!1);const So=n.getDataAtCell(gn,Ui);Ct===!1?[Qr.checkedTemplate,Qr.checkedTemplate.toString()].includes(So)?Un.push([gn,Ui,Qr.uncheckedTemplate,Is]):[Qr.uncheckedTemplate,Qr.uncheckedTemplate.toString(),null,void 0].includes(So)&&Un.push([gn,Ui,Qr.checkedTemplate,Is]):Un.push([gn,Ui,Qr.uncheckedTemplate,Is]),gr+=1}Jt.push(gr),gr=0}Un.every(jn=>{let[,,Kt]=jn;return Kt===Un[0][2]})?Un=Un.map(jn=>{let[Kt,Yt,Sr]=jn;return[Kt,Yt,Sr]}):Un=Un.map(jn=>{let[Kt,Yt,,Sr]=jn;return[Kt,Yt,Sr.checkedTemplate]}),Un.length>0&&Jt.forEach((jn,Kt)=>{let Yt=Un.splice(0,jn);Pt.size&&Pt.has(Kt)&&(Yt=[...Yt,...Pt.get(Kt)]),n.setDataAtCell(Yt)})}}function Ze(){const Ct=n.getSelectedRange();if(Ct){for(let ot=0;ot<Ct.length;ot++){const Jt=Ct[ot].getTopStartCorner(),Pt=Ct[ot].getBottomEndCorner();for(let Un=Jt.row;Un<=Pt.row;Un++)for(let gr=Jt.col;gr<=Pt.col;gr++){if(n.getCellMeta(Un,gr).readOnly)continue;const Kt=n.getCell(Un,gr);if((0,N.isHTMLElement)(Kt)&&Kt.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}ls.RENDERER_TYPE=ka;function dr(n){let e=nl.get(n);if(!e){const{rootElement:t}=n;e=new fr.Z(n),e.addEventListener(t,"click",r=>re(r,n)),e.addEventListener(t,"mouseup",r=>x(r,n)),e.addEventListener(t,"change",r=>he(r,n)),nl.set(n,e)}return e}function se(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function O(n,e,t){const r=n.createElement("label");r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`;const s=n.createTextNode(e);if(t){const l=n.createElement("span");l.appendChild(s),r.appendChild(l)}else r.appendChild(s);return r.cloneNode(!0)}function x(n,e){const{target:t}=n;Me(t)&&(!t.hasAttribute(xs)||!t.hasAttribute(Yi)||setTimeout(e.listen,10))}function re(n,e){const{target:t}=n;if(!Me(t)||!t.hasAttribute(xs)||!t.hasAttribute(Yi))return;const r=parseInt(t.getAttribute(xs),10),s=parseInt(t.getAttribute(Yi),10);e.getCellMeta(r,s).readOnly&&n.preventDefault()}function he(n,e){const{target:t}=n;if(!Me(t)||!t.hasAttribute(xs)||!t.hasAttribute(Yi))return;const r=parseInt(t.getAttribute(xs),10),s=parseInt(t.getAttribute(Yi),10),l=e.getCellMeta(r,s);if(!l.readOnly){let g=null;n.target.checked?g=l.uncheckedTemplate===void 0?!0:l.checkedTemplate:g=l.uncheckedTemplate===void 0?!1:l.uncheckedTemplate,e.setDataAtCell(r,s,g)}}function Me(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const Xe="handsontable";function nt(n,e,t,r,s,l,g){li.apply(this,[n,e,t,r,s,l,g])}nt.RENDERER_TYPE=Xe;var Tt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof f.g!="undefined"?f.g:typeof self!="undefined"?self:{};function En(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Tn,pn;function vr(){return pn||(pn=1,Tn={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(n){let e=n%10;return~~(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Tn}var Cr,Cs;function Gi(){if(Cs)return Cr;Cs=1;const n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(M){return M.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function t(M,P,j,oe,ye,xe,Ze){if(!isNaN(+M))return+M;let Ct="",ot=M.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ot!==M)return-1*t(ot,P,j,oe,ye,xe);for(let Kt=0;Kt<n.length;Kt++){let Yt=n[Kt];if(Ct=M.replace(RegExp(`([0-9 ])(${Yt.key})$`),"$1"),Ct!==M)return t(Ct,P,j,oe,ye,xe)*Yt.factor}if(Ct=M.replace("%",""),Ct!==M)return t(Ct,P,j,oe,ye,xe)/100;let Jt=parseFloat(M);if(isNaN(Jt))return;let Pt=oe(Jt);if(Pt&&Pt!=="."&&(Ct=M.replace(new RegExp(`${e(Pt)}$`),""),Ct!==M))return t(Ct,P,j,oe,ye,xe);let Un={};Object.keys(xe).forEach(Kt=>{Un[xe[Kt]]=Kt});let gr=Object.keys(Un).sort().reverse(),jn=gr.length;for(let Kt=0;Kt<jn;Kt++){let Yt=gr[Kt],Sr=Un[Yt];if(Ct=M.replace(Yt,""),Ct!==M){let oi;switch(Sr){case"thousand":oi=Math.pow(10,3);break;case"million":oi=Math.pow(10,6);break;case"billion":oi=Math.pow(10,9);break;case"trillion":oi=Math.pow(10,12);break}return t(Ct,P,j,oe,ye,xe)*oi}}}function r(M,P,j){let oe=M.replace(j,"");return oe=oe.replace(new RegExp(`([0-9])${e(P.thousands)}([0-9])`,"g"),"$1$2"),oe=oe.replace(P.decimal,"."),oe}function s(M,P,j="",oe,ye,xe,Ze){if(M==="")return;if(M===ye)return 0;let Ct=r(M,P,j);return t(Ct,P,j,oe,ye,xe)}function l(M,P){if(!(M.indexOf(":")&&P.thousands!==":"))return!1;let oe=M.split(":");if(oe.length!==3)return!1;let ye=+oe[0],xe=+oe[1],Ze=+oe[2];return!isNaN(ye)&&!isNaN(xe)&&!isNaN(Ze)}function g(M){let P=M.split(":"),j=+P[0],oe=+P[1];return+P[2]+60*oe+3600*j}function S(M,P){const j=Mo();let oe=j.currentDelimiters(),ye=j.currentCurrency().symbol,xe=j.currentOrdinal(),Ze=j.getZeroFormat(),Ct=j.currentAbbreviations(),ot;if(typeof M=="string")l(M,oe)?ot=g(M):ot=s(M,oe,ye,xe,Ze,Ct);else if(typeof M=="number")ot=M;else return;if(ot!==void 0)return ot}return Cr={unformat:S},Cr}var As,Ro;function Ns(){if(Ro)return As;Ro=1;let n=Gi();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,t=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],l=["sign","parenthesis"],g={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},P={output:{type:"string",validValues:t},base:{type:"string",validValues:["decimal","binary","general"],restriction:(ot,Jt)=>Jt.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:ot=>ot.output==="byte"},characteristic:{type:"number",restriction:ot=>ot>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(ot,Jt)=>Jt.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:ot=>ot>=0,message:"value must be positive"},{restriction:(ot,Jt)=>!Jt.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:ot=>ot>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:l},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(ot,Jt)=>Jt.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},j={languageTag:{type:"string",mandatory:!0,restriction:ot=>ot.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:g,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function oe(ot,Jt){let Pt=ye(ot),Un=Ze(Jt);return Pt&&Un}function ye(ot){return n.unformat(ot)!==void 0}function xe(ot,Jt,Pt,Un=!1){let gr=Object.keys(ot).map(jn=>{if(!Jt[jn])return console.error(`${Pt} Invalid key: ${jn}`),!1;let Kt=ot[jn],Yt=Jt[jn];if(typeof Yt=="string"&&(Yt={type:Yt}),Yt.type==="format"){if(!xe(Kt,P,`[Validate ${jn}]`,!0))return!1}else if(typeof Kt!==Yt.type)return console.error(`${Pt} ${jn} type mismatched: "${Yt.type}" expected, "${typeof Kt}" provided`),!1;if(Yt.restrictions&&Yt.restrictions.length){let Sr=Yt.restrictions.length;for(let oi=0;oi<Sr;oi++){let{restriction:gn,message:Ui}=Yt.restrictions[oi];if(!gn(Kt,ot))return console.error(`${Pt} ${jn} invalid value: ${Ui}`),!1}}return Yt.restriction&&!Yt.restriction(Kt,ot)?(console.error(`${Pt} ${jn} invalid value: ${Yt.message}`),!1):Yt.validValues&&Yt.validValues.indexOf(Kt)===-1?(console.error(`${Pt} ${jn} invalid value: must be among ${JSON.stringify(Yt.validValues)}, "${Kt}" provided`),!1):!(Yt.children&&!xe(Kt,Yt.children,`[Validate ${jn}]`))});return Un||gr.push(...Object.keys(Jt).map(jn=>{let Kt=Jt[jn];if(typeof Kt=="string"&&(Kt={type:Kt}),Kt.mandatory){let Yt=Kt.mandatory;if(typeof Yt=="function"&&(Yt=Yt(ot)),Yt&&ot[jn]===void 0)return console.error(`${Pt} Missing mandatory key "${jn}"`),!1}return!0})),gr.reduce((jn,Kt)=>jn&&Kt,!0)}function Ze(ot){return xe(ot,P,"[Validate format]")}function Ct(ot){return xe(ot,j,"[Validate language]")}return As={validate:oe,validateFormat:Ze,validateInput:ye,validateLanguage:Ct},As}function fe(n,e){let t=n.match(/^{([^}]*)}/);return t?(e.prefix=t[1],n.slice(t[0].length)):n}function Do(n,e){let t=n.match(/{([^}]*)}$/);return t?(e.postfix=t[1],n.slice(0,-t[0].length)):n}function Yn(n,e){if(n.indexOf("$")!==-1){e.output="currency";return}if(n.indexOf("%")!==-1){e.output="percent";return}if(n.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(n.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(n.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(n.indexOf(":")!==-1){e.output="time";return}n.indexOf("o")!==-1&&(e.output="ordinal")}function Us(n,e){n.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function To(n,e){n.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function qs(n,e){let t=n.match(/[1-9]+[0-9]*/);t&&(e.totalLength=+t[0])}function Zu(n,e){let r=n.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function Si(n,e){let t=n.split(".")[1];if(t){let r=t.match(/0+/);r&&(e.mantissa=r[0].length)}}function Sa(n,e){const t=n.split(".")[1];t&&(e.trimMantissa=t.indexOf("[")!==-1)}function El(n,e){n.indexOf("a")!==-1&&(e.average=!0)}function or(n,e){n.indexOf("K")!==-1?e.forceAverage="thousand":n.indexOf("M")!==-1?e.forceAverage="million":n.indexOf("B")!==-1?e.forceAverage="billion":n.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Ts(n,e){n.match(/\[\.]/)?e.optionalMantissa=!0:n.match(/\./)&&(e.optionalMantissa=!1)}function ua(n,e){if(n.indexOf(".")!==-1){let t=n.split(".")[0];e.optionalCharacteristic=t.indexOf("0")===-1}}function rl(n,e){n.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),n.match(/^\+?-/)&&(e.negative="sign")}function mu(n,e){n.match(/^\+/)&&(e.forceSign=!0)}function zs(n,e={}){return typeof n!="string"?n:(n=fe(n,e),n=Do(n,e),Yn(n,e),qs(n,e),Zu(n,e),ua(n,e),El(n,e),or(n,e),Si(n,e),Ts(n,e),Sa(n,e),Us(n,e),To(n,e),rl(n,e),mu(n,e),e)}var ws={parseFormat:zs};var Yo,Go;function Mo(){if(Go)return Yo;Go=1;const n=vr(),e=Ns(),t=ws;let r={},s,l={},g=null,S={};function M(j){s=j}function P(){return l[s]}return r.languages=()=>Object.assign({},l),r.currentLanguage=()=>s,r.currentBytes=()=>P().bytes||{},r.currentCurrency=()=>P().currency,r.currentAbbreviations=()=>P().abbreviations,r.currentDelimiters=()=>P().delimiters,r.currentOrdinal=()=>P().ordinal,r.currentDefaults=()=>Object.assign({},P().defaults,S),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),P().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),P().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),P().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),P().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),P().timeFormat),r.setDefaults=j=>{j=t.parseFormat(j),e.validateFormat(j)&&(S=j)},r.getZeroFormat=()=>g,r.setZeroFormat=j=>g=typeof j=="string"?j:null,r.hasZeroFormat=()=>g!==null,r.languageData=j=>{if(j){if(l[j])return l[j];throw new Error(`Unknown tag "${j}"`)}return P()},r.registerLanguage=(j,oe=!1)=>{if(!e.validateLanguage(j))throw new Error("Invalid language data");l[j.languageTag]=j,oe&&M(j.languageTag)},r.setLanguage=(j,oe=n.languageTag)=>{if(!l[j]){let ye=j.split("-")[0],xe=Object.keys(l).find(Ze=>Ze.split("-")[0]===ye);if(!l[xe]){M(oe);return}M(xe);return}M(j)},r.registerLanguage(n),s=n.languageTag,Yo=r,Yo}function Rl(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function Va(n,e){n.forEach(t=>{let r;try{r=Rl(`../languages/${t}`)}catch(s){console.error(`Unable to load "${t}". No matching language file found.`)}r&&e.registerLanguage(r)})}var Ho=n=>({loadLanguagesInNode:e=>Va(e,n)}),Ju={exports:{}};(function(n){(function(e){var t,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,l=Math.floor,g="[BigNumber Error] ",S=g+"Number primitive has more than 15 significant digits: ",M=1e14,P=14,j=9007199254740991,oe=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ye=1e7,xe=1e9;function Ze(Kt){var Yt,Sr,oi,gn=On.prototype={constructor:On,toString:null,valueOf:null},Ui=new On(1),Qr=20,Is=4,So=-7,_l=21,Xv=-1e7,zd=1e7,Zv=!1,e_=1,wp=0,UA={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Jv="0123456789abcdefghijklmnopqrstuvwxyz",zA=!0;function On(be,Pe){var ke,yt,at,pt,Ot,qe,ft,bt,wt=this;if(!(wt instanceof On))return new On(be,Pe);if(Pe==null){if(be&&be._isBigNumber===!0){wt.s=be.s,!be.c||be.e>zd?wt.c=wt.e=null:be.e<Xv?wt.c=[wt.e=0]:(wt.e=be.e,wt.c=be.c.slice());return}if((qe=typeof be=="number")&&be*0==0){if(wt.s=1/be<0?(be=-be,-1):1,be===~~be){for(pt=0,Ot=be;Ot>=10;Ot/=10,pt++);pt>zd?wt.c=wt.e=null:(wt.e=pt,wt.c=[be]);return}bt=String(be)}else{if(!r.test(bt=String(be)))return oi(wt,bt,qe);wt.s=bt.charCodeAt(0)==45?(bt=bt.slice(1),-1):1}(pt=bt.indexOf("."))>-1&&(bt=bt.replace(".","")),(Ot=bt.search(/e/i))>0?(pt<0&&(pt=Ot),pt+=+bt.slice(Ot+1),bt=bt.substring(0,Ot)):pt<0&&(pt=bt.length)}else{if(Pt(Pe,2,Jv.length,"Base"),Pe==10&&zA)return wt=new On(be),td(wt,Qr+wt.e+1,Is);if(bt=String(be),qe=typeof be=="number"){if(be*0!=0)return oi(wt,bt,qe,Pe);if(wt.s=1/be<0?(bt=bt.slice(1),-1):1,On.DEBUG&&bt.replace(/^0\.0*|\./,"").length>15)throw Error(S+be)}else wt.s=bt.charCodeAt(0)===45?(bt=bt.slice(1),-1):1;for(ke=Jv.slice(0,Pe),pt=Ot=0,ft=bt.length;Ot<ft;Ot++)if(ke.indexOf(yt=bt.charAt(Ot))<0){if(yt=="."){if(Ot>pt){pt=ft;continue}}else if(!at&&(bt==bt.toUpperCase()&&(bt=bt.toLowerCase())||bt==bt.toLowerCase()&&(bt=bt.toUpperCase()))){at=!0,Ot=-1,pt=0;continue}return oi(wt,String(be),qe,Pe)}qe=!1,bt=Sr(bt,Pe,10,wt.s),(pt=bt.indexOf("."))>-1?bt=bt.replace(".",""):pt=bt.length}for(Ot=0;bt.charCodeAt(Ot)===48;Ot++);for(ft=bt.length;bt.charCodeAt(--ft)===48;);if(bt=bt.slice(Ot,++ft)){if(ft-=Ot,qe&&On.DEBUG&&ft>15&&(be>j||be!==l(be)))throw Error(S+wt.s*be);if((pt=pt-Ot-1)>zd)wt.c=wt.e=null;else if(pt<Xv)wt.c=[wt.e=0];else{if(wt.e=pt,wt.c=[],Ot=(pt+1)%P,pt<0&&(Ot+=P),Ot<ft){for(Ot&&wt.c.push(+bt.slice(0,Ot)),ft-=P;Ot<ft;)wt.c.push(+bt.slice(Ot,Ot+=P));Ot=P-(bt=bt.slice(Ot)).length}else Ot-=ft;for(;Ot--;bt+="0");wt.c.push(+bt)}}else wt.c=[wt.e=0]}On.clone=Ze,On.ROUND_UP=0,On.ROUND_DOWN=1,On.ROUND_CEIL=2,On.ROUND_FLOOR=3,On.ROUND_HALF_UP=4,On.ROUND_HALF_DOWN=5,On.ROUND_HALF_EVEN=6,On.ROUND_HALF_CEIL=7,On.ROUND_HALF_FLOOR=8,On.EUCLID=9,On.config=On.set=function(be){var Pe,ke;if(be!=null)if(typeof be=="object"){if(be.hasOwnProperty(Pe="DECIMAL_PLACES")&&(ke=be[Pe],Pt(ke,0,xe,Pe),Qr=ke),be.hasOwnProperty(Pe="ROUNDING_MODE")&&(ke=be[Pe],Pt(ke,0,8,Pe),Is=ke),be.hasOwnProperty(Pe="EXPONENTIAL_AT")&&(ke=be[Pe],ke&&ke.pop?(Pt(ke[0],-xe,0,Pe),Pt(ke[1],0,xe,Pe),So=ke[0],_l=ke[1]):(Pt(ke,-xe,xe,Pe),So=-(_l=ke<0?-ke:ke))),be.hasOwnProperty(Pe="RANGE"))if(ke=be[Pe],ke&&ke.pop)Pt(ke[0],-xe,-1,Pe),Pt(ke[1],1,xe,Pe),Xv=ke[0],zd=ke[1];else if(Pt(ke,-xe,xe,Pe),ke)Xv=-(zd=ke<0?-ke:ke);else throw Error(g+Pe+" cannot be zero: "+ke);if(be.hasOwnProperty(Pe="CRYPTO"))if(ke=be[Pe],ke===!!ke)if(ke)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Zv=ke;else throw Zv=!ke,Error(g+"crypto unavailable");else Zv=ke;else throw Error(g+Pe+" not true or false: "+ke);if(be.hasOwnProperty(Pe="MODULO_MODE")&&(ke=be[Pe],Pt(ke,0,9,Pe),e_=ke),be.hasOwnProperty(Pe="POW_PRECISION")&&(ke=be[Pe],Pt(ke,0,xe,Pe),wp=ke),be.hasOwnProperty(Pe="FORMAT"))if(ke=be[Pe],typeof ke=="object")UA=ke;else throw Error(g+Pe+" not an object: "+ke);if(be.hasOwnProperty(Pe="ALPHABET"))if(ke=be[Pe],typeof ke=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(ke))zA=ke.slice(0,10)=="0123456789",Jv=ke;else throw Error(g+Pe+" invalid: "+ke)}else throw Error(g+"Object expected: "+be);return{DECIMAL_PLACES:Qr,ROUNDING_MODE:Is,EXPONENTIAL_AT:[So,_l],RANGE:[Xv,zd],CRYPTO:Zv,MODULO_MODE:e_,POW_PRECISION:wp,FORMAT:UA,ALPHABET:Jv}},On.isBigNumber=function(be){if(!be||be._isBigNumber!==!0)return!1;if(!On.DEBUG)return!0;var Pe,ke,yt=be.c,at=be.e,pt=be.s;e:if({}.toString.call(yt)=="[object Array]"){if((pt===1||pt===-1)&&at>=-xe&&at<=xe&&at===l(at)){if(yt[0]===0){if(at===0&&yt.length===1)return!0;break e}if(Pe=(at+1)%P,Pe<1&&(Pe+=P),String(yt[0]).length==Pe){for(Pe=0;Pe<yt.length;Pe++)if(ke=yt[Pe],ke<0||ke>=M||ke!==l(ke))break e;if(ke!==0)return!0}}}else if(yt===null&&at===null&&(pt===null||pt===1||pt===-1))return!0;throw Error(g+"Invalid BigNumber: "+be)},On.maximum=On.max=function(){return c1(arguments,-1)},On.minimum=On.min=function(){return c1(arguments,1)},On.random=function(){var be=9007199254740992,Pe=Math.random()*be&2097151?function(){return l(Math.random()*be)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(ke){var yt,at,pt,Ot,qe,ft=0,bt=[],wt=new On(Ui);if(ke==null?ke=Qr:Pt(ke,0,xe),Ot=s(ke/P),Zv)if(crypto.getRandomValues){for(yt=crypto.getRandomValues(new Uint32Array(Ot*=2));ft<Ot;)qe=yt[ft]*131072+(yt[ft+1]>>>11),qe>=9e15?(at=crypto.getRandomValues(new Uint32Array(2)),yt[ft]=at[0],yt[ft+1]=at[1]):(bt.push(qe%1e14),ft+=2);ft=Ot/2}else if(crypto.randomBytes){for(yt=crypto.randomBytes(Ot*=7);ft<Ot;)qe=(yt[ft]&31)*281474976710656+yt[ft+1]*1099511627776+yt[ft+2]*4294967296+yt[ft+3]*16777216+(yt[ft+4]<<16)+(yt[ft+5]<<8)+yt[ft+6],qe>=9e15?crypto.randomBytes(7).copy(yt,ft):(bt.push(qe%1e14),ft+=7);ft=Ot/7}else throw Zv=!1,Error(g+"crypto unavailable");if(!Zv)for(;ft<Ot;)qe=Pe(),qe<9e15&&(bt[ft++]=qe%1e14);for(Ot=bt[--ft],ke%=P,Ot&&ke&&(qe=oe[P-ke],bt[ft]=l(Ot/qe)*qe);bt[ft]===0;bt.pop(),ft--);if(ft<0)bt=[pt=0];else{for(pt=-1;bt[0]===0;bt.splice(0,1),pt-=P);for(ft=1,qe=bt[0];qe>=10;qe/=10,ft++);ft<P&&(pt-=P-ft)}return wt.e=pt,wt.c=bt,wt}}(),On.sum=function(){for(var be=1,Pe=arguments,ke=new On(Pe[0]);be<Pe.length;)ke=ke.plus(Pe[be++]);return ke},Sr=function(){var be="0123456789";function Pe(ke,yt,at,pt){for(var Ot,qe=[0],ft,bt=0,wt=ke.length;bt<wt;){for(ft=qe.length;ft--;qe[ft]*=yt);for(qe[0]+=pt.indexOf(ke.charAt(bt++)),Ot=0;Ot<qe.length;Ot++)qe[Ot]>at-1&&(qe[Ot+1]==null&&(qe[Ot+1]=0),qe[Ot+1]+=qe[Ot]/at|0,qe[Ot]%=at)}return qe.reverse()}return function(ke,yt,at,pt,Ot){var qe,ft,bt,wt,on,_r,Tr,ms,aa=ke.indexOf("."),el=Qr,os=Is;for(aa>=0&&(wt=wp,wp=0,ke=ke.replace(".",""),ms=new On(yt),_r=ms.pow(ke.length-aa),wp=wt,ms.c=Pe(jn(ot(_r.c),_r.e,"0"),10,at,be),ms.e=ms.c.length),Tr=Pe(ke,yt,at,Ot?(qe=Jv,be):(qe=be,Jv)),bt=wt=Tr.length;Tr[--wt]==0;Tr.pop());if(!Tr[0])return qe.charAt(0);if(aa<0?--bt:(_r.c=Tr,_r.e=bt,_r.s=pt,_r=Yt(_r,ms,el,os,at),Tr=_r.c,on=_r.r,bt=_r.e),ft=bt+el+1,aa=Tr[ft],wt=at/2,on=on||ft<0||Tr[ft+1]!=null,on=os<4?(aa!=null||on)&&(os==0||os==(_r.s<0?3:2)):aa>wt||aa==wt&&(os==4||on||os==6&&Tr[ft-1]&1||os==(_r.s<0?8:7)),ft<1||!Tr[0])ke=on?jn(qe.charAt(1),-el,qe.charAt(0)):qe.charAt(0);else{if(Tr.length=ft,on)for(--at;++Tr[--ft]>at;)Tr[ft]=0,ft||(++bt,Tr=[1].concat(Tr));for(wt=Tr.length;!Tr[--wt];);for(aa=0,ke="";aa<=wt;ke+=qe.charAt(Tr[aa++]));ke=jn(ke,bt,qe.charAt(0))}return ke}}(),Yt=function(){function be(yt,at,pt){var Ot,qe,ft,bt,wt=0,on=yt.length,_r=at%ye,Tr=at/ye|0;for(yt=yt.slice();on--;)ft=yt[on]%ye,bt=yt[on]/ye|0,Ot=Tr*ft+bt*_r,qe=_r*ft+Ot%ye*ye+wt,wt=(qe/pt|0)+(Ot/ye|0)+Tr*bt,yt[on]=qe%pt;return wt&&(yt=[wt].concat(yt)),yt}function Pe(yt,at,pt,Ot){var qe,ft;if(pt!=Ot)ft=pt>Ot?1:-1;else for(qe=ft=0;qe<pt;qe++)if(yt[qe]!=at[qe]){ft=yt[qe]>at[qe]?1:-1;break}return ft}function ke(yt,at,pt,Ot){for(var qe=0;pt--;)yt[pt]-=qe,qe=yt[pt]<at[pt]?1:0,yt[pt]=qe*Ot+yt[pt]-at[pt];for(;!yt[0]&&yt.length>1;yt.splice(0,1));}return function(yt,at,pt,Ot,qe){var ft,bt,wt,on,_r,Tr,ms,aa,el,os,ks,gu,kT,GA,$A,Xf,t_,nd=yt.s==at.s?1:-1,$u=yt.c,la=at.c;if(!$u||!$u[0]||!la||!la[0])return new On(!yt.s||!at.s||($u?la&&$u[0]==la[0]:!la)?NaN:$u&&$u[0]==0||!la?nd*0:nd/0);for(aa=new On(nd),el=aa.c=[],bt=yt.e-at.e,nd=pt+bt+1,qe||(qe=M,bt=Ct(yt.e/P)-Ct(at.e/P),nd=nd/P|0),wt=0;la[wt]==($u[wt]||0);wt++);if(la[wt]>($u[wt]||0)&&bt--,nd<0)el.push(1),on=!0;else{for(GA=$u.length,Xf=la.length,wt=0,nd+=2,_r=l(qe/(la[0]+1)),_r>1&&(la=be(la,_r,qe),$u=be($u,_r,qe),Xf=la.length,GA=$u.length),kT=Xf,os=$u.slice(0,Xf),ks=os.length;ks<Xf;os[ks++]=0);t_=la.slice(),t_=[0].concat(t_),$A=la[0],la[1]>=qe/2&&$A++;do{if(_r=0,ft=Pe(la,os,Xf,ks),ft<0){if(gu=os[0],Xf!=ks&&(gu=gu*qe+(os[1]||0)),_r=l(gu/$A),_r>1)for(_r>=qe&&(_r=qe-1),Tr=be(la,_r,qe),ms=Tr.length,ks=os.length;Pe(Tr,os,ms,ks)==1;)_r--,ke(Tr,Xf<ms?t_:la,ms,qe),ms=Tr.length,ft=1;else _r==0&&(ft=_r=1),Tr=la.slice(),ms=Tr.length;if(ms<ks&&(Tr=[0].concat(Tr)),ke(os,Tr,ks,qe),ks=os.length,ft==-1)for(;Pe(la,os,Xf,ks)<1;)_r++,ke(os,Xf<ks?t_:la,ks,qe),ks=os.length}else ft===0&&(_r++,os=[0]);el[wt++]=_r,os[0]?os[ks++]=$u[kT]||0:(os=[$u[kT]],ks=1)}while((kT++<GA||os[0]!=null)&&nd--);on=os[0]!=null,el[0]||el.splice(0,1)}if(qe==M){for(wt=1,nd=el[0];nd>=10;nd/=10,wt++);td(aa,pt+(aa.e=wt+bt*P-1)+1,Ot,on)}else aa.e=bt,aa.r=+on;return aa}}();function KA(be,Pe,ke,yt){var at,pt,Ot,qe,ft;if(ke==null?ke=Is:Pt(ke,0,8),!be.c)return be.toString();if(at=be.c[0],Ot=be.e,Pe==null)ft=ot(be.c),ft=yt==1||yt==2&&(Ot<=So||Ot>=_l)?gr(ft,Ot):jn(ft,Ot,"0");else if(be=td(new On(be),Pe,ke),pt=be.e,ft=ot(be.c),qe=ft.length,yt==1||yt==2&&(Pe<=pt||pt<=So)){for(;qe<Pe;ft+="0",qe++);ft=gr(ft,pt)}else if(Pe-=Ot,ft=jn(ft,pt,"0"),pt+1>qe){if(--Pe>0)for(ft+=".";Pe--;ft+="0");}else if(Pe+=pt-qe,Pe>0)for(pt+1==qe&&(ft+=".");Pe--;ft+="0");return be.s<0&&at?"-"+ft:ft}function c1(be,Pe){for(var ke,yt,at=1,pt=new On(be[0]);at<be.length;at++)yt=new On(be[at]),(!yt.s||(ke=Jt(pt,yt))===Pe||ke===0&&pt.s===Pe)&&(pt=yt);return pt}function YA(be,Pe,ke){for(var yt=1,at=Pe.length;!Pe[--at];Pe.pop());for(at=Pe[0];at>=10;at/=10,yt++);return(ke=yt+ke*P-1)>zd?be.c=be.e=null:ke<Xv?be.c=[be.e=0]:(be.e=ke,be.c=Pe),be}oi=function(){var be=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Pe=/^([^.]+)\.$/,ke=/^\.([^.]+)$/,yt=/^-?(Infinity|NaN)$/,at=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(pt,Ot,qe,ft){var bt,wt=qe?Ot:Ot.replace(at,"");if(yt.test(wt))pt.s=isNaN(wt)?null:wt<0?-1:1;else{if(!qe&&(wt=wt.replace(be,function(on,_r,Tr){return bt=(Tr=Tr.toLowerCase())=="x"?16:Tr=="b"?2:8,!ft||ft==bt?_r:on}),ft&&(bt=ft,wt=wt.replace(Pe,"$1").replace(ke,"0.$1")),Ot!=wt))return new On(wt,bt);if(On.DEBUG)throw Error(g+"Not a"+(ft?" base "+ft:"")+" number: "+Ot);pt.s=null}pt.c=pt.e=null}}();function td(be,Pe,ke,yt){var at,pt,Ot,qe,ft,bt,wt,on=be.c,_r=oe;if(on){e:{for(at=1,qe=on[0];qe>=10;qe/=10,at++);if(pt=Pe-at,pt<0)pt+=P,Ot=Pe,ft=on[bt=0],wt=l(ft/_r[at-Ot-1]%10);else if(bt=s((pt+1)/P),bt>=on.length)if(yt){for(;on.length<=bt;on.push(0));ft=wt=0,at=1,pt%=P,Ot=pt-P+1}else break e;else{for(ft=qe=on[bt],at=1;qe>=10;qe/=10,at++);pt%=P,Ot=pt-P+at,wt=Ot<0?0:l(ft/_r[at-Ot-1]%10)}if(yt=yt||Pe<0||on[bt+1]!=null||(Ot<0?ft:ft%_r[at-Ot-1]),yt=ke<4?(wt||yt)&&(ke==0||ke==(be.s<0?3:2)):wt>5||wt==5&&(ke==4||yt||ke==6&&(pt>0?Ot>0?ft/_r[at-Ot]:0:on[bt-1])%10&1||ke==(be.s<0?8:7)),Pe<1||!on[0])return on.length=0,yt?(Pe-=be.e+1,on[0]=_r[(P-Pe%P)%P],be.e=-Pe||0):on[0]=be.e=0,be;if(pt==0?(on.length=bt,qe=1,bt--):(on.length=bt+1,qe=_r[P-pt],on[bt]=Ot>0?l(ft/_r[at-Ot]%_r[Ot])*qe:0),yt)for(;;)if(bt==0){for(pt=1,Ot=on[0];Ot>=10;Ot/=10,pt++);for(Ot=on[0]+=qe,qe=1;Ot>=10;Ot/=10,qe++);pt!=qe&&(be.e++,on[0]==M&&(on[0]=1));break}else{if(on[bt]+=qe,on[bt]!=M)break;on[bt--]=0,qe=1}for(pt=on.length;on[--pt]===0;on.pop());}be.e>zd?be.c=be.e=null:be.e<Xv&&(be.c=[be.e=0])}return be}function um(be){var Pe,ke=be.e;return ke===null?be.toString():(Pe=ot(be.c),Pe=ke<=So||ke>=_l?gr(Pe,ke):jn(Pe,ke,"0"),be.s<0?"-"+Pe:Pe)}return gn.absoluteValue=gn.abs=function(){var be=new On(this);return be.s<0&&(be.s=1),be},gn.comparedTo=function(be,Pe){return Jt(this,new On(be,Pe))},gn.decimalPlaces=gn.dp=function(be,Pe){var ke,yt,at,pt=this;if(be!=null)return Pt(be,0,xe),Pe==null?Pe=Is:Pt(Pe,0,8),td(new On(pt),be+pt.e+1,Pe);if(!(ke=pt.c))return null;if(yt=((at=ke.length-1)-Ct(this.e/P))*P,at=ke[at])for(;at%10==0;at/=10,yt--);return yt<0&&(yt=0),yt},gn.dividedBy=gn.div=function(be,Pe){return Yt(this,new On(be,Pe),Qr,Is)},gn.dividedToIntegerBy=gn.idiv=function(be,Pe){return Yt(this,new On(be,Pe),0,1)},gn.exponentiatedBy=gn.pow=function(be,Pe){var ke,yt,at,pt,Ot,qe,ft,bt,wt,on=this;if(be=new On(be),be.c&&!be.isInteger())throw Error(g+"Exponent not an integer: "+um(be));if(Pe!=null&&(Pe=new On(Pe)),qe=be.e>14,!on.c||!on.c[0]||on.c[0]==1&&!on.e&&on.c.length==1||!be.c||!be.c[0])return wt=new On(Math.pow(+um(on),qe?be.s*(2-Un(be)):+um(be))),Pe?wt.mod(Pe):wt;if(ft=be.s<0,Pe){if(Pe.c?!Pe.c[0]:!Pe.s)return new On(NaN);yt=!ft&&on.isInteger()&&Pe.isInteger(),yt&&(on=on.mod(Pe))}else{if(be.e>9&&(on.e>0||on.e<-1||(on.e==0?on.c[0]>1||qe&&on.c[1]>=24e7:on.c[0]<8e13||qe&&on.c[0]<=9999975e7)))return pt=on.s<0&&Un(be)?-0:0,on.e>-1&&(pt=1/pt),new On(ft?1/pt:pt);wp&&(pt=s(wp/P+2))}for(qe?(ke=new On(.5),ft&&(be.s=1),bt=Un(be)):(at=Math.abs(+um(be)),bt=at%2),wt=new On(Ui);;){if(bt){if(wt=wt.times(on),!wt.c)break;pt?wt.c.length>pt&&(wt.c.length=pt):yt&&(wt=wt.mod(Pe))}if(at){if(at=l(at/2),at===0)break;bt=at%2}else if(be=be.times(ke),td(be,be.e+1,1),be.e>14)bt=Un(be);else{if(at=+um(be),at===0)break;bt=at%2}on=on.times(on),pt?on.c&&on.c.length>pt&&(on.c.length=pt):yt&&(on=on.mod(Pe))}return yt?wt:(ft&&(wt=Ui.div(wt)),Pe?wt.mod(Pe):pt?td(wt,wp,Is,Ot):wt)},gn.integerValue=function(be){var Pe=new On(this);return be==null?be=Is:Pt(be,0,8),td(Pe,Pe.e+1,be)},gn.isEqualTo=gn.eq=function(be,Pe){return Jt(this,new On(be,Pe))===0},gn.isFinite=function(){return!!this.c},gn.isGreaterThan=gn.gt=function(be,Pe){return Jt(this,new On(be,Pe))>0},gn.isGreaterThanOrEqualTo=gn.gte=function(be,Pe){return(Pe=Jt(this,new On(be,Pe)))===1||Pe===0},gn.isInteger=function(){return!!this.c&&Ct(this.e/P)>this.c.length-2},gn.isLessThan=gn.lt=function(be,Pe){return Jt(this,new On(be,Pe))<0},gn.isLessThanOrEqualTo=gn.lte=function(be,Pe){return(Pe=Jt(this,new On(be,Pe)))===-1||Pe===0},gn.isNaN=function(){return!this.s},gn.isNegative=function(){return this.s<0},gn.isPositive=function(){return this.s>0},gn.isZero=function(){return!!this.c&&this.c[0]==0},gn.minus=function(be,Pe){var ke,yt,at,pt,Ot=this,qe=Ot.s;if(be=new On(be,Pe),Pe=be.s,!qe||!Pe)return new On(NaN);if(qe!=Pe)return be.s=-Pe,Ot.plus(be);var ft=Ot.e/P,bt=be.e/P,wt=Ot.c,on=be.c;if(!ft||!bt){if(!wt||!on)return wt?(be.s=-Pe,be):new On(on?Ot:NaN);if(!wt[0]||!on[0])return on[0]?(be.s=-Pe,be):new On(wt[0]?Ot:Is==3?-0:0)}if(ft=Ct(ft),bt=Ct(bt),wt=wt.slice(),qe=ft-bt){for((pt=qe<0)?(qe=-qe,at=wt):(bt=ft,at=on),at.reverse(),Pe=qe;Pe--;at.push(0));at.reverse()}else for(yt=(pt=(qe=wt.length)<(Pe=on.length))?qe:Pe,qe=Pe=0;Pe<yt;Pe++)if(wt[Pe]!=on[Pe]){pt=wt[Pe]<on[Pe];break}if(pt&&(at=wt,wt=on,on=at,be.s=-be.s),Pe=(yt=on.length)-(ke=wt.length),Pe>0)for(;Pe--;wt[ke++]=0);for(Pe=M-1;yt>qe;){if(wt[--yt]<on[yt]){for(ke=yt;ke&&!wt[--ke];wt[ke]=Pe);--wt[ke],wt[yt]+=M}wt[yt]-=on[yt]}for(;wt[0]==0;wt.splice(0,1),--bt);return wt[0]?YA(be,wt,bt):(be.s=Is==3?-1:1,be.c=[be.e=0],be)},gn.modulo=gn.mod=function(be,Pe){var ke,yt,at=this;return be=new On(be,Pe),!at.c||!be.s||be.c&&!be.c[0]?new On(NaN):!be.c||at.c&&!at.c[0]?new On(at):(e_==9?(yt=be.s,be.s=1,ke=Yt(at,be,0,3),be.s=yt,ke.s*=yt):ke=Yt(at,be,0,e_),be=at.minus(ke.times(be)),!be.c[0]&&e_==1&&(be.s=at.s),be)},gn.multipliedBy=gn.times=function(be,Pe){var ke,yt,at,pt,Ot,qe,ft,bt,wt,on,_r,Tr,ms,aa,el,os=this,ks=os.c,gu=(be=new On(be,Pe)).c;if(!ks||!gu||!ks[0]||!gu[0])return!os.s||!be.s||ks&&!ks[0]&&!gu||gu&&!gu[0]&&!ks?be.c=be.e=be.s=null:(be.s*=os.s,!ks||!gu?be.c=be.e=null:(be.c=[0],be.e=0)),be;for(yt=Ct(os.e/P)+Ct(be.e/P),be.s*=os.s,ft=ks.length,on=gu.length,ft<on&&(ms=ks,ks=gu,gu=ms,at=ft,ft=on,on=at),at=ft+on,ms=[];at--;ms.push(0));for(aa=M,el=ye,at=on;--at>=0;){for(ke=0,_r=gu[at]%el,Tr=gu[at]/el|0,Ot=ft,pt=at+Ot;pt>at;)bt=ks[--Ot]%el,wt=ks[Ot]/el|0,qe=Tr*bt+wt*_r,bt=_r*bt+qe%el*el+ms[pt]+ke,ke=(bt/aa|0)+(qe/el|0)+Tr*wt,ms[pt--]=bt%aa;ms[pt]=ke}return ke?++yt:ms.splice(0,1),YA(be,ms,yt)},gn.negated=function(){var be=new On(this);return be.s=-be.s||null,be},gn.plus=function(be,Pe){var ke,yt=this,at=yt.s;if(be=new On(be,Pe),Pe=be.s,!at||!Pe)return new On(NaN);if(at!=Pe)return be.s=-Pe,yt.minus(be);var pt=yt.e/P,Ot=be.e/P,qe=yt.c,ft=be.c;if(!pt||!Ot){if(!qe||!ft)return new On(at/0);if(!qe[0]||!ft[0])return ft[0]?be:new On(qe[0]?yt:at*0)}if(pt=Ct(pt),Ot=Ct(Ot),qe=qe.slice(),at=pt-Ot){for(at>0?(Ot=pt,ke=ft):(at=-at,ke=qe),ke.reverse();at--;ke.push(0));ke.reverse()}for(at=qe.length,Pe=ft.length,at-Pe<0&&(ke=ft,ft=qe,qe=ke,Pe=at),at=0;Pe;)at=(qe[--Pe]=qe[Pe]+ft[Pe]+at)/M|0,qe[Pe]=M===qe[Pe]?0:qe[Pe]%M;return at&&(qe=[at].concat(qe),++Ot),YA(be,qe,Ot)},gn.precision=gn.sd=function(be,Pe){var ke,yt,at,pt=this;if(be!=null&&be!==!!be)return Pt(be,1,xe),Pe==null?Pe=Is:Pt(Pe,0,8),td(new On(pt),be,Pe);if(!(ke=pt.c))return null;if(at=ke.length-1,yt=at*P+1,at=ke[at]){for(;at%10==0;at/=10,yt--);for(at=ke[0];at>=10;at/=10,yt++);}return be&&pt.e+1>yt&&(yt=pt.e+1),yt},gn.shiftedBy=function(be){return Pt(be,-j,j),this.times("1e"+be)},gn.squareRoot=gn.sqrt=function(){var be,Pe,ke,yt,at,pt=this,Ot=pt.c,qe=pt.s,ft=pt.e,bt=Qr+4,wt=new On("0.5");if(qe!==1||!Ot||!Ot[0])return new On(!qe||qe<0&&(!Ot||Ot[0])?NaN:Ot?pt:1/0);if(qe=Math.sqrt(+um(pt)),qe==0||qe==1/0?(Pe=ot(Ot),(Pe.length+ft)%2==0&&(Pe+="0"),qe=Math.sqrt(+Pe),ft=Ct((ft+1)/2)-(ft<0||ft%2),qe==1/0?Pe="5e"+ft:(Pe=qe.toExponential(),Pe=Pe.slice(0,Pe.indexOf("e")+1)+ft),ke=new On(Pe)):ke=new On(qe+""),ke.c[0]){for(ft=ke.e,qe=ft+bt,qe<3&&(qe=0);;)if(at=ke,ke=wt.times(at.plus(Yt(pt,at,bt,1))),ot(at.c).slice(0,qe)===(Pe=ot(ke.c)).slice(0,qe))if(ke.e<ft&&--qe,Pe=Pe.slice(qe-3,qe+1),Pe=="9999"||!yt&&Pe=="4999"){if(!yt&&(td(at,at.e+Qr+2,0),at.times(at).eq(pt))){ke=at;break}bt+=4,qe+=4,yt=1}else{(!+Pe||!+Pe.slice(1)&&Pe.charAt(0)=="5")&&(td(ke,ke.e+Qr+2,1),be=!ke.times(ke).eq(pt));break}}return td(ke,ke.e+Qr+1,Is,be)},gn.toExponential=function(be,Pe){return be!=null&&(Pt(be,0,xe),be++),KA(this,be,Pe,1)},gn.toFixed=function(be,Pe){return be!=null&&(Pt(be,0,xe),be=be+this.e+1),KA(this,be,Pe)},gn.toFormat=function(be,Pe,ke){var yt,at=this;if(ke==null)be!=null&&Pe&&typeof Pe=="object"?(ke=Pe,Pe=null):be&&typeof be=="object"?(ke=be,be=Pe=null):ke=UA;else if(typeof ke!="object")throw Error(g+"Argument not an object: "+ke);if(yt=at.toFixed(be,Pe),at.c){var pt,Ot=yt.split("."),qe=+ke.groupSize,ft=+ke.secondaryGroupSize,bt=ke.groupSeparator||"",wt=Ot[0],on=Ot[1],_r=at.s<0,Tr=_r?wt.slice(1):wt,ms=Tr.length;if(ft&&(pt=qe,qe=ft,ft=pt,ms-=pt),qe>0&&ms>0){for(pt=ms%qe||qe,wt=Tr.substr(0,pt);pt<ms;pt+=qe)wt+=bt+Tr.substr(pt,qe);ft>0&&(wt+=bt+Tr.slice(pt)),_r&&(wt="-"+wt)}yt=on?wt+(ke.decimalSeparator||"")+((ft=+ke.fractionGroupSize)?on.replace(new RegExp("\\d{"+ft+"}\\B","g"),"$&"+(ke.fractionGroupSeparator||"")):on):wt}return(ke.prefix||"")+yt+(ke.suffix||"")},gn.toFraction=function(be){var Pe,ke,yt,at,pt,Ot,qe,ft,bt,wt,on,_r,Tr=this,ms=Tr.c;if(be!=null&&(qe=new On(be),!qe.isInteger()&&(qe.c||qe.s!==1)||qe.lt(Ui)))throw Error(g+"Argument "+(qe.isInteger()?"out of range: ":"not an integer: ")+um(qe));if(!ms)return new On(Tr);for(Pe=new On(Ui),bt=ke=new On(Ui),yt=ft=new On(Ui),_r=ot(ms),pt=Pe.e=_r.length-Tr.e-1,Pe.c[0]=oe[(Ot=pt%P)<0?P+Ot:Ot],be=!be||qe.comparedTo(Pe)>0?pt>0?Pe:bt:qe,Ot=zd,zd=1/0,qe=new On(_r),ft.c[0]=0;wt=Yt(qe,Pe,0,1),at=ke.plus(wt.times(yt)),at.comparedTo(be)!=1;)ke=yt,yt=at,bt=ft.plus(wt.times(at=bt)),ft=at,Pe=qe.minus(wt.times(at=Pe)),qe=at;return at=Yt(be.minus(ke),yt,0,1),ft=ft.plus(at.times(bt)),ke=ke.plus(at.times(yt)),ft.s=bt.s=Tr.s,pt=pt*2,on=Yt(bt,yt,pt,Is).minus(Tr).abs().comparedTo(Yt(ft,ke,pt,Is).minus(Tr).abs())<1?[bt,yt]:[ft,ke],zd=Ot,on},gn.toNumber=function(){return+um(this)},gn.toPrecision=function(be,Pe){return be!=null&&Pt(be,1,xe),KA(this,be,Pe,2)},gn.toString=function(be){var Pe,ke=this,yt=ke.s,at=ke.e;return at===null?yt?(Pe="Infinity",yt<0&&(Pe="-"+Pe)):Pe="NaN":(be==null?Pe=at<=So||at>=_l?gr(ot(ke.c),at):jn(ot(ke.c),at,"0"):be===10&&zA?(ke=td(new On(ke),Qr+at+1,Is),Pe=jn(ot(ke.c),ke.e,"0")):(Pt(be,2,Jv.length,"Base"),Pe=Sr(jn(ot(ke.c),at,"0"),10,be,yt,!0)),yt<0&&ke.c[0]&&(Pe="-"+Pe)),Pe},gn.valueOf=gn.toJSON=function(){return um(this)},gn._isBigNumber=!0,Kt!=null&&On.set(Kt),On}function Ct(Kt){var Yt=Kt|0;return Kt>0||Kt===Yt?Yt:Yt-1}function ot(Kt){for(var Yt,Sr,oi=1,gn=Kt.length,Ui=Kt[0]+"";oi<gn;){for(Yt=Kt[oi++]+"",Sr=P-Yt.length;Sr--;Yt="0"+Yt);Ui+=Yt}for(gn=Ui.length;Ui.charCodeAt(--gn)===48;);return Ui.slice(0,gn+1||1)}function Jt(Kt,Yt){var Sr,oi,gn=Kt.c,Ui=Yt.c,Qr=Kt.s,Is=Yt.s,So=Kt.e,_l=Yt.e;if(!Qr||!Is)return null;if(Sr=gn&&!gn[0],oi=Ui&&!Ui[0],Sr||oi)return Sr?oi?0:-Is:Qr;if(Qr!=Is)return Qr;if(Sr=Qr<0,oi=So==_l,!gn||!Ui)return oi?0:!gn^Sr?1:-1;if(!oi)return So>_l^Sr?1:-1;for(Is=(So=gn.length)<(_l=Ui.length)?So:_l,Qr=0;Qr<Is;Qr++)if(gn[Qr]!=Ui[Qr])return gn[Qr]>Ui[Qr]^Sr?1:-1;return So==_l?0:So>_l^Sr?1:-1}function Pt(Kt,Yt,Sr,oi){if(Kt<Yt||Kt>Sr||Kt!==l(Kt))throw Error(g+(oi||"Argument")+(typeof Kt=="number"?Kt<Yt||Kt>Sr?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Kt))}function Un(Kt){var Yt=Kt.c.length-1;return Ct(Kt.e/P)==Yt&&Kt.c[Yt]%2!=0}function gr(Kt,Yt){return(Kt.length>1?Kt.charAt(0)+"."+Kt.slice(1):Kt)+(Yt<0?"e":"e+")+Yt}function jn(Kt,Yt,Sr){var oi,gn;if(Yt<0){for(gn=Sr+".";++Yt;gn+=Sr);Kt=gn+Kt}else if(oi=Kt.length,++Yt>oi){for(gn=Sr,Yt-=oi;--Yt;gn+=Sr);Kt+=gn}else Yt<oi&&(Kt=Kt.slice(0,Yt)+"."+Kt.slice(Yt));return Kt}t=Ze(),t.default=t.BigNumber=t,n.exports?n.exports=t:(e||(e=typeof self!="undefined"&&self?self:window),e.BigNumber=t)})(Tt)})(Ju);var pu=Ju.exports;const Lo=Mo(),Fr=Ns(),Gn=ws,je=pu,Wt={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Pn={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:Hi,decimalSuffixes:es}=Lo.currentBytes(),_i={general:{scale:1024,suffixes:es,marker:"bd"},binary:{scale:1024,suffixes:Hi,marker:"b"},decimal:{scale:1e3,suffixes:es,marker:"d"}};function Li(n,e={},t){if(typeof e=="string"&&(e=Gn.parseFormat(e)),!Fr.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",l=e.postfix||"",g=_a(n,e,t);return g=Cu(g,s),g=eg(g,l),g}function _a(n,e,t){switch(e.output){case"currency":return e=ja(e,Lo.currentCurrencyDefaultFormat()),ah(n,e,Lo);case"percent":return e=ja(e,Lo.currentPercentageDefaultFormat()),Ic(n,e,Lo,t);case"byte":return e=ja(e,Lo.currentByteDefaultFormat()),vu(n,e,Lo,t);case"time":return e=ja(e,Lo.currentTimeDefaultFormat()),Zf(n);case"ordinal":return e=ja(e,Lo.currentOrdinalDefaultFormat()),Oc(n,e,Lo);case"number":default:return Ol({instance:n,providedFormat:e,numbro:t})}}function Tl(n){let e=_i.decimal;return Ml(n._value,e.suffixes,e.scale).suffix}function ba(n){let e=_i.binary;return Ml(n._value,e.suffixes,e.scale).suffix}function uo(n){let e=_i.general;return Ml(n._value,e.suffixes,e.scale).suffix}function Ml(n,e,t){let r=e[0],s=Math.abs(n);if(s>=t){for(let l=1;l<e.length;++l){let g=Math.pow(t,l),S=Math.pow(t,l+1);if(s>=g&&s<S){r=e[l],n=n/g;break}}r===e[0]&&(n=n/Math.pow(t,e.length-1),r=e[e.length-1])}return{value:n,suffix:r}}function vu(n,e,t,r){let s=e.base||"binary",l=Object.assign({},Pn,e);const{binarySuffixes:g,decimalSuffixes:S}=t.currentBytes();let P={general:{scale:1024,suffixes:S||es,marker:"bd"},binary:{scale:1024,suffixes:g||Hi,marker:"b"},decimal:{scale:1e3,suffixes:S||es,marker:"d"}}[s],{value:j,suffix:oe}=Ml(n._value,P.suffixes,P.scale);return`${Ol({instance:r(j),providedFormat:e,state:t,defaults:t.currentByteDefaultFormat()})}${l.spaceSeparated?" ":""}${oe}`}function Oc(n,e,t){let r=t.currentOrdinal(),s=Object.assign({},Pn,e),l=Ol({instance:n,providedFormat:e,state:t}),g=r(n._value);return`${l}${s.spaceSeparated?" ":""}${g}`}function Zf(n){let e=Math.floor(n._value/60/60),t=Math.floor((n._value-e*60*60)/60),r=Math.round(n._value-e*60*60-t*60);return`${e}:${t<10?"0":""}${t}:${r<10?"0":""}${r}`}function Ic(n,e,t,r){let s=e.prefixSymbol,l=Ol({instance:r(n._value*100),providedFormat:e,state:t}),g=Object.assign({},Pn,e);return s?`%${g.spaceSeparated?" ":""}${l}`:`${l}${g.spaceSeparated?" ":""}%`}function ah(n,e,t){const r=t.currentCurrency();let s=Object.assign({},e),l=Object.assign({},Pn,s),g,S="",M=!!l.totalLength||!!l.forceAverage||l.average,P=s.currencyPosition||r.position,j=s.currencySymbol||r.symbol;const oe=l.spaceSeparatedCurrency!==void 0?l.spaceSeparatedCurrency:l.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),oe&&(S=" "),P==="infix"&&(g=S+j+S);let ye=Ol({instance:n,providedFormat:s,state:t,decimalSeparator:g});return P==="prefix"&&(n._value<0&&l.negative==="sign"?ye=`-${S}${j}${ye.slice(1)}`:n._value>0&&l.forceSign?ye=`+${S}${j}${ye.slice(1)}`:ye=j+S+ye),(!P||P==="postfix")&&(S=!l.spaceSeparatedAbbreviation&&M?"":S,ye=ye+S+j),ye}function Jf({value:n,forceAverage:e,lowPrecision:t=!0,abbreviations:r,spaceSeparated:s=!1,totalLength:l=0,roundingFunction:g=Math.round}){let S="",M=Math.abs(n),P=-1;if(e&&r[e]&&Wt[e]?(S=r[e],n=n/Wt[e]):M>=Wt.trillion||t&&g(M/Wt.trillion)===1?(S=r.trillion,n=n/Wt.trillion):M<Wt.trillion&&M>=Wt.billion||t&&g(M/Wt.billion)===1?(S=r.billion,n=n/Wt.billion):M<Wt.billion&&M>=Wt.million||t&&g(M/Wt.million)===1?(S=r.million,n=n/Wt.million):(M<Wt.million&&M>=Wt.thousand||t&&g(M/Wt.thousand)===1)&&(S=r.thousand,n=n/Wt.thousand),S&&(S=(s?" ":"")+S),l){let oe=n<0,ye=n.toString().split(".")[0],xe=oe?ye.length-1:ye.length;P=Math.max(l-xe,0)}return{value:n,abbreviation:S,mantissaPrecision:P}}function Kd({value:n,characteristicPrecision:e}){let[t,r]=n.toExponential().split("e"),s=+t;if(!e)return{value:s,abbreviation:`e${r}`};let l=1;return l<e&&(s=s*Math.pow(10,e-l),r=+r-(e-l),r=r>=0?`+${r}`:r),{value:s,abbreviation:`e${r}`}}function Pc(n){let e="";for(let t=0;t<n;t++)e+="0";return e}function $o(n,e){let t=n.toString(),[r,s]=t.split("e"),[l,g=""]=r.split(".");if(+s>0)t=l+g+Pc(s-g.length);else{let S=".";+l<0?S=`-0${S}`:S=`0${S}`;let M=(Pc(-s-1)+Math.abs(l)+g).substr(0,e);M.length<e&&(M+=Pc(e-M.length)),t=S+M}return+s>0&&e>0&&(t+=`.${Pc(e)}`),t}function xc(n,e,t=Math.round){return n.toString().indexOf("e")!==-1?$o(n,e):new je(t(+`${n}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Yd(n,e,t,r,s,l){if(r===-1)return n;let g=xc(e,r,l),[S,M=""]=g.toString().split(".");if(M.match(/^0+$/)&&(t||s))return S;let P=M.match(/0+$/);return s&&P?`${S}.${M.toString().slice(0,P.index)}`:g.toString()}function rd(n,e,t,r){let s=n,[l,g]=s.toString().split(".");if(l.match(/^-?0$/)&&t)return g?`${l.replace("0","")}.${g}`:l.replace("0","");const S=e<0&&l.indexOf("-")===0;if(S&&(l=l.slice(1),s=s.slice(1)),l.length<r){let M=r-l.length;for(let P=0;P<M;P++)s=`0${s}`}return S&&(s=`-${s}`),s.toString()}function Gd(n,e){let t=[],r=0;for(let s=n;s>0;s--)r===e&&(t.unshift(s),r=0),r++;return t}function Qf(n,e,t,r,s){let l=r.currentDelimiters(),g=l.thousands;s=s||l.decimal;let S=l.thousandsSize||3,M=n.toString(),P=M.split(".")[0],j=M.split(".")[1];const oe=e<0&&P.indexOf("-")===0;return t&&(oe&&(P=P.slice(1)),Gd(P.length,S).forEach((xe,Ze)=>{P=P.slice(0,xe+Ze)+g+P.slice(xe+Ze)}),oe&&(P=`-${P}`)),j?M=P+s+j:M=P,M}function qf(n,e){return n+e}function lh(n,e,t){return e===0?n:+n==0?n.replace("-",""):e>0?`+${n}`:t==="sign"?n:`(${n.replace("-","")})`}function Cu(n,e){return e+n}function eg(n,e){return n+e}function Ol({instance:n,providedFormat:e,state:t=Lo,decimalSeparator:r,defaults:s=t.currentDefaults()}){let l=n._value;if(l===0&&t.hasZeroFormat())return t.getZeroFormat();if(!isFinite(l))return l.toString();let g=Object.assign({},Pn,s,e),S=g.totalLength,M=S?0:g.characteristic,P=g.optionalCharacteristic,j=g.forceAverage,oe=g.lowPrecision,ye=!!S||!!j||g.average,xe=S?-1:ye&&e.mantissa===void 0?0:g.mantissa,Ze=S?!1:e.optionalMantissa===void 0?xe===-1:g.optionalMantissa,Ct=g.trimMantissa,ot=g.thousandSeparated,Jt=g.spaceSeparated,Pt=g.negative,Un=g.forceSign,gr=g.exponential,jn=g.roundingFunction,Kt="";if(ye){let Sr=Jf({value:l,forceAverage:j,lowPrecision:oe,abbreviations:t.currentAbbreviations(),spaceSeparated:Jt,roundingFunction:jn,totalLength:S});l=Sr.value,Kt+=Sr.abbreviation,S&&(xe=Sr.mantissaPrecision)}if(gr){let Sr=Kd({value:l,characteristicPrecision:M});l=Sr.value,Kt=Sr.abbreviation+Kt}let Yt=Yd(l.toString(),l,Ze,xe,Ct,jn);return Yt=rd(Yt,l,P,M),Yt=Qf(Yt,l,ot,t,r),(ye||gr)&&(Yt=qf(Yt,Kt)),(Un||l<0)&&(Yt=lh(Yt,l,Pt)),Yt}function ja(n,e){if(!n)return e;let t=Object.keys(n);return t.length===1&&t[0]==="output"?e:n}var Ea=n=>({format:(...e)=>Li(...e,n),getByteUnit:(...e)=>uo(...e,n),getBinaryByteUnit:(...e)=>ba(...e,n),getDecimalByteUnit:(...e)=>Tl(...e,n),formatOrDefault:ja});const Ra=pu;function tg(n,e,t){let r=new Ra(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new Ra(s),n._value=r.plus(s).toNumber(),n}function id(n,e,t){let r=new Ra(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new Ra(s),n._value=r.minus(s).toNumber(),n}function Il(n,e,t){let r=new Ra(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new Ra(s),n._value=r.times(s).toNumber(),n}function uh(n,e,t){let r=new Ra(n._value),s=e;return t.isNumbro(e)&&(s=e._value),s=new Ra(s),n._value=r.dividedBy(s).toNumber(),n}function Oo(n,e,t){let r=e;return t.isNumbro(e)&&(r=e._value),n._value=r,n}function wu(n,e,t){let r=t(n._value);return id(r,e,t),Math.abs(r._value)}var Ii=n=>({add:(e,t)=>tg(e,t,n),subtract:(e,t)=>id(e,t,n),multiply:(e,t)=>Il(e,t,n),divide:(e,t)=>uh(e,t,n),set:(e,t)=>Oo(e,t,n),difference:(e,t)=>wu(e,t,n),BigNumber:Ra});const ng="2.5.0",eo=Mo(),$d=Ns(),rg=Ho(Fi),yu=Gi();let $l=Ea(Fi),Io=Ii(Fi);const Xd=ws;class ch{constructor(e){this._value=e}clone(){return Fi(this._value)}format(e={}){return $l.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Xd.parseFormat(e)),e=$l.formatOrDefault(e,eo.currentCurrencyDefaultFormat()),e.output="currency",$l.format(this,e)}formatTime(e={}){return e.output="time",$l.format(this,e)}binaryByteUnits(){return $l.getBinaryByteUnit(this)}decimalByteUnits(){return $l.getDecimalByteUnit(this)}byteUnits(){return $l.getByteUnit(this)}difference(e){return Io.difference(this,e)}add(e){return Io.add(this,e)}subtract(e){return Io.subtract(this,e)}multiply(e){return Io.multiply(this,e)}divide(e){return Io.divide(this,e)}set(e){return Io.set(this,Qu(e))}value(){return this._value}valueOf(){return this._value}}function Qu(n){let e=n;return Fi.isNumbro(n)?e=n._value:typeof n=="string"?e=Fi.unformat(n):isNaN(n)&&(e=NaN),e}function Fi(n){return new ch(Qu(n))}Fi.version=ng,Fi.isNumbro=function(n){return n instanceof ch},Fi.language=eo.currentLanguage,Fi.registerLanguage=eo.registerLanguage,Fi.setLanguage=eo.setLanguage,Fi.languages=eo.languages,Fi.languageData=eo.languageData,Fi.zeroFormat=eo.setZeroFormat,Fi.defaultFormat=eo.currentDefaults,Fi.setDefaults=eo.setDefaults,Fi.defaultCurrencyFormat=eo.currentCurrencyDefaultFormat,Fi.validate=$d.validate,Fi.loadLanguagesInNode=rg.loadLanguagesInNode,Fi.unformat=yu.unformat,Fi.BigNumber=Io.BigNumber;var qu=Fi,Xl=En(qu),Rn=f(46495);const Ac="numeric";function Nc(n,e){if((0,Rn.isNumeric)(n)){const t=e.numericFormat,r=t&&t.culture||"-",s=t&&t.pattern;if(typeof r!="undefined"&&!Xl.languages()[r]){const l=r.replace("-",""),g=Xl.allLanguages?Xl.allLanguages[r]:Xl[l];g&&Xl.registerLanguage(g)}Xl.setLanguage(r),n=Xl(n).format(s||"0")}return n}function Zl(n,e,t,r,s,l,g){let S=l;if((0,Rn.isNumeric)(S)){let P=[];if(Array.isArray(g.className))P=g.className;else{var M;const j=(M=g.className)!==null&&M!==void 0?M:"";j.length&&(P=j.split(" "))}S=Nc(S,g),P.indexOf("htLeft")<0&&P.indexOf("htCenter")<0&&P.indexOf("htRight")<0&&P.indexOf("htJustify")<0&&P.push("htRight"),P.indexOf("htNumeric")<0&&P.push("htNumeric"),g.className=P.join(" "),e.dir="ltr"}(0,de.V)(n,e,t,r,s,S,g)}Zl.RENDERER_TYPE=Ac;const hh="password";function ec(n,e,t,r,s,l,g){de.V.apply(this,[n,e,t,r,s,l,g]);const S=g.hashLength||e.innerHTML.length,M=g.hashSymbol||"*";let P="";(0,Rn.rangeEach)(S-1,()=>{P+=M}),(0,N.fastInnerHTML)(e,P)}ec.RENDERER_TYPE=hh;const Zd="select";function Jl(n,e,t,r,s,l,g){de.V.apply(this,[n,e,t,r,s,l,g])}Jl.RENDERER_TYPE=Zd;const Jd="time";function sd(n,e,t,r,s,l,g){de.V.apply(this,[n,e,t,r,s,l,g]),e.dir="ltr"}sd.RENDERER_TYPE=Jd;var Xo=f(70959);function Qd(){(0,Xo.zn)(li),(0,Xo.zn)(Er.Z),(0,Xo.zn)(ls),(0,Xo.zn)(Wn),(0,Xo.zn)(nt),(0,Xo.zn)(fi),(0,Xo.zn)(Zl),(0,Xo.zn)(ec),(0,Xo.zn)(Jl),(0,Xo.zn)(de.V),(0,Xo.zn)(sd)}const il="autocomplete";function tc(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,qd(t,e)):qd(t,e)(this.source):e(!0)}tc.VALIDATOR_TYPE=il;function qd(n,e){const t=n;return function(r){let s=!1;for(let l=0,g=r.length;l<g;l++)if(t===r[l]){s=!0;break}e(s)}}var Ua=f(95742);const Zo="date";function nc(n,e){const t=(0,_n.Jq)(tt,this.instance);let r=n,s=!0;r==null&&(r="");let l=Ae()(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),g=Ae()(new Date(r)).isValid()||l;if(this.allowEmpty&&r===""&&(g=!0,l=!0),g||(s=!1),!g&&l&&(s=!0),g&&!l)if(this.correctFormat===!0){const S=Ql(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,S,"dateValidator"),s=!0}else s=!1;e(s)}nc.VALIDATOR_TYPE=Zo;function Ql(n,e){const t=Ae()((0,Ua.getNormalizedDate)(n)),r=Ae()(n,e),s=n.search(/[A-Za-z]/g)>-1;let l;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||s?l=t:l=r,l.format(e)}const Po="dropdown";function Fo(n,e){tc.apply(this,[n,e])}Fo.VALIDATOR_TYPE=Po;const ca="numeric";function od(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:(0,Rn.isNumeric)(n))}od.VALIDATOR_TYPE=ca;const rc=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],sl="time";function ef(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,s=n;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const l=/^\d{1,2}$/.test(s);l&&(s+=":00");const g=Ae()(s,rc,!0).isValid()?Ae()(s):Ae()(s,t);let S=g.isValid(),M=Ae()(s,t,!0).isValid()&&!l;if(this.allowEmpty&&s===""&&(S=!0,M=!0),S||(r=!1),!S&&M&&(r=!0),S&&!M)if(this.correctFormat===!0){const P=g.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,P,"timeValidator"),r=!0}else r=!1;e(r)}ef.VALIDATOR_TYPE=sl;var Ta=f(72095);function dh(){(0,Ta.Ie)(tc),(0,Ta.Ie)(Fo),(0,Ta.Ie)(nc),(0,Ta.Ie)(od),(0,Ta.Ie)(ef)}const Ks={CELL_TYPE:"autocomplete",editor:jt,renderer:li,validator:tc},ig={CELL_TYPE:"checkbox",editor:Je,renderer:ls},ic="date";function gh(n,e,t,r,s,l,g){li.apply(this,[n,e,t,r,s,l,g])}gh.RENDERER_TYPE=ic;const tf={CELL_TYPE:"date",editor:Vn,renderer:gh,validator:nc},nf={CELL_TYPE:"dropdown",editor:sr,renderer:Wn,validator:Fo,filter:!1,strict:!0},xr={CELL_TYPE:"handsontable",editor:J,renderer:nt},sf={CELL_TYPE:"numeric",editor:ur,renderer:Zl,validator:od,dataType:"number"},og={CELL_TYPE:"password",editor:Pr,renderer:ec,copyable:!1},Dc={CELL_TYPE:"select",editor:Ue,renderer:Jl};var Gs=f(71547);const za={CELL_TYPE:"time",editor:$t,renderer:sd,validator:ef};var ol=f(49312);function ad(){(0,ol.xN)(Ks),(0,ol.xN)(ig),(0,ol.xN)(tf),(0,ol.xN)(nf),(0,ol.xN)(xr),(0,ol.xN)(sf),(0,ol.xN)(og),(0,ol.xN)(Dc),(0,ol.xN)(Gs.n),(0,ol.xN)(za)}var Hc=f(97487),jr=f(80913),Qo=f(54883),Lc=f(46806);function Pl(n,e,t){return(e=xl(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xl(n){var e=of(n,"string");return typeof e=="symbol"?e:e+""}function of(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Al{static get SAMPLE_COUNT(){return 3}constructor(e){Pl(this,"samples",null),Pl(this,"dataFactory",null),Pl(this,"customSampleCount",null),Pl(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Al.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const s=new Map,{from:l,to:g}=typeof r=="number"?{from:r,to:r}:r;return(0,Rn.rangeEach)(l,g,S=>{const M=this.generateSample(e,t,S);s.set(S,M)}),s}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,l=e==="row"?"col":"row",g=[];return(0,Rn.rangeEach)(t.from,t.to,S=>{const M=e==="row"?this.dataFactory(r,S):this.dataFactory(S,r);if(M===!1)return;const{value:P,bundleSeed:j}=M,oe=typeof j=="string"&&j.length>0;let ye;oe?ye=j:(0,Y.isObject)(P)?ye=`${Object.keys(P).length}`:Array.isArray(P)?ye=`${P.length}`:ye=`${(0,I.stringify)(P).length}`,s.has(ye)||s.set(ye,{needed:this.getSampleCount(),strings:[]});const xe=s.get(ye);xe.needed&&(!(g.indexOf(P)>-1)||this.allowDuplicates||oe)&&(xe.strings.push({value:P,[l]:S}),g.push(P),xe.needed-=1)}),s}}var ld=Al,Nl=f(39097),Ka=f(55556);function Dl(n,e){Fc(n,e),e.add(n)}function mh(n,e,t){Fc(n,e),e.set(n,t)}function Fc(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(n,e,t){return(e=ud(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ud(n){var e=hm(n,"string");return typeof e=="symbol"?e:e+""}function hm(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ql(n,e){return n.get(qo(n,e))}function Hl(n,e,t){return n.set(qo(n,e),t),t}function qo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("modifyAutoColumnSizeSeed");const cd="autoColumnSize",yp=10,af="autoColumnSize";var ph=new WeakMap,_u=new WeakMap,Pi=new WeakMap,Wo=new WeakSet;class ea extends jr.vq{static get PLUGIN_KEY(){return cd}static get PLUGIN_PRIORITY(){return yp}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Dl(this,Wo),$s(this,"ghostTable",new Lc.Z(this.hot)),$s(this,"samplesGenerator",new ld((t,r)=>{const s=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(l))return!1;const g=this.hot.getCellMeta(t,r);let S="";g.spanned||(S=this.hot.getDataAtCell(t,r));let M="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(M=this.hot.runHooks("modifyAutoColumnSizeSeed",M,g,S)),{value:S,bundleSeed:M}})),$s(this,"inProgress",!1),$s(this,"measuredColumns",0),$s(this,"columnWidthsMap",new Ka.L),mh(this,ph,!1),mh(this,_u,[]),mh(this,Pi,[]),this.hot.columnIndexMapper.registerMap(af,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,s)=>qo(Wo,this,co).call(this,t,r,s))}isEnabled(){return this.hot.getSettings()[cd]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return qo(Wo,e,Ll).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return qo(Wo,e,oc).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return qo(Wo,e,Wi).call(e,...s)}),this.addHook("beforeRender",()=>qo(Wo,this,ys).call(this)),this.addHook("modifyColWidth",(r,s)=>this.getColumnWidth(s,r)),this.addHook("init",()=>qo(Wo,this,ac).call(this)),super.enablePlugin()}updatePlugin(){Hl(Pi,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>qo(Wo,this,co).call(this,e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,l=typeof t=="number"?{from:t,to:t}:t;(0,Rn.rangeEach)(s.from,s.to,g=>{let S=this.hot.toPhysicalColumn(g);S===null&&(S=g),(r||this.columnWidthsMap.getValueAtIndex(S)===null&&!this.hot._getColWidthFromSettings(S))&&qo(Wo,this,ui).call(this,g,l)}),this.ghostTable.columns.length&&(qo(Wo,this,da).call(this),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const s=this.hot.countCols()-1;let l=null;this.inProgress=!0;const g=()=>{if(!this.hot){(0,Qo.cancelAnimationFrame)(l),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+ea.CALCULATION_STEP,s)},e,t),r=r+ea.CALCULATION_STEP+1,r<s?l=(0,Qo.requestAnimationFrame)(g):((0,Qo.cancelAnimationFrame)(l),this.inProgress=!1,this.hot.view.adjustElementsSize())},S=this.getSyncCalculationLimit();S>=0&&(this.calculateColumnsWidth({from:0,to:S},e,t),r=S+1),r<s?g():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[cd];let t=ea.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return(0,Y.isObject)(e)&&(t=e.syncLimit,(0,V.isPercentValue)(t)?t=(0,Rn.valueAccordingPercent)(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof s=="number"&&(s=Math.max(s,Nl.$))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,s,l)=>{const g=ql(_u,this).length;return(g-1<l||ql(_u,this)[l]!==s)&&r.push(this.hot.toVisualColumn(l)),g-1<l?ql(_u,this).push(s):ql(_u,this)[l]=s,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Ya(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const r=this.hot.toPhysicalColumn(t);r!==null&&(this.hot._getColWidthFromSettings(r)||qo(Wo,this,ui).call(this,t,e))}),this.ghostTable.columns.length&&(qo(Wo,this,da).call(this),this.ghostTable.clean())}function ui(n,e){this.samplesGenerator.generateColumnSamples(n,e).forEach((r,s)=>this.ghostTable.addColumn(s,r))}function da(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,e)=>{const t=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(t,e)})},!0)}function ys(){this.calculateVisibleColumnsWidth(),this.inProgress||(qo(Wo,this,Ya).call(this,ql(Pi,this)),Hl(Pi,this,[]))}function Ll(n,e){e||this.recalculateAllColumnsWidth()}function oc(n){const e=n.reduce((t,r)=>{let[,s]=r;const l=this.hot.propToCol(s);return Number.isInteger(l)&&t.indexOf(l)===-1&&t.push(l),t},[]);ql(Pi,this).push(...e)}function co(n,e,t){let r=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function ac(){Hl(_u,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Hl(ph,this,!0)}function Wi(n){if(!ql(ph,this))return;const e=n.reduce((t,r)=>{var s;const l=(s=r.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(l)){const g=this.hot.toVisualColumn(l);t.indexOf(g)===-1&&t.push(g)}return t},[]);ql(Pi,this).push(...e)}const Ds={horizontal:"horizontal",vertical:"vertical"};function vh(n,e,t){let r,s,l;return e[0]===n[0]&&e[1]<n[1]?(l="left",r=t(e[0],e[1]),s=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(l="right",r=t(e[0],n[3]+1),s=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(l="up",r=t(e[0],e[1]),s=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(l="down",r=t(n[2]+1,e[1]),s=t(e[2],e[3])),r&&r.normalize(),s&&s.normalize(),{directionOfDrag:l,startOfDragCoords:r,endOfDragCoords:s}}function Br(n){const e={};return n===!0?(e.directions=Object.keys(Ds),e.autoInsertRow=!0):(0,Y.isObject)(n)?((0,I.isDefined)(n.autoInsertRow)?n.direction===Ds.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,(0,I.isDefined)(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Ds)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function ta(n,e){ho(n,e),e.add(n)}function ho(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(n,e,t){return(e=us(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function us(n){var e=Ma(n,"string");return typeof e=="symbol"?e:e+""}function Ma(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Fl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("modifyAutofillRange"),xn.P.getSingleton().register("beforeAutofill"),xn.P.getSingleton().register("afterAutofill");const hd="autofill",Wl=20,lc=["fillHandle"],dd="insert_row_below",cs=200;var na=new WeakSet;class Bl extends jr.vq{constructor(){super(...arguments),ta(this,na),bi(this,"addingStarted",!1),bi(this,"mouseDownOnCellCorner",!1),bi(this,"mouseDragOutside",!1),bi(this,"handleDraggedCells",0),bi(this,"directions",[]),bi(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return hd}static get PLUGIN_PRIORITY(){return Wl}static get SETTING_KEYS(){return[hd,...lc]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fl(na,this,ts).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fl(na,this,Oa).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>Fl(na,this,fa).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:s,col:l}=e.getBottomEndCorner(),g=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:s,endCol:l}]),S=[],M=[],P=[];return(0,W.arrayEach)(g,j=>{for(let oe=j.startRow;oe<=j.endRow;oe+=1)S.indexOf(oe)===-1&&S.push(oe);for(let oe=j.startCol;oe<=j.endCol;oe+=1)M.indexOf(oe)===-1&&M.push(oe)}),(0,W.arrayEach)(S,j=>{const oe=[];(0,W.arrayEach)(M,ye=>{oe.push(this.hot.getCopyableData(j,ye))}),P.push(oe)}),P}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,s]=this.hot.selection.highlight.getFill().getVisualCorners(),l=this.hot.getSelectedRangeLast(),g=l.getTopStartCorner(),S=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();const M=[g.row,g.col,S.row,S.col],P=this.hot.runHooks("modifyAutofillRange",[Math.min(g.row,e),Math.min(g.col,t),Math.max(S.row,r),Math.max(S.col,s)],M),{directionOfDrag:j,startOfDragCoords:oe,endOfDragCoords:ye}=vh(M,P,(xe,Ze)=>this.hot._createCellCoords(xe,Ze));if(oe&&oe.row>-1&&oe.col>-1){const xe=this.getSelectionData(),Ze=l.clone(),Ct=this.hot._createCellRange(oe,oe,ye),ot=this.hot.runHooks("beforeAutofill",xe,Ze,Ct,j);if(ot===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let Jt=ot;const Pt=ot;if(["up","left"].indexOf(j)>-1&&!(Pt.length===1&&Pt[0].length===0))if(Jt=[],j==="up"){const Un=ye.row-oe.row+1,gr=Un%Pt.length;for(let jn=0;jn<Un;jn++)Jt.push(Pt[(jn+(Pt.length-gr))%Pt.length])}else{const Un=ye.col-oe.col+1,gr=Un%Pt[0].length;for(let jn=0;jn<Pt.length;jn++){Jt.push([]);for(let Kt=0;Kt<Un;Kt++)Jt[jn].push(Pt[jn][(Kt+(Pt[jn].length-gr))%Pt[jn].length])}}this.hot.populateFromArray(oe.row,oe.col,Jt,ye.row,ye.col,`${this.pluginName}.fill`,null),this.setSelection(P),this.hot.runHooks("afterAutofill",Jt,Ze,Ct,j),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let s=e;if(this.directions.includes(Ds.vertical)&&this.directions.includes(Ds.horizontal)){const l=t.getTopStartCorner();(r.col<=e.col||l.col>=e.col)&&(s=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||l.row>e.row)&&(s=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ds.vertical))s=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ds.horizontal))s=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(dd,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},cs)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let s;for(let l=e[2]+1;l<r;l++){for(let M=e[1];M<=e[3];M++){const P=t[l][M];if(!(0,I.isEmpty)(P))return-1}const g=t[l][e[1]-1],S=t[l][e[3]+1];(!(0,I.isEmpty)(g)||!(0,I.isEmpty)(S))&&(s=l)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...(0,W.arrayMap)(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=(0,N.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+(0,N.outerHeight)(this.hot.table),s=(0,N.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+(0,N.outerWidth)(this.hot.table);return e.clientY>r&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fl(na,this,Ut).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>Fl(na,this,lf).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Br(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Oa(){this.selectAdjacent()&&this.fillIn()}function ts(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function fa(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function Ut(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function lf(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Ar(n,e){ei(n,e),e.add(n)}function to(n,e,t){ei(n,e),e.set(n,t)}function ei(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(n,e,t){return(e=Ss(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ss(n){var e=bu(n,"string");return typeof e=="symbol"?e:e+""}function bu(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function uc(n,e,t){return n.set(Bi(n,e),t),t}function ra(n,e){return n.get(Bi(n,e))}function Bi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const al="autoRowSize",Ch=40,Pa="autoRowSize";var ns=new WeakMap,cc=new WeakMap,ga=new WeakSet;class wh extends jr.vq{static get PLUGIN_KEY(){return al}static get PLUGIN_PRIORITY(){return Ch}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Ar(this,ga),Ia(this,"headerHeight",null),Ia(this,"ghostTable",new Lc.Z(this.hot)),Ia(this,"samplesGenerator",new ld((t,r)=>{const s=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(l)||t>=0&&r>=0&&this.hot.getCellMeta(t,r).hidden)return!1;let g;return t>=0?g=this.hot.getDataAtCell(t,r):t===-1&&(g=this.hot.getColHeader(r)),{value:g}})),Ia(this,"inProgress",!1),Ia(this,"measuredRows",0),Ia(this,"rowHeightsMap",new Ka.L),to(this,ns,[]),to(this,cc,!1),this.hot.rowIndexMapper.registerMap(Pa,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,s)=>Bi(ga,this,hc).call(this,t,r,s))}isEnabled(){const e=this.hot.getSettings()[al];return e===!0||(0,Y.isObject)(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return Bi(ga,e,fd).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return Bi(ga,e,gd).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return Bi(ga,e,Eu).call(e,...s)}),this.addHook("beforeRender",()=>Bi(ga,this,tu).call(this)),this.addHook("modifyRowHeight",(r,s)=>this.getRowHeight(s,r)),this.addHook("init",()=>Bi(ga,this,ma).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>Bi(ga,this,hc).call(this,e,t,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,l=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const g=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(g.get(-1))}(0,Rn.rangeEach)(s.from,s.to,g=>{let S=this.hot.toPhysicalRow(g);S===null&&(S=g),(r||this.rowHeightsMap.getValueAtIndex(S)===null)&&this.samplesGenerator.generateRowSamples(g,l).forEach((P,j)=>this.ghostTable.addRow(j,P))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((g,S)=>{g<0?this.headerHeight=S:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(g),S)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const s=this.hot.countRows()-1;let l=null;this.inProgress=!0;const g=()=>{if(!this.hot){(0,Qo.cancelAnimationFrame)(l),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+wh.CALCULATION_STEP,s)},e,t),r=r+wh.CALCULATION_STEP+1,r<s?l=(0,Qo.requestAnimationFrame)(g):((0,Qo.cancelAnimationFrame)(l),this.inProgress=!1,this.hot.view.adjustElementsSize())},S=this.getSyncCalculationLimit();S>=0&&(this.calculateRowsHeight({from:0,to:S},e,t),r=S+1),r<s?g():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[al];let t=wh.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return(0,Y.isObject)(e)&&(t=e.syncLimit,(0,V.isPercentValue)(t)?t=(0,Rn.valueAccordingPercent)(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=t;return r!==null&&r>(t||0)&&(s=r),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{(0,Rn.rangeEach)(Math.min(t,r),Math.max(t,r),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function eu(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((s,l)=>this.ghostTable.addRow(l,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,r)=>{const s=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(s,r)})},!0),this.ghostTable.clean())}function tu(){this.calculateVisibleRowsHeight(),this.inProgress||(Bi(ga,this,eu).call(this,ra(ns,this)),uc(ns,this,[]))}function hc(n,e,t){let r=n;return t&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function fd(n,e){e||this.recalculateAllRowsHeight()}function gd(n){const e=n.reduce((t,r)=>{let[s]=r;return t.indexOf(s)===-1&&t.push(s),t},[]);ra(ns,this).push(...e)}function ma(){this.recalculateAllRowsHeight(),uc(cc,this,!0)}function Eu(n){if(!ra(cc,this))return;const e=n.reduce((t,r)=>{var s;const l=(s=r.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(l)){const g=this.hot.toVisualRow(l);t.indexOf(g)===-1&&t.push(g)}return t},[]);ra(ns,this).push(...e)}var yh=f(85738),dc=f(87167);const md=new Map([["indexesSequence",{getListWithInsertedItems:yh.S,getListWithRemovedItems:yh.t}],["physicallyIndexed",{getListWithInsertedItems:dc.S,getListWithRemovedItems:dc.t}]]),Wc=n=>{if(md.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return md.get(n)};var ag=f(2135),ll=f(19468);const{getListWithInsertedItems:fc,getListWithRemovedItems:nu}=Wc("physicallyIndexed");class lg extends ag.n{constructor(){super(e=>e)}insert(e,t){const r=(0,ll.X)(this.indexedValues,t);this.indexedValues=fc(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=nu(this.indexedValues,e);this.indexedValues=(0,ll.i)(t,e),super.remove(e)}}var Bc=lg;const{getListWithInsertedItems:_s,getListWithRemovedItems:Hs}=Wc("physicallyIndexed");class Ru extends ag.n{constructor(){super(e=>e)}insert(e,t){this.indexedValues=_s(this.indexedValues,e,t,(r,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=Hs(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}var pd=Ru;function Sh(n,e){_h(n,e),e.add(n)}function _h(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ul(n,e,t){return(e=xa(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xa(n){var e=ru(n,"string");return typeof e=="symbol"?e:e+""}function ru(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Bo="bindRowsWithHeaders",cl=210,dm="loose",gc=new Map([["loose",Bc],["strict",pd]]);var uf=new WeakSet;class ug extends jr.vq{constructor(){super(...arguments),Sh(this,uf),ul(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Bo}static get PLUGIN_PRIORITY(){return cl}isEnabled(){return!!this.hot.getSettings()[Bo]}enablePlugin(){var e;if(this.enabled)return;const t=(e=gc.get(this.getSetting()))!==null&&e!==void 0?e:gc.get(dm);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>bh(uf,this,cg).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function cg(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}var v=f(40674);function b(n,e){F(n,e),e.add(n)}function D(n,e,t){F(n,e),e.set(n,t)}function F(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(n,e,t){return(e=m(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m(n){var e=E(n,"string");return typeof e=="symbol"?e:e+""}function E(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function R(n,e){return n.get(ae(n,e))}function L(n,e,t){return n.set(ae(n,e),t),t}function ae(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ce="collapsibleColumns",_e=290,Ge=["nestedHeaders"],ht="collapsibleIndicator",Dt=Ce,Ht=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var tr=new WeakMap,cr=new WeakSet;class An extends jr.vq{constructor(){super(...arguments),b(this,cr),c(this,"nestedHeadersPlugin",null),c(this,"headerStateManager",null),D(this,tr,null)}static get PLUGIN_KEY(){return Ce}static get PLUGIN_PRIORITY(){return _e}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Ce,...Ge]}isEnabled(){return!!this.hot.getSettings()[Ce]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||(0,v.ZK)("You need to configure the Nested Headers plugin in order to use collapsible headers."),L(tr,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ae(cr,this,At).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return ae(cr,e,vn).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return ae(cr,e,lt).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(r,s,l)=>ae(cr,this,Nt).call(this,r,s,l)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),L(tr,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:l,columnIndex:g}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(s)return l?this.expandSection({row:t,col:g}):this.collapseSection({row:t,col:g}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:Dt,relativeToGroup:Z.I,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Dt)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(g){g&&g.parentNode.removeChild(g)};(0,Rn.rangeEach)(0,e-1,g=>{const S=t.childNodes[g],M=r.childNodes[g],P=s?s.childNodes[g]:null;(0,Rn.rangeEach)(0,S.childNodes.length-1,j=>{let oe=S.childNodes[j].querySelector(`.${ht}`);l(oe),M&&M.childNodes[j]&&(oe=M.childNodes[j].querySelector(`.${ht}`),l(oe)),s&&P&&P.childNodes[j]&&(oe=P.childNodes[j].querySelector(`.${ht}`),l(oe))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:s,origColspan:l,headerLevel:g,columnIndex:S,isCollapsed:M}=r;if(s===!0&&l>1&&(M&&e==="expand"||!M&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(g),col:S}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Ht.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=(0,W.arrayFilter)(e,xe=>{let{row:Ze}=xe;return Ze<0});let s=r.length>0;(0,W.arrayEach)(r,xe=>{var Ze;let{row:Ct,col:ot}=xe;const{collapsible:Jt,isCollapsed:Pt}=(Ze=this.headerStateManager.getHeaderSettings(Ct,ot))!==null&&Ze!==void 0?Ze:{};if(!Jt||Pt&&t==="collapse"||!Pt&&t==="expand")return s=!1,!1});const l=[],g=[];s&&(0,W.arrayEach)(r,xe=>{let{row:Ze,col:Ct}=xe;const{colspanCompensation:ot,affectedColumns:Jt,rollbackModification:Pt}=this.headerStateManager.triggerNodeModification(t,Ze,Ct);ot>0&&(g.push(...Jt),l.push(Pt))});const S=this.getCollapsedColumns();let M=[];t==="collapse"?M=(0,W.arrayUnique)([...S,...g]):t==="expand"&&(M=(0,W.arrayFilter)(S,xe=>!g.includes(xe)));const P=Ht.get(t);if(this.hot.runHooks(P.beforeHook,S,M,s)===!1){(0,W.arrayEach)(l,xe=>{xe()});return}this.hot.batchExecution(()=>{(0,W.arrayEach)(g,xe=>{R(tr,this).setValueAtIndex(this.hot.toPhysicalColumn(xe),P.hideColumn)})},!0);const oe=this.getCollapsedColumns().length!==S.length,ye=this.hot.getSelectedRangeLast();if(t==="collapse"&&oe&&ye){const{row:xe,col:Ze}=ye.highlight;if((this.hot.rowIndexMapper.isHidden(xe)||this.hot.columnIndexMapper.isHidden(Ze))&&g.includes(Ze)){const ot=xe>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(xe,1,!0):xe,Jt=Ze>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(Ze,1,!0):Ze;ot!==null&&Jt!==null&&this.hot.selectCell(ot,Jt)}}this.hot.runHooks(P.afterHook,S,M,s,oe),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return R(tr,this).getHiddenIndexes()}destroy(){L(tr,this,null),super.destroy()}}function lt(n,e,t){var r;const{collapsible:s,origColspan:l,isCollapsed:g}=(r=this.headerStateManager.getHeaderSettings(t,n))!==null&&r!==void 0?r:{},S=s&&l>1&&n>=this.hot.getSettings().fixedColumnsStart,M=this.hot.getSettings().ariaTags;let P=e.querySelector(`.${ht}`);if((0,N.removeAttribute)(e,[(0,ue.JV)("")[0]]),S)P||(P=this.hot.rootDocument.createElement("div"),(0,N.addClass)(P,ht),e.querySelector("div:first-child").appendChild(P)),(0,N.removeClass)(P,["collapsed","expanded"]),g?((0,N.addClass)(P,"collapsed"),(0,N.fastInnerText)(P,"+"),M&&(0,N.setAttribute)(e,...(0,ue.JV)(!1))):((0,N.addClass)(P,"expanded"),(0,N.fastInnerText)(P,"-"),M&&(0,N.setAttribute)(e,...(0,ue.JV)(!0))),M&&(0,N.setAttribute)(P,...(0,ue.cV)());else{var j;(j=P)===null||j===void 0||j.remove()}}function Nt(n,e){(0,N.hasClass)(n.target,ht)&&((0,N.hasClass)(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):(0,N.hasClass)(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),(0,ce.stopImmediatePropagation)(n))}function At(){this.updatePlugin()}function vn(n,e){e||this.updatePlugin()}var qn=f(85231),hr=f(26665);function Qt(n,e,t){return(e=dn(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dn(n){var e=ar(n,"string");return typeof e=="symbol"?e:e+""}function ar(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ai=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ti=!1,Ei=!0,bs=!0;class $n{constructor(e,t){Qt(this,"hot",void 0),Qt(this,"sortingStates",new hr.A),Qt(this,"sortEmptyCells",ti),Qt(this,"indicator",Ei),Qt(this,"headerAction",bs),Qt(this,"compareFunctionFactory",void 0),Qt(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){(0,Y.isObject)(e)&&(0,Y.objectEach)(e,(t,r)=>{ai.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return(0,Y.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,s]=t;return hi({column:this.hot.toVisualColumn(r)},s)})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if((0,I.isDefined)(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}var ni=f(71441),lr=f(31702),Ls=f(89050),Tu=f(16110),kc=f(8274),ri=f(64109),iu=f(92128),mc=f(5499);function ia(n,e,t){const r=e.locale;return function(s,l){const{sortEmptyCells:g}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(r)),typeof l=="string"&&(l=l.toLocaleLowerCase(r)),s===l?cn:(0,I.isEmpty)(s)?(0,I.isEmpty)(l)?cn:g&&n==="asc"?Lt:wn:(0,I.isEmpty)(l)?g&&n==="asc"?wn:Lt:isNaN(s)&&!isNaN(l)?n==="asc"?wn:Lt:!isNaN(s)&&isNaN(l)||(isNaN(s)||isNaN(l)||(s=parseFloat(s),l=parseFloat(l)),s<l)?n==="asc"?Lt:wn:s>l?n==="asc"?wn:Lt:cn}}const fm="default";function Aa(n,e,t){return function(r,s){const l=parseFloat(r),g=parseFloat(s),{sortEmptyCells:S}=t;if(l===g||isNaN(l)&&isNaN(g))return cn;if(S){if((0,I.isEmpty)(r))return n==="asc"?Lt:wn;if((0,I.isEmpty)(s))return n==="asc"?wn:Lt}return isNaN(l)?wn:isNaN(g)?Lt:l<g?n==="asc"?Lt:wn:l>g?n==="asc"?wn:Lt:cn}}const hg="numeric";function kl(n,e,t){const r=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:l}=t;return function(g,S){const M=(0,I.isEmpty)(g),P=(0,I.isEmpty)(S),j=M?s:g,oe=P?s:S,ye=j===s||j===r,xe=oe===s||oe===r;if(l===!1){if(M&&P===!1)return wn;if(M===!1&&P)return Lt}return ye===!1&&xe?n==="asc"?Lt:wn:ye&&xe===!1?n==="asc"?wn:Lt:ye===!1&&xe===!1?ia(n,e,t)(g,S):j===s&&oe===r?n==="asc"?Lt:wn:j===r&&oe===s?n==="asc"?wn:Lt:cn}}const ko="checkbox";function Mu(n,e,t){return Ou(n,e.dateFormat,t)}const gm="date";function Eh(n,e,t){return Ou(n,e.timeFormat,t)}const Ne="time";var We=f(80534);const{register:Rt,getItem:ln,hasItem:Xt}=(0,We.Z)("sorting.compareFunctionFactory"),{register:rn,getItem:fn}=(0,We.Z)("sorting.mainSortComparator");function gt(n){return Xt(n)?ln(n):ln(fm)}Rt(ko,kl),Rt(gm,Mu),Rt(fm,ia),Rt(hg,Aa),Rt(Ne,Eh);const cn=0,Lt=-1,wn=1;function Dn(n,e){const t=fn(e);for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];n.sort(t(...s))}var Nn=f(8767);const wr="asc",Zr="desc",rs="colHeader";function ki(n){if((0,Y.isObject)(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[wr,Zr].includes(t)}function Na(n){if(n.some(t=>ki(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function fo(n){if(n!==Zr)return n===wr?Zr:wr}function Da(n){return n.querySelector(`.${rs}`)}function Ga(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function Vc(n,e,t){return n===-1&&e>=0&&(0,ce.isRightClick)(t)===!1}function Ou(n,e,t){return function(r,s){const{sortEmptyCells:l}=t;if(r===s)return cn;if((0,I.isEmpty)(r))return(0,I.isEmpty)(s)?cn:l&&n==="asc"?Lt:wn;if((0,I.isEmpty)(s))return l&&n==="asc"?wn:Lt;const g=Ae()(r,e),S=Ae()(s,e);return g.isValid()?S.isValid()?S.isAfter(g)?n==="asc"?Lt:wn:S.isBefore(g)?n==="asc"?wn:Lt:cn:Lt:wn}}function $a(n,e){(0,v.ZK)((0,Nn.e)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${n}\` will work. The \`${e}\` plugin will remain disabled.`)}const su="ascending",sa="descending",cf="indicatorDisabled",Qv="columnSorting",mm="sortAction",qv=new Map([[wr,su],[Zr,sa]]);function wy(n,e,t,r){const s=[Qv];if(r&&s.push(mm),t===!1)return s.push(cf),s;const l=n.getSortOrderOfColumn(e);return(0,I.isDefined)(l)&&s.push(qv.get(l)),s}function Sp(){return Array.from(qv.values()).concat(mm,cf,Qv)}function jc(n,e){return function(t,r){const[,...s]=t,[,...l]=r;return function(S){const M=n[S],P=e[S],j=s[S],oe=l[S],ye=P.columnSorting;return(ye.compareFunctionFactory?ye.compareFunctionFactory:gt(P.type))(M,P,ye)(j,oe)}(0)}}function _p(n,e){bp(n,e),e.add(n)}function bp(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hf(n,e,t){return(e=yy(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yy(n){var e=eC(n,"string");return typeof e=="symbol"?e:e+""}function eC(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function df(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pm="columnSorting",tC=50,ff="append",nC="replace",rC=pm;rn(pm,jc),xn.P.getSingleton().register("beforeColumnSort"),xn.P.getSingleton().register("afterColumnSort");const is=new WeakMap;var vd=new WeakSet;class Uc extends jr.vq{constructor(){super(...arguments),_p(this,vd),hf(this,"columnStatesManager",null),hf(this,"columnMetaCache",null),hf(this,"pluginKey",pm),hf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return pm}static get PLUGIN_PRIORITY(){return tC}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(is.has(this.hot)&&is.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),$a(is.get(this.hot),this.pluginKey);return}this.enabled||(is.set(this.hot,this.pluginKey),this.columnStatesManager=new $n(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ka.L(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>df(vd,this,pc).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return df(vd,e,zc).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>df(vd,this,Iu).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return df(vd,e,Sy).call(e,...r)}),this.hot.view&&df(vd,this,Iu).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const s=Da(r);Ga(t,r)===!1||s===null||this.updateHeaderClasses(s)};is.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Z.I,position:"before",group:rC})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rC)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new qn.b),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,s?r:t,s),s&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return(0,I.isDefined)(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return Na(e)&&e.every(r=>{let{column:s}=r;return s<=t&&s>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=s=>{let S=s,{column:l}=S,g=Xu(S,["column"]);return hi({column:this.hot.toPhysicalColumn(l)},g)};t.initialConfig=(0,W.arrayMap)(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=s=>{let S=s,{column:l}=S,g=Xu(S,["column"]);return hi({column:this.hot.toVisualColumn(l)},g)};return(0,I.isDefined)(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=(0,W.arrayMap)(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if((0,I.isDefined)(t)){const s=fo(t);return(0,I.isDefined)(s)?{column:e,sortOrder:s}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:fo()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ff;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=r!==-1,l=this.getSortConfig(),g=this.getColumnNextConfig(e);if(s){if((0,I.isUndefined)(g))return[...l.slice(0,r),...l.slice(r+1)];if(t===ff)return[...l.slice(0,r),...l.slice(r+1),g];if(t===nC)return[...l.slice(0,r),g,...l.slice(r+1)]}return(0,I.isDefined)(g)?l.concat(g):l}getPluginColumnConfig(e){if((0,Y.isObject)(e)){const t=e[this.pluginKey];if((0,Y.isObject)(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(r,t,this.getPluginColumnConfig(l.columns[e])):(0,ve.isFunction)(l.columns)?Object.assign(r,t,this.getPluginColumnConfig(l.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),s=P=>(0,W.arrayMap)(e,j=>this.hot.getDataAtCell(P,j.column));for(let P=0;P<this.getNumberOfRowsToSort(r);P+=1)t.push([this.hot.toPhysicalRow(P)].concat(s(P)));const l=(0,W.arrayMap)(t,P=>P[0]);Dn(t,this.pluginKey,(0,W.arrayMap)(e,P=>P.sortOrder),(0,W.arrayMap)(e,P=>this.getFirstCellSettings(P.column)));for(let P=t.length;P<r;P+=1)t.push([P].concat(s(P)));const g=(0,W.arrayMap)(t,P=>P[0]),S=new Map((0,W.arrayMap)(l,(P,j)=>[P,g[j]])),M=(0,W.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),P=>S.has(P)?S.get(P):P);this.hot.rowIndexMapper.setIndexesSequence(M)}sortBySettings(e){if((0,Y.isObject)(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||(0,Y.isObject)(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if((0,N.removeClass)(e,Sp(e)),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];(0,N.addClass)(e,wy(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,I.isDefined)(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&(0,N.hasClass)(e.target,rs)}onAfterOnCellMouseDown(e,t){if(Vc(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),s=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Iu(){const n=this.getAllSavedSortSettings();if((0,Y.isObject)(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function pc(n,e){const t=Da(e);if(Ga(n,e)===!1||t===null)return;const r=this.getFirstCellSettings(n)[this.pluginKey],s=r.indicator,l=r.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,s,l),this.hot.getSettings().ariaTags){const g=this.columnStatesManager.getSortOrderOfColumn(n);(0,N.setAttribute)(e,...(0,ue.l_)(g?`${g}ending`:"none"))}}function Sy(n){n===!0&&this.hot.view&&df(vd,this,Iu).call(this)}function zc(n,e,t,r){Vc(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Cd(n,e,t){return(e=iC(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iC(n){var e=_y(n,"string");return typeof e=="symbol"?e:e+""}function _y(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class by{constructor(e,t){Cd(this,"plugin",void 0),Cd(this,"hot",void 0),Cd(this,"endpoints",[]),Cd(this,"settings",void 0),Cd(this,"settingsType","array"),Cd(this,"currentEndpoint",null),Cd(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),(0,W.arrayEach)(r,s=>{const l={};this.assignSetting(s,l,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,l,"reversedRowCoords",!1),this.assignSetting(s,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,l,"sourceColumn",s.destinationColumn),this.assignSetting(s,l,"type","sum"),this.assignSetting(s,l,"forceNumeric",!1),this.assignSetting(s,l,"suppressDataTypeErrors",!0),this.assignSetting(s,l,"customFunction",null),this.assignSetting(s,l,"readOnly",!0),this.assignSetting(s,l,"roundFloat",!1),t.push(l)}),t}assignSetting(e,t,r,s){if(r==="ranges"&&e[r]===void 0){t[r]=s;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(s instanceof Error)throw s;t[r]=s}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",l=this.getAllEndpoints();(0,W.arrayEach)(l,g=>{s==="row"&&g.destinationRow>=t&&(e==="insert_row"?g.alterRowOffset=r:e==="remove_row"&&(g.alterRowOffset=-1*r)),s==="col"&&g.destinationColumn>=t&&(e==="insert_col"?g.alterColumnOffset=r:e==="remove_col"&&(g.alterColumnOffset=-1*r))}),this.resetAllEndpoints(l,!1)}resetSetupAfterStructureAlteration(e,t,r,s,l){let g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const ye=()=>(this.hot.removeHook("beforeViewRender",ye),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",ye);return}const S=e.indexOf("row")>-1?"row":"col",M=e.indexOf("remove")>-1?-1:1,P=this.getAllEndpoints(),j=e.indexOf("move_row")===0,oe=t;(0,W.arrayEach)(P,ye=>{S==="row"&&ye.destinationRow>=oe&&(ye.alterRowOffset=M*r),S==="col"&&ye.destinationColumn>=oe&&(ye.alterColumnOffset=M*r)}),this.resetAllEndpoints(P,!j),j?(0,W.arrayEach)(P,ye=>{this.extendEndpointRanges(ye,oe,s[0],s.length),this.recreatePhysicalRanges(ye),this.clearOffsetInformation(ye)}):(0,W.arrayEach)(P,ye=>{this.shiftEndpointCoordinates(ye,oe)}),g&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,s){(0,W.arrayEach)(e.ranges,l=>{l[1]&&(t>=l[0]&&t<=l[1]?r>l[1]?l[1]+=s:r<l[0]&&(l[0]-=s):r>=l[0]&&r<=l[1]&&(l[1]-=s,t<=l[0]&&(l[0]+=1,l[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],s=[];(0,W.arrayEach)(t,l=>{const g=[];if(l[1])for(let S=l[0];S<=l[1];S++)g.push(this.hot.toPhysicalRow(S));else g.push(this.hot.toPhysicalRow(l[0]));s.push(g)}),(0,W.arrayEach)(s,l=>{let g=[];(0,W.arrayEach)(l,(S,M)=>{M===0?g.push(S):l[M]!==l[M-1]+1&&(g.push(l[M-1]),r.push(g),g=[],g.push(S)),M===l.length-1&&(g.push(S),r.push(g))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,(0,W.arrayEach)(e.ranges,r=>{(0,W.arrayEach)(r,(s,l)=>{s>=t&&(r[l]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const l=s.alterRowOffset||0,g=s.alterColumnOffset||0;return s.destinationRow+l>=this.hot.countRows()||s.destinationColumn+g>=this.hot.countCols()})||(this.cellsToSetCache=[],(0,W.arrayEach)(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,W.arrayEach)(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],(0,W.arrayEach)(e,(r,s,l)=>{`${r[2]||""}`!=`${r[3]}`&&(0,W.arrayEach)(this.getAllEndpoints(),(g,S)=>{this.hot.propToCol(l[s][1])===g.sourceColumn&&t.indexOf(S)===-1&&t.push(S)})}),(0,W.arrayEach)(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const l=this.hot.toVisualRow(e.destinationRow);if(l!==null){const g=this.hot.getCellMeta(l,e.destinationColumn);(t==="init"||g.readOnly!==e.readOnly)&&(g.readOnly=e.readOnly,g.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const g=e.roundFloat;let S=0;Number.isInteger(g)&&(S=Math.min(Math.max(0,g),100)),e.result=e.result.toFixed(S)}r?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,v.ZK)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var Ey=by;function Rh(n){return n==null||isNaN(n)}function Ry(n,e){Ep(n,e),e.add(n)}function Ep(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rp(n,e,t){return(e=Ri(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ri(n){var e=vm(n,"string");return typeof e=="symbol"?e:e+""}function vm(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Xs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const gf="columnSummary",Ms=220;var Xa=new WeakSet;class go extends jr.vq{constructor(){super(...arguments),Ry(this,Xa),Rp(this,"endpoints",null)}static get PLUGIN_KEY(){return gf}static get PLUGIN_PRIORITY(){return Ms}isEnabled(){return!!this.hot.getSettings()[gf]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[gf],this.endpoints=new Ey(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Xs(Xa,e,Cm).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Xs(Xa,e,Tp).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Xs(Xa,e,sC).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,s)),this.addHook("beforeCreateCol",(t,r,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,s)),this.addHook("afterCreateCol",(t,r,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Xs(Xa,e,wm).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let t=0;return(0,Y.objectEach)(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,s=e[1]||e[0],l=null,g=0;do{if(l=this.getCellValue(s,t),l=Rh(l)?null:l,l!==null){const S=(`${l}`.split(".")[1]||[]).length||1;S>g&&(g=S)}r+=l||0,s-=1}while(s>=e[0]);return Math.round(r*jT(10,g))/jT(10,g)}calculateMinMax(e,t){let r=null;return(0,Y.objectEach)(e.ranges,s=>{const l=this.getPartialMinMax(s,e.sourceColumn,t);if(r===null&&l!==null&&(r=l),l!==null)switch(t){case"min":r=Math.min(r,l);break;case"max":r=Math.max(r,l);break;default:break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let s=null,l=e[1]||e[0],g;do{if(g=this.getCellValue(l,t),g=Rh(g)?null:g,s===null)s=g;else if(g!==null)switch(r){case"min":s=Math.min(s,g);break;case"max":s=Math.max(s,g);break;default:break}l-=1}while(l>=e[0]);return s}countEmpty(e,t){let r,s=0,l=e[1]||e[0];do r=this.getCellValue(l,t),r=Rh(r)?null:r,r===null&&(s+=1),l-=1;while(l>=e[0]);return s}countEntries(e){let t=0;const r=e.ranges;return(0,Y.objectEach)(r,s=>{const l=s[1]===void 0?1:s[1]-s[0]+1,g=this.countEmpty(s,e.sourceColumn);t+=l,t-=g}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t);let l=this.hot.getSourceDataAtCell(e,t),g="";if(r!==null&&s!==null&&(g=this.hot.getCellMeta(r,s).className||""),g.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error((0,Nn.e)`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return l}}function Cm(){this.endpoints.initEndpoints()}function sC(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function Tp(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function wm(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}var Pu=f(25506);function oC(n,e){ym(n,e),e.add(n)}function Kc(n,e,t){ym(n,e),e.set(n,t)}function ym(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yc(n,e){return n.get(Mp(n,e))}function Th(n,e,t){return n.set(Mp(n,e),t),t}function Mp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var vc=new WeakMap,Sm=new WeakMap,_m=new WeakMap,Os=new WeakSet;class mo{constructor(){oC(this,Os),Kc(this,vc,!0),Kc(this,Sm,null),Kc(this,_m,new ResizeObserver(e=>Mp(Os,this,aC).call(this,e)))}setObservedElement(e){Th(Sm,this,e)}unobserve(){Yc(_m,this).unobserve(Yc(Sm,this))}observe(){Th(vc,this,!0),Yc(_m,this).observe(Yc(Sm,this))}destroy(){Yc(_m,this).disconnect()}}function aC(n){if(Yc(vc,this)||!Array.isArray(n)||!n.length){Th(vc,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:s}=t[0];this.runLocalHooks("resize",r,s)})}(0,Y.mixin)(mo,Pu.Z);function Zs(n,e,t){wd(n,e),e.set(n,t)}function wd(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vi(n,e){return n.get(yd(n,e))}function Vl(n,e,t){return n.set(yd(n,e),t),t}function yd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xu=new WeakMap,mf=new WeakMap,Gc=new WeakMap,Au=new WeakMap,Mh=new WeakMap,Sd=new WeakMap,pf=new WeakMap;class Cc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var r=this;Zs(this,xu,void 0),Zs(this,mf,!1),Zs(this,Gc,null),Zs(this,Au,void 0),Zs(this,Mh,void 0),Zs(this,Sd,!0),Zs(this,pf,new mo),Vl(xu,this,e),Vl(mf,this,t),Vl(Au,this,this.createEditor()),Vl(Mh,this,vi(Au,this).style),vi(pf,this).setObservedElement(this.getInputElement()),vi(pf,this).addLocalHook("resize",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return r.runLocalHooks("resize",...l)}),this.hide()}setPosition(e,t){vi(Mh,this).left=`${e}px`,vi(Mh,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:(0,N.outerWidth)(this.getInputElement()),height:(0,N.outerHeight)(this.getInputElement())}}observeSize(){vi(pf,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){vi(Mh,this).display="block",Vl(Sd,this,!1)}hide(){vi(pf,this).unobserve(),vi(Sd,this)||(vi(Mh,this).display="none"),Vl(Sd,this,!0)}isVisible(){return vi(Mh,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return vi(xu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=vi(xu,this).createElement("div"),t=vi(xu,this).createElement("textarea");return e.style.display="none",Vl(Gc,this,vi(xu,this).createElement("div")),vi(Gc,this).setAttribute("dir",vi(mf,this)?"rtl":"ltr"),(0,N.addClass)(vi(Gc,this),Cc.CLASS_EDITOR_CONTAINER),vi(xu,this).body.appendChild(vi(Gc,this)),(0,N.addClass)(e,Cc.CLASS_EDITOR),(0,N.addClass)(t,Cc.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),vi(Gc,this).appendChild(e),e}getInputElement(){return vi(Au,this).querySelector(`.${Cc.CLASS_INPUT}`)}getEditorElement(){return vi(Au,this)}destroy(){const e=vi(Gc,this)?vi(Gc,this).parentNode:null;vi(Au,this).parentNode.removeChild(vi(Au,this)),Vl(Au,this,null),Vl(Mh,this,null),vi(pf,this).destroy(),e&&e.removeChild(vi(Gc,this))}}(0,Y.mixin)(Cc,Pu.Z);var bm=Cc;function vf(n,e,t){return(e=lC(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lC(n){var e=uC(n,"string");return typeof e=="symbol"?e:e+""}function uC(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ty=250,My=250;class cC{constructor(e){vf(this,"wasLastActionShow",!0),vf(this,"showDebounced",null),vf(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},My)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ty;this.showDebounced=(0,ve.debounce)(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}(0,Y.mixin)(cC,Pu.Z);var Op=cC;const ii="---------";function Oy(){return{name:ii}}function Iy(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Py(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((t,r)=>{t>=0&&r>=0&&n.removeCommentAtCell(t,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Em(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function xy(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Oh(n,e){const t={};return(0,W.arrayEach)(n,r=>{r.forAll((s,l)=>{s>=0&&l>=0&&(t[s]||(t[s]=[]),t[s][l]=e(s,l))})}),t}function Nu(n,e,t,r,s){(0,W.arrayEach)(n,l=>{l.forAll((g,S)=>{g>=0&&S>=0&&hC(g,S,e,t,r,s)})})}function hC(n,e,t,r,s,l){const g=s(n,e);let S=r;g.className&&(t==="vertical"?S=Em(g.className,r):S=xy(g.className,r)),l(n,e,"className",S)}function dC(n){return`<span class="selected">\u2713</span>${n}`}function Rm(n,e){let t=!1;return Array.isArray(n)&&(0,W.arrayEach)(n,r=>(r.forAll((s,l)=>{if(s>=0&&l>=0&&e(s,l))return t=!0,!1}),t)),t}function dg(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:r}=e.defaultView,{top:s,left:l}=r.getBoundingClientRect();t.top=s,t.left=l}return t}function Ay(n){return function(e,t){const r=this.getCellMeta(e,t).className;return r&&r.indexOf(n)!==-1}}function fC(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return Rm(this.getSelectedRange(),(r,s)=>n.getCommentMeta(r,s,Tm))?dC(e):e},callback(){this.getSelectedRangeLast().forAll((t,r)=>{if(t>=0&&r>=0){const s=!!n.getCommentMeta(t,r,Tm);n.updateCommentMeta(t,r,{[Tm]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ny(n,e){gC(n,e),e.add(n)}function Cf(n,e,t){gC(n,e),e.set(n,t)}function gC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ip(n,e,t){return(e=mC(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mC(n){var e=pC(n,"string");return typeof e=="symbol"?e:e+""}function pC(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $c(n,e,t){return n.set(hl(n,e),t),t}function Jr(n,e){return n.get(hl(n,e))}function hl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const fg="comments",Pp=60,wc="comment",wf="value",vC="style",Tm="readOnly",yf=fg,Mm=`plugin:${fg}`;var Vi=new WeakMap,po=new WeakMap,Om=new WeakMap,gg=new WeakMap,Ih=new WeakMap,mg=new WeakMap,Za=new WeakSet;class _d extends jr.vq{constructor(){super(...arguments),Ny(this,Za),Ip(this,"range",{}),Cf(this,Vi,null),Cf(this,po,null),Cf(this,Om,!1),Cf(this,gg,!1),Cf(this,Ih,null),Cf(this,mg,"")}static get PLUGIN_KEY(){return fg}static get PLUGIN_PRIORITY(){return Pp}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[fg]}enablePlugin(){var e=this;this.enabled||(Jr(Vi,this)||($c(Vi,this,new bm(this.hot.rootDocument,this.hot.isRtl())),Jr(Vi,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hl(Za,e,ky).call(e,...r)})),Jr(po,this)||$c(po,this,new Op(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,s,l,g,S)=>hl(Za,this,Fy).call(this,t,S)),this.addHook("afterScroll",()=>hl(Za,this,Im).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>hl(Za,this,CC).call(this,t)),this.addHook("beforeCompositionStart",t=>hl(Za,this,CC).call(this,t)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hl(Za,e,xp).call(e,...r)}),Jr(po,this).addLocalHook("hide",()=>this.hide()),Jr(po,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Jr(po,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(Mm);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();$c(gg,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(Mm),this.hot._registerTimeout(()=>{$c(gg,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:yf}),r.addShortcut({keys:[["Escape"]],callback:()=>{Jr(Vi,this).setValue(Jr(mg,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Jr(Vi,this).isVisible()&&Jr(Vi,this).isFocused(),group:yf}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Jr(Vi,this).isVisible()&&Jr(Vi,this).isFocused(),group:yf}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Jr(Vi,this).setValue(Jr(Vi,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:yf})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yf)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>hl(Za,this,Hy).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>hl(Za,this,pg).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hl(Za,this,Ly).call(this)),this.eventManager.addEventListener(t,"focus",()=>hl(Za,this,By).call(this)),this.eventManager.addEventListener(t,"blur",()=>hl(Za,this,Wy).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>hl(Za,this,Dy).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=(0,N.closest)(e.target,"TD","TBODY");return!!(t&&(0,N.hasClass)(t,"htCommentCell")&&(0,N.closest)(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=Jr(Vi,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,{[wf]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,wc),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,wf)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,wf)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Jr(po,this).cancelHiding(),Jr(Vi,this).setValue((e=s[wc]?s[wc][wf]:null)!==null&&e!==void 0?e:""),Jr(Vi,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){Jr(Vi,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Jr(Vi,this).isVisible()))return;const{rowIndexMapper:t,columnIndexMapper:r}=this.hot,{row:s,col:l}=this.range.from;let g=t.getRenderableFromVisualIndex(s),S=r.getRenderableFromVisualIndex(l);const M=g===null;Jr(Vi,this).setPosition(0,0),g===null&&(g=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(s,-1))),S===null&&(S=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1)));const P=g===null,j=S===null;g=g!=null?g:0,S=S!=null?S:0;const{rootWindow:oe,view:{_wt:ye}}=this.hot,{wtTable:xe}=ye,Ze=ye.getCell({row:g,col:S},!0),Ct=this.getCommentMeta(s,l,vC);Ct?Jr(Vi,this).setSize(Ct.width,Ct.height):Jr(Vi,this).resetSize();const ot=j?0:xe.getColumnWidth(S),Jt=M&&!P?(0,N.outerHeight)(Ze):0,{left:Pt,top:Un,width:gr,height:jn}=Ze.getBoundingClientRect(),{width:Kt,height:Yt}=Jr(Vi,this).getSize(),{innerWidth:Sr,innerHeight:oi}=this.hot.rootWindow,gn=this.hot.rootDocument.documentElement,Ui=(0,N.getScrollbarWidth)(this.hot.rootDocument),Qr=(0,N.hasVerticalScrollbar)(this.hot.rootWindow)?Ui:0,Is=(0,N.hasHorizontalScrollbar)(this.hot.rootWindow)?Ui:0;let So=Pt+oe.scrollX+ot,_l=Un+oe.scrollY+Jt;this.hot.isRtl()&&(So-=Kt+ot),this.hot.isLtr()&&Pt+gr+Kt>Sr-Qr?So=Pt+oe.scrollX-Kt-1:this.hot.isRtl()&&So<-(gn.scrollWidth-gn.clientWidth)&&(So=Pt+oe.scrollX+ot+1),Un+Yt>oi-Is&&(_l-=Yt-jn+1),Jr(Vi,this).setPosition(So,_l),Jr(Vi,this).setReadOnlyState(this.getCommentMeta(s,l,Tm)),Jr(Vi,this).observeSize()}focusEditor(){Jr(Vi,this).focus()}updateCommentMeta(e,t,r){const s=this.hot.getCellMeta(e,t)[wc];let l;s?(l=(0,Y.deepClone)(s),(0,Y.deepExtend)(l,r)):l=r,this.hot.setCellMeta(e,t,wc,l)}getCommentMeta(e,t,r){const s=this.hot.getCellMeta(e,t);if(s[wc])return s[wc][r]}addToContextMenu(e){e.items.push({name:ii},Iy(this),Py(this),fC(this))}getEditorInputElement(){return Jr(Vi,this).getInputElement()}destroy(){var e,t;(e=Jr(Vi,this))===null||e===void 0||e.destroy(),(t=Jr(po,this))===null||t===void 0||t.destroy(),super.destroy()}}function pg(n){if(!(!this.hot.view||!this.hot.view._wt)&&!Jr(Om,this)&&!this.targetIsCommentTextArea(n)){const e=(0,N.closest)(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function Dy(n){n.stopPropagation()}function Hy(n){const{rootDocument:e}=this.hot;if(!(Jr(Om,this)||Jr(Vi,this).isFocused()||(0,N.hasClass)(n.target,"wtBorder")||Jr(Ih,this)===n.target||!Jr(Vi,this)))if($c(Ih,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));Jr(po,this).show(t)}else(0,N.isChildOf)(n.target,e)&&!this.targetIsCommentTextArea(n)&&Jr(po,this).hide()}function Ly(){$c(Om,this,!1)}function Fy(n,e){e[wc]&&e[wc][wf]&&(0,N.addClass)(n,e.commentedCellClassName)}function Wy(){$c(mg,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function By(){$c(mg,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Mm)}function ky(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[vC]:{width:n,height:e}})}function CC(n){Jr(Vi,this).isFocused()&&(0,ce.stopImmediatePropagation)(n)}function Im(){Jr(gg,this)||this.hide()}function xp(){const n=Jr(Vi,this).getEditorElement();(0,N.removeClass)(n,/ht-theme-.*/g),(0,N.addClass)(n,this.hot.getCurrentThemeName())}var Vy=f(82891);function Ap(n,e,t){return(e=Np(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Np(n){var e=Ph(n,"string");return typeof e=="symbol"?e:e+""}function Ph(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wC{constructor(e){Ap(this,"hot",void 0),Ap(this,"commands",{}),Ap(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const l=e.split(":"),g=l[0],S=l.length===2?l[1]:null;let M=this.commands[g];if(!M)throw new Error(`Menu command '${g}' not exists.`);if(S&&M.submenu&&(M=Pm(S,M.submenu.items)),M.disabled===!0||typeof M.disabled=="function"&&M.disabled.call(this.hot)===!0||(0,Y.hasOwnProperty)(M,"submenu"))return;const P=[];typeof M.callback=="function"&&P.push(M.callback),typeof this.commonCallback=="function"&&P.push(this.commonCallback),r.unshift(l.join(":")),(0,W.arrayEach)(P,j=>j.apply(this.hot,r))}}function Pm(n,e){let t;return(0,W.arrayEach)(e,r=>{const s=r.key?r.key.split(":"):null;if(Array.isArray(s)&&s[1]===n)return t=r,!1}),t}const jl="alignment";function vg(){return{key:jl,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${jl}:left`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{key:`${jl}:center`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{key:`${jl}:right`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{key:`${jl}:justify`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{name:ii},{key:`${jl}:top`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{key:`${jl}:middle`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1},{key:`${jl}:bottom`,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const n=this.getSelectedRange(),e=Oh(n,(s,l)=>this.getCellMeta(s,l).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Nu(n,t,r,(s,l)=>this.getCellMeta(s,l),(s,l,g,S)=>this.setCellMeta(s,l,g,S)),this.render()},disabled:!1}]}}}const xm="clear_column";function yC(){return{key:xm,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return n.forAll((t,r)=>{if(t<0||r<0)return!0;const{readOnly:s}=this.getCellMeta(t,r);return s?!0:(e=!0,!1)}),!e}}}const bd="col_left";function Am(){return{key:bd,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Sf="col_right";function SC(){return{key:Sf,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!!(!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Cg="make_read_only";function Dp(){return{key:Cg,checkable:!0,ariaChecked(){return Rm(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_READ_ONLY)},name(){let n=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_READ_ONLY);return Rm(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=dC(n)),n},callback(){const n=this.getSelectedRange(),e=Rm(n,(t,r)=>this.getCellMeta(t,r).readOnly);(0,W.arrayEach)(n,t=>{t.forAll((r,s)=>{r>=0&&s>=0&&this.setCellMeta(r,s,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const xh="redo";function wg(){return{key:xh,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_REDO)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var Xc=f(11043);const _f="remove_col";function jy(){return{key:_f,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",(0,Xc.X8)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const yc="remove_row";function _C(){return{key:yc,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",(0,Xc.I8)(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const yg="row_above";function Uy(){return{key:yg,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Nm="row_below";function zy(){return{key:Nm,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!!(!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Sg="no_items";function Ky(){return{key:Sg,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const Dm="undo";function Yy(){return{key:Dm,name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_UNDO)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const bC=[yg,Nm,bd,Sf,xm,yc,_f,Dm,xh,Cg,jl,ii,Sg],EC={[ii]:Oy,[Sg]:Ky,[yg]:Uy,[Nm]:zy,[bd]:Am,[Sf]:SC,[xm]:yC,[yc]:_C,[_f]:jy,[Dm]:Yy,[xh]:wg,[Cg]:Dp,[jl]:vg};function RC(){const n={};return(0,Y.objectEach)(EC,(e,t)=>{n[t]=e()}),n}function n_(n,e){bC.indexOf(n)===-1&&(EC[n]=e)}function Ah(n,e,t){return(e=bf(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bf(n){var e=Gy(n,"string");return typeof e=="symbol"?e:e+""}function Gy(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Hp{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ah(this,"hot",void 0),Ah(this,"predefinedItems",RC()),Ah(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,(0,Y.objectEach)(e,(r,s)=>{let l="";r.name===ii?(t[ii]=r,l=ii):isNaN(parseInt(s,10))?(r.key=r.key===void 0?s:r.key,t[s]=r,l=r.key):(t[r.key]=r,l=r.key),this.defaultOrderPattern.push(l)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return $y(e,this.defaultOrderPattern,this.predefinedItems)}}function $y(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let s=n;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),(0,Y.isObject)(s)?(0,Y.objectEach)(s,(l,g)=>{let S=t[typeof l=="string"?l:g];S||(S=l),(0,Y.isObject)(l)?(0,Y.extend)(S,l):typeof S=="string"&&(S={name:S}),S.key===void 0&&(S.key=g),r.push(S)}):(0,W.arrayEach)(s,(l,g)=>{let S=t[l];!S&&bC.indexOf(l)>=0||(S||(S={name:l,key:`${g}`}),(0,Y.isObject)(l)&&(0,Y.extend)(S,l),S.key===void 0&&(S.key=g),r.push(S))}),r}function Nh(n,e,t){return(e=TC(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TC(n){var e=Xy(n,"string");return typeof e=="symbol"?e:e+""}function Xy(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dh{constructor(e,t){Nh(this,"top",void 0),Nh(this,"topRelative",void 0),Nh(this,"left",void 0),Nh(this,"leftRelative",void 0),Nh(this,"scrollTop",void 0),Nh(this,"scrollLeft",void 0),Nh(this,"cellHeight",void 0),Nh(this,"cellWidth",void 0);const r=t.scrollY,s=t.scrollX;let l,g,S,M,P,j;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(l=parseInt(e.top,10),S=parseInt(e.left,10),P=e.height||0,j=e.width||0,g=l,M=S,l+=r,S+=s):this.type==="event"&&(l=parseInt(e.pageY,10),S=parseInt(e.pageX,10),P=e.target.clientHeight,j=e.target.clientWidth,g=l-r,M=S-s),this.top=l,this.topRelative=g,this.left=S,this.leftRelative=M,this.scrollTop=r,this.scrollLeft=s,this.cellHeight=P,this.cellWidth=j}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _g(n,e,t){Hm(n,e),e.set(n,t)}function Hm(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(n,e){return n.get(Lp(n,e))}function Lm(n,e,t){return n.set(Lp(n,e),t),t}function Lp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ja=new WeakMap,Ha=new WeakMap,dl=new WeakMap,Fp=new WeakMap,Ef=new WeakMap;class Zy{constructor(e){_g(this,Ja,void 0),_g(this,Ha,void 0),_g(this,dl,void 0),_g(this,Fp,!1),_g(this,Ef,{above:0,below:0,left:0,right:0}),Lm(Fp,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return zr(Ef,this)[e]=t,this}setElement(e){return Lm(Ja,this,e),this}setParentElement(e){return Lm(Ha,this,e),this}updatePosition(e){Lm(dl,this,new Dh(e,zr(Ja,this).ownerDocument.defaultView)),zr(Fp,this)?(zr(dl,this).fitsBelow(zr(Ja,this))?this.setPositionBelowCursor():zr(dl,this).fitsAbove(zr(Ja,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){zr(Ja,this).dir==="rtl"?zr(dl,this).fitsOnLeft(zr(Ja,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():zr(dl,this).fitsOnRight(zr(Ja,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=zr(Ef,this).above+zr(dl,this).top-zr(Ja,this).offsetHeight;if(zr(Ha,this)){const r=zr(Ha,this).ownerDocument.defaultView.getComputedStyle(zr(Ha,this).querySelector(".ht_master")),s=Number.parseInt(r.paddingTop,10),l=Number.parseInt(r.borderTop,10);e=zr(dl,this).top+zr(dl,this).cellHeight-zr(Ja,this).scrollHeight+s+l}zr(Ja,this).style.top=`${e}px`}setPositionBelowCursor(){let e=zr(Ef,this).below+zr(dl,this).top+1;if(zr(Ha,this)){const r=zr(Ha,this).ownerDocument.defaultView.getComputedStyle(zr(Ha,this).querySelector(".ht_master")),s=Number.parseInt(r.paddingTop,10),l=Number.parseInt(r.borderTop,10);e=zr(dl,this).top-s-l-1}zr(Ja,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=zr(dl,this).left;if(zr(Ha,this)){const t=zr(Ha,this).ownerDocument.defaultView,r=Number.parseInt(t.getComputedStyle(zr(Ha,this).querySelector(".htCore")).borderRightWidth,10);e+=zr(dl,this).cellWidth+r}else e+=zr(Ef,this).right;zr(Ja,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=zr(Ef,this).left+zr(dl,this).left-zr(Ja,this).offsetWidth;if(zr(Ha,this)){const t=zr(Ha,this).ownerDocument.defaultView,r=Number.parseInt(t.getComputedStyle(zr(Ha,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}zr(Ja,this).style.left=`${e}px`}}function Wp(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:r=()=>{},onClear:s=()=>{}}=n;const l=new Set;let g=(0,Rn.clamp)(e,-1,Ze()-1);function S(ot,Jt){const Pt=Ze()-1;return ot<0&&(ot=Pt),ot>Pt&&(ot=0),l.has(ot)?-1:(l.add(ot),r(ot,!1)===!1&&(ot=S(Jt===1?++ot:--ot,Jt)),ot)}function M(ot){ot>-1&&ot<Ze()&&r(ot,!0)!==!1&&(g=ot)}function P(){return g}function j(){Ze()>0&&(l.clear(),g=S(0,1))}function oe(){Ze()>0&&(l.clear(),g=S(Ze()-1,-1))}function ye(){Ze()>0&&(l.clear(),g=S(++g,1))}function xe(){Ze()>0&&(l.clear(),g=S(--g,-1))}function Ze(){return Math.max(t(),0)}function Ct(){l.clear(),g=e,s()}return{setCurrentPage:M,getCurrentPage:P,toFirstItem:j,toLastItem:oe,toNextItem:ye,toPreviousItem:xe,getSize:Ze,clear:Ct}}function Jy(n){return(0,W.arrayMap)(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Bp(n){return(0,Y.hasOwnProperty)(n,"submenu")}function kp(n){return new RegExp(ii,"i").test(n.name)}function bg(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function MC(n){return(0,Y.hasOwnProperty)(n,"disableSelection")}function Vp(n){return(0,N.hasClass)(n,"htSeparator")}function Qy(n){return(0,N.hasClass)(n,"htSubmenu")}function jp(n){return(0,N.hasClass)(n,"htDisabled")}function qy(n){return(0,N.hasClass)(n,"htSelectionDisabled")}function Up(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function OC(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function Fm(n,e){let t=n.slice(0);return t.reverse(),t=OC(t,e),t.reverse(),t}function e0(n){const e=[];return(0,W.arrayEach)(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function Rf(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ii,t=n.slice(0);return t=OC(t,e),t=Fm(t,e),t=e0(t),t}function IC(n){return n.checkable===!0}function PC(n){return Wp({size:()=>n.countRows(),onItemSelect(e,t){const r=n.getCell(e,0);if(!r||Vp(r)||jp(r)||qy(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function Wm(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,s)=>{const l=e.getSettings(),g=typeof l.tabMoves=="function"?l.tabMoves(r):l.tabMoves;s.includes("shift")?e.selection.transformStart(-g.row,-g.col):e.selection.transformStart(g.row,g.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=t.getSelectedLast();if(r){const s=n.openSubMenu(r[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const s=t.getSelectedLast();s&&(t.getSourceDataAtRow(s[0]).submenu?n.openSubMenu(s[0]).getNavigator().toFirstItem():(n.executeCommand(r),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const Eg="menu",xC=Eg;function zp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];r(Wm(n)),e.forEach(P=>{let{shortcuts:j,contextName:oe}=P;s(j,oe)});function r(P,j){S(j).addShortcuts(P,{group:Eg})}function s(P,j){const oe=S(j);P.forEach(ye=>{let{keys:xe}=ye;xe.forEach(Ze=>oe.removeShortcutsByKeys(Ze))}),t.push({shortcuts:P,contextName:j}),r(P,j)}function l(){return[...t]}function g(P){return P?`${xC}:${P}`:xC}function S(P){var j;const oe=n.hotMenu.getShortcutManager(),ye=g(P);return(j=oe.getContext(ye))!==null&&j!==void 0?j:oe.addContext(ye)}function M(P){n.hotMenu.getShortcutManager().setActiveContextName(g(P))}return{addCustomShortcuts:s,getCustomShortcuts:l,getContext:S,listen:M}}function t0(n){return(e,t,r,s,l,g)=>{const S=e.getSourceDataAtRow(r),M=n.rootDocument.createElement("div"),P=typeof g=="function"?g.call(n):g,j=typeof S.ariaLabel=="function"?S.ariaLabel.call(n):S.ariaLabel,oe=typeof S.ariaChecked=="function"?S.ariaChecked.call(n):S.ariaChecked;if((0,N.empty)(t),(0,N.addClass)(M,"htItemWrapper"),n.getSettings().ariaTags){const ye=!bg(S,n)&&!MC(S)&&!kp(S);(0,N.setAttribute)(t,[...IC(S)?[(0,ue.ys)(),(0,ue.QK)(j),(0,ue.Pn)(oe)]:[(0,ue.rQ)(),(0,ue.QK)(P)],...ye?[(0,ue.Qk)(-1)]:[],...bg(S,n)?[(0,ue.gw)()]:[],...Bp(S)?[(0,ue.JV)(!1)]:[]])}t.className="",t.appendChild(M),kp(S)?(0,N.addClass)(t,"htSeparator"):typeof S.renderer=="function"?((0,N.addClass)(t,"htCustomMenuRenderer"),t.appendChild(S.renderer(e,M,r,s,l,P))):(0,N.fastInnerHTML)(M,P),bg(S,n)?(0,N.addClass)(t,"htDisabled"):MC(S)?(0,N.addClass)(t,"htSelectionDisabled"):Bp(S)&&(0,N.addClass)(t,"htSubmenu")}}function Ul(n,e,t){n0(n,e),e.set(n,t)}function n0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(n,e,t){return(e=i(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i(n){var e=a(n,"string");return typeof e=="symbol"?e:e+""}function a(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function d(n,e,t){return n.set(p(n,e),t),t}function w(n,e){return n.get(p(n,e))}function p(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const T=215;var H=new WeakMap,z=new WeakMap,te=new WeakMap;class we{get tableBorderWidth(){return w(te,this)===void 0&&this.hotMenu&&d(te,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),w(te,this)}constructor(e,t){var r=this;u(this,"hot",void 0),u(this,"options",void 0),u(this,"eventManager",new fr.Z(this)),u(this,"container",void 0),u(this,"positioner",void 0),u(this,"hotMenu",null),u(this,"hotSubMenus",{}),u(this,"parentMenu",void 0),u(this,"menuItems",null),u(this,"origOutsideClickDeselects",null),Ul(this,H,void 0),Ul(this,z,void 0),Ul(this,te,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:T,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Zy(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return r.parentMenu.runLocalHooks("afterSelectionChange",...l)}),this.hot.addHook("afterSetTheme",(s,l)=>{if(!l){var g;(g=this.hotMenu)===null||g===void 0||g.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=(0,N.getParentWindow)(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return w(H,this)}getKeyboardShortcutsCtrl(){return w(z,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=(0,ve.debounce)(S=>this.openSubMenu(S),300),t=this.options.minWidth||T;let r=!1,s=(0,W.arrayFilter)(this.menuItems,S=>(S.key===Sg&&(r=!0),Up(S,this.hot)));if(s.length<1&&!r)s.push(RC()[Sg]);else if(s.length===0)return;s=Rf(s,ii);let l=!1;const g={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(S){return(0,I.isDefined)(S)&&S<t?t:S},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:t0(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(S,M)=>{w(H,this).setCurrentPage(M.row)},afterOnCellMouseOver:(S,M)=>{this.isAllSubMenusClosed()?e(M.row):this.openSubMenu(M.row)},afterOnCellContextMenu:S=>{S.preventDefault(),(0,en.isWindowsOS)()&&l&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(S,M,P,j,oe)=>{this.hotMenu.view.isMouseDown()&&(oe.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:S=>{this.hasSelectedItem()&&(l=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(S))},afterOnCellMouseUp:S=>{(!(0,en.isWindowsOS)()||!(0,ce.isRightClick)(S))&&l&&this.hasSelectedItem()&&((0,en.isMobileBrowser)()||(0,en.isIpadOS)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,g),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),d(H,this,PC(this.hotMenu)),d(z,this,zp(this)),w(z,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(w(H,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const r=this.parentMenu.hotMenu.getCell(t[0],0);(0,N.setAttribute)(r,[(0,ue.JV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!Qy(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),s=new we(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(r.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=s,this.hot.getSettings().ariaTags&&(0,N.setAttribute)(t,[(0,ue.JV)(!0)]),s}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&(0,N.setAttribute)(s,[(0,ue.JV)(!1)])}}closeAllSubMenus(){(0,W.arrayEach)(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),s=r?Jy(r):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){return e.isCommand===!1||kp(e)||bg(e,this.hot)||Bp(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,s=t.hider.style,l=t.holder.style,g=parseInt(s.width,10),S=(0,W.arrayReduce)(r,(M,P,j)=>{const ye=this.hotMenu.getCell(j,0)?(0,N.outerHeight)(this.hotMenu.getCell(j,0)):0;return M+(P.name===ii?1:ye)},0);e.isClassicTheme()?(l.width=`${g+3}px`,l.height=`${S+3}px`):(l.width=`${g}px`,l.height=`${S}px`),s.height=l.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,s;return r&&((0,ve.isFunction)(r)&&(r=r.call(this.hot),r===null||(0,I.isUndefined)(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,s=t.querySelector(`.${this.options.className}.${r}`)),s||(s=t.createElement("div"),(0,N.addClass)(s,`htMenu handsontable ${this.options.className}`),r&&(0,N.addClass)(s,r),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&(0,N.setAttribute)(this.hotMenu.rootElement,[(0,ue.tm)(),(0,ue.Qk)(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,N.isChildOf)(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,N.isChildOf)(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&(0,N.hasClass)(e.target,"htCore")&&(0,N.isChildOf)(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}(0,Y.mixin)(we,Pu.Z);function Ie(n,e){De(n,e),e.add(n)}function De(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(n,e,t){return(e=ut(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ut(n){var e=Bt(n,"string");return typeof e=="symbol"?e:e+""}function Bt(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Mn="contextMenu",_t=70,Ci=Mn;xn.P.getSingleton().register("afterContextMenuDefaultOptions"),xn.P.getSingleton().register("beforeContextMenuShow"),xn.P.getSingleton().register("afterContextMenuShow"),xn.P.getSingleton().register("afterContextMenuHide"),xn.P.getSingleton().register("afterContextMenuExecute");var mi=new WeakSet;class ss extends jr.vq{constructor(){super(...arguments),Ie(this,mi),Le(this,"commandExecutor",new wC(this.hot)),Le(this,"itemsFactory",null),Le(this,"menu",null)}static get PLUGIN_KEY(){return Mn}static get PLUGIN_PRIORITY(){return _t}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[yg,Nm,ii,bd,Sf,ii,yc,_f,ii,Dm,xh,ii,Cg,ii,jl]}isEnabled(){return!!this.hot.getSettings()[Mn]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Mn];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new we(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>zn(mi,this,Ti).call(this)),this.menu.addLocalHook("afterOpen",()=>zn(mi,this,Qa).call(this)),this.menu.addLocalHook("afterClose",()=>zn(mi,this,Kr).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",r=>zn(mi,this,si).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=dg(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:Ci})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ci)}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();const s=this.menu.tableBorderWidth>0;(0,Y.objectEach)(r,(l,g)=>{const S=["below","right"].includes(g)?l+1:l-1;this.menu.setOffset(g,s?l:S)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new Hp(this.hot,ss.DEFAULT_ITEMS);const e=this.hot.getSettings()[Mn],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),(0,W.arrayEach)(r,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function si(n){const e=this.hot.getSettings(),t=e.rowHeaders,r=e.colHeaders;function s(S){return S.nodeName==="TD"||S.parentNode.nodeName==="TD"}const l=n.target;if(this.close(),(0,N.hasClass)(l,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||r)&&!s(l)&&!((0,N.hasClass)(l,"current")&&(0,N.hasClass)(l,"wtBorder"))))return;const g=dg(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+g.top,left:n.clientX+g.left})}function Ti(){this.hot.runHooks("beforeContextMenuShow",this)}function Qa(){this.hot.runHooks("afterContextMenuShow",this)}function Kr(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ss.SEPARATOR={name:ii};var Du=f(4338);function Hh(n){return{key:"copy",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_COPY)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Rg(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?(0,Rn.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Lh(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?(0,Rn.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Tg(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?(0,Rn.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Mg(n){return{key:"cut",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_CUT)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class Og{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class fl{constructor(){this.clipboardData=new Og}preventDefault(){}composedPath(){return[]}}function qa(n,e){Bm(n,e),e.add(n)}function xo(n,e,t){Bm(n,e),e.set(n,t)}function Bm(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vo(n,e){return n.get(ne(n,e))}function U(n,e,t){return n.set(ne(n,e),t),t}function ne(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var me=new WeakMap,$e=new WeakMap,it=new WeakMap,vt=new WeakMap,qt=new WeakMap,sn=new WeakMap,nr=new WeakSet;class er{constructor(e){let{countRows:t,countColumns:r,rowsLimit:s,columnsLimit:l,countColumnHeaders:g}=e;qa(this,nr),xo(this,me,void 0),xo(this,$e,void 0),xo(this,it,void 0),xo(this,vt,void 0),xo(this,qt,void 0),xo(this,sn,void 0),U($e,this,t),U(it,this,r),U(vt,this,s),U(qt,this,l),U(sn,this,g)}setSelectedRange(e){U(me,this,e)}getCellsRange(){if(Vo($e,this).call(this)===0||Vo(it,this).call(this)===0)return null;const{row:e,col:t}=Vo(me,this).getTopStartCorner(),{row:r,col:s}=Vo(me,this).getBottomEndCorner(),l=ne(nr,this,pi).call(this,e,r),g=ne(nr,this,nn).call(this,t,s);return{isRangeTrimmed:r!==l||s!==g,startRow:e,startCol:t,endRow:l,endCol:g}}getMostBottomColumnHeadersRange(){if(Vo(it,this).call(this)===0||Vo(sn,this).call(this)===0)return null;const{col:e}=Vo(me,this).getTopStartCorner(),{col:t}=Vo(me,this).getBottomEndCorner(),r=ne(nr,this,nn).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Vo(it,this).call(this)===0||Vo(sn,this).call(this)===0)return null;const{col:e}=Vo(me,this).getTopStartCorner(),{col:t}=Vo(me,this).getBottomEndCorner(),r=ne(nr,this,nn).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-Vo(sn,this).call(this),startCol:e,endRow:-1,endCol:r}}}function nn(n,e){return Math.min(e,Math.max(n+Vo(qt,this).call(this)-1,n))}function pi(n,e){return Math.min(e,Math.max(n+Vo(vt,this).call(this)-1,n))}function $i(n){const e=[],t=[];return(0,W.arrayEach)(n,r=>{const s=Math.min(r.startRow,r.endRow),l=Math.max(r.startRow,r.endRow);(0,Rn.rangeEach)(s,l,M=>{e.indexOf(M)===-1&&e.push(M)});const g=Math.min(r.startCol,r.endCol),S=Math.max(r.startCol,r.endCol);(0,Rn.rangeEach)(g,S,M=>{t.indexOf(M)===-1&&t.push(M)})}),{rows:e,columns:t}}var Xi=f(67910);function La(n,e){vo(n,e),e.add(n)}function Js(n,e,t){vo(n,e),e.set(n,t)}function vo(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gl(n,e,t){return(e=no(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function no(n){var e=oa(n,"string");return typeof e=="symbol"?e:e+""}function oa(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Bs(n,e){return n.get(jo(n,e))}function pa(n,e,t){return n.set(jo(n,e),t),t}function jo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("afterCopyLimit"),xn.P.getSingleton().register("modifyCopyableRange"),xn.P.getSingleton().register("beforeCut"),xn.P.getSingleton().register("afterCut"),xn.P.getSingleton().register("beforePaste"),xn.P.getSingleton().register("afterPaste"),xn.P.getSingleton().register("beforeCopy"),xn.P.getSingleton().register("afterCopy");const ou="copyPaste",Zc=80,Jc=["fragmentSelection"],Tf=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Ed=new WeakMap,Ig=new WeakMap,km=new WeakMap,Fh=new WeakMap,au=new WeakMap,Wh=new WeakMap,Hu=new WeakMap,Bh=new WeakMap,ro=new WeakSet;class Sc extends jr.vq{constructor(){super(...arguments),La(this,ro),gl(this,"columnsLimit",1/0),gl(this,"rowsLimit",1/0),gl(this,"pasteMode","overwrite"),gl(this,"uiContainer",this.hot.rootDocument.body),Js(this,Ed,!1),Js(this,Ig,!1),Js(this,km,!1),Js(this,Fh,"cells-only"),Js(this,au,!1),Js(this,Wh,!1),Js(this,Hu,new er({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Js(this,Bh,!1),gl(this,"copyableRanges",[])}static get PLUGIN_KEY(){return ou}static get SETTING_KEYS(){return[ou,...Jc]}static get PLUGIN_PRIORITY(){return Zc}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[ou]}enablePlugin(){var e,t,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),pa(Ed,this,this.getSetting("copyColumnHeaders")),pa(Ig,this,this.getSetting("copyColumnGroupHeaders")),pa(km,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(t=this.getSetting("uiContainer"))!==null&&t!==void 0?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>jo(ro,this,zT).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return jo(ro,r,KT).call(r,...l)}),this.addHook("afterSelectionEnd",()=>jo(ro,this,YT).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),(0,en.isSafari)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return jo(ro,r,GT).call(r,...l)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return jo(ro,r,$T).call(r,...l)}),this.addHook("afterSelection",()=>jo(ro,this,XT).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";pa(Fh,this,e),pa(au,this,!0),jo(ro,this,Kp).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){pa(Wh,this,!0),jo(ro,this,Kp).call(this,"cut")}getRangedCopyableData(e){return(0,Du.P)(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:s}=$i(e);return(0,W.arrayEach)(r,l=>{const g=[];(0,W.arrayEach)(s,S=>{l<0?g.push(this.hot.getColHeader(S,l)):g.push(this.hot.getCopyableData(l,S))}),t.push(g)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new fl;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Bs(Hu,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);Bs(Fh,this)==="column-headers-only"?t.set("headers",Bs(Hu,this).getMostBottomColumnHeadersRange()):(Bs(Fh,this)==="with-column-headers"?t.set("headers",Bs(Hu,this).getMostBottomColumnHeadersRange()):Bs(Fh,this)==="with-column-group-headers"&&t.set("headers",Bs(Hu,this).getAllColumnHeadersRange()),t.set("cells",Bs(Hu,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:l,startCol:g,endRow:S,endCol:M}=s;return{startRow:l,startCol:g,endRow:S,endCol:M}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:s,startCol:l,endRow:g,endCol:S}=r;this.hot.runHooks("afterCopyLimit",g-s+1,S-l+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,s=e[0].length,l=[],{row:g,col:S}=t.getTopStartCorner(),{row:M,col:P}=t.getBottomEndCorner();let j=g,oe=S,ye=g,xe=S;for(;l.length<r||j<=M;){const{skipRowOnPaste:Ze,visualRow:Ct}=this.hot.getCellMeta(j,S);if(j=Ct+1,Ze===!0)continue;ye=Ct,oe=S;const ot=[],Jt=l.length%r;for(;ot.length<s||oe<=P;){const{skipColumnOnPaste:Pt,visualCol:Un}=this.hot.getCellMeta(g,oe);if(oe=Un+1,Pt===!0)continue;xe=Un;const gr=ot.length%s;ot.push(e[Jt][gr])}l.push(ot)}return pa(Bh,this,!0),this.hot.populateFromArray(g,S,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[g,S,ye,xe]}onCopy(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),s=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Bs(au,this)||this.isEditorOpened()||(0,N.isHTMLElement)(t)&&(s&&t!==r||!s&&t!==this.hot.rootDocument.body&&!(0,N.isInternalElement)(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pa(au,this,!1);const l=this.getRangedData(this.copyableRanges),g=jo(ro,this,AC).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",l,this.copyableRanges,g)){const M=(0,Du.P)(l);if(e&&e.clipboardData){const P=(0,Xi._dataToHTML)(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",M),e.clipboardData.setData("text/html",[Tf,P].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",M);this.hot.runHooks("afterCopy",l,this.copyableRanges,g)}pa(Fh,this,"cells-only")}onCut(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),s=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Bs(Wh,this)||this.isEditorOpened()||(0,N.isHTMLElement)(t)&&(s&&t!==r||!s&&t!==this.hot.rootDocument.body&&!(0,N.isInternalElement)(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pa(Wh,this,!1);const l=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",l,this.copyableRanges)){const S=(0,Du.P)(l);if(e&&e.clipboardData){const M=(0,Xi._dataToHTML)(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",S),e.clipboardData.setData("text/html",[Tf,M].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",S);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",l,this.copyableRanges)}}onPaste(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),s=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||(0,N.isHTMLElement)(t)&&(s&&t!==r||!s&&t!==this.hot.rootDocument.body&&!(0,N.isInternalElement)(t,this.hot.rootElement)))return;e.preventDefault();let l;if(e&&typeof e.clipboardData!="undefined"){const j=(0,V.sanitize)(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});j&&/(<table)|(<TABLE)/g.test(j)?l=(0,Xi.htmlToGridSettings)(j,this.hot.rootDocument).data:l=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&typeof this.hot.rootWindow.clipboardData!="undefined"&&(l=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof l=="string"&&(l=(0,Du.Q)(l)),l===void 0||l&&l.length===0||this.hot.runHooks("beforePaste",l,this.copyableRanges)===!1)return;const[g,S,M,P]=this.populateValues(l);this.hot.selectCell(g,S,Math.min(this.hot.countRows()-1,M),Math.min(this.hot.countCols()-1,P)),this.hot.runHooks("afterPaste",l,this.copyableRanges)}destroy(){super.destroy()}}function Kp(n){if((0,en.isSafari)()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,s=this.hot.getCell(t,r,!0);s&&(0,N.runWithSelectedContendEditableElement)(s,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function AC(n){const{rows:e}=$i(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function UT(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r&&(0,N.makeElementContentEditableAndSelectItsContent)(r)}}}function r_(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r!=null&&r.hasAttribute("contenteditable")&&(0,N.removeContentEditableFromElementAndDeselect)(r)}}}function zT(n){n.items.push({name:"---------"},Hh(this)),Bs(Ed,this)&&n.items.push(Tg(this)),Bs(Ig,this)&&n.items.push(Lh(this)),Bs(km,this)&&n.items.push(Rg(this)),n.items.push(Mg(this))}function KT(n,e,t,r,s){Bs(Bh,this)&&(s.value=!0),pa(Bh,this,!1)}function YT(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function GT(){jo(ro,this,r_).call(this)}function $T(){jo(ro,this,UT).call(this)}function XT(){jo(ro,this,r_).call(this)}function i_(n,e){return`border_row${n}col${e}`}function Yp(){return{width:1,color:"#000"}}function ji(){return{hide:!0}}function NC(){return{width:1,color:"#000",cornerVisible:!1}}function Qc(n){if((0,I.isDefined)(n.start)||(0,I.isDefined)(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if((0,I.isDefined)(n.end)||(0,I.isDefined)(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Gp(n){return(0,I.isDefined)(n.start)&&(n.left=n.start),(0,I.isDefined)(n.end)&&(n.right=n.end),n}function r0(n,e){return{id:i_(n,e),border:NC(),row:n,col:e,top:ji(),bottom:ji(),start:ji(),end:ji()}}function s_(n,e){return(0,Y.hasOwnProperty)(e,"border")&&e.border&&(n.border=e.border),(0,Y.hasOwnProperty)(e,"top")&&(0,I.isDefined)(e.top)&&(e.top?((0,Y.isObject)(e.top)||(e.top=Yp()),n.top=e.top):(e.top=ji(),n.top=e.top)),(0,Y.hasOwnProperty)(e,"bottom")&&(0,I.isDefined)(e.bottom)&&(e.bottom?((0,Y.isObject)(e.bottom)||(e.bottom=Yp()),n.bottom=e.bottom):(e.bottom=ji(),n.bottom=e.bottom)),(0,Y.hasOwnProperty)(e,"start")&&(0,I.isDefined)(e.start)&&(e.start?((0,Y.isObject)(e.start)||(e.start=Yp()),n.start=e.start):(e.start=ji(),n.start=e.start)),(0,Y.hasOwnProperty)(e,"end")&&(0,I.isDefined)(e.end)&&(e.end?((0,Y.isObject)(e.end)||(e.end=Yp()),n.end=e.end):(e.end=ji(),n.end=e.end)),n}function Rd(n,e){let t=!1;return(0,W.arrayEach)(n.getSelectedRange(),r=>{r.forAll((s,l)=>{if(s<0||l<0)return;const g=n.getCellMeta(s,l).borders;if(g)if(e){if(!(0,Y.hasOwnProperty)(g[e],"hide")||g[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function DC(n){return`<span class="selected">\u2713</span>${n}`}function ZT(n){return n.some(e=>(0,I.isDefined)(e.left)||(0,I.isDefined)(e.right))}function o_(n){return n.some(e=>(0,I.isDefined)(e.start)||(0,I.isDefined)(e.end))}const JT=new Map([["left","start"],["right","end"]]);function QT(n){var e;return(e=JT.get(n))!==null&&e!==void 0?e:n}function qT(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_BORDERS_TOP);return Rd(this,"top")&&(e=DC(e)),e},callback(e,t){const r=Rd(this,"top");n.prepareBorder(t,"top",r)}}}function a_(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return Rd(this,e)&&(t=DC(t)),t},callback(t,r){const s=Rd(this,e);n.prepareBorder(r,e,s)}}}function eM(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return Rd(this,"bottom")&&(e=DC(e)),e},callback(e,t){const r=Rd(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function tM(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_BORDERS_LEFT);return Rd(this,e)&&(t=DC(t)),t},callback(t,r){const s=Rd(this,e);n.prepareBorder(r,e,s)}}}function l_(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!Rd(this)}}}function nM(n,e){i0(n,e),e.add(n)}function i0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rM(n,e,t){return(e=u_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u_(n){var e=iM(n,"string");return typeof e=="symbol"?e:e+""}function iM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function s0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const HC="customBorders",sM=90;var o0=new WeakSet;class oM extends jr.vq{constructor(){super(...arguments),nM(this,o0),rM(this,"savedBorders",[])}static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return sM}isEnabled(){return!!this.hot.getSettings()[HC]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>s0(o0,this,aM).call(this,e)),this.addHook("init",()=>s0(o0,this,LC).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),s=Qc(t));const l=(0,Xc.AV)(e),g=(0,Xc.S5)(l,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,W.arrayEach)(e,S=>{g(S).forAll((M,P)=>{(0,W.arrayEach)(r,j=>{this.prepareBorderFromCustomAdded(M,P,s,QT(j))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=(0,Xc.AV)(e),r=(0,Xc.S5)(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return(0,W.arrayEach)(e,l=>{r(l).forAll((g,S)=>{(0,W.arrayEach)(this.savedBorders,M=>{M.row===g&&M.col===S&&s.push(Gp(M))})})}),s}clearBorders(e){e?this.setBorders(e):((0,W.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,r,s){const l=this.hot.countRows(),g=this.hot.countCols();if(e>=l||t>=g)return;let S=r0(e,t);r&&(S=s_(S,r),(0,W.arrayEach)(this.hot.selection.highlight.customSelections,M=>{if(S.id===M.settings.id)return Object.assign(M.settings,r),S.id=M.settings.id,S.top=M.settings.top,S.bottom=M.settings.bottom,S.start=M.settings.start,S.end=M.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Gp(S)),this.insertBorderIntoSettings(S,s)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);(0,Rn.rangeEach)(e.from.row,r,l=>{(0,Rn.rangeEach)(e.from.col,s,g=>{const S=r0(l,g);let M=0;l===e.from.row&&(0,Y.hasOwnProperty)(t,"top")&&(M+=1,S.top=t.top),l===e.to.row&&(0,Y.hasOwnProperty)(t,"bottom")&&(M+=1,S.bottom=t.bottom),g===e.from.col&&(0,Y.hasOwnProperty)(t,"start")&&(M+=1,S.start=t.start),g===e.to.col&&(0,Y.hasOwnProperty)(t,"end")&&(M+=1,S.end=t.end),M>0&&(this.hot.setCellMeta(l,g,"borders",Gp(S)),this.insertBorderIntoSettings(S))})})}removeAllBorders(e,t){const r=i_(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,s){let l=this.hot.getCellMeta(e,t).borders;!l||l.border===void 0?l=r0(e,t):l=Qc(l),s?(l[r]=ji(),this.countHide(l)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(l,r,s)||this.insertBorderIntoSettings(l),this.hot.setCellMeta(e,t,"borders",Gp(l)))):(l[r]=Yp(),this.checkCustomSelectionsFromContextMenu(l,r,s)||this.insertBorderIntoSettings(l),this.hot.setCellMeta(e,t,"borders",Gp(l)))}prepareBorder(e,t,r){(0,W.arrayEach)(e,s=>{let{start:l,end:g}=s;if(l.row===g.row&&l.col===g.col)t==="noBorders"?this.removeAllBorders(l.row,l.col):this.setBorder(l.row,l.col,t,r);else switch(t){case"noBorders":(0,Rn.rangeEach)(l.col,g.col,S=>{(0,Rn.rangeEach)(l.row,g.row,M=>{this.removeAllBorders(M,S)})});break;case"top":(0,Rn.rangeEach)(l.col,g.col,S=>{this.setBorder(l.row,S,t,r)});break;case"bottom":(0,Rn.rangeEach)(l.col,g.col,S=>{this.setBorder(g.row,S,t,r)});break;case"start":(0,Rn.rangeEach)(l.row,g.row,S=>{this.setBorder(S,l.col,t,r)});break;case"end":(0,Rn.rangeEach)(l.row,g.row,S=>{this.setBorder(S,g.col,t,r)});break;default:break}})}createCustomBorders(e){(0,W.arrayEach)(e,t=>{const r=Qc(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:s,end:l}=e,g=[t,r,s,l];return(0,W.arrayReduce)(g,(S,M)=>{let P=S;return M&&M.hide&&(P+=1),P},0)}clearBordersFromSelectionSettings(e){const t=(0,W.arrayMap)(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){(0,W.arrayEach)(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){(0,W.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=(0,W.arrayMap)(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):(0,W.arrayEach)(this.savedBorders,(s,l)=>{if(e.id===s.id)return this.savedBorders[l]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let s=!1;return(0,W.arrayEach)(this.hot.selection.highlight.customSelections,l=>{if(e.id===l.settings.id){const g=this.hot.view._wt.selectionManager.getBorderInstances(l);return(0,W.arrayEach)(g,S=>{S.toggleHiddenClass(t,r)}),s=!0,!1}}),s}checkCustomSelections(e,t,r){const s=this.countHide(e);let l=!1;return s===4?(this.removeAllBorders(e.row,e.col),l=!0):(0,W.arrayEach)(this.hot.selection.highlight.customSelections,g=>{if(e.id===g.settings.id){if(g.visualCellRange=t,g.commit(),r){const S=this.hot.view._wt.selectionManager.getBorderInstances(g);(0,W.arrayEach)(S,M=>{M.changeBorderStyle(r,e)})}return l=!0,!1}}),l}changeBorderSettings(){const e=this.hot.getSettings()[HC];if(Array.isArray(e)){const t=(0,Y.deepClone)(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=ZT(e),r=o_(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function aM(n){this.hot.getSettings()[HC]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_BORDERS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[qT(this),a_(this),eM(this),tM(this),l_(this)]}})}function LC(){this.changeBorderSettings()}function FC(n,e){lM(n,e),e.add(n)}function lM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $p(n,e,t){return(e=uM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uM(n){var e=Xp(n,"string");return typeof e=="symbol"?e:e+""}function Xp(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function c_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const h_="dragToScroll",cM=100;var WC=new WeakSet;class hM extends jr.vq{constructor(){super(...arguments),FC(this,WC),$p(this,"boundaries",null),$p(this,"callback",null),$p(this,"listening",!1)}static get PLUGIN_KEY(){return h_}static get PLUGIN_PRIORITY(){return cM}isEnabled(){return!!this.hot.getSettings()[h_]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>c_(WC,this,BC).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>c_(WC,this,BC).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=(0,N.getParentWindow)(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function BC(n){if((0,ce.isRightClick)(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,r)=>{var s,l;const g=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,S=(l=e.scrollTop)!==null&&l!==void 0?l:e.scrollY;e.scroll(g+Math.sign(t)*50,S+Math.sign(r)*20)}),this.listen()}function dM(n,e){d_(n,e),e.add(n)}function kC(n,e,t){d_(n,e),e.set(n,t)}function d_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a0(n,e,t){return(e=fM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fM(n){var e=gM(n,"string");return typeof e=="symbol"?e:e+""}function gM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mM(n,e){return n.get(_c(n,e))}function f_(n,e,t){return n.set(_c(n,e),t),t}function _c(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("afterDropdownMenuDefaultOptions"),xn.P.getSingleton().register("beforeDropdownMenuShow"),xn.P.getSingleton().register("afterDropdownMenuShow"),xn.P.getSingleton().register("afterDropdownMenuHide"),xn.P.getSingleton().register("afterDropdownMenuExecute");const VC="dropdownMenu",pM=230,Zp="changeType",l0=VC;var jC=new WeakMap,qc=new WeakSet;class Jp extends jr.vq{static get PLUGIN_KEY(){return VC}static get PLUGIN_PRIORITY(){return pM}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[bd,Sf,ii,_f,ii,xm,ii,Cg,ii,jl]}constructor(e){super(e),dM(this,qc),a0(this,"commandExecutor",new wC(this.hot)),a0(this,"itemsFactory",null),a0(this,"menu",null),kC(this,jC,!1),this.hot.addHook("afterGetColHeader",(t,r)=>_c(qc,this,CM).call(this,t,r))}isEnabled(){return this.hot.getSettings()[VC]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new Hp(this.hot,Jp.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return _c(qc,e,EM).call(e,...l)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,l=new Array(s),g=0;g<s;g++)l[g]=arguments[g];return _c(qc,e,bM).call(e,...l)});const t=this.hot.getSettings()[VC],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new we(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>_c(qc,this,wM).call(this)),this.menu.addLocalHook("afterOpen",()=>_c(qc,this,yM).call(this)),this.menu.addLocalHook("afterSubmenuOpen",l=>_c(qc,this,SM).call(this,l)),this.menu.addLocalHook("afterClose",()=>_c(qc,this,_M).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var l=arguments.length,g=new Array(l),S=0;S<l;S++)g[S]=arguments[S];return e.executeCommand.call(e,...g)}),(0,W.arrayEach)(s,l=>this.commandExecutor.registerCommand(l.key,l))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),l=dg(this.menu.container,this.hot.rootDocument),g=this.hot.getCell(-1,s.col,!0).querySelector(`.${Zp}`),S=g.getBoundingClientRect();this.open({left:S.left+l.left,top:S.top+g.offsetHeight+l.top},{left:S.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var r;const s=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:l0},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var r;const s=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:l0}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(l0)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_c(qc,this,vM).call(this,e))}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),(0,Y.objectEach)(r,(s,l)=>{this.menu.setOffset(l,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function UC(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function vM(n){if((0,N.hasClass)(n.target,Zp)){const e=dg(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),f_(jC,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function CM(n,e){const t=e.parentNode;if(!t)return;const r=t.parentNode.childNodes,s=Array.prototype.indexOf.call(r,t);if(n<0||s!==r.length-1)return;const l=e.querySelector(`.${Zp}`);if(this.enabled&&l)return;if(!this.enabled){l&&l.parentNode.removeChild(l);return}const g=this.hot.rootDocument.createElement("button");g.className=Zp,g.type="button",g.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,N.setAttribute)(g,[(0,ue.cV)(),(0,ue.QK)(" ")]),(0,N.setAttribute)(e,[(0,ue.fv)("menu")])),g.onclick=function(){return!1},e.firstChild.insertBefore(g,e.firstChild.firstChild)}function wM(){this.hot.runHooks("beforeDropdownMenuShow",this)}function yM(){this.hot.runHooks("afterDropdownMenuShow",this),_c(qc,this,UC).call(this,this.menu)}function SM(n){_c(qc,this,UC).call(this,n)}function _M(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function bM(n){return mM(jC,this)?null:n}function EM(n){(0,N.hasClass)(n.target,Zp)&&f_(jC,this,!0)}Jp.SEPARATOR={name:ii};function u0(n,e,t){return(e=g_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g_(n){var e=zC(n,"string");return typeof e=="symbol"?e:e+""}function zC(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RM{constructor(e){u0(this,"hot",void 0),u0(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:s}=this._getDataRange(),l=this.options,g=[];return(0,Rn.rangeEach)(e,r,S=>{const M=[];!l.exportHiddenRows&&this._isHiddenRow(S)||((0,Rn.rangeEach)(t,s,P=>{!l.exportHiddenColumns&&this._isHiddenColumn(P)||M.push(this.hot.getDataAtCell(S,P))}),g.push(M))}),g}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),s=this.hot.getRowHeader();(0,Rn.rangeEach)(t,r,l=>{!this.options.exportHiddenRows&&this._isHiddenRow(l)||e.push(s[l])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),s=this.hot.getColHeader();(0,Rn.rangeEach)(t,r,l=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(l)||e.push(s[l])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,s=0,l=t,g=e]=this.options.range;return r=Math.max(r,0),s=Math.max(s,0),l=Math.min(l,t),g=Math.min(g,e),{startRow:r,startCol:s,endRow:l,endCol:g}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}var m_=RM;function p_(n,e,t){return(e=TM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TM(n){var e=v_(n,"string");return typeof e=="symbol"?e:e+""}function v_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vm{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){p_(this,"dataProvider",void 0),p_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=(0,Y.clone)(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=(0,Y.extend)((0,Y.clone)(Vm.DEFAULT_OPTIONS),t),t=(0,Y.extend)(t,e),t.filename=(0,V.substitute)(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}var MM=Vm;function OM(n,e){IM(n,e),e.add(n)}function IM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const C_="\r",w_='"',PM=`
`,c0="=",xM="+",y_="-",AM="@",S_="	";var h0=new WeakSet;class NM extends MM{constructor(){super(...arguments),OM(this,h0)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const s=r.length>0,l=this.dataProvider.getRowHeaders(),g=l.length>0;let S=e.bom?"\uFEFF":"";return s&&(r=(0,W.arrayMap)(r,M=>this._escapeCell(M,{force:!0,sanitizeValue:e.sanitizeValues})),g&&(S+=e.columnDelimiter),S+=r.join(e.columnDelimiter),S+=e.rowDelimiter),(0,W.arrayEach)(t,(M,P)=>{P>0&&(S+=e.rowDelimiter),g&&(S+=this._escapeCell(l[P],{sanitizeValue:e.sanitizeValues}),S+=e.columnDelimiter);const j=M.map(oe=>this._escapeCell(oe,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);S+=j}),S}_escapeCell(e){let{force:t=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=(0,I.stringify)(e);return s===""||(r&&(t=!0),r instanceof RegExp?s=KC(h0,this,__).call(this,s,r):typeof r=="function"?s=r(s):r&&(s=KC(h0,this,DM).call(this,s)),(t||s.indexOf(C_)>=0||s.indexOf(w_)>=0||s.indexOf(PM)>=0||s.indexOf(this.options.columnDelimiter)>=0)&&(s=s.replace(new RegExp('"',"g"),'""'),s=`"${s}"`)),s}}function DM(n){return n.startsWith(c0)||n.startsWith(xM)||n.startsWith(y_)||n.startsWith(AM)||n.startsWith(S_)||n.startsWith(C_)?`'${n}`:n}function __(n,e){return e.test(n)?`'${n}`:n}var HM=NM;const YC="csv",XA="excel",ZA="pdf",d0={[YC]:HM};function b_(n,e,t){return typeof d0[n]=="function"?new d0[n](e,t):null}const LM="exportFile",f0=240;class FM extends jr.vq{static get PLUGIN_KEY(){return LM}static get PLUGIN_PRIORITY(){return f0}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:s}=this.hot,l=this._createTypeFormatter(e,t),g=this._createBlob(l),S=s.URL||s.webkitURL,M=r.createElement("a"),P=`${l.options.filename}.${l.options.fileExtension}`;if(M.download!==void 0){const j=S.createObjectURL(g);M.style.display="none",M.setAttribute("href",j),M.setAttribute("download",P),r.body.appendChild(M),M.dispatchEvent(new MouseEvent("click")),r.body.removeChild(M),setTimeout(()=>{S.revokeObjectURL(j)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(g,P)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!d0[e])throw new Error(`Export format type "${e}" is not supported.`);return b_(e,new m_(this.hot),t)}_createBlob(e){let t=null;return typeof Blob!="undefined"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}var JA=f(25799);function jm(n,e,t){return(e=g0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g0(n){var e=WM(n,"string");return typeof e=="symbol"?e:e+""}function WM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Nr{constructor(e,t){let{id:r,stateless:s=!0}=t;jm(this,"hot",void 0),jm(this,"id",void 0),jm(this,"elements",[]),jm(this,"hidden",!1),jm(this,"stateId",""),jm(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new hr.A)}getElements(){return this.elements}reset(){(0,W.arrayEach)(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,W.arrayEach)(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,Y.mixin)(Nr,Pu.Z);const Qp={};function Mf(n,e){if(!Qp[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=Qp[n];let s=e;return r.inputValuesDecorator&&(s=r.inputValuesDecorator(s)),function(l){return t.apply(l.meta.instance,[].concat([l],[s]))}}function Of(n){if(!Qp[n])throw Error(`Filter condition "${n}" does not exist.`);return Qp[n].descriptor}function Uo(n,e,t){t.key=n,Qp[n]={condition:e,descriptor:t}}const va="none";function BM(){return!0}Uo(va,BM,{name:tn.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const qp="empty";function kM(n){return(0,I.isEmpty)(n.value)}Uo(qp,kM,{name:tn.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const GC="not_empty";function E_(n,e){return!Mf(qp,e)(n)}Uo(GC,E_,{name:tn.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const ev="eq";function R_(n,e){let[t]=e;return(0,I.stringify)(n.value).toLocaleLowerCase(n.meta.locale)===(0,I.stringify)(t)}Uo(ev,R_,{name:tn.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const $C="neq";function VM(n,e){return!Mf(ev,e)(n)}Uo($C,VM,{name:tn.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const T_="gt";function M_(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}Uo(T_,M_,{name:tn.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const O_="gte";function m0(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}Uo(O_,m0,{name:tn.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const I_="lt";function kh(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}Uo(I_,kh,{name:tn.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const P_="lte";function x_(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}Uo(P_,x_,{name:tn.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const p0="date_after";function If(n,e){let[t]=e;const r=Ae()(n.value,n.meta.dateFormat),s=Ae()(t,n.meta.dateFormat);return!r.isValid()||!s.isValid()?!1:r.diff(s)>=0}Uo(p0,If,{name:tn.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});const v0="date_before";function jM(n,e){let[t]=e;const r=Ae()(n.value,n.meta.dateFormat),s=Ae()(t,n.meta.dateFormat);return!r.isValid()||!s.isValid()?!1:r.diff(s)<=0}Uo(v0,jM,{name:tn.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const XC="between";function ZC(n,e){let[t,r]=e,s=t,l=r;if(n.meta.type==="numeric"){const g=parseFloat(s,10),S=parseFloat(l,10);s=Math.min(g,S),l=Math.max(g,S)}else if(n.meta.type==="date"){const g=Mf(v0,[l]),S=Mf(p0,[s]);return g(n)&&S(n)}return n.value>=s&&n.value<=l}Uo(XC,ZC,{name:tn.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const A_="not_between";function UM(n,e){return!Mf(XC,e)(n)}Uo(A_,UM,{name:tn.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const N_="begins_with";function D_(n,e){let[t]=e;return(0,I.stringify)(n.value).toLocaleLowerCase(n.meta.locale).startsWith((0,I.stringify)(t))}Uo(N_,D_,{name:tn.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const H_="ends_with";function L_(n,e){let[t]=e;return(0,I.stringify)(n.value).toLocaleLowerCase(n.meta.locale).endsWith((0,I.stringify)(t))}Uo(H_,L_,{name:tn.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const C0="contains";function w0(n,e){let[t]=e;return(0,I.stringify)(n.value).toLocaleLowerCase(n.meta.locale).indexOf((0,I.stringify)(t))>=0}Uo(C0,w0,{name:tn.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const y0="not_contains";function zM(n,e){return!Mf(C0,e)(n)}Uo(y0,zM,{name:tn.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});const JC="date_tomorrow";function F_(n){const e=Ae()(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Ae()().subtract(-1,"days").startOf("day"),"d"):!1}Uo(JC,F_,{name:tn.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});const W_="date_today";function tv(n){const e=Ae()(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Ae()().startOf("day"),"d"):!1}Uo(W_,tv,{name:tn.FILTERS_CONDITIONS_TODAY,inputsCount:0});const B_="date_yesterday";function KM(n){const e=Ae()(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Ae()().subtract(1,"days").startOf("day"),"d"):!1}Uo(B_,KM,{name:tn.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});const YM="numeric",k_="text",S0="date",V_={[YM]:[va,ii,qp,GC,ii,ev,$C,ii,T_,O_,I_,P_,XC,A_],[k_]:[va,ii,qp,GC,ii,ev,$C,ii,N_,H_,ii,C0,y0],[S0]:[va,ii,qp,GC,ii,ev,$C,ii,v0,p0,XC,ii,JC,W_,B_]};function j_(n){const e=[];let t=n;return V_[t]||(t=k_),(0,W.arrayEach)(V_[t],r=>{let s;r===ii?s={name:ii}:s=(0,Y.clone)(Of(r)),e.push(s)}),e}function Um(n,e,t){return(e=GM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GM(n){var e=$M(n,"string");return typeof e=="symbol"?e:e+""}function $M(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const QC="built",_0="building",qC=["click","input","keydown","keypress","keyup","focus","blur","change"];class Lu{static get DEFAULTS(){return(0,Y.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){Um(this,"hot",void 0),Um(this,"eventManager",new fr.Z(this)),Um(this,"options",void 0),Um(this,"_element",void 0),Um(this,"buildState",void 0),this.hot=e,this.options=(0,Y.extend)(Lu.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===_0?this._element:this.buildState===QC?(this.update(),this._element):(this.buildState=_0,this.build(),this.buildState=QC,this._element)}isBuilt(){return this.buildState===QC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(tn.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,s=>this.runLocalHooks(r,s,this))};if(this.buildState||(this.buildState=_0),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,N.addClass)(this._element,this.options.className),this.options.children.length)(0,W.arrayEach)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),(0,Y.objectEach)(this.options,(r,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(r))}),this._element.appendChild(t),(0,W.arrayEach)(qC,r=>e(t,r))}else(0,W.arrayEach)(qC,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}(0,Y.mixin)(Lu,Pu.Z);function Ao(n,e){ew(n,e),e.add(n)}function XM(n,e,t){ew(n,e),e.set(n,t)}function ew(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tw(n,e){return n.get(E0(n,e))}function b0(n,e,t){return n.set(E0(n,e),t),t}function E0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zm=new WeakMap,R0=new WeakSet;class Vh extends Lu{static get DEFAULTS(){return(0,Y.clone)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,(0,Y.extend)(Vh.DEFAULTS,t)),Ao(this,R0),XM(this,zm,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>E0(R0,this,U_).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");b0(zm,this,this._element.firstChild),(0,N.addClass)(this._element,"htUIInput"),(0,N.addClass)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(tw(zm,this).type=this.options.type,tw(zm,this).placeholder=this.translateIfPossible(this.options.placeholder),tw(zm,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&tw(zm,this).focus()}}function U_(n){this.options.value=n.target.value}function ZM(n,e){nw(n,e),e.add(n)}function nv(n,e,t){nw(n,e),e.set(n,t)}function nw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Km(n,e,t){return n.set(rv(n,e),t),t}function io(n,e){return n.get(rv(n,e))}function rv(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ca=new WeakMap,iv=new WeakMap,rw=new WeakMap,iw=new WeakMap,sw=new WeakMap,sv=new WeakSet;class ov extends Lu{static get DEFAULTS(){return(0,Y.clone)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,(0,Y.extend)(ov.DEFAULTS,t)),ZM(this,sv),nv(this,Ca,null),nv(this,iv,[]),nv(this,rw,void 0),nv(this,iw,void 0),nv(this,sw,void 0),this.registerHooks()}getMenu(){return io(Ca,this)}registerHooks(){this.addLocalHook("click",()=>rv(sv,this,QM).call(this))}setItems(e){Km(iv,this,this.translateNames(e)),io(Ca,this)&&io(Ca,this).setMenuItems(io(iv,this))}translateNames(e){return(0,W.arrayEach)(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Km(Ca,this,new we(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),io(Ca,this).setMenuItems(io(iv,this));const e=new Lu(this.hot,{className:"htUISelectCaption"}),t=new Lu(this.hot,{className:"htUISelectDropdown"});Km(rw,this,e),Km(iw,this,e.element),Km(sw,this,t),this.hot.getSettings().ariaTags&&((0,N.setAttribute)(t.element,[(0,ue.cV)()]),(0,N.setAttribute)(this._element,[(0,ue.a6)()])),(0,W.arrayEach)([e,t],r=>this._element.appendChild(r.element)),io(Ca,this).addLocalHook("select",r=>rv(sv,this,T0).call(this,r)),io(Ca,this).addLocalHook("afterClose",()=>rv(sv,this,JM).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=io(Ca,this).hot.getTranslatedPhrase(tn.FILTERS_CONDITIONS_NONE),io(iw,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();io(Ca,this)&&(io(Ca,this).open(),io(Ca,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),io(Ca,this).getNavigator().toFirstItem(),io(Ca,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){io(Ca,this)&&io(Ca,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){io(Ca,this)&&(io(Ca,this).destroy(),Km(Ca,this,null)),io(rw,this)&&io(rw,this).destroy(),io(sw,this)&&io(sw,this).destroy(),super.destroy()}}function T0(n){n.name!==ii&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function JM(){this.runLocalHooks("afterClose")}function QM(){this.openOptions()}function av(n,e){qM(n,e),e.add(n)}function qM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M0(n,e,t){return(e=eO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eO(n){var e=lu(n,"string");return typeof e=="symbol"?e:e+""}function lu(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function z_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ow=new WeakSet;class O0 extends Nr{constructor(e,t){super(e,{id:t.id,stateless:!1}),av(this,ow),M0(this,"name",""),M0(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new ov(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Vh(this.hot,{placeholder:tn.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new Vh(this.hot,{placeholder:tn.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>z_(ow,this,K_).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),(0,W.arrayEach)(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>z_(ow,this,tO).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=(0,Y.clone)(e.command);t.name.startsWith(tn.FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),(0,W.arrayEach)(e.args,(r,s)=>{if(s>t.inputsCount-1)return!1;const l=this.getInputElement(s);l.setValue(r),l[t.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>l.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Of(va),t=[];return(0,W.arrayEach)(this.getInputElements(),(r,s)=>{e.inputsCount>s&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=Of(e?e.name:va);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||(0,W.arrayEach)(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof ov)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Vh)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,s,l,g)=>{(0,N.addClass)(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,N.addClass)(t.parentNode,"border");const S=this.hot.rootDocument.createElement("div");return(0,N.addClass)(S,"htFiltersMenuLabel"),S.textContent=g,t.appendChild(S),t.parentElement.hasAttribute("ghost-table")||(0,W.arrayEach)(this.elements,M=>t.appendChild(M.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Of(va)];if(e!==null){const{visualIndex:r}=e;t=j_(this.hot.getDataType(0,r,this.hot.countRows(),r))}(0,W.arrayEach)(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function K_(n){(0,W.arrayEach)(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function tO(n){(0,q.isKey)(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,ce.stopImmediatePropagation)(n))}const Ym={};function nO(n){if(!Ym[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Ym[n].func;return function(t,r){return e(t,r)}}function Y_(n){return Ym[n].name}function I0(n,e,t){Ym[n]={name:e,func:t}}const Td="conjunction",rO=tn.FILTERS_LABELS_CONJUNCTION;function aw(n,e){return n.every(t=>t.func(e))}I0(Td,rO,aw);const lw="disjunction",G_=tn.FILTERS_LABELS_DISJUNCTION;function iO(n,e){return n.some(t=>t.func(e))}I0(lw,G_,iO);const uw="disjunctionWithExtraCondition",sO=tn.FILTERS_LABELS_DISJUNCTION;function jh(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}I0(uw,sO,jh);function $_(n,e,t){cw(n,e),e.set(n,t)}function cw(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lv(n,e){return n.get(Z_(n,e))}function X_(n,e,t){return n.set(Z_(n,e),t),t}function Z_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Pg=new WeakMap,P0=new WeakMap;class Gm extends Lu{static get DEFAULTS(){return(0,Y.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,(0,Y.extend)(Gm.DEFAULTS,t)),$_(this,Pg,void 0),$_(this,P0,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),X_(P0,this,e),X_(Pg,this,this._element.firstChild),lv(Pg,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(lv(P0,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?lv(Pg,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(lv(Pg,this).checked=e)}focus(){this.isBuilt()&&lv(Pg,this).focus()}}function oO(n,e){J_(n,e),e.add(n)}function J_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aO(n,e,t){return(e=hw(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hw(n){var e=lO(n,"string");return typeof e=="symbol"?e:e+""}function lO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Q_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const q_=0;var eb=new WeakSet;class uO extends Nr{constructor(e,t){super(e,{id:t.id,stateless:!1}),oO(this,eb),aO(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,N.addClass)(t.parentNode,"htFiltersMenuOperators"),(0,W.arrayEach)(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[Td,lw];(0,W.arrayEach)(e,t=>{const r=new Gm(this.hot,{name:"operator",label:{htmlFor:t,textContent:Y_(t)},value:t,checked:t===e[q_],id:t});r.addLocalHook("change",s=>Q_(eb,this,cO).call(this,s)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error((0,Nn.e)`Radio button with index ${e} doesn't exist.`);(0,W.arrayEach)(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof Gm&&t.isChecked());return e?e.getValue():Td}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&(0,W.arrayEach)(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Td,t=arguments.length>1?arguments[1]:void 0,r=e;r===uw&&(r=lw),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(q_)}}function cO(n){this.setState(n.target.value)}const hO=(0,Qo.getComparisonFunction)();function QA(n,e){return typeof n=="number"&&typeof e=="number"?n-e:hO(n,e)}function dO(n,e){let t=n;return t===""&&(t=`(${e})`),t}function $m(n){const e=new Set(n);return function(t){return e.has(t)}}function x0(n){return n==null?"":n}function Xm(n){return Array.from(new Set(n)).map(e=>x0(e)).sort((e,t)=>typeof e=="number"&&typeof t=="number"?e-t:e===t?0:e>t?1:-1)}function tb(n,e,t,r){const s=[],l=n===e;let g;return l||(g=$m(e)),n.forEach(S=>{let M=!1;(l||g(S))&&(M=!0);const P={checked:M,value:S,visualValue:dO(S,t)};r&&r(P),s.push(P)}),s}var xg=f(71050);function fO(n,e,t){gO(n,e),e.set(n,t)}function gO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A0(n,e){return n.get(rb(n,e))}function nb(n,e,t){return n.set(rb(n,e),t),t}function rb(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var uv=new WeakMap;class Ag extends Lu{static get DEFAULTS(){return(0,Y.clone)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,(0,Y.extend)(Ag.DEFAULTS,t)),fO(this,uv,void 0)}build(){super.build(),nb(uv,this,this._element.firstChild)}update(){this.isBuilt()&&(A0(uv,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&A0(uv,this).focus()}activate(){A0(uv,this).click()}}function ib(n,e){sb(n,e),e.add(n)}function Zm(n,e,t){sb(n,e),e.set(n,t)}function sb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yr(n,e){return n.get(Ng(n,e))}function eh(n,e,t){return n.set(Ng(n,e),t),t}function Ng(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ob="multipleSelect.itemBox";var th=new WeakMap,No=new WeakMap,dw=new WeakMap,Md=new WeakMap,Pf=new WeakMap,Uh=new WeakMap,cv=new WeakSet;class hv extends Lu{static get DEFAULTS(){return(0,Y.clone)({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,(0,Y.extend)(hv.DEFAULTS,t)),ib(this,cv),Zm(this,th,[]),Zm(this,No,void 0),Zm(this,dw,void 0),Zm(this,Md,void 0),Zm(this,Pf,void 0),Zm(this,Uh,void 0),eh(Md,this,new Vh(this.hot,{placeholder:tn.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),eh(Pf,this,new Ag(this.hot,{textContent:tn.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),eh(Uh,this,new Ag(this.hot,{textContent:tn.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Yr(No,this)}registerHooks(){Yr(Md,this).addLocalHook("keydown",e=>Ng(cv,this,ab).call(this,e)),Yr(Md,this).addLocalHook("input",e=>Ng(cv,this,mO).call(this,e)),Yr(Pf,this).addLocalHook("click",e=>Ng(cv,this,pO).call(this,e)),Yr(Uh,this).addLocalHook("click",e=>Ng(cv,this,lb).call(this,e))}setItems(e){var t;eh(th,this,e),(t=Yr(No,this))===null||t===void 0||t.loadData(Yr(th,this))}setLocale(e){eh(dw,this,e)}getLocale(){return Yr(dw,this)}getItems(){return[...Yr(th,this)]}getValue(){return vO(Yr(th,this))}getSearchInputElement(){return Yr(Md,this)}getSelectAllElement(){return Yr(Pf,this)}getClearAllElement(){return Yr(Uh,this)}isSelectedAllValues(){return Yr(th,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new Lu(this.hot,{className:"htUISelectionControls",children:[Yr(Pf,this),Yr(Uh,this)]});this._element.appendChild(Yr(Md,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const s=l=>{var g;if(!this._element)return;(g=Yr(No,this))===null||g===void 0||g.destroy(),(0,N.addClass)(l,"htUIMultipleSelectHot"),eh(No,this,new this.hot.constructor(l,{data:Yr(th,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(P,j,oe,ye,xe,Ze)=>{P.title=Ze.instance.getDataAtRowProp(j,Ze.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Yr(No,this).listen()},modifyColWidth:P=>{const j=Yr(No,this).container.scrollWidth-(0,N.getScrollbarWidth)(e);return P!==void 0&&P<j?j:P},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Yr(No,this).init(),this.hot.addHook("afterSetTheme",(P,j)=>{j||Yr(No,this).useTheme(P)});const M=Yr(No,this).getShortcutManager().getContext("grid");M.removeShortcutsByKeys(["Tab"]),M.removeShortcutsByKeys(["Shift","Tab"]),M.addShortcut({keys:[["Escape"]],callback:P=>{this.runLocalHooks("keydown",P,this)},group:ob}),M.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:P=>{Yr(No,this).deselectCell(),this.runLocalHooks("keydown",P,this),this.runLocalHooks("listTabKeydown",P,this)},group:ob})};s(t),this.hot._registerTimeout(()=>s(t),100)}focus(){this.isBuilt()&&Yr(No,this).listen()}reset(){Yr(Md,this).reset(),Yr(Pf,this).reset(),Yr(Uh,this).reset()}update(){this.isBuilt()&&(Yr(No,this).loadData(ub(Yr(th,this),this.options.value)),super.update())}destroy(){var e;(e=Yr(No,this))===null||e===void 0||e.destroy(),Yr(Md,this).destroy(),Yr(Uh,this).destroy(),Yr(Pf,this).destroy(),eh(Md,this,null),eh(Uh,this,null),eh(Pf,this,null),eh(No,this,null),eh(th,this,null),super.destroy()}}function mO(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...Yr(th,this)]:t=Yr(th,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Yr(No,this).loadData(t)}function ab(n){this.runLocalHooks("keydown",n,this),(0,ve.partial)(q.isKey,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),(0,ce.stopImmediatePropagation)(n),Yr(No,this).listen(),Yr(No,this).selectCell(0,0))}function pO(n){const e=[];n.preventDefault(),Yr(No,this).getSourceData().forEach((t,r)=>{t.checked=!0,e.push((0,xg.dataRowToChangesArray)(t,r)[0])}),Yr(No,this).setSourceDataAtCell(e)}function lb(n){const e=[];n.preventDefault(),Yr(No,this).getSourceData().forEach((t,r)=>{t.checked=!1,e.push((0,xg.dataRowToChangesArray)(t,r)[0])}),Yr(No,this).setSourceDataAtCell(e)}var qA=null;function ub(n,e){const t=$m(e);return n.map(r=>(r.checked=t(r.value),r))}function vO(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}const xf="by_value";function CO(n,e){let[t]=e;return t(n.value)}Uo(xf,CO,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[$m(e)]},showOperators:!1});function wO(n,e){N0(n,e),e.add(n)}function N0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yO(n,e,t){return(e=cb(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cb(n){var e=SO(n,"string");return typeof e=="symbol"?e:e+""}function SO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dv(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var fv=new WeakSet;class hb extends Nr{constructor(e,t){super(e,{id:t.id,stateless:!1}),wO(this,fv),yO(this,"name",""),this.name=t.name,this.elements.push(new hv(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>dv(fv,this,_O).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>dv(fv,this,bO).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===xf){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?va:xf},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,s,l,g,S)=>{const[M]=(0,W.arrayFilter)(s,oe=>oe.name===xf),P={},j=this.hot.getTranslatedPhrase(tn.FILTERS_VALUES_BLANK_CELLS);if(M){const oe=g(r,S),ye=(0,W.arrayMap)(oe,Pt=>Pt.value),xe=new Map(oe.map(Pt=>[Pt.value,this.hot.getCellMeta(Pt.meta.visualRow,Pt.meta.visualCol)])),Ze=Xm(ye);l&&(M.args[0]=l);const Ct=[],ot=tb(Ze,M.args[0],j,Pt=>{Pt.checked&&Ct.push(Pt.value),dv(fv,this,db).call(this,Pt,xe)}),Jt=e.editedConditionStack.column;P.locale=this.hot.getCellMeta(0,Jt).locale,P.args=[Ct],P.command=Of(xf),P.itemsSnapshot=ot}else P.args=[],P.command=Of(va);this.state.setValueAtIndex(r,P)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof hv)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,s,l,g)=>{(0,N.addClass)(t.parentNode,"htFiltersMenuValue");const S=this.hot.rootDocument.createElement("div");return(0,N.addClass)(S,"htFiltersMenuLabel"),S.textContent=g,t.appendChild(S),t.parentElement.hasAttribute("ghost-table")||(0,W.arrayEach)(this.elements,M=>t.appendChild(M.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(tn.FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),r=t.map(M=>M.value),s=new Map(t.map(M=>[M.value,M.meta])),l=Xm(r),g=tb(l,l,e,M=>{dv(fv,this,db).call(this,M,s)});this.getMultipleSelectElement().setItems(g),super.reset(),this.getMultipleSelectElement().setValue(l);const S=this.hot.getPlugin("filters").getSelectedColumn();S!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,S.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:(0,W.arrayMap)(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:x0(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function _O(n){(0,q.isKey)(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,ce.stopImmediatePropagation)(n))}function db(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function bO(n,e){switch(e.type){case"numeric":return Nc(n,e);default:return n}}var fw;function EO(n,e){fb(n,e),e.add(n)}function fb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RO(n,e,t){return(e=gb(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gb(n){var e=TO(n,"string");return typeof e=="symbol"?e:e+""}function TO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mb=new WeakSet;class Jm extends Nr{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),EO(this,mb),RO(this,"name",""),this.name=t.name,this.elements.push(new Vh(this.hot,{type:"button",value:tn.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:Jm.BUTTON_OK})),this.elements.push(new Vh(this.hot,{type:"button",value:tn.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:Jm.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,W.arrayEach)(this.elements,e=>{e.addLocalHook("click",(t,r)=>gw(mb,this,MO).call(this,t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,N.addClass)(t.parentNode,"htFiltersMenuActionBar"),(0,W.arrayEach)(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}fw=Jm;function MO(n,e){e.options.identifier===fw.BUTTON_OK?this.accept():this.cancel()}function Dg(n,e,t){return(e=OO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OO(n){var e=pb(n,"string");return typeof e=="symbol"?e:e+""}function pb(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vb="ConditionCollection.filteringStates";class Cb{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Dg(this,"hot",void 0),Dg(this,"isMapRegistrable",void 0),Dg(this,"filteringStates",new hr.A),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(vb,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const s=this.filteringStates.getValueAtIndex(t),l=(r=s==null?void 0:s.conditions)!==null&&r!==void 0?r:[],g=s==null?void 0:s.operation;return this.isMatchInConditions(l,e,g)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Td;return e.length?nO(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Td,s=arguments.length>3?arguments[3]:void 0;const l=this.hot.getCellMeta(0,e).locale,g=t.args.map(j=>typeof j=="string"?j.toLocaleLowerCase(l):j),S=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const M=this.getOperation(e);if(M){if(M!==r)throw Error((0,Nn.e)`The column of index ${e} has been already applied with a \`${M}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,I.isUndefined)(Ym[r]))throw new Error((0,Nn.e)`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const P=this.getConditions(e);P.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:S,args:g,func:Mf(S,g)}]},s):P.push({name:S,args:g,func:Mf(S,g)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[r,{operation:s,conditions:l}]=t;return e.push({column:r,operation:s,conditions:l.map(g=>{let{name:S,args:M}=g;return{name:S,args:[...M]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(t=>{t.conditions.forEach(r=>this.addCondition(t.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(s=>s.name===t):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(vb),this.filteringStates=null,this.clearLocalHooks()}}(0,Y.mixin)(Cb,Pu.Z);var D0=Cb;function wb(n,e,t){return(e=yb(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yb(n){var e=IO(n,"string");return typeof e=="symbol"?e:e+""}function IO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];wb(this,"conditionCollection",void 0),wb(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return(0,W.arrayEach)(this.conditionCollection.getFilteredColumns(),(t,r)=>{let s=this.columnDataFactory(t);r&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return(0,W.arrayEach)(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&r.push(s)}),r}_getIntersectData(e,t){const r=[];return(0,W.arrayEach)(t,s=>{const l=s.meta.visualRow;e[l]!==void 0&&(r[l]=e[l])}),r}}var H0=PO;function xO(n,e){Sb(n,e),e.add(n)}function Sb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hg(n,e,t){return(e=AO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AO(n){var e=_b(n,"string");return typeof e=="symbol"?e:e+""}function _b(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function L0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var gv=new WeakSet;class bb{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];xO(this,gv),Hg(this,"hot",void 0),Hg(this,"conditionCollection",void 0),Hg(this,"columnDataFactory",void 0),Hg(this,"changes",[]),Hg(this,"grouping",!1),Hg(this,"latestEditedColumnPosition",-1),Hg(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",s=>L0(gv,this,NO).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>L0(gv,this,DO).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>L0(gv,this,HO).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,W.arrayEach)(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let l=this.conditionCollection.getColumnStackPosition(e);l===-1&&(l=this.latestEditedColumnPosition);const g=s.slice(0,l),S=s.slice(l);S.length&&S[0].column===e&&S.shift();const M=(0,ve.curry)(function(j,oe){let ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const xe=new D0(r.hot,!1),Ze=[].concat(j,ye);xe.importAllConditions(Ze);const Ct=r.columnDataFactory(oe);let ot;xe.isEmpty()?ot=Ct:ot=new H0(xe,Pt=>r.columnDataFactory(Pt)).filter(),ot=(0,W.arrayMap)(ot,Pt=>Pt.meta.visualRow);const Jt=$m(ot);return xe.destroy(),(0,W.arrayFilter)(Ct,Pt=>Jt(Pt.meta.visualRow))})(g),P=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:P},dependentConditionStacks:S,filteredRowsFactory:M,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),(0,Y.objectEach)(this,(e,t)=>{this[t]=null})}}function NO(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function DO(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function HO(){(0,W.arrayEach)(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}(0,Y.mixin)(bb,Pu.Z);var LO=bb;function FO(n){return Wp({initialPage:0,size:()=>n.length,onItemSelect:(t,r)=>{const s=n[t];if(s instanceof hv)return r;if(s.element&&!(0,N.isVisible)(s.element))return!1;s.focus()}})}const Qm="filters";function WO(n,e){let t=-1,r;const s=FO(e),l=oe=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Qm),s.setCurrentPage(e.indexOf(oe))};e.forEach(oe=>{oe instanceof Lu&&(oe.addLocalHook("click",l(oe)),oe.addLocalHook("focus",l(oe)),oe.addLocalHook("afterClose",l(oe)))}),M(n);function g(oe){const ye=r.getKeyboardShortcutsCtrl(),xe=oe.getKeyboardShortcutsCtrl();s.clear(),xe.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:ye.getContext(Qm),callback:()=>{oe.isSubMenu()&&oe.close(),ye.listen(Qm)}}]),!oe.isSubMenu()&&ye.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:Ze=>{const Ct=r.getNavigator();Ct.getCurrentPage()>-1&&(t=Ct.getCurrentPage()),Ct.clear(),Ze.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:Ze=>{const Ct=e[s.getCurrentPage()];Ct instanceof ov&&(Ct.openOptions(),Ze.preventDefault()),Ct instanceof Ag&&(Ct.activate(),Ze.preventDefault()),Ct instanceof Lu||Ze.preventDefault()}}],Qm)}function S(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Qm)}function M(oe){oe.addLocalHook("afterSelectionChange",ye=>{ye.key.startsWith("filter_")||s.clear()}),oe.addLocalHook("afterSubmenuOpen",g),oe.addLocalHook("afterOpen",g),r=oe}function P(){return r}function j(){return t}return Gl(hi({},s),{listen:S,setMenu:M,getMenu:P,getLastMenuPage:j})}var mw=f(55315);function BO(n,e){Eb(n,e),e.add(n)}function pw(n,e,t){Eb(n,e),e.set(n,t)}function Eb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qm(n,e,t){return(e=kO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kO(n){var e=Rb(n,"string");return typeof e=="symbol"?e:e+""}function Rb(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vw(n,e,t){return n.set(uu(n,e),t),t}function Fu(n,e){return n.get(uu(n,e))}function uu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Cw="filters",VO=250,F0=Cw;var Od=new WeakMap,ep=new WeakMap,Lg=new WeakMap,cu=new WeakSet;class jO extends jr.vq{static get PLUGIN_KEY(){return Cw}static get PLUGIN_PRIORITY(){return VO}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t;super(e),t=this,BO(this,cu),qm(this,"dropdownMenuPlugin",null),qm(this,"conditionCollection",null),qm(this,"conditionUpdateObserver",null),qm(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),qm(this,"filtersRowsMap",null),pw(this,Od,void 0),pw(this,ep,new WeakSet),pw(this,Lg,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return uu(cu,t,ww).call(t,...s)})}isEnabled(){return!!this.hot.getSettings()[Cw]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new mw.n),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,r=t&&t.uiContainer||this.hot.rootDocument.body,s=S=>(S.addLocalHook("accept",()=>uu(cu,this,Ob).call(this,"accept")),S.addLocalHook("cancel",()=>uu(cu,this,Ob).call(this,"cancel")),S.addLocalHook("change",M=>uu(cu,this,W0).call(this,S,M)),S),l=()=>`${this.hot.getTranslatedPhrase(tn.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,g=()=>`${this.hot.getTranslatedPhrase(tn.FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const S=new O0(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:r});S.addLocalHook("afterClose",()=>uu(cu,this,Ib).call(this)),this.components.set("filter_by_condition",s(S))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new uO(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const S=new O0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});S.addLocalHook("afterClose",()=>uu(cu,this,Ib).call(this)),this.components.set("filter_by_condition2",s(S))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new hb(this.hot,{id:"filter_by_value",name:g}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new Jm(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new D0(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new LO(this.hot,this.conditionCollection,S=>this.getDataMapAtColumn(S)),this.conditionUpdateObserver.addLocalHook("update",S=>uu(cu,this,YO).call(this,S))),this.components.forEach(S=>S.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var S=arguments.length,M=new Array(S),P=0;P<S;P++)M[P]=arguments[P];return uu(cu,e,Mb).call(e,...M)}),this.addHook("beforeDropdownMenuShow",()=>uu(cu,this,KO).call(this)),this.addHook("afterDropdownMenuShow",()=>uu(cu,this,UO).call(this)),this.addHook("afterDropdownMenuHide",()=>uu(cu,this,zO).call(this)),this.addHook("afterChange",S=>uu(cu,this,Tb).call(this,S)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Fu(Od,this)&&this.dropdownMenuPlugin.enabled){const S=[{focus:()=>{const P=Fu(Od,this).getMenu(),j=P.getNavigator(),oe=Fu(Od,this).getLastMenuPage();P.focus(),oe>0?j.setCurrentPage(oe):j.toFirstItem()}},...Array.from(this.components).map(P=>{let[,j]=P;return j.getElements()}).flat()];vw(Od,this,WO(this.dropdownMenuPlugin.menu,S));const M=P=>{Fu(Od,this).listen(),P.preventDefault(),(0,q.isKey)(P.keyCode,"TAB")&&(P.shiftKey?Fu(Od,this).toPreviousItem():Fu(Od,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",M),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",M)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:F0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(F0)}addCondition(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Td;const l=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(l,{command:{key:t},args:r},s)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let s=[];const l=this.exportConditions(),g=this.hot.runHooks("beforeFilter",l,Fu(Lg,this));if(g!==!1&&r){const S=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=(0,W.arrayMap)(t.filter(),P=>P.meta.visualRow);const M=$m(s);(0,Rn.rangeEach)(this.hot.countSourceRows()-1,P=>{M(P)||S.push(P)}),(0,W.arrayEach)(S,P=>{this.filtersRowsMap.setValueAtIndex(P,!0)})},!0),!e&&!s.length&&this.hot.deselectCell(),vw(Lg,this,this.exportConditions())}else g!==!1&&!r?(vw(Lg,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Fu(Lg,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),g!==!1&&(this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return(0,W.arrayEach)(this.hot.getSourceDataAtCol(t),(s,l)=>{var g;const{row:S,col:M,visualCol:P,visualRow:j,type:oe,instance:ye,dateFormat:xe,locale:Ze}=this.hot.getCellMeta(l,t),Ct=(g=this.hot.getDataAtCell(this.hot.toVisualRow(l),t))!==null&&g!==void 0?g:s;r.push({meta:{row:S,col:M,visualCol:P,visualRow:j,type:oe,instance:ye,dateFormat:xe,locale:Ze},value:x0(Ct)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=Xm(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,s){let l=e;return l===lw&&t.command.key!==va&&r.command.key!==va&&s.command.key!==va?l=uw:s.command.key!==va&&(t.command.key===va||r.command.key===va)&&(l=Td),l}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new H0(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(0,W.arrayEach)(s,g=>{(0,W.arrayEach)(t.menuItems,(S,M)=>{S.key===g.getMenuItemDescriptor().key&&e.push(M)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,s=r.getPlugin("hiddenRows");for(var l=arguments.length,g=new Array(l>1?l-1:0),S=1;S<l;S++)g[S-1]=arguments[S];const M=this.getIndexesOfComponents(...g);e?s.showRows(M):s.hideRows(M),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Tb(n){n&&(0,W.arrayEach)(n,e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function UO(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function zO(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function KO(){const n=this.dropdownMenuPlugin.menu;Fu(ep,this).has(n)||Fu(Od,this).setMenu(n),Fu(ep,this).add(n)}function Mb(n){n.items.push({name:ii}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function Ob(n){var e;if(n==="accept"){const r=this.getSelectedColumn();if(r===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:s}=r,l=this.components.get("filter_by_condition").getState(),g=this.components.get("filter_by_condition2").getState(),S=this.components.get("filter_by_value").getState(),M=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),l,g,S);this.conditionUpdateObserver.groupChanges();let P=this.conditionCollection.getColumnStackPosition(s);P===-1&&(P=void 0),this.conditionCollection.removeConditions(s),l.command.key!==va&&(this.conditionCollection.addCondition(s,l,M,P),g.command.key!==va&&this.conditionCollection.addCondition(s,g,M,P)),S.command.key!==va&&this.conditionCollection.addCondition(s,S,M,P),this.conditionUpdateObserver.flush(),this.components.forEach(j=>j.saveState(s)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function W0(n,e){const t=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),n.constructor===O0&&!e.inputsCount&&this.setListeningDropdownMenu(),t.updateMenuDimensions()}function Ib(){this.setListeningDropdownMenu()}function ww(n,e,t){const r=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(r)&&t===this.hot.view.getColumnHeadersCount()-1?(0,N.addClass)(e,"htFiltersActive"):(0,N.removeClass)(e,"htFiltersActive")}function YO(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:r},conditionArgsChange:s}=n;Array.isArray(s)&&vw(Lg,this,Fu(Lg,this).map(S=>(S.column===r&&t.length>0&&S.conditions.forEach(M=>{M.name==="by_value"&&(M.args=[[...s]])}),S)));const l=t.filter(S=>S.name===xf),g=t.filter(S=>S.name!==xf);if(l.length>=2||g.length>=3)(0,v.ZK)((0,Nn.e)`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const S=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(g[0],r),this.components.get("filter_by_condition2").updateState(g[1],r),this.components.get("filter_operators").updateState(S,r),this.components.get("filter_by_value").updateState(n)}}var GO=f(18601);const Pb="internal-use-in-handsontable",yw={licenseKey:Pb,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function xb(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[ml])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Ab(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function $O(n){var e;const t=n[ml],r=Ab(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=xb(n);return hi(hi(hi({},yw),r),s)}function XO(n){var e;const t=n[ml],r=Ab(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=xb(n);return hi(hi({},r),s)}function ZO(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function mv(){const n="engine_relationship",e=(0,We.Z)(ml);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function B0(){const n="shared_engine_usage",e=(0,We.Z)(ml);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function JO(n){const e=n.getSettings(),t=e[ml],r=t==null?void 0:t.engine;if(t===!0||(0,I.isUndefined)(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var s;return QO((s=r.hyperformula)!==null&&s!==void 0?s:r,e,n)}else if(typeof r=="object"&&(0,I.isUndefined)(r.hyperformula)){const l=mv(),g=B0().get(r);return l.has(r)||l.set(r,[]),l.get(r).push(n),g&&g.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:Pb}),(r.getConfig().leapYear1900!==yw.leapYear1900||(0,Y.isObjectEqual)(r.getConfig().nullDate,yw.nullDate)===!1)&&(0,v.ZK)((0,Nn.e)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function QO(n,e,t){const r=e[ml],s=$O(e),l=mv(),g=B0();Hb(n,r.functions),qO(n,r.language);const S=n.buildEmpty(s);return l.set(S,[t]),g.set(S,[t.guid]),eI(S,r.namedExpressions),S.on("sheetAdded",()=>{S.rebuildAndRecalculate()}),S.on("sheetRemoved",()=>{S.rebuildAndRecalculate()}),S}function Nb(n){var e;const t=mv(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(s=>[s.getPlugin("formulas").sheetId,s]))}function Db(n,e){if(n){const t=mv(),r=t.get(n),s=B0(),l=s.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),l&&l.includes(e.guid)&&(l.splice(l.indexOf(e.guid),1),l.length===0&&(s.delete(n),n.destroy()))}}function Hb(n,e){e&&e.forEach(t=>{const{name:r,plugin:s,translations:l}=t;try{n.registerFunction(r,s,l)}catch(g){(0,v.ZK)(g.message)}})}function qO(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){(0,v.ZK)(r.message)}}}function eI(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:s,scope:l,options:g}=t;try{n.addNamedExpression(r,s,l,g)}catch(S){(0,v.ZK)(S.message)}}),n.resumeEvaluation())}function pv(n,e){return((0,I.isUndefined)(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const Lb="DD/MM/YYYY";function k0(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function tI(n){return k0(n)?n.substr(1):n}function Fg(n){return typeof n=="string"&&n.startsWith("=")}function V0(n,e){return typeof n=="string"&&e==="date"}function Fb(n,e){return Ae()(n,e,!0).isValid()}function j0(n,e){return Ae()(n,e,!0).format(Lb)}function nI(n,e){return Ae()(n,Lb,!0).format(e)}function Wb(n,e){const r=new Date(Date.UTC(0,0,n+-1));return Ae()(r).format(e)}function Bb(n,e,t){const r=Array.from(Array(t).keys()).filter(l=>n.includes(l)===!1);if(e===0){var s;return(s=r[e])!==null&&s!==void 0?s:0}return r[e-1]+1}function rI(n,e){const t=[];return n.forEach(r=>{const s={from:r,to:e};t.forEach(l=>{const g=l.from>l.to,S=l.to<=s.from;l.from>s.from&&S&&g&&(s.from+=1)}),s.from>=e&&(e+=1),t.push(s)}),t}function kb(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(s=>{const l=s.from<s.to;s.from>e.from&&l&&(s.from-=1)})}),n}function U0(n,e,t){const r=rI(n,Bb(n,e,t));return kb(r)}function Wg(n,e,t){z0(n,e),e.set(n,t)}function z0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(n,e){return n.get(Vb(n,e))}function zh(n,e,t){return n.set(Vb(n,e),t),t}function Vb(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var tp=new WeakMap,Af=new WeakMap,hu=new WeakMap,Sw=new WeakMap,_w=new WeakMap,K0=new WeakMap,bw=new WeakMap;class iI{constructor(e,t,r){Wg(this,tp,void 0),Wg(this,Af,void 0),Wg(this,hu,void 0),Wg(this,Sw,[]),Wg(this,_w,[]),Wg(this,K0,void 0),Wg(this,bw,[]),zh(tp,this,e),zh(Af,this,t),zh(hu,this,r)}setRemovedHfIndexes(e){return zh(bw,this,e.map(t=>{const r=Qs(Af,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),Qs(bw,this)}getRemovedHfIndexes(){return Qs(bw,this)}getHfIndexFromVisualIndex(e){const t=Qs(Af,this).getIndexesSequence(),r=Qs(Af,this).getNotTrimmedIndexes();return t.indexOf(r[e],e)}syncMoves(e){const r=`move${(0,V.toUpperCaseFirst)(Qs(tp,this))}s`;Qs(hu,this).getEngine().batch(()=>{e.forEach(s=>{const l=s.from!==s.to,g=s.from+1!==s.to;l&&g&&Qs(hu,this).getEngine()[r](Qs(hu,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,r){r!==!1&&(zh(_w,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),zh(K0,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(Qs(hu,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=U0(Qs(_w,this),Qs(K0,this),Qs(Af,this).getNumberOfIndexes());Qs(hu,this).getSheetId()===null?Qs(hu,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${(0,V.toUpperCaseFirst)(Qs(tp,this))}Order`;return t=>{if(Qs(hu,this).isPerformingUndoRedo())return;const r=Qs(Af,this).getIndexesSequence();if(t==="update"&&r.length>0){const s=Qs(Sw,this).map(M=>r.indexOf(M)),l=Qs(hu,this).getEngine().getSheetDimensions(Qs(hu,this).getSheetId());let g;Qs(tp,this)==="row"?g=l.height:g=l.width;const S=s.length;for(let M=S;M<g;M+=1)s.push(M);Qs(hu,this).getEngine()[e](Qs(hu,this).getSheetId(),s)}zh(Sw,this,r)}}init(){zh(Sw,this,Qs(Af,this).getIndexesSequence())}}var Y0=iI;function Bg(n,e,t){sI(n,e),e.set(n,t)}function sI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Id(n,e){return n.get(G0(n,e))}function Nf(n,e,t){return n.set(G0(n,e),t),t}function G0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ew=new WeakMap,Rw=new WeakMap,$0=new WeakMap,Tw=new WeakMap,X0=new WeakMap,Mw=new WeakMap,Z0=new WeakMap;class vv{constructor(e,t,r){Bg(this,Ew,void 0),Bg(this,Rw,void 0),Bg(this,$0,void 0),Bg(this,Tw,!1),Bg(this,X0,!1),Bg(this,Mw,null),Bg(this,Z0,null),Nf(Ew,this,new Y0("row",e,this)),Nf(Rw,this,new Y0("column",t,this)),Nf($0,this,r)}getForAxis(e){return e==="row"?Id(Ew,this):Id(Rw,this)}setPerformUndo(e){Nf(Tw,this,e)}setPerformRedo(e){Nf(X0,this,e)}isPerformingUndoRedo(){return Id(Tw,this)||Id(X0,this)}getSheetId(){return Id(Z0,this)}getEngine(){return Id(Mw,this)}getPostponeAction(){return Id($0,this)}setupSyncEndpoint(e,t){Nf(Mw,this,e),Nf(Z0,this,t),Id(Ew,this).init(),Id(Rw,this).init()}}var oI=vv;function jb(n,e){zb(n,e),e.add(n)}function kg(n,e,t){return(e=Ub(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ub(n){var e=aI(n,"string");return typeof e=="symbol"?e:e+""}function aI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function J0(n,e,t){zb(n,e),e.set(n,t)}function zb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pd(n,e,t){return n.set(xi(n,e),t),t}function Vg(n,e){return n.get(xi(n,e))}function xi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ml="formulas",lI=["maxRows","maxColumns","language"],Kb=260;xn.P.getSingleton().register("afterNamedExpressionAdded"),xn.P.getSingleton().register("afterNamedExpressionRemoved"),xn.P.getSingleton().register("afterSheetAdded"),xn.P.getSingleton().register("afterSheetRemoved"),xn.P.getSingleton().register("afterSheetRenamed"),xn.P.getSingleton().register("afterFormulasValuesUpdate");const np=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var xd=new WeakMap,Ow=new WeakMap,rp=new WeakMap,Ki=new WeakSet;class Yb extends jr.vq{constructor(){var e;super(...arguments),e=this,jb(this,Ki),J0(this,xd,!1),J0(this,Ow,!1),J0(this,rp,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,vI).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,nE).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,CI).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,wI).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,q0).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return xi(Ki,e,yI).call(e,...r)}]]),kg(this,"staticRegister",(0,We.Z)("formulas")),kg(this,"engine",null),kg(this,"sheetId",null),kg(this,"sheetName",null),kg(this,"indexSyncer",null),kg(this,"rowAxisSyncer",null),kg(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return ml}static get PLUGIN_PRIORITY(){return Kb}static get SETTING_KEYS(){return[ml,...lI]}isEnabled(){return!!this.hot.getSettings()[ml]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=JO(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){(0,v.ZK)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&xi(Ki,this,Cv).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,$b).call(t,...s)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Xb).call(t,...s)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,$b).call(t,...s)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Xb).call(t,...s)}),this.addHook("modifyData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,hI).call(t,...s)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Zb).call(t,...s)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Gb).call(t,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Qb).call(t,...s)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Jb).call(t,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Jb).call(t,...s)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,dI).call(t,...s)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,qb).call(t,...s)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,eE).call(t,...s)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,mI).call(t,...s)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,fI).call(t,...s)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,gI).call(t,...s)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,Q0).call(t,...s)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,pI).call(t,...s)}),this.indexSyncer=new oI(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,s,l,g)=>{this.rowAxisSyncer.storeMovesInformation(r,s,g)}),this.hot.addHook("beforeColumnMove",(r,s,l,g)=>{this.columnAxisSyncer.storeMovesInformation(r,s,g)}),this.hot.addHook("afterRowMove",(r,s,l,g,S)=>{this.rowAxisSyncer.calculateAndSyncMoves(g,S)}),this.hot.addHook("afterColumnMove",(r,s,l,g,S)=>{this.columnAxisSyncer.calculateAndSyncMoves(g,S)}),this.hot.addHook("beforeColumnFreeze",(r,s)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(r,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(r,s)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(r,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,cI).call(t,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,tE).call(t,...s)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return xi(Ki,t,uI).call(t,...s)}),Vg(rp,this).forEach(r=>{let[s,l]=r;return this.engine.on(s,l)}),super.enablePlugin()}}disablePlugin(){Vg(rp,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),Db(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=XO(this.hot.getSettings());ZO(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[ml];if((0,I.isDefined)(r)&&(0,I.isDefined)(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[ml].sheetName;if(s&&this.engine.doesSheetExist(s))this.switchSheet(this.sheetName);else{const l=this.addSheet(s!=null?s:void 0,this.hot.getSourceDataArray());xi(Ki,this,Cv).call(this,l)}}super.updatePlugin(e)}destroy(){Vg(rp,this).forEach(e=>{var t;let[r,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,s)}),Pd(rp,this,null),Db(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if((0,I.isDefined)(t)&&!(0,xg.isArrayOfArrays)(t))return(0,v.ZK)("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return(0,v.ZK)("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e!=null?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return(0,v.ZK)(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){(0,v.vU)(`The sheet named \`${e}\` does not exist, switch aborted.`);return}xi(Ki,this,Cv).call(this,e);const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${(0,V.toUpperCaseFirst)(ml)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),l=this.hot.toPhysicalColumn(t);return s!==null&&l!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(s=>{var l;const g=s==null||(l=s.address)===null||l===void 0?void 0:l.sheet;g!==void 0&&(r.has(g)||r.add(g))}),Nb(this.engine).forEach((s,l)=>{if((t||l!==this.sheetId)&&r.has(l)){var g;s.render(),(g=s.view)===null||g===void 0||g.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=l=>{var g;const{row:S,col:M,sheet:P}=(g=l==null?void 0:l.address)!==null&&g!==void 0?g:{};return(0,I.isDefined)(P)?`${P}:${S}x${M}`:""},s=new Set(t.map(l=>r(l)));e.forEach(l=>{var g,S;const{row:M,col:P}=(g=l.address)!==null&&g!==void 0?g:{};if((0,I.isDefined)(M)===!1||(0,I.isDefined)(P)===!1||M>=this.hot.countRows()||P>=this.hot.countCols())return;const j=l==null||(S=l.address)===null||S===void 0?void 0:S.sheet,oe=r(l);if(j!==void 0&&!s.has(oe)){const ye=Nb(this.engine).get(j);if(!ye)return;ye.validateCell(ye.getDataAtCell(M,P),ye.getCellMeta(M,P),()=>{})}})}syncChangeWithEngine(e,t,r){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){(0,v.ZK)(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const l=this.hot.getCellMeta(e,t);return V0(r,l.type)&&(Fb(r,l.dateFormat)?r=j0(r,l.dateFormat):Fg(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(s,r)}}function Cv(n){this.sheetName=n,this.sheetId=this.engine.getSheetId(this.sheetName)}function Gb(n,e,t){const r=this.hot.propToCol(t);if(this.isFormulaCellType(e,r)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},l=this.hot.getCellMeta(e,r);let g=this.engine.getCellValue(s);return l.type==="date"&&(0,Rn.isNumeric)(g)&&(g=Wb(g,l.dateFormat)),typeof g=="object"&&g!==null?g.value:g}return n}function uI(n,e,t){const{row:r,col:s}=e.getTopStartCorner(),{row:l,col:g}=e.getBottomEndCorner(),{row:S,col:M}=t.getTopStartCorner(),{row:P,col:j}=t.getBottomEndCorner(),oe={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}},ye={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(S),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(M),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(P),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(j),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(ye)===!1)return!1;const xe=this.engine.getFillRangeData(oe,ye),{row:Ze,col:Ct}=oe.start,{row:ot,col:Jt}=oe.end,Pt=ot-Ze+1,Un=Jt-Ct+1;for(let gr=0;gr<xe.length;gr+=1)for(let jn=0;jn<xe[gr].length;jn+=1){const Kt=xe[gr][jn],Yt=Ze+gr%Pt,Sr=Ct+jn%Un,oi=this.hot.getCellMeta(Yt,Sr);V0(Kt,oi.type)&&(Kt.startsWith("'")?xe[gr][jn]=Kt.slice(1):this.isFormulaCellType(Yt,Sr,this.sheetId)===!1&&(xe[gr][jn]=nI(Kt,oi.dateFormat)))}return xe}function $b(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes((0,V.toUpperCaseFirst)(ml))||Pd(Ow,this,(0,I.isUndefined)(this.hot.getSettings().data))}function cI(){if(Vg(Ow,this)){this.switchSheet(this.sheetName);return}const n=this.hot.getSourceDataArray();n.forEach((t,r)=>{t.forEach((s,l)=>{const g=this.hot.getCellMeta(r,l,{skipMetaExtension:!0}),S=g.dateFormat;V0(s,g.type)&&(Fb(s,S)?n[r][l]=j0(s,S):s.startsWith("=")||(n[r][l]=`'${s}`))})}),Pd(xd,this,!0);const e=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Pd(xd,this,!1)}function Xb(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(t.includes((0,V.toUpperCaseFirst)(ml)))return;const r=pv(this.engine,this.hot.getSettings()[ml].sheetName);if(xi(Ki,this,Cv).call(this,r),t!=="updateSettings")if(Vg(Ow,this))this.switchSheet(this.sheetName);else{const s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){Pd(xd,this,!0);const l=this.engine.setSheetContent(this.sheetId,s);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(l),Pd(xd,this,!1)}}}function hI(n,e,t,r){if(r!=="get"||Vg(xd,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(n);if(s===null||e===null)return;const l=this.getCellType(s,e);if(l==="VALUE"||l==="EMPTY"){t.value=tI(t.value);return}const g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let S=this.engine.getCellValue(g);const M=this.hot.getCellMeta(s,e,{skipMetaExtension:!0});M.type==="date"&&(0,Rn.isNumeric)(S)&&(S=Wb(S,M.dateFormat)),t.value=typeof S=="object"&&S!==null?S.value:S}function Zb(n,e,t,r){if(r!=="get"||Vg(xd,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(n),l=this.hot.propToCol(e);if(s===null||l===null)return;const g=this.getCellType(s,l);if(g==="VALUE"||g==="EMPTY")return;const S=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(S.width===0&&S.height===0)return;const M={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};t.value=this.engine.getCellSerialized(M)}function Jb(n,e){if(np(e))return;const t=[],r=[],s=this.engine.batch(()=>{n.forEach(l=>{let[g,S,,M]=l;const P=this.hot.propToCol(S),j=this.hot.toPhysicalRow(g),oe=this.hot.toPhysicalColumn(P),ye={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(g),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(P),sheet:this.sheetId};j!==null&&oe!==null?this.syncChangeWithEngine(g,P,M):t.push([g,P,M]),r.push({address:ye})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const l=this.engine.batch(()=>{t.forEach(g=>{let[S,M,P]=g;this.syncChangeWithEngine(S,M,P)})});this.renderDependentSheets(l,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,r)}function Qb(n,e){if(np(e))return;const t=[],r=[];n.forEach(s=>{let[l,g,,S]=s;const M=this.hot.propToCol(g);if(!(0,Rn.isNumeric)(M))return;const P={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(M),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(P)){(0,v.ZK)(`Not possible to set source cell data at ${JSON.stringify(P)}`);return}r.push({address:P}),t.push(...this.engine.setCellContents(P,S))}),this.renderDependentSheets(t),this.validateDependentCells(t,r)}function dI(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function qb(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function fI(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(l=>this.engine.isItPossibleToRemoveRows(this.sheetId,[l,1]))===!1?!1:void 0}function gI(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(l=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[l,1]))===!1?!1:void 0}function eE(n,e,t){if(np(t))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function mI(n,e,t){if(np(t))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function Q0(n,e,t,r){if(np(r))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((g,S)=>S-g),l=this.engine.batch(()=>{s.forEach(g=>{this.engine.removeRows(this.sheetId,[g,1])})});this.renderDependentSheets(l)}function pI(n,e,t,r){if(np(r))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((g,S)=>S-g),l=this.engine.batch(()=>{s.forEach(g=>{this.engine.removeColumns(this.sheetId,[g,1])})});this.renderDependentSheets(l)}function tE(n,e,t){var r;Pd(xd,this,!0);const s=this.hot.getSourceDataArray(t,0,t+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Pd(xd,this,!1),s.forEach((l,g)=>{l.forEach((S,M)=>{this.engine.setCellContents({col:M,row:t+g,sheet:this.sheetId},[[S]])})})}function vI(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function nE(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function CI(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function wI(n){this.hot.runHooks("afterSheetAdded",n)}function q0(n,e){xi(Ki,this,Cv).call(this,e),this.hot.runHooks("afterSheetRenamed",n,e)}function yI(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function rE(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,s]=e;r-s!==0&&(t=1)}return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),l=[];for(let M=r;M<=s;M+=1)l.push(M);n.hideColumns(l);const g=l[l.length-1],S=this.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0);Number.isInteger(S)&&S>=0?this.selectColumns(S):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function eS(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback(){var t,r;if(e.length===0)return;let s=e[0],l=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,l=(r=this.columnIndexMapper.getNearestNotHiddenIndex(l+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),l-s+1===this.countCols()||this.selectColumns(s,l)},disabled:!1,hidden(){const t=(0,W.arrayMap)(n.getHiddenColumns(),oe=>this.toPhysicalColumn(oe));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),s=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,g=this.columnIndexMapper,S=g.getRenderableFromVisualIndex(s),M=g.getRenderableFromVisualIndex(l),P=g.getNotTrimmedIndexes(),j=[];if(s!==l){const oe=l-s+1,ye=M-S+1;if(oe>ye){const xe=P.slice(s,l+1);j.push(...xe.filter(Ze=>t.includes(Ze)))}}else if(S===0&&S<s)j.push(...P.slice(0,s));else if(S===null)j.push(...P.slice(0,this.countCols()));else{const oe=this.countCols()-1,ye=g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(oe,-1));M===ye&&oe>l&&j.push(...P.slice(l+1))}return(0,W.arrayEach)(j,oe=>{e.push(this.toVisualColumn(oe))}),e.length===0}}}var iE=f(67822);function SI(n,e){sE(n,e),e.add(n)}function _I(n,e,t){sE(n,e),e.set(n,t)}function sE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(n,e){return n.get(Ad(n,e))}function oE(n,e,t){return n.set(Ad(n,e),t),t}function Ad(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeHideColumns"),xn.P.getSingleton().register("afterHideColumns"),xn.P.getSingleton().register("beforeUnhideColumns"),xn.P.getSingleton().register("afterUnhideColumns");const aE="hiddenColumns",lE=310;var Kh=new WeakMap,jg=new WeakSet;class bI extends jr.vq{constructor(){super(...arguments),SI(this,jg),_I(this,Kh,null)}static get PLUGIN_KEY(){return aE}static get PLUGIN_PRIORITY(){return lE}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[aE]}enablePlugin(){var e=this;this.enabled||(oE(Kh,this,new iE.o),Df(Kh,this).addLocalHook("init",()=>Ad(jg,this,hE).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Df(Kh,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Ad(jg,e,RI).call(e,...r)}),this.addHook("afterGetCellMeta",(t,r,s)=>Ad(jg,this,EI).call(this,t,r,s)),this.addHook("modifyColWidth",(t,r)=>Ad(jg,this,uE).call(this,t,r),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Ad(jg,e,cE).call(e,...r)}),this.addHook("modifyCopyableRange",t=>Ad(jg,this,Iw).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let s=t;const l=Df(Kh,this).getValues().slice(),g=e.length>0;if(r&&g){const M=e.map(P=>this.hot.toPhysicalColumn(P));(0,W.arrayEach)(M,P=>{l[P]=!1}),s=(0,W.arrayReduce)(l,(P,j,oe)=>(j&&P.push(this.hot.toVisualColumn(oe)),P),[])}this.hot.runHooks("beforeUnhideColumns",t,s,r&&g)!==!1&&(r&&g&&Df(Kh,this).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,r&&g,r&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{(0,W.arrayEach)(e,g=>{Df(Kh,this).setValueAtIndex(this.hot.toPhysicalColumn(g),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,r,r&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return(0,W.arrayMap)(Df(Kh,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Df(Kh,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){(0,W.arrayEach)(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){oE(Kh,this,null),super.destroy()}}function uE(n,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function EI(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const r=t.className.split(" ");if(r.length>0){const s=r.indexOf("afterHiddenColumn");s>-1&&r.splice(s,1),t.className=r.join(" ")}}}function Iw(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(r,s,l,g)=>{e.push({startRow:r,endRow:s,startCol:l,endCol:g})};return(0,W.arrayEach)(n,r=>{let s=!0,l=0;(0,Rn.rangeEach)(r.startCol,r.endCol,g=>{this.isHidden(g)?(s||t(r.startRow,r.endRow,l,g-1),s=!0):(s&&(l=g),g===r.endCol&&t(r.startRow,r.endRow,l,g),s=!1)})}),e}function cE(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),(0,N.addClass)(e,t)}function RI(n){n.items.push({name:ii},rE(this),eS(this))}function hE(){const n=this.getSetting("columns");Array.isArray(n)&&this.hideColumns(n)}function TI(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,s]=e;r-s!==0&&(t=1)}return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),l=[];for(let M=r;M<=s;M+=1)l.push(M);n.hideRows(l);const g=l[l.length-1],S=this.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0);Number.isInteger(S)&&S>=0?this.selectRows(S):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function dE(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var t,r;if(e.length===0)return;let s=e[0],l=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,l=(r=this.rowIndexMapper.getNearestNotHiddenIndex(l+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),l-s+1===this.countRows()||this.selectRows(s,l)},disabled:!1,hidden(){const t=(0,W.arrayMap)(n.getHiddenRows(),oe=>this.toPhysicalRow(oe));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),s=r.getTopStartCorner().row,l=r.getBottomEndCorner().row,g=this.rowIndexMapper,S=g.getRenderableFromVisualIndex(s),M=g.getRenderableFromVisualIndex(l),P=g.getNotTrimmedIndexes(),j=[];if(s!==l){const oe=l-s+1,ye=M-S+1;if(oe>ye){const xe=P.slice(s,l+1);j.push(...xe.filter(Ze=>t.includes(Ze)))}}else if(S===0&&S<s)j.push(...P.slice(0,s));else if(S===null)j.push(...P.slice(0,this.countRows()));else{const oe=this.countRows()-1,ye=g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(oe,-1));M===ye&&oe>l&&j.push(...P.slice(l+1))}return(0,W.arrayEach)(j,oe=>{e.push(this.toVisualRow(oe))}),e.length===0}}}function MI(n,e){tS(n,e),e.add(n)}function OI(n,e,t){tS(n,e),e.set(n,t)}function tS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ug(n,e){return n.get(Nd(n,e))}function fE(n,e,t){return n.set(Nd(n,e),t),t}function Nd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeHideRows"),xn.P.getSingleton().register("afterHideRows"),xn.P.getSingleton().register("beforeUnhideRows"),xn.P.getSingleton().register("afterUnhideRows");const gE="hiddenRows",II=320;var nh=new WeakMap,zg=new WeakSet;class PI extends jr.vq{constructor(){super(...arguments),MI(this,zg),OI(this,nh,null)}static get PLUGIN_KEY(){return gE}static get PLUGIN_PRIORITY(){return II}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[gE]}enablePlugin(){var e=this;this.enabled||(fE(nh,this,new iE.o),Ug(nh,this).addLocalHook("init",()=>Nd(zg,this,vE).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ug(nh,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Nd(zg,e,NI).call(e,...r)}),this.addHook("afterGetCellMeta",(t,r,s)=>Nd(zg,this,mE).call(this,t,r,s)),this.addHook("modifyRowHeight",(t,r)=>Nd(zg,this,xI).call(this,t,r)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Nd(zg,e,pE).call(e,...r)}),this.addHook("modifyCopyableRange",t=>Nd(zg,this,AI).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let s=t;const l=Ug(nh,this).getValues().slice(),g=e.length>0;if(r&&g){const M=e.map(P=>this.hot.toPhysicalRow(P));(0,W.arrayEach)(M,P=>{l[P]=!1}),s=(0,W.arrayReduce)(l,(P,j,oe)=>(j&&P.push(this.hot.toVisualRow(oe)),P),[])}this.hot.runHooks("beforeUnhideRows",t,s,r&&g)!==!1&&(r&&g&&Ug(nh,this).setValues(l),this.hot.runHooks("afterUnhideRows",t,s,r&&g,r&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{(0,W.arrayEach)(e,g=>{Ug(nh,this).setValueAtIndex(this.hot.toPhysicalRow(g),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,r,r&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return(0,W.arrayMap)(Ug(nh,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ug(nh,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){(0,W.arrayEach)(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){fE(nh,this,null),super.destroy()}}function xI(n,e){return this.isHidden(e)?0:n}function mE(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const r=t.className.split(" ");if(r.length>0){const s=r.indexOf("afterHiddenRow");s>-1&&r.splice(s,1),t.className=r.join(" ")}}}function AI(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(r,s,l,g)=>{e.push({startRow:r,endRow:s,startCol:l,endCol:g})};return(0,W.arrayEach)(n,r=>{let s=!0,l=0;(0,Rn.rangeEach)(r.startRow,r.endRow,g=>{this.isHidden(g)?(s||t(l,g-1,r.startCol,r.endCol),s=!0):(s&&(l=g),g===r.endRow&&t(l,g,r.startCol,r.endCol),s=!1)})}),e}function pE(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),(0,N.addClass)(e,t)}function NI(n){n.items.push({name:ii},TI(this),dE(this))}function vE(){const n=this.getSetting("rows");Array.isArray(n)&&this.hideRows(n)}function DI(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function HI(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function LI(n,e){CE(n,e),e.add(n)}function FI(n,e,t){CE(n,e),e.set(n,t)}function CE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pw(n,e){return n.get(wv(n,e))}function nS(n,e,t){return n.set(wv(n,e),t),t}function wv(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeColumnFreeze"),xn.P.getSingleton().register("afterColumnFreeze"),xn.P.getSingleton().register("beforeColumnUnfreeze"),xn.P.getSingleton().register("afterColumnUnfreeze");const wE="manualColumnFreeze",yE=110;var Kg=new WeakMap,yv=new WeakSet;class WI extends jr.vq{constructor(){super(...arguments),LI(this,yv),FI(this,Kg,!1)}static get PLUGIN_KEY(){return wE}static get PLUGIN_PRIORITY(){return yE}isEnabled(){return!!this.hot.getSettings()[wE]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>wv(yv,this,SE).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>wv(yv,this,BI).call(this,e,t)),super.enablePlugin())}disablePlugin(){nS(Kg,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;Pw(Kg,this)||nS(Kg,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;Pw(Kg,this)||nS(Kg,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function SE(n){n.items.push({name:"---------"},DI(this),HI(this))}function BI(n,e){if(Pw(Kg,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(r=>r<t))return!1}}function Sv(n,e,t){return(e=kI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kI(n){var e=_E(n,"string");return typeof e=="symbol"?e:e+""}function _E(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const rS=0,iS=1,bE=2,ip="px";class EE{constructor(e){Sv(this,"hot",void 0),Sv(this,"_element",null),Sv(this,"state",rS),Sv(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=bE}build(){this.state===rS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iS)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=rS}isAppended(){return this.state===bE}isBuilt(){return this.state>=iS}setPosition(e,t){(0,Rn.isNumeric)(e)&&(this._element.style.top=e+ip),(0,Rn.isNumeric)(t)&&(this._element.style[this.inlineProperty]=t+ip)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){(0,Rn.isNumeric)(e)&&(this._element.style.width=e+ip),(0,Rn.isNumeric)(t)&&(this._element.style.height=t+ip)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){(0,Rn.isNumeric)(e)&&(this._element.style.marginTop=e+ip),(0,Rn.isNumeric)(t)&&(this._element.style[`margin${(0,V.toUpperCaseFirst)(this.inlineProperty)}`]=t+ip)}getOffset(){const e=this._element.style,t=`margin${(0,V.toUpperCaseFirst)(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}var RE=EE;const VI="ht__manualColumnMove--backlight";class TE extends RE{build(){super.build(),(0,N.addClass)(this._element,VI)}}var jI=TE;const xw="ht__manualColumnMove--guideline";class UI extends RE{build(){super.build(),(0,N.addClass)(this._element,xw)}}var ME=UI;function zI(n,e){OE(n,e),e.add(n)}function bc(n,e,t){OE(n,e),e.set(n,t)}function OE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(n,e,t){return n.set(Hf(n,e),t),t}function Zn(n,e){return n.get(Hf(n,e))}function Hf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeColumnMove"),xn.P.getSingleton().register("afterColumnMove");const Aw="manualColumnMove",KI=120,sS="ht__manualColumnMove",Nw="show-ui",Dw="on-moving--columns",oS="after-selection--columns";var vl=new WeakMap,Lf=new WeakMap,Yh=new WeakMap,Hw=new WeakMap,Dd=new WeakMap,zl=new WeakMap,_v=new WeakMap,Ec=new WeakMap,Yg=new WeakMap,Lw=new WeakMap,Gg=new WeakMap,$g=new WeakSet;class IE extends jr.vq{constructor(){super(...arguments),zI(this,$g),bc(this,vl,new jI(this.hot)),bc(this,Lf,new ME(this.hot)),bc(this,Yh,[]),bc(this,Hw,0),bc(this,Dd,!1),bc(this,zl,{}),bc(this,_v,void 0),bc(this,Ec,void 0),bc(this,Yg,void 0),bc(this,Lw,void 0),bc(this,Gg,void 0)}static get PLUGIN_KEY(){return Aw}static get PLUGIN_PRIORITY(){return KI}isEnabled(){return!!this.hot.getSettings()[Aw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Hf($g,e,YI).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Hf($g,e,sp).call(e,...r)}),this.addHook("afterScrollVertically",()=>Hf($g,this,XI).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Hf($g,e,ZI).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),(0,N.addClass)(this.hot.rootElement,sS),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,N.removeClass)(this.hot.rootElement,sS),this.unregisterEvents(),Zn(vl,this).destroy(),Zn(Lf,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=Zn(_v,this),s=this.isMovePossible(e,t),l=this.hot.runHooks("beforeColumnMove",e,t,r,s);if(pl(_v,this,void 0),l===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,t);const g=s&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,s,g),g}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return pl(_v,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>r,l=t<0,g=e.some(M=>M<0),S=e.some(M=>M>=r);return!(s||l||g||S)}isColumnOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}countFinalIndex(e,t){const r=(0,W.arrayReduce)(e,(s,l)=>(l<t&&(s+=1),s),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let s=0;for(let l=e;l<=t;l+=1){const g=r.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:g!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(g)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Aw];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return(0,Rn.rangeEach)(e,t,s=>{r.push(s)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Zn(Ec,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let l=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Zn(Ec,this)-1);const g=t.hider.offsetWidth,S=t.TBODY.offsetLeft,M=Zn(vl,this).getOffset().start,P=Zn(vl,this).getSize().width;let j=0,oe=0;if(this.hot.isRtl()){const Ze=this.hot.rootWindow,Ct=(0,N.outerWidth)(this.hot.rootElement),ot=Ze.innerWidth-Zn(Yg,this)-Ct;oe=Ze.innerWidth-Zn(zl,this).eventPageX-ot-(r.scrollX===void 0?s:0)}else oe=Zn(zl,this).eventPageX-(Zn(Yg,this)-(r.scrollX===void 0?s:0));if(Zn(Lw,this)&&(j=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Zn(Ec,this))&&(l+=s),l+=j,Zn(Ec,this)<0)Zn(Gg,this)>0?Zn(zl,this).col=0:Zn(zl,this).col=e>0?e-1:e;else if(Zn(zl,this).TD.offsetWidth/2+l<=oe){const Ze=Zn(Ec,this)>=Zn(Hw,this)?Zn(Hw,this)-1:Zn(Ec,this);Zn(zl,this).col=Ze+1,l+=Zn(zl,this).TD.offsetWidth}else Zn(zl,this).col=Zn(Ec,this);let ye=oe,xe=l;oe+P+M>=g?ye=g-P-M:oe+M<S+j&&(ye=S+j+Math.abs(M)),l>=g-1?xe=g-1:xe===0?xe=1:r.scrollX!==void 0&&Zn(Ec,this)<Zn(Gg,this)&&(xe-=Zn(Yg,this)<=r.scrollX?Zn(Yg,this):0),Zn(vl,this).setPosition(null,ye),Zn(Lf,this).setPosition(null,xe)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Hf($g,this,GI).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Hf($g,this,$I).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Zn(vl,this).build(),Zn(Lf,this).build()}destroy(){Zn(vl,this).destroy(),Zn(Lf,this).destroy(),super.destroy()}}function YI(n,e,t,r){const s=this.hot.view._wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),g=this.hot.getSelectedRangeLast(),S=(0,N.hasClass)(n.target,"sortAction");if(!g||!l||Zn(Dd,this)||n.button!==0||S){pl(Dd,this,!1),Zn(Yh,this).length=0,(0,N.removeClass)(this.hot.rootElement,[Dw,Nw]);return}const M=Zn(Lf,this).isBuilt()&&!Zn(Lf,this).isAppended(),P=Zn(vl,this).isBuilt()&&!Zn(vl,this).isAppended();M&&P&&(Zn(Lf,this).appendTo(s.hider),Zn(vl,this).appendTo(s.hider));const{from:j,to:oe}=g,ye=Math.min(j.col,oe.col),xe=Math.max(j.col,oe.col);if(e.row<0&&e.col>=ye&&e.col<=xe){r.column=!0,pl(Dd,this,!0);const Ze=t.firstChild?(0,ce.offsetRelativeTo)(n,t.firstChild).x:n.offsetX;Zn(zl,this).eventPageX=n.pageX,pl(Ec,this,e.col),Zn(zl,this).TD=t,Zn(zl,this).col=e.col,pl(Yh,this,this.prepareColumnsToMoving(ye,xe)),pl(Lw,this,!!this.hot.getSettings().rowHeaders),pl(Hw,this,this.hot.countCols()),pl(Gg,this,this.hot.getSettings().fixedColumnsStart),pl(Yg,this,(0,N.offset)(this.hot.rootElement).left);const Ct=Zn(Lw,this)?-1:0,ot=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,Jt=e.col<Zn(Gg,this),Pt=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),Un=Math.abs(Ze-(this.hot.isRtl()?t.offsetWidth:0)),gr=this.getColumnsWidth(ye,e.col-1)+Un,jn=this.getColumnsWidth(Ct,ye-1)+(Jt?Pt:0)+gr;Zn(vl,this).setPosition(ot,jn),Zn(vl,this).setSize(this.getColumnsWidth(ye,xe),s.hider.offsetHeight-ot),Zn(vl,this).setOffset(null,-gr),(0,N.addClass)(this.hot.rootElement,Dw)}else(0,N.removeClass)(this.hot.rootElement,oS),pl(Dd,this,!1),Zn(Yh,this).length=0}function GI(n){Zn(Dd,this)&&(Zn(zl,this).eventPageX=n.pageX,this.refreshPositions())}function sp(n,e,t,r){!this.hot.getSelectedRangeLast()||!Zn(Dd,this)||(Zn(Yh,this).indexOf(e.col)>-1?(0,N.removeClass)(this.hot.rootElement,Nw):(0,N.addClass)(this.hot.rootElement,Nw),r.row=!0,r.column=!0,r.cell=!0,pl(Ec,this,e.col),Zn(zl,this).TD=t)}function $I(){const n=Zn(zl,this).col,e=Zn(Yh,this).length;if(pl(Ec,this,void 0),pl(Dd,this,!1),(0,N.removeClass)(this.hot.rootElement,[Dw,Nw,oS]),this.hot.selection.isSelectedByColumnHeader()&&(0,N.addClass)(this.hot.rootElement,oS),e<1||n===void 0)return;const t=Zn(Yh,this)[0],r=this.hot.toPhysicalColumn(t),s=this.dragColumns(Zn(Yh,this),n);if(Zn(Yh,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const l=this.hot.toVisualColumn(r),g=l+e-1;this.hot.selectColumns(l,g)}}function XI(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,r=e+t;Zn(vl,this).setPosition(r),Zn(vl,this).setSize(null,n.hider.offsetHeight-r)}function ZI(){this.moveBySettingsOrLoad()}function JI(n,e){PE(n,e),e.add(n)}function Fa(n,e,t){PE(n,e),e.set(n,t)}function PE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function so(n,e,t){return n.set(Wu(n,e),t),t}function Bn(n,e){return n.get(Wu(n,e))}function Wu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Fw="manualColumnResize",xE=130,AE="manualColumnWidths";var Gh=new WeakMap,Ww=new WeakMap,du=new WeakMap,Bw=new WeakMap,Rc=new WeakMap,QI=new WeakMap,op=new WeakMap,kw=new WeakMap,fu=new WeakMap,Hd=new WeakMap,Xg=new WeakMap,bv=new WeakMap,Ev=new WeakMap,Ld=new WeakMap,Bu=new WeakMap,ap=new WeakMap,$h=new WeakSet;class aS extends jr.vq{static get PLUGIN_KEY(){return Fw}static get PLUGIN_PRIORITY(){return xE}constructor(e){super(e),JI(this,$h),Fa(this,Gh,null),Fa(this,Ww,null),Fa(this,du,[]),Fa(this,Bw,null),Fa(this,Rc,null),Fa(this,QI,null),Fa(this,op,null),Fa(this,kw,null),Fa(this,fu,this.hot.rootDocument.createElement("DIV")),Fa(this,Hd,this.hot.rootDocument.createElement("DIV")),Fa(this,Xg,null),Fa(this,bv,!1),Fa(this,Ev,0),Fa(this,Ld,null),Fa(this,Bu,void 0),Fa(this,ap,void 0),(0,N.addClass)(Bn(fu,this),"manualColumnResizer"),(0,N.addClass)(Bn(Hd,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Fw]}enablePlugin(){var e=this;this.enabled||(so(Bu,this,new Ka.L),Bn(Bu,this).addLocalHook("init",()=>Wu($h,this,qI).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Bn(Bu,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wu($h,e,rP).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wu($h,e,HE).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wu($h,e,iP).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){so(ap,this,Bn(Bu,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",AE,Bn(Bu,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",AE,e),e.value}setManualSize(e,t){const r=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return Bn(Bu,this).setValueAtIndex(s,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);Bn(Bu,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;so(Gh,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(Bn(Gh,this)),s=r.col;if(s<0)return;const l=(0,N.outerHeight)(Bn(Gh,this)),g=Bn(Gh,this).getBoundingClientRect(),S=s<t.getSetting("fixedColumnsStart");let M;S&&(M=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Bn(Gh,this),r.row,r.col)),M||(M=t.wtOverlays.topOverlay.getRelativeCellPosition(Bn(Gh,this),r.row,r.col)),so(Ww,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),so(du,this,[]);const P=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&P){const j=this.hot.getSelectedRange();(0,W.arrayEach)(j,oe=>{const ye=oe.getTopStartCorner().col,xe=oe.getBottomEndCorner().col;(0,Rn.rangeEach)(ye,xe,Ze=>{Bn(du,this).includes(Ze)||Bn(du,this).push(Ze)})})}Bn(du,this).includes(Bn(Ww,this))||so(du,this,[Bn(Ww,this)]),so(kw,this,M.start-6),so(op,this,parseInt(g.width,10)),Bn(fu,this).style.top=`${M.top}px`,Bn(fu,this).style[this.inlineDir]=`${Bn(kw,this)+Bn(op,this)}px`,Bn(fu,this).style.height=`${l}px`,this.hot.rootElement.appendChild(Bn(fu,this))}refreshHandlePosition(){Bn(fu,this).style[this.inlineDir]=`${Bn(kw,this)+Bn(Bw,this)}px`}setupGuidePosition(){const e=parseInt((0,N.outerHeight)(Bn(fu,this)),10),t=parseInt(Bn(fu,this).style.top,10)+e,r=this.hot.view.getTableHeight();(0,N.addClass)(Bn(fu,this),"active"),(0,N.addClass)(Bn(Hd,this),"active"),Bn(Hd,this).style.top=`${t}px`,this.refreshGuidePosition(),Bn(Hd,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(Bn(Hd,this))}refreshGuidePosition(){Bn(Hd,this).style[this.inlineDir]=Bn(fu,this).style[this.inlineDir]}hideHandleAndGuide(){(0,N.removeClass)(Bn(fu,this),"active"),(0,N.removeClass)(Bn(Hd,this),"active")}checkIfColumnHeader(e){const t=(0,N.closest)(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(r,s)=>{const l=this.hot.runHooks("beforeColumnResize",Bn(Rc,this),r,!0);l!==void 0&&so(Rc,this,l),this.setManualSize(r,Bn(Rc,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Bn(Rc,this),r,!0),s&&e()};Bn(Ev,this)>=2&&(Bn(du,this).length>1?((0,W.arrayEach)(Bn(du,this),s=>{t(s)}),e()):(0,W.arrayEach)(Bn(du,this),s=>{t(s,!0)})),so(Ev,this,0),so(Ld,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>Wu($h,this,NE).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>Wu($h,this,eP).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Wu($h,this,DE).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Wu($h,this,tP).call(this)),this.eventManager.addEventListener(Bn(fu,this),"contextmenu",()=>Wu($h,this,nP).call(this))}destroy(){super.destroy()}}function qI(){const n=this.hot.getSettings()[Fw],e=this.loadManualColumnWidths();typeof e!="undefined"?this.hot.batchExecution(()=>{e.forEach((t,r)=>{Bn(Bu,this).setValueAtIndex(r,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,r)=>{Bn(Bu,this).setValueAtIndex(r,t)})},!0),so(ap,this,n)):n===!0&&Array.isArray(Bn(ap,this))&&this.hot.batchExecution(()=>{Bn(ap,this).forEach((t,r)=>{Bn(Bu,this).setValueAtIndex(r,t)})},!0)}function NE(n){if(!(0,N.isDetached)(n.target)&&Bn(bv,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(Bn(Xg,this)||this.setupHandlePosition(e))}}function eP(n){n.target.parentNode===this.hot.rootElement&&(0,N.hasClass)(n.target,"manualColumnResizer")&&(this.setupHandlePosition(Bn(Gh,this)),this.setupGuidePosition(),so(Xg,this,!0),Bn(Ld,this)===null&&(so(Ld,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Bn(Ld,this))),so(Ev,this,Bn(Ev,this)+1),this.startX=n.pageX,so(Rc,this,Bn(op,this)))}function DE(n){if(Bn(Xg,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();so(Bw,this,Bn(op,this)+e),(0,W.arrayEach)(Bn(du,this),t=>{so(Rc,this,this.setManualSize(t,Bn(Bw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function tP(){const n=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeColumnResize",Bn(Rc,this),t,!1),r&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Bn(Rc,this),t,!1)};Bn(Xg,this)&&(this.hideHandleAndGuide(),so(Xg,this,!1),Bn(Rc,this)!==Bn(op,this)&&(Bn(du,this).length>1?((0,W.arrayEach)(Bn(du,this),r=>{e(r)}),n()):(0,W.arrayEach)(Bn(du,this),r=>{e(r,!0)})),this.setupHandlePosition(Bn(Gh,this)))}function nP(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Bn(fu,this)),this.hot.rootElement.removeChild(Bn(Hd,this)),so(Xg,this,!1),so(bv,this,!0),this.hot._registerImmediate(()=>{so(bv,this,!1)})}function rP(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalColumn(e),s=Bn(Bu,this).getValueAtIndex(r);this.hot.getSettings()[Fw]&&s&&(t=s)}return t}function HE(n,e){const t=Bn(Bu,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof t=="number"?t:n}function iP(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function lS(n,e,t){return(e=sP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sP(n){var e=LE(n,"string");return typeof e=="symbol"?e:e+""}function LE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const uS=0,cS=1,FE=2,Ff="px";class oP{constructor(e){lS(this,"hot",void 0),lS(this,"_element",null),lS(this,"state",uS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=FE}build(){this.state===uS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=cS)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uS}isAppended(){return this.state===FE}isBuilt(){return this.state>=cS}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Ff),t!==void 0&&(this._element.style.left=t+Ff)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Ff),t&&(this._element.style.height=t+Ff)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Ff),t&&(this._element.style.marginLeft=t+Ff)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var hS=oP;const aP="ht__manualRowMove--backlight";class lP extends hS{build(){super.build(),(0,N.addClass)(this._element,aP)}}var uP=lP;const cP="ht__manualRowMove--guideline";class WE extends hS{build(){super.build(),(0,N.addClass)(this._element,cP)}}var hP=WE;function BE(n,e){dS(n,e),e.add(n)}function lp(n,e,t){dS(n,e),e.set(n,t)}function dS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zg(n,e,t){return n.set(Wf(n,e),t),t}function Gr(n,e){return n.get(Wf(n,e))}function Wf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeRowMove"),xn.P.getSingleton().register("afterRowMove");const Rv="manualRowMove",dP=140,kE="ht__manualRowMove",Tv="show-ui",fS="on-moving--rows",gS="after-selection--rows";var Kl=new WeakMap,Bf=new WeakMap,Fd=new WeakMap,kf=new WeakMap,Cl=new WeakMap,up=new WeakMap,Jg=new WeakSet;class VE extends jr.vq{constructor(){super(...arguments),BE(this,Jg),lp(this,Kl,new uP(this.hot)),lp(this,Bf,new hP(this.hot)),lp(this,Fd,[]),lp(this,kf,void 0),lp(this,Cl,{}),lp(this,up,void 0)}static get PLUGIN_KEY(){return Rv}static get PLUGIN_PRIORITY(){return dP}isEnabled(){return!!this.hot.getSettings()[Rv]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wf(Jg,e,jE).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wf(Jg,e,fP).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Wf(Jg,this,KE).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Wf(Jg,e,gP).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),(0,N.addClass)(this.hot.rootElement,kE),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,N.removeClass)(this.hot.rootElement,kE),this.unregisterEvents(),Gr(Kl,this).destroy(),Gr(Bf,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=Gr(up,this),s=this.isMovePossible(e,t),l=this.hot.runHooks("beforeRowMove",e,t,r,s);if(Zg(up,this,void 0),l===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,t);const g=s&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,s,g),g}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return Zg(up,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>r,l=t<0,g=e.some(M=>M<0),S=e.some(M=>M>=r);return!(s||l||g||S)}isRowOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}countFinalIndex(e,t){const r=(0,W.arrayReduce)(e,(s,l)=>(l<t&&(s+=1),s),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let s=0;for(let l=e;l<=t;l++){const g=r.getRenderableFromVisualIndex(l);g!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(g)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Rv];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:s}=e,l=Math.min(r.row,s.row),g=Math.max(r.row,s.row);return(0,Rn.rangeEach)(l,g,S=>{t.push(S)}),t}refreshPositions(){const e=Gr(Cl,this).coords,t=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const l=this.hot.view._wt.wtTable,g=Gr(Cl,this).TD,S=this.hot.rootElement,M=(0,N.offset)(S),P=(0,N.getTrimmingContainer)(S),j=l.holder.scrollTop,oe=this.hot.rootWindow!==P?P.scrollTop:0,ye=M.top-oe,xe=Gr(Cl,this).eventPageY-ye+j,Ze=l.hider.offsetHeight,Ct=l.TBODY.offsetTop,ot=Gr(Kl,this).getOffset().top,Jt=Gr(Kl,this).getSize().height,Pt=g.offsetHeight/2,Un=g.offsetHeight;let gr=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const jn=xe>=gr+Pt;this.isFixedRowTop(e.row)&&(gr+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Gr(Cl,this).row=t>0?t-1:t:jn?(Gr(Cl,this).row=e.row+1,gr+=e.row===0?Un-1:Un):Gr(Cl,this).row=e.row;let Kt=xe,Yt=gr;xe+Jt+ot>=Ze?Kt=Ze-Jt-ot:xe+ot<Ct&&(Kt=Ct+Math.abs(ot)),gr>=Ze-1&&(Yt=Ze-1),Gr(Kl,this).setPosition(Kt),Gr(Bf,this).setPosition(Yt)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Wf(Jg,this,UE).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Wf(Jg,this,zE).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Gr(Kl,this).build(),Gr(Bf,this).build()}destroy(){Gr(Kl,this).destroy(),Gr(Bf,this).destroy(),super.destroy()}}function jE(n,e,t,r){const{wtTable:s,wtViewport:l}=this.hot.view._wt,g=this.hot.selection.isSelectedByRowHeader(),S=this.hot.getSelectedRangeLast();if(!S||!g||Gr(kf,this)||n.button!==0){Zg(kf,this,!1),Gr(Fd,this).length=0,(0,N.removeClass)(this.hot.rootElement,[fS,Tv]);return}const M=Gr(Bf,this).isBuilt()&&!Gr(Bf,this).isAppended(),P=Gr(Kl,this).isBuilt()&&!Gr(Kl,this).isAppended();M&&P&&(Gr(Bf,this).appendTo(s.hider),Gr(Kl,this).appendTo(s.hider));const{from:j,to:oe}=S,ye=Math.min(j.row,oe.row),xe=Math.max(j.row,oe.row);if(e.col<0&&e.row>=ye&&e.row<=xe){r.row=!0,Zg(kf,this,!0),Gr(Cl,this).eventPageY=n.pageY,Gr(Cl,this).coords=e,Gr(Cl,this).TD=t,Zg(Fd,this,this.prepareRowsToMoving());const Ze=s.holder.scrollLeft+l.getRowHeaderWidth(),Ct=this.getRowsHeight(ye,e.row-1)+(n.clientY-t.getBoundingClientRect().top);Gr(Kl,this).setPosition(null,Ze),Gr(Kl,this).setSize(s.hider.offsetWidth-Ze,this.getRowsHeight(ye,xe)),Gr(Kl,this).setOffset(-Ct,null),(0,N.addClass)(this.hot.rootElement,fS),this.refreshPositions()}else(0,N.removeClass)(this.hot.rootElement,gS),Zg(kf,this,!1),Gr(Fd,this).length=0}function UE(n){Gr(kf,this)&&(Gr(Cl,this).eventPageY=n.pageY,this.refreshPositions())}function fP(n,e,t,r){!this.hot.getSelectedRangeLast()||!Gr(kf,this)||(Gr(Fd,this).indexOf(e.row)>-1?(0,N.removeClass)(this.hot.rootElement,Tv):(0,N.addClass)(this.hot.rootElement,Tv),r.row=!0,r.column=!0,r.cell=!0,Gr(Cl,this).coords=e,Gr(Cl,this).TD=t)}function zE(){const n=Gr(Cl,this).row,e=Gr(Fd,this).length;if(Zg(kf,this,!1),(0,N.removeClass)(this.hot.rootElement,[fS,Tv,gS]),this.hot.selection.isSelectedByRowHeader()&&(0,N.addClass)(this.hot.rootElement,gS),e<1||n===void 0)return;const t=Gr(Fd,this)[0],r=this.hot.toPhysicalRow(t),s=this.dragRows(Gr(Fd,this),n);if(Gr(Fd,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const l=this.hot.toVisualRow(r),g=l+e-1;this.hot.selectRows(l,g)}}function KE(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,r=e+t;Gr(Kl,this).setPosition(null,r),Gr(Kl,this).setSize(n.hider.offsetWidth-r)}function gP(){this.moveBySettingsOrLoad()}function mP(n,e){mS(n,e),e.add(n)}function wl(n,e,t){mS(n,e),e.set(n,t)}function mS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Co(n,e,t){return n.set(Wd(n,e),t),t}function Fn(n,e){return n.get(Wd(n,e))}function Wd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Bd="manualRowResize",pP=30,YE="manualRowHeights";var ku=new WeakMap,Vw=new WeakMap,Vu=new WeakMap,Mv=new WeakMap,kd=new WeakMap,pS=new WeakMap,Qg=new WeakMap,jw=new WeakMap,yl=new WeakMap,Xh=new WeakMap,qg=new WeakMap,Uw=new WeakMap,cp=new WeakMap,Ov=new WeakMap,ju=new WeakMap,em=new WeakMap,Vf=new WeakSet;class vS extends jr.vq{static get PLUGIN_KEY(){return Bd}static get PLUGIN_PRIORITY(){return pP}constructor(e){super(e),mP(this,Vf),wl(this,ku,null),wl(this,Vw,null),wl(this,Vu,[]),wl(this,Mv,null),wl(this,kd,null),wl(this,pS,null),wl(this,Qg,null),wl(this,jw,null),wl(this,yl,this.hot.rootDocument.createElement("DIV")),wl(this,Xh,this.hot.rootDocument.createElement("DIV")),wl(this,qg,!1),wl(this,Uw,!1),wl(this,cp,0),wl(this,Ov,null),wl(this,ju,void 0),wl(this,em,void 0),(0,N.addClass)(Fn(yl,this),"manualRowResizer"),(0,N.addClass)(Fn(Xh,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Bd]}enablePlugin(){this.enabled||(Co(ju,this,new Ka.L),Fn(ju,this).addLocalHook("init",()=>Wd(Vf,this,XE).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Fn(ju,this)),this.addHook("modifyRowHeight",(e,t)=>Wd(Vf,this,yP).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Co(em,this,Fn(ju,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",YE,Fn(ju,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",YE,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),s=Math.max(t,this.hot.view.getDefaultRowHeight());return Fn(ju,this).setValueAtIndex(r,s),s}getLastDesiredRowHeight(){return Fn(Mv,this)}setupHandlePosition(e){Co(ku,this,e);const{view:t}=this.hot,{_wt:r}=t,s=r.wtTable.getCoords(Fn(ku,this)),l=s.row;if(l<0)return;const g=(0,N.outerWidth)(Fn(ku,this)),S=Fn(ku,this).getBoundingClientRect(),M=l<r.getSetting("fixedRowsTop"),P=l>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let j;M?j=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Fn(ku,this),s.row,s.col):P&&(j=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Fn(ku,this),s.row,s.col)),j||(j=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Fn(ku,this),s.row,s.col)),Co(Vw,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(l)),Co(Vu,this,[]);const oe=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&oe){const ye=this.hot.getSelectedRange();(0,W.arrayEach)(ye,xe=>{const Ze=xe.getTopStartCorner().row,Ct=xe.getBottomStartCorner().row;(0,Rn.rangeEach)(Ze,Ct,ot=>{Fn(Vu,this).includes(ot)||Fn(Vu,this).push(ot)})})}Fn(Vu,this).includes(Fn(Vw,this))||Co(Vu,this,[Fn(Vw,this)]),Co(jw,this,j.top-6),Co(Qg,this,parseInt(S.height,10)),Fn(yl,this).style.top=`${Fn(jw,this)+Fn(Qg,this)}px`,Fn(yl,this).style[this.inlineDir]=`${j.start}px`,Fn(yl,this).style.width=`${g}px`,this.hot.rootElement.appendChild(Fn(yl,this))}refreshHandlePosition(){Fn(yl,this).style.top=`${Fn(jw,this)+Fn(Mv,this)}px`}setupGuidePosition(){const e=parseInt((0,N.outerWidth)(Fn(yl,this)),10),t=parseInt(Fn(yl,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();(0,N.addClass)(Fn(yl,this),"active"),(0,N.addClass)(Fn(Xh,this),"active"),Fn(Xh,this).style.top=Fn(yl,this).style.top,Fn(Xh,this).style[this.inlineDir]=`${t}px`,Fn(Xh,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(Fn(Xh,this))}refreshGuidePosition(){Fn(Xh,this).style.top=Fn(yl,this).style.top}hideHandleAndGuide(){(0,N.removeClass)(Fn(yl,this),"active"),(0,N.removeClass)(Fn(Xh,this),"active")}checkIfRowHeader(e){const t=(0,N.closest)(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:l}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,s.clone.wtTable.TBODY,l.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&Fn(kd,this)<t?t:Fn(kd,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(r,s)=>{const l=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);l!==void 0&&Co(kd,this,l),this.setManualSize(r,Fn(kd,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),s&&e()};Fn(cp,this)>=2&&(Fn(Vu,this).length>1?((0,W.arrayEach)(Fn(Vu,this),s=>{t(s)}),e()):(0,W.arrayEach)(Fn(Vu,this),s=>{t(s,!0)})),Co(cp,this,0),Co(Ov,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Wd(Vf,this,GE).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Wd(Vf,this,vP).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>Wd(Vf,this,$E).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>Wd(Vf,this,CP).call(this)),this.eventManager.addEventListener(Fn(yl,this),"contextmenu",()=>Wd(Vf,this,wP).call(this))}destroy(){super.destroy()}}function GE(n){if(!(0,N.isDetached)(n.target)&&Fn(Uw,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(Fn(qg,this)||this.setupHandlePosition(e))}}function vP(n){(0,N.hasClass)(n.target,"manualRowResizer")&&(this.setupHandlePosition(Fn(ku,this)),this.setupGuidePosition(),Co(qg,this,!0),Fn(Ov,this)===null&&(Co(Ov,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Fn(Ov,this))),Co(cp,this,Fn(cp,this)+1),Co(pS,this,n.pageY),Co(kd,this,Fn(Qg,this)))}function $E(n){Fn(qg,this)&&(Co(Mv,this,Fn(Qg,this)+(n.pageY-Fn(pS,this))),(0,W.arrayEach)(Fn(Vu,this),e=>{Co(kd,this,this.setManualSize(e,Fn(Mv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function CP(){const n=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};Fn(qg,this)&&(this.hideHandleAndGuide(),Co(qg,this,!1),Fn(kd,this)!==Fn(Qg,this)&&(Fn(Vu,this).length>1?((0,W.arrayEach)(Fn(Vu,this),r=>{e(r)}),n()):(0,W.arrayEach)(Fn(Vu,this),r=>{e(r,!0)})),this.setupHandlePosition(Fn(ku,this)))}function wP(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Fn(yl,this)),this.hot.rootElement.removeChild(Fn(Xh,this)),Co(qg,this,!1),Co(Uw,this,!0),this.hot._registerImmediate(()=>{Co(Uw,this,!1)})}function yP(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalRow(e),s=Fn(ju,this).getValueAtIndex(r);this.hot.getSettings()[Bd]&&s&&(t=s)}return t}function XE(){const n=this.hot.getSettings()[Bd],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e!="undefined"?e.forEach((t,r)=>{Fn(ju,this).setValueAtIndex(r,t)}):Array.isArray(n)?(n.forEach((t,r)=>{Fn(ju,this).setValueAtIndex(r,t)}),Co(em,this,n)):n===!0&&Array.isArray(Fn(em,this))&&Fn(em,this).forEach((t,r)=>{Fn(ju,this).setValueAtIndex(r,t)})},!0)}var e1=f(25372),ZE=f(30834);function SP(n,e,t){JE(n,e),e.set(n,t)}function JE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tm(n,e,t){return(e=_P(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _P(n){var e=bP(n,"string");return typeof e=="symbol"?e:e+""}function bP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CS(n,e){return n.get(Kw(n,e))}function zw(n,e,t){return n.set(Kw(n,e),t),t}function Kw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var nm=new WeakMap;class wS{constructor(e,t,r,s,l,g){tm(this,"row",void 0),tm(this,"col",void 0),tm(this,"rowspan",void 0),tm(this,"colspan",void 0),tm(this,"removed",!1),tm(this,"cellCoordsFactory",void 0),tm(this,"cellRangeFactory",void 0),SP(this,nm,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=s,this.cellCoordsFactory=l,this.cellRangeFactory=g}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:s,colspan:l}=e;return(0,Nn.e)`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${s}, colspan: ${l}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return(0,Nn.e)`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return(0,Nn.e)`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return(0,Nn.e)`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:s,colspan:l}=e;return t<0||r<0||s<0||l<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),zw(nm,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,l=e[0]?"colspan":"rowspan",g=e[0]?"col":"row",S=Math.min(t,s),M=Math.max(t,s),P=this[g],j=this[g]+this[l]-1;if(P>=t&&(this[g]+=r),r>0)t<=j&&t>P&&(this[l]+=r);else if(r<0){if(S<=P&&M>=j)return this.removed=!0,zw(nm,this,null),!1;if(P>=S&&P<=M){const oe=M-P+1,ye=Math.abs(r)-oe;this[g]-=ye+r,this[l]-=oe}else if(P<=S&&j>=M)this[l]+=r;else if(P<=S&&j>=S&&j<M){const oe=j-S+1;this[l]-=oe}}return zw(nm,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return CS(nm,this)||zw(nm,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),CS(nm,this)}}var Zh=wS;function QE(n,e){EP(n,e),e.add(n)}function EP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iv(n,e,t){return(e=RP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RP(n){var e=qE(n,"string");return typeof e=="symbol"?e:e+""}function qE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var jf=new WeakSet;class Yw{constructor(e){QE(this,jf),Iv(this,"plugin",void 0),Iv(this,"mergedCells",[]),Iv(this,"mergedCellsMatrix",new Map),Iv(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return(0,Nn.e)`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(t))!==null&&r!==void 0?r:!1}getByRange(e){const{row:t,col:r}=e.getTopStartCorner(),{row:s,col:l}=e.getBottomEndCorner(),g=this.mergedCells.length;let S=!1;for(let M=0;M<g;M++){const P=this.mergedCells[M],{row:j,col:oe,rowspan:ye,colspan:xe}=P;if(j>=t&&j+ye-1<=s&&oe>=r&&oe+xe-1<=l){S=P;break}}return S}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(s=>{const{row:l,col:g,colspan:S,rowspan:M}=s;for(let P=l;P<l+M;P++)for(let j=g;j<g+S;j++)t.add(`r${P},c${j}`)}),e.filter(s=>{const{row:l,col:g,colspan:S,rowspan:M}=s,P=new Set;let j=!1;for(let oe=l;oe<l+M;oe++){for(let ye=g;ye<g+S;ye++){const xe=`r${oe},c${ye}`;if(t.has(xe)){(0,v.ZK)(Yw.IS_OVERLAPPING_WARNING(s)),j=!0;break}P.add(xe)}if(j)break}return j||t.add(...P),!j})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:s}=e.getTopStartCorner(),{row:l,col:g}=e.getBottomEndCorner(),S=[];for(let M=r;M<=l;M++)for(let P=s;P<=g;P++){const j=this.get(M,P);j&&(t||!t&&j.row===M&&j.col===P)&&S.push(j)}return S}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,s=e.col,l=e.rowspan,g=e.colspan,S=new Zh(r,s,l,g,this.hot._createCellCoords,this.hot._createCellRange),M=this.get(r,s),P=t?!1:this.isOverlapping(S);return!M&&!P?(this.hot&&S.normalize(this.hot),this.mergedCells.push(S),rm(jf,this,eR).call(this,S),S):(P&&(0,v.ZK)(Yw.IS_OVERLAPPING_WARNING(S)),!1)}remove(e,t){const r=this.get(e,t),s=r?this.mergedCells.indexOf(r):-1;return r&&s!==-1?(this.mergedCells.splice(s,1),rm(jf,this,tR).call(this,r),r):!1}clear(){(0,W.arrayEach)(this.mergedCells,e=>{let{row:t,col:r,rowspan:s,colspan:l}=e;(0,Rn.rangeEach)(t,t+s,g=>{(0,Rn.rangeEach)(r,r+l,S=>{const M=this.hot.getCell(g,S);M&&(M.removeAttribute("rowspan"),M.removeAttribute("colspan"),M.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);if(!r)return!1;const{row:s,col:l,rowspan:g,colspan:S}=r,M=this.hot.view.getActiveOverlayName(),P=["top","top_inline_start_corner"].includes(M)?0:this.hot.getFirstRenderedVisibleRow(),j=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(M)?0:this.hot.getFirstRenderedVisibleColumn(),oe=(0,Rn.clamp)(P,s,s+g-1),ye=(0,Rn.clamp)(j,l,l+S-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(oe,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(ye,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(s,l)}getStartMostColumnIndex(e,t){const r=rm(jf,this,Pv).call(this,e,"col",-1);let s=t;for(let l=0;l<r.length;l++)if(r[l]<=t){s=r[l];break}return s}getEndMostColumnIndex(e,t){const r=rm(jf,this,Pv).call(this,e,"col",1);let s=t;for(let l=0;l<r.length;l++)if(r[l]>=t){s=r[l];break}return s}getTopMostRowIndex(e,t){const r=rm(jf,this,Pv).call(this,e,"row",-1);let s=t;for(let l=0;l<r.length;l++)if(r[l]<=t){s=r[l];break}return s}getBottomMostRowIndex(e,t){const r=rm(jf,this,Pv).call(this,e,"row",1);let s=t;for(let l=0;l<r.length;l++)if(r[l]>=t){s=r[l];break}return s}shiftCollections(e,t,r){const s=[0,0];switch(e){case"right":s[0]+=r;break;case"left":s[0]-=r;break;case"down":s[1]+=r;break;case"up":s[1]-=r;break;default:}const l=[];this.mergedCells.forEach(g=>{g.shift(s,t),g.removed&&l.push(g)}),l.forEach(g=>{this.mergedCells.splice(this.mergedCells.indexOf(g),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(g=>{rm(jf,this,eR).call(this,g)})}}function Pv(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,s=t===1?n.getTopStartCorner():n.getBottomEndCorner(),l=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let g=s.row;t===1?g<=l.row:g>=l.row;g+=t)for(let S=s.col;t===1?S<=l.col:S>=l.col;S+=t){const M=e==="row"?g:S,P=this.get(g,S);let j=M;P&&(j=t===1?P[e]+P[`${e}span`]-1:P[e]),r.has(M)||r.set(M,new Set),r.get(M).add(j)}return Array.from(new Set(Array.from(r.entries()).filter(g=>{let[,S]=g;return S.size===1}).flatMap(g=>{let[,S]=g;return Array.from(S)})))}function eR(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function tR(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}var TP=Yw;function yS(n,e,t){return(e=MP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MP(n){var e=SS(n,"string");return typeof e=="symbol"?e:e+""}function SS(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OP{constructor(e){yS(this,"plugin",void 0),yS(this,"mergedCellsCollection",void 0),yS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,s){const l=t.slice(0),g=this.getAutofillSize(e,t,r),[S,M,P,j]=e,ye=["up","down"].indexOf(r)>-1?P-S+1:j-M+1,xe=Math.floor(g/ye)*ye,Ze=g-xe,Ct=this.getFarthestCollection(e,t,r,s);if(Ct){if(r==="down"){const ot=Ct.row+Ct.rowspan-S-Ze;l[2]+ot>=this.plugin.hot.countRows()?l[2]-=Ze:l[2]+=Ze?ot:0}else if(r==="right"){const ot=Ct.col+Ct.colspan-M-Ze;l[3]+ot>=this.plugin.hot.countCols()?l[3]-=Ze:l[3]+=Ze?ot:0}else if(r==="up"){const ot=P-Ze-Ct.row+1;l[0]+ot<0?l[0]+=Ze:l[0]-=Ze?ot:0}else if(r==="left"){const ot=j-Ze-Ct.col+1;l[1]+ot<0?l[1]+=Ze:l[1]-=Ze?ot:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:s,fillSize:g,dragArea:l,cycleLength:ye}),l}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),(0,Y.extend)(this.currentFillData,e)}getAutofillSize(e,t,r){const[s,l,g,S]=e,[M,P,j,oe]=t;switch(r){case"up":return s-M;case"down":return j-g;case"left":return l-P;case"right":return oe-S;default:return null}}getDragArea(e,t,r){const[s,l,g,S]=e,[M,P,j,oe]=t;switch(r){case"up":return[M,P,s-1,S];case"down":{const ye=this.mergedCellsCollection.get(j,S),xe=ye?ye.rowspan-1:0;return[g+1,l,j+xe,S]}case"left":return[M,P,g,l-1];case"right":{const ye=this.mergedCellsCollection.get(j,S),xe=ye?ye.colspan-1:0;return[s,S+xe,j,oe]}default:return null}}getFarthestCollection(e,t,r,s){const[l,g,S,M]=e,P=["up","down"].indexOf(r)>-1,j=P?S:M,oe=P?l:g,ye=this.getAutofillSize(e,t,r),xe=P?S-l+1:M-g+1,Ze=Math.floor(ye/xe)*xe,Ct=ye-Ze;let ot=null,Jt=null,Pt=null;switch(r){case"up":ot="includesVertically",Pt=j-Ct+1;break;case"left":ot="includesHorizontally",Pt=j-Ct+1;break;case"down":ot="includesVertically",Pt=oe+Ct-1;break;case"right":ot="includesHorizontally",Pt=oe+Ct-1;break;default:}return(0,W.arrayEach)(s,Un=>{Un[ot](Pt)&&Un.isFarther(Jt,r)&&(Jt=Un)}),Jt}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,l=(P,j)=>{switch(s){case"up":return P.row-j>=t.from.row;case"down":return P.row+P.rowspan-1+j<=t.to.row;case"left":return P.col-j>=t.from.column;case"right":return P.col+P.colspan-1+j<=t.to.column;default:return null}};let g=0,S=null,M=1;do for(let P=0;P<r.length;P+=1){if(S=r[P],g=M*this.currentFillData.cycleLength,l(S,g))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:S.row-g,rowspan:S.rowspan,col:S.col,colspan:S.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:S.row+g,rowspan:S.rowspan,col:S.col,colspan:S.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:S.row,rowspan:S.rowspan,col:S.col-g,colspan:S.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:S.row,rowspan:S.rowspan,col:S.col+g,colspan:S.colspan},!0);break;default:}P===r.length-1&&(M+=1)}while(l(S,g));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return(0,W.arrayEach)(e,s=>{const l=s[0],g=this.plugin.hot.propToCol(s[1]);(t.min===null||l<t.min)&&(t.min=l),(t.max===null||l>t.max)&&(t.max=l),(r.min===null||g<r.min)&&(r.min=g),(r.max===null||g>r.max)&&(r.max=g)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const s=this.getDragArea(e,t,r),[l,g,S,M]=s,P=this.plugin.hot._createCellCoords(l,g),j=this.plugin.hot._createCellCoords(S,M),oe=this.plugin.hot._createCellRange(P,P,j);if(this.mergedCellsCollection.getWithinRange(oe,!0).length===0)return!1;const xe=this.mergedCellsCollection.getWithinRange(oe,!1);return xe.length===0?!0:r==="up"||r==="down"?!xe.every(Ze=>{let{colspan:Ct}=Ze;return Ct===oe.getWidth()}):!xe.every(Ze=>{let{rowspan:Ct}=Ze;return Ct===oe.getHeight()})}}var IP=OP;function _S(n,e,t){return(e=PP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PP(n){var e=nR(n,"string");return typeof e=="symbol"?e:e+""}function nR(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xP{constructor(e){_S(this,"plugin",void 0),_S(this,"hot",void 0),_S(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,s){const l=Math.min(r[0],r[2]),g=Math.min(r[1],r[3]),S=Math.max(r[0],r[2]),M=Math.max(r[1],r[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const j=this.plugin.mergedCellsCollection.get(e,t);if(!j)return;const oe=j.getLastRow(),ye=j.getLastColumn();if(l<=j.row&&g<=j.col&&S>=oe&&M>=ye)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(j,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let l=0;l<e.colspan;l+=1)r.push(this.hot._createCellCoords(e.row+s,e.col+l));for(let s=0;s<r.length;s+=1){const l=[];for(let g=0;g<t.length;g+=1)l[g]=t[g].includes(r[s]);if(!l.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}var AP=xP;function NP(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Zh.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function xv(n,e,t){return(e=DP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DP(n){var e=rR(n,"string");return typeof e=="symbol"?e:e+""}function rR(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iR{constructor(e){xv(this,"data",void 0),xv(this,"next",null),xv(this,"prev",null),this.data=e}}class sR{constructor(){xv(this,"first",null),xv(this,"last",null)}push(e){const t=new iR(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new iR(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,s;for(;t;){if(t.data===e)return r=t.next,s=t.prev,r&&(r.prev=s),s&&(s.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=s),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,s){s&&(e(s,s.next),s.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}var Gw=sR;function oR(n,e){aR(n,e),e.add(n)}function im(n,e,t){aR(n,e),e.set(n,t)}function aR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(n,e){return n.get(Av(n,e))}function Uu(n,e,t){return n.set(Av(n,e),t),t}function Av(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Jh=new WeakMap,rh=new WeakMap,Qh=new WeakMap,qh=new WeakMap,bS=new WeakMap,Nv=new WeakMap,$w=new WeakMap,Xw=new WeakSet;class HP{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:s}=e;oR(this,Xw),im(this,Jh,new Gw),im(this,rh,new Gw),im(this,Qh,null),im(this,qh,null),im(this,bS,null),im(this,Nv,null),im(this,$w,null),Uu(bS,this,t),Uu(Nv,this,r),Uu($w,this,s)}getCurrentVerticalNode(){return Zi(qh,this).data}getFirstVerticalNode(){return Zi(rh,this).first.data}getNextVerticalNode(){return Zi(qh,this).next.data}getPrevVerticalNode(){return Zi(qh,this).prev.data}getCurrentHorizontalNode(){return Zi(Qh,this).data}getFirstHorizontalNode(){return Zi(Jh,this).first.data}getNextHorizontalNode(){return Zi(Qh,this).next.data}getPrevHorizontalNode(){return Zi(Qh,this).prev.data}setPrevNodeAsActive(){Uu(qh,this,Zi(qh,this).prev),Uu(Qh,this,Zi(Qh,this).prev)}setNextNodeAsActive(){Uu(qh,this,Zi(qh,this).next),Uu(Qh,this,Zi(Qh,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),s=new WeakSet;Uu(Jh,this,new Gw);for(let g=t.row;g<=r.row;g++)if(!Zi(Nv,this).isHidden(g))for(let S=t.col;S<=r.col;S++){if(Zi($w,this).isHidden(S))continue;const M=Av(Xw,this,ES).call(this,e,Zi(Jh,this),s,g,S);M&&Uu(Qh,this,M)}Zi(Jh,this).first&&(Zi(Jh,this).first.prev=Zi(Jh,this).last,Zi(Jh,this).last.next=Zi(Jh,this).first);const l=new WeakSet;Uu(rh,this,new Gw);for(let g=t.col;g<=r.col;g++)if(!Zi($w,this).isHidden(g))for(let S=t.row;S<=r.row;S++){if(Zi(Nv,this).isHidden(S))continue;const M=Av(Xw,this,ES).call(this,e,Zi(rh,this),l,S,g);M&&Uu(qh,this,M)}Zi(rh,this).first&&(Zi(rh,this).first.prev=Zi(rh,this).last,Zi(rh,this).last.next=Zi(rh,this).first)}setActiveNode(e,t){return Zi(Jh,this).inorder(r=>{const{rowStart:s,rowEnd:l,colStart:g,colEnd:S}=r.data;if(e>=s&&e<=l&&t>=g&&t<=S)return Uu(Qh,this,r),!1}),Zi(rh,this).inorder(r=>{const{rowStart:s,rowEnd:l,colStart:g,colEnd:S}=r.data;if(e>=s&&e<=l&&t>=g&&t<=S)return Uu(qh,this,r),!1}),this}}function ES(n,e,t,r,s){const l=n.getTopStartCorner(),g=n.getBottomEndCorner(),S=n.highlight.clone().normalize(),M=Zi(bS,this).call(this,r,s);if(M&&t.has(M))return null;const P={colStart:s,colEnd:s,rowStart:r,rowEnd:r};if(M){if(t.add(M),M.row<l.row||M.row+M.rowspan-1>g.row||M.col<l.col||M.col+M.colspan-1>g.col)return null;P.colStart=M.col,P.colEnd=M.col+M.colspan-1,P.rowStart=M.row,P.rowEnd=M.row+M.rowspan-1}const j=e.push(P);return r===S.row&&s===S.col||M&&S.row>=M.row&&S.row<=M.row+M.rowspan-1&&S.col>=M.col&&S.col<=M.col+M.colspan-1?j:null}function lR(n,e,t){const{view:r,rowIndexMapper:s}=n,l=r.getStylesHandler(),g=r.getDefaultRowHeight();let S=0;for(let P=e;P<e+t;P++)if(!s.isHidden(P)){var M;S+=(M=n.getRowHeight(P))!==null&&M!==void 0?M:g,P===0&&!l.isClassicTheme()&&(S+=1)}return S}function uR(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:r}=e,s=new Map;function l(){}function g(S,M,P){const j=n.mergedCellsCollection.get(M,P);if(!(0,Y.isObject)(j)){S.removeAttribute("rowspan"),S.removeAttribute("colspan"),(0,en.isSafari)()&&s.has(M)&&!e.getSettings().rowHeaders&&(S.style.height=`${s.get(M)}px`,s.delete(M)),S.style.display="";return}const{row:oe,col:ye,colspan:xe,rowspan:Ze}=j,[Ct,ot]=n.translateMergedCellToRenderable(oe,Ze,ye,xe),Jt=n.getSetting("virtualized");if((0,en.isSafari)()&&ye===0&&!e.getSettings().rowHeaders){const gn=lR(e,oe,Ze);s.set(M,gn/Ze)}const Pt=t.getRenderableFromVisualIndex(M),Un=r.getRenderableFromVisualIndex(P),gr=Ct-Pt+1,jn=ot-Un+1;let Kt=t.getNearestNotHiddenIndex(oe,1),Yt=r.getNearestNotHiddenIndex(ye,1);if(Jt){const gn=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(gn)||(Kt=Math.max(Kt,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(gn)||(Yt=Math.max(Yt,e.getFirstRenderedVisibleColumn()))}const Sr=Math.min(Ze,gr),oi=Math.min(xe,jn);Kt===M&&Yt===P?(S.setAttribute("rowspan",Sr),S.setAttribute("colspan",oi)):(S.removeAttribute("rowspan"),S.removeAttribute("colspan"),S.style.display="none")}return{before:l,after:g}}function LP(n,e){cR(n,e),e.add(n)}function Dv(n,e,t){cR(n,e),e.set(n,t)}function cR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(n,e,t){return(e=hR(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hR(n){var e=FP(n,"string");return typeof e=="symbol"?e:e+""}function FP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hp(n,e,t){return n.set(hs(n,e),t),t}function Fs(n,e){return n.get(hs(n,e))}function hs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}xn.P.getSingleton().register("beforeMergeCells"),xn.P.getSingleton().register("afterMergeCells"),xn.P.getSingleton().register("beforeUnmergeCells"),xn.P.getSingleton().register("afterUnmergeCells");const TS="mergeCells",Zw=150,dR=TS;var zu=new WeakMap,Tc=new WeakMap,ih=new WeakMap,fR=new WeakMap,Es=new WeakSet;class WP extends jr.vq{constructor(){super(...arguments),LP(this,Es),RS(this,"mergedCellsCollection",null),RS(this,"autofillCalculations",null),RS(this,"selectionCalculations",null),Dv(this,zu,null),Dv(this,Tc,{row:0,col:0}),Dv(this,ih,new HP({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Dv(this,fR,uR(this))}static get PLUGIN_KEY(){return TS}static get PLUGIN_PRIORITY(){return Zw}static get DEFAULT_SETTINGS(){return{[jr.Ur]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[TS]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new TP(this),this.autofillCalculations=new IP(this),this.selectionCalculations=new AP(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,gR).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,Jw).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,kP).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,VP).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,jP).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,MS).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,MS).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,zP).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,pR).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,KP).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,mR).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,mR).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,BP).call(e,...r)}),this.addHook("afterRenderer",function(){return Fs(fR,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,UP).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,vR).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,YP).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,GP).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,$P).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,XP).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,ZP).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,CR).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,JP).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,QP).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,qP).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,wR).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,ex).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,yR).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return hs(Es,e,tx).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,en.isChrome)())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:s,rowspan:l}=r;for(let g=s+1;g<s+l;g++)t.push(g)}),t=[...new Set(t)],t.forEach(r=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(l=>(l==null?void 0:l.name)==="master"?l:l.clone.wtTable).forEach(l=>{const g=l.getRow(s);g&&(g.style.background=(0,N.getStyle)(g,"backgroundColor").replace(")",", 0.99)"),e.push(g))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var s;r.style.background=(s=(0,N.getStyle)(r,"backgroundColor"))===null||s===void 0?void 0:s.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Zh.containsNegativeValues(e)?((0,v.ZK)(Zh.NEGATIVE_VALUES_WARNING(e)),!1):Zh.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?((0,v.ZK)(Zh.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Zh.isSingleCell(e)?((0,v.ZK)(Zh.IS_SINGLE_CELL(e)),!1):Zh.containsZeroSpan(e)?((0,v.ZK)(Zh.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];t.forEach(s=>{const{row:l,col:g,rowspan:S,colspan:M}=s,P=this.hot._createCellCoords(l,g),j=this.hot._createCellCoords(l+S-1,g+M-1),oe=this.hot._createCellRange(P,P,j);this.mergeRange(oe,!0,!0);for(let ye=l;ye<l+S;ye++)for(let xe=g;xe<g+M;xe++)(ye!==l||xe!==g)&&r.push([ye,xe,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),l=e.getBottomEndCorner(),g={row:s.row,col:s.col,rowspan:l.row-s.row+1,colspan:l.col-s.col+1},S=[];let M=null;return this.canMergeRange(g,t)?(this.hot.runHooks("beforeMergeCells",e,t),(0,Rn.rangeEach)(0,g.rowspan-1,j=>{(0,Rn.rangeEach)(0,g.colspan-1,oe=>{let ye=null;S[j]||(S[j]=[]),j===0&&oe===0?ye=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(g.row),this.hot.toPhysicalColumn(g.col)):this.hot.setCellMeta(g.row+j,g.col+oe,"hidden",!0),S[j][oe]=ye})}),this.hot.setCellMeta(g.row,g.col,"spanned",!0),this.mergedCellsCollection.add(g,t)?(r?M=[g.row,g.col,S]:this.hot.populateFromArray(g.row,g.col,S,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,g,t),M):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),(0,W.arrayEach)(r,s=>{this.mergedCellsCollection.remove(s.row,s.col),(0,Rn.rangeEach)(0,s.rowspan-1,l=>{(0,Rn.rangeEach)(0,s.colspan-1,g=>{this.hot.removeCellMeta(s.row+l,s.col+g,"hidden"),this.hot.removeCellMeta(s.row+l,s.col+g,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const{from:t,to:r}=e.clone().normalize(),s=this.mergedCellsCollection.get(t.row,t.col);s.row===t.row&&s.col===t.col&&s.row+s.rowspan-1===r.row&&s.col+s.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,s){const l=this.hot._createCellCoords(e,t),g=this.hot._createCellCoords(r,s);this.mergeRange(this.hot._createCellRange(l,l,g))}unmerge(e,t,r,s){const l=this.hot._createCellCoords(e,t),g=this.hot._createCellCoords(r,s);this.unmergeRange(this.hot._createCellRange(l,l,g))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:dR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dR)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,s=r.getVisualFromRenderableIndex(e.startRow);for(let l=0;l<t;l+=1){const g=this.mergedCellsCollection.get(s,l);if((0,Y.isObject)(g)){const S=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(g.row,1));if(S<e.startRow){e.startRow=S,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,s=r.getVisualFromRenderableIndex(e.endRow);for(let l=0;l<t;l+=1){const g=this.mergedCellsCollection.get(s,l);if((0,Y.isObject)(g)){const S=g.row+g.rowspan-1,M=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(S,-1));if(M>e.endRow){e.endRow=M,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,s=r.getVisualFromRenderableIndex(e.startColumn);for(let l=0;l<t;l+=1){const g=this.mergedCellsCollection.get(l,s);if((0,Y.isObject)(g)){const S=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(g.col,1));if(S<e.startColumn){e.startColumn=S,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,s=r.getVisualFromRenderableIndex(e.endColumn);for(let l=0;l<t;l+=1){const g=this.mergedCellsCollection.get(l,s);if((0,Y.isObject)(g)){const S=g.col+g.colspan-1,M=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(S,-1));if(M>e.endColumn){e.endColumn=M,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,s){const{rowIndexMapper:l,columnIndexMapper:g}=this.hot;let S,M;t===0?S=l.getNearestNotHiddenIndex(e,1):S=l.getNearestNotHiddenIndex(e+t-1,-1),s===0?M=g.getNearestNotHiddenIndex(r,1):M=g.getNearestNotHiddenIndex(r+s-1,-1);const P=e>=0?l.getRenderableFromVisualIndex(S):e,j=r>=0?g.getRenderableFromVisualIndex(M):r;return[P,j]}}function gR(){this.generateFromSettings(),this.hot.render()}function BP(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner(),s=t.getBottomEndCorner();for(let l=0;l<e.length;l+=1)if(r.row===e[l].row&&r.col===e[l].col&&s.row===e[l].row+e[l].rowspan-1&&s.col===e[l].col+e[l].colspan-1)return!1}return n}function Jw(n){Fs(Tc,this).row=n.row,Fs(Tc,this).col=n.col}function kP(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:r,rowIndexMapper:s}=this.hot;Fs(zu,this)&&(s.getRenderableFromVisualIndex(Fs(zu,this).row)!==null&&(t.row=Fs(zu,this).row),r.getRenderableFromVisualIndex(Fs(zu,this).col)!==null&&(t.col=Fs(zu,this).col),hp(zu,this,null));const l=this.mergedCellsCollection.get(t.row,t.col);if(!l)return;const g=l.col,S=l.col+l.colspan-1;if(n.col<0){const j=t.col>=g&&t.col<=S?g-1:S,oe=r.getNearestNotHiddenIndex(j,-1);oe===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(oe,t.col)-1,1)}else if(n.col>0){const j=t.col>=g&&t.col<=S?S+1:g,oe=r.getNearestNotHiddenIndex(j,1);oe===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,oe)-1,1)}const M=l.row,P=l.row+l.rowspan-1;if(n.row<0){const j=t.row>=M&&t.row<=P?M-1:P,oe=s.getNearestNotHiddenIndex(j,-1);oe===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(oe,t.row)-1,1)}else if(n.row>0){const j=t.row>=M&&t.row<=P?P+1:M,oe=s.getNearestNotHiddenIndex(j,1);oe===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,oe)-1,1)}}function VP(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:r}=e,{columnIndexMapper:s,rowIndexMapper:l}=this.hot,g=(S,M)=>{t.expand(this.hot._createCellCoords(S,M));for(let P=0;P<this.mergedCellsCollection.mergedCells.length;P+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[P].getRange())};if(n.col<0){let S=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+n.col;g(r.row,S),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(S=t.getTopStartCorner().col);const M=s.getNearestNotHiddenIndex(S,1);M!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(M,r.col)-1,1))}else if(n.col>0){let S=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+n.col;g(r.row,S),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(S=t.getBottomEndCorner().col);const M=s.getNearestNotHiddenIndex(S,-1);M!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,M)-1,1))}if(n.row<0){let S=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+n.row;g(S,r.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(S=t.getTopStartCorner().row);const M=l.getNearestNotHiddenIndex(S,1);M!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(M,r.row)-1,1))}else if(n.row>0){let S=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+n.row;g(S,r.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(S=t.getBottomStartCorner().row);const M=l.getNearestNotHiddenIndex(S,-1);M!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,M)-1,1))}}function jP(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){hp(zu,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);hp(zu,this,e.clone()),t&&e.assign(t)}function mR(n,e,t,r){if(n<0||e<0)return;const s=this.mergedCellsCollection.get(n,e);if(!s)return;const{row:l,col:g,colspan:S,rowspan:M}=s,P=l,j=g,oe=l+M-1,ye=g+S-1;if(r==="render"&&this.getSetting("virtualized")){const xe=this.hot.view.getActiveOverlayName(),Ze=["top","top_inline_start_corner"].includes(xe)?0:this.hot.getFirstRenderedVisibleRow(),Ct=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(xe)?0:this.hot.getFirstRenderedVisibleColumn();return[(0,Rn.clamp)(Ze,P,oe),(0,Rn.clamp)(Ct,j,ye),(0,Rn.clamp)(this.hot.getLastRenderedVisibleRow(),P,oe),(0,Rn.clamp)(this.hot.getLastRenderedVisibleColumn(),j,ye)]}return[P,j,oe,ye]}function UP(n){n.items.push({name:"---------"},NP(this))}function MS(){hp(zu,this,null)}function zP(){if(Fs(zu,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),r=Fs(zu,this).clone().normalize();Fs(ih,this).setActiveNode(r.row,r.col),Fs(Tc,this).row>0||Fs(Tc,this).col>0?Fs(ih,this).setPrevNodeAsActive():(t==="E-W"&&Fs(Tc,this).col<0||e==="S-N"&&Fs(Tc,this).row<0)&&Fs(ih,this).setNextNodeAsActive()}function pR(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:s}=this.hot;let l=null,g=null;if(Fs(Tc,this).col<0){const{rowEnd:S,colEnd:M}=Fs(ih,this).getPrevHorizontalNode();g=r.getNearestNotHiddenIndex(M,-1),l=s.getNearestNotHiddenIndex(S,-1)}else if(Fs(Tc,this).col>0){const{rowStart:S,colStart:M}=Fs(ih,this).getNextHorizontalNode();g=r.getNearestNotHiddenIndex(M,1),l=s.getNearestNotHiddenIndex(S,1)}else if(Fs(Tc,this).row<0){const{rowEnd:S,colEnd:M}=Fs(ih,this).getPrevVerticalNode();g=r.getNearestNotHiddenIndex(M,-1),l=s.getNearestNotHiddenIndex(S,-1)}else if(Fs(Tc,this).row>0){const{rowStart:S,colStart:M}=Fs(ih,this).getNextVerticalNode();g=r.getNearestNotHiddenIndex(M,1),l=s.getNearestNotHiddenIndex(S,1)}if(l!==null||g!==null){const S=this.hot._createCellCoords(l,g),M=this.mergedCellsCollection.get(S.row,S.col),P=this.hot.selection.highlight.getFocus();n=S.row,e=S.col,M?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(M.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(M.col,1)}):t.highlight.assign(S),P.clear(),P.add(S).commit()}Fs(ih,this).setActiveNode(n,e),hp(Tc,this,{row:0,col:0})}function KP(){this.hot.getSelectedRangeLast().isHeader()||Fs(ih,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function vR(n,e,t){const r=this.mergedCellsCollection.get(n,e);r&&(r.row!==n||r.col!==e?t.copyable=!1:(t.rowspan=r.rowspan,t.colspan=r.colspan))}function YP(n){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function GP(n){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function $P(n,e){const t=this.autofillCalculations.getDirection(e,n);if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,t))return e;const r=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),l=this.hot._createCellRange(r,r,s),g=this.mergedCellsCollection.getWithinRange(l);return g.length===0?n:this.autofillCalculations.snapDragArea(e,n,t,g)}function XP(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function ZP(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function CR(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function JP(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function QP(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function qP(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(t);(0,W.arrayEach)(r,s=>{t.getBottomEndCorner().row===s.getLastRow()&&t.getBottomEndCorner().col===s.getLastColumn()&&(n[2]=s.row,n[3]=s.col)})}}function wR(n,e,t,r){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,r)}function ex(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function yR(n,e,t,r){if(!(r instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getByRange(s);if(!l)return;const g=this.hot._createCellCoords(l.row,l.col),S=this.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(g,g,S))}function tx(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let r,s;if(t==="master")r=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const ye=this.hot.view.getOverlayByName(t);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(ye.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(ye.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return n;const g=this.hot._createCellCoords(e,r),S=this.hot._createCellCoords(e,s),M=this.hot._createCellRange(g,g,S),P=this.mergedCellsCollection.getWithinRange(M,!0),j=P.reduce((ye,xe)=>{let{rowspan:Ze}=xe;return Math.max(ye,Ze)},1);let oe=0;return P.length>1&&P[0].rowspan<j&&(oe=j-P[0].rowspan),P.forEach(ye=>{let{rowspan:xe}=ye,Ze=0;t==="top"||t==="top_inline_start_corner"?Ze=Math.min(j,this.hot.view.countNotHiddenFixedRowsTop()-e):Ze=xe-oe,n=Math.max(n!=null?n:0,lR(this.hot,e,Ze))}),n}function SR(n,e){return function(t,r){const[,...s]=t,[,...l]=r;return function g(S){const M=n[S],P=e[S],j=s[S],oe=l[S],ye=P.multiColumnSorting,Ze=(ye.compareFunctionFactory?ye.compareFunctionFactory:gt(P.type))(M,P,ye)(j,oe);if(Ze===cn){const Ct=S+1;if(typeof e[Ct]!="undefined")return g(Ct)}return Ze}(0)}}const _R="sort";function nx(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${_R}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function rx(n){const e=n.className.split(" "),t=new RegExp(`^${_R}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}function bR(n,e,t){return(e=ix(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ix(n){var e=ER(n,"string");return typeof e=="symbol"?e:e+""}function ER(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Qw="multiColumnSorting",sx=170,RR=Qw;rn(Qw,SR);class ox extends Uc{constructor(){super(...arguments),bR(this,"pluginKey",Qw)}static get PLUGIN_KEY(){return Qw}static get PLUGIN_PRIORITY(){return sx}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,ff)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Z.I,position:"before",group:RR})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RR)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];super.updateHeaderClasses(e,...r),(0,N.removeClass)(e,rx(e)),this.enabled!==!1&&(0,N.addClass)(e,nx(...r))}onAfterOnCellMouseDown(e,t){Vc(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,ff))):this.sort(this.getColumnNextConfig(t.col)))}}function TR(n,e,t){return(e=OS(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OS(n){var e=ax(n,"string");return typeof e=="symbol"?e:e+""}function ax(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const lx="multipleSelectionHandles",ux=160;class qw extends jr.vq{constructor(){super(...arguments),TR(this,"dragged",[]),TR(this,"lastSetCell",null)}static get PLUGIN_KEY(){return lx}static get PLUGIN_PRIORITY(){return ux}isEnabled(){return(0,en.isMobileBrowser)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const l=e.dragged.indexOf(s);if(l===-1)return!1;l===0?e.dragged=e.dragged.slice(0,1):l===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let l;if((0,N.hasClass)(s.target,"topSelectionHandle-HitArea"))return l=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1;if((0,N.hasClass)(s.target,"bottomSelectionHandle-HitArea"))return l=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if((0,N.hasClass)(s.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if((0,N.hasClass)(s.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{const{rootDocument:l}=this.hot;let g,S,M,P,j,oe;if(e.dragged.length===0)return;const ye=l.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!ye||ye===e.lastSetCell||((ye.nodeName==="TD"||ye.nodeName==="TH")&&(g=e.hot.getCoords(ye),g.col===-1&&(g.col=0),S=e.hot.getSelectedRangeLast(),M=S.getWidth(),P=S.getHeight(),j=S.getDirection(),M===1&&P===1&&e.hot.selection.setRangeEnd(g),oe=e.getCurrentRangeCoords(S,g,e.touchStartRange.direction,j,e.dragged[0]),oe.start!==null&&e.hot.selection.setRangeStart(oe.start),e.hot.selection.setRangeEnd(oe.end),e.lastSetCell=ye),s.preventDefault())})}getCurrentRangeCoords(e,t,r,s,l){const g=e.getTopStartCorner(),S=e.getBottomEndCorner(),M=e.getBottomStartCorner(),P=e.getTopEndCorner();let j={start:null,end:null};switch(r){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?j={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(M.row,t.col)}:j={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,g.col)};break;case"SE-NW":l==="bottom"&&(j={start:this.hot._createCellCoords(S.row,t.col),end:this.hot._createCellCoords(t.row,g.col)});break;default:break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?j={start:t,end:M}:j.end=t;break;case"NW-SE":l==="top"?j={start:t,end:S}:j.end=t;break;case"SE-NW":l==="top"?j={start:t,end:g}:j.end=t;break;case"SW-NE":l==="top"?j={start:t,end:P}:j.end=t;break;default:break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?j={start:this.hot._createCellCoords(t.row,g.col),end:this.hot._createCellCoords(M.row,t.col)}:j={start:this.hot._createCellCoords(g.row,t.col),end:this.hot._createCellCoords(t.row,S.col)};break;case"SW-NE":l==="top"?j={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,S.col)}:j={start:this.hot._createCellCoords(t.row,g.col),end:this.hot._createCellCoords(g.row,t.col)};break;case"SE-NW":l==="bottom"?j={start:this.hot._createCellCoords(t.row,P.col),end:this.hot._createCellCoords(g.row,t.col)}:l==="top"&&(j={start:M,end:t});break;default:break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(j.end=t);break;case"SE-NW":l==="top"?j.end=t:j={start:t,end:g};break;default:break}break;default:break}return j}isDragged(){return this.dragged.length>0}}var MR=f(99450);function ey(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:s=[],isCollapsed:l=!1,isHidden:g=!1,isRoot:S=!1,isPlaceholder:M=!1,headerClassNames:P=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:l,crossHiddenColumns:s,isHidden:g,isRoot:S,isPlaceholder:M,headerClassNames:P}}function OR(){return{label:"",isPlaceholder:!0}}function IR(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;(0,W.arrayEach)(n,s=>{const l=[];let g=0;t.push(l),(0,W.arrayEach)(s,S=>{const M=ey();if((0,Y.isObject)(S)){const{label:j,colspan:oe,headerClassName:ye}=S;M.label=(0,I.stringify)(j),typeof oe=="number"&&oe>1&&(M.colspan=oe,M.origColspan=oe),typeof ye=="string"&&(M.headerClassNames=[...ye.split(" ")])}else M.label=(0,I.stringify)(S);g+=M.origColspan;let P=!1;if(g>=e&&(M.colspan=M.origColspan-(g-e),M.origColspan=M.colspan,P=!0),l.push(M),M.colspan>1)for(let j=0;j<M.colspan-1;j++)l.push(OR());return!P})});const r=Math.max(...(0,W.arrayMap)(t,s=>s.length));return(0,W.arrayEach)(t,s=>{if(s.length<r){const l=(0,W.arrayMap)(new Array(r-s.length),()=>ey());s.splice(s.length,0,...l)}}),t}function IS(n,e,t){PR(n,e),e.set(n,t)}function PR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sh(n,e){return n.get(xR(n,e))}function dp(n,e,t){return n.set(xR(n,e),t),t}function xR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PS=["label","collapsible"];var Vd=new WeakMap,Uf=new WeakMap,xS=new WeakMap;class AR{constructor(){IS(this,Vd,[]),IS(this,Uf,0),IS(this,xS,1/0)}setColumnsLimit(e){dp(xS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];dp(Vd,this,IR(e,sh(xS,this))),dp(Uf,this,sh(Vd,this).length)}getData(){return sh(Vd,this)}mergeWith(e){(0,W.arrayEach)(e,t=>{let S=t,{row:r,col:s}=S,l=Xu(S,["row","col"]);const g=this.getHeaderSettings(r,s);g!==null&&(0,Y.extend)(g,l,PS)})}map(e){(0,W.arrayEach)(sh(Vd,this),t=>{(0,W.arrayEach)(t,r=>{const s=e(hi({},r));(0,Y.isObject)(s)&&(0,Y.extend)(r,s,PS)})})}getHeaderSettings(e,t){var r;if(e>=sh(Uf,this)||e<0)return null;const s=sh(Vd,this)[e];return Array.isArray(s)===!1||t>=s.length?null:(r=s[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=sh(Uf,this)||e<0)return s;const l=sh(Vd,this)[e];let g=0;for(let S=t;S<l.length;S++){const M=l[S];if(M.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(g+=M.colspan,s.push(M),M.colspan>1&&(S+=M.colspan-1),g===r)break;if(g>r)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return sh(Uf,this)}getColumnsCount(){return sh(Uf,this)>0?sh(Vd,this)[0].length:0}clear(){dp(Vd,this,[]),dp(Uf,this,0)}}function AS(n,e,t){return(e=NR(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NR(n){var e=cx(n,"string");return typeof e=="symbol"?e:e+""}function cx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const NS="DF-pre-order";function DR(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=DR.call(this.childs[r],n,e)}return t}const hx="DF-post-order";function DS(n,e){for(let t=0;t<this.childs.length;t++)if(DS.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const HR="BF";function dx(n,e){const t=[this];function r(){if(t.length===0)return;const s=t.shift();t.push(...s.childs),n.call(e,s)!==!1&&r()}r()}const fx=HR,HS=new Map([[NS,DR],[hx,DS],[HR,dx]]);class ty{constructor(e){AS(this,"data",{}),AS(this,"parent",null),AS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new ty(hi({},e.data));for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data=hi({},e.data),this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fx;if(!HS.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);HS.get(t).call(this,e,this)}walkUp(e){const t=this,r=s=>{e.call(t,s)!==!1&&s.parent!==null&&r(s.parent)};r(this)}}function ny(n,e,t){gx(n,e),e.set(n,t)}function gx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(n,e){return n.get(LS(n,e))}function mx(n,e,t){return n.set(LS(n,e),t),t}function LS(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var fp=new WeakMap,zf=new WeakMap,gp=new WeakMap;class LR{constructor(e){ny(this,fp,new Map),ny(this,zf,new Map),ny(this,gp,null),mx(gp,this,e)}getRoots(){return Array.from(Sl(fp,this).values())}getRootByColumn(e){let t;return Sl(zf,this).has(e)&&(t=Sl(fp,this).get(Sl(zf,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const s=t-Sl(zf,this).get(t);let l=0,g;return r.walkDown(S=>{const{data:{origColspan:M,headerLevel:P}}=S;if(e===P){if(s>=l&&s<=l+M-1)return g=S,g.data.isRoot=t===g.data.columnIndex,!1;l+=M}}),g}rebuildTreeIndex(){let e=0;Sl(zf,this).clear(),(0,W.arrayEach)(Sl(fp,this),t=>{let[,{data:{colspan:r}}]=t;for(let s=e;s<e+r;s++)Sl(zf,this).set(s,e);e+=r})}buildTree(){this.clear();const e=Sl(gp,this).getColumnsCount();let t=0;for(;t<e;){const r=Sl(gp,this).getHeaderSettings(0,t),s=new ty;Sl(fp,this).set(t,s),this.buildLeaves(s,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const l=Sl(gp,this).getHeadersSettings(r,t,s);r+=1,(0,W.arrayEach)(l,g=>{const S=Gl(hi({},g),{headerLevel:r-1,columnIndex:t});let M;r===1?(e.data=S,M=e):(M=new ty(S),e.addChild(M)),r<Sl(gp,this).getLayersCount()&&this.buildLeaves(M,t,r,g.origColspan),t+=g.origColspan})}clear(){Sl(fp,this).clear(),Sl(zf,this).clear()}}function FR(n,e){n.walkDown(t=>{let{data:r,childs:s}=t;if(!r.isHidden&&(e(r.columnIndex),s.length===0))for(let l=1;l<r.colspan;l++)e(r.columnIndex+l)})}function Hv(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function ry(n){return Hv(n,"origColspan")===n.data.origColspan}function iy(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ry(n))return iy(t[0]);e.isCollapsed=!1;const s=t.slice(1),l=new Set;let g=0;if(s.length>0)(0,W.arrayEach)(s,S=>{S.replaceTreeWith(S.data.clonedTree),S.data.clonedTree=null;const M=S.data;g+=M.colspan,FR(S,P=>{l.add(P)})});else{const{colspan:S,origColspan:M,columnIndex:P}=e;g=M-S;for(let j=1;j<M;j++)l.add(P+j)}return n.walkUp(S=>{const{data:M}=S;M.colspan+=g,M.colspan>=M.origColspan?(M.colspan=M.origColspan,M.isCollapsed=!1):ry(S)&&(M.isCollapsed=Hv(S,"isCollapsed"))}),{rollbackModification:()=>FS(n),affectedColumns:Array.from(l),colspanCompensation:g}}function FS(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ry(n))return FS(r[0]);t.isCollapsed=!0;const l=r.slice(1),g=new Set;if(l.length>0)(0,W.arrayEach)(l,M=>{FR(M,P=>{g.add(P)}),M.data.clonedTree=M.cloneTree(),M.walkDown(P=>{let{data:j}=P;j.isHidden=!0})});else{const{origColspan:M,columnIndex:P}=t;for(let j=1;j<M;j++){const oe=P+j;g.add(oe)}}const S=t.colspan-((e=Hv(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(M=>{const{data:P}=M;P.colspan-=S,P.colspan<=1?(P.colspan=1,P.isCollapsed=!0):ry(M)&&(P.isCollapsed=Hv(M,"isCollapsed"))}),{rollbackModification:()=>iy(n),affectedColumns:Array.from(g),colspanCompensation:S}}function WR(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error((0,Nn.e)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(s=>{const{data:{collapsible:l}}=s;if(l)return r=!0,!1}),!r&&n.walkUp(s=>{const{data:l}=s;l.crossHiddenColumns.push(e),l.colspan>1?l.colspan-=1:l.isHidden=!0})}function px(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error((0,Nn.e)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(s=>{const{data:{collapsible:l}}=s;if(l)return r=!0,!1}),!r&&n.walkUp(s=>{const{data:l}=s;l.crossHiddenColumns.splice(l.crossHiddenColumns.indexOf(e),1),!l.isHidden&&l.colspan<l.origColspan&&(l.colspan+=1),l.isHidden=!1})}const WS=new Map([["collapse",FS],["expand",iy],["hide-column",WR],["show-column",px]]);function vx(n,e,t){if(!WS.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return WS.get(n)(e,t)}function Lv(n){const e=[];return(0,W.arrayEach)(n,t=>{t.walkDown(r=>{const s=r.data,{origColspan:l,columnIndex:g,headerLevel:S,crossHiddenColumns:M}=s,P=BR(e,S);let j=!1;for(let oe=g;oe<g+l;oe++)if(M.includes(oe)||j)P.push(OR(s));else{const xe=Cx(s);xe.isRoot=!0,P.push(xe),j=!0}})}),e}function Cx(n){const r=ey(n),{crossHiddenColumns:e}=r;return Xu(r,["crossHiddenColumns"])}function BR(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function BS(n,e,t){kR(n,e),e.set(n,t)}function kR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fv(n,e,t){return n.set(VR(n,e),t),t}function oo(n,e){return n.get(VR(n,e))}function VR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var oh=new WeakMap,Yl=new WeakMap,sm=new WeakMap;class wx{constructor(){BS(this,oh,new AR),BS(this,Yl,new LR(oo(oh,this))),BS(this,sm,[[]])}setState(e){oo(oh,this).setData(e);let t=!1;try{oo(Yl,this).buildTree()}catch(r){oo(Yl,this).clear(),oo(oh,this).clear(),t=!0}return Fv(sm,this,Lv(oo(Yl,this).getRoots())),t}setColumnsLimit(e){oo(oh,this).setColumnsLimit(e)}mergeStateWith(e){const t=(0,W.arrayMap)(e,r=>{let g=r,{row:s}=g,l=Xu(g,["row"]);return hi({row:s<0?this.rowCoordsToLevel(s):s},l)});oo(oh,this).mergeWith(t),oo(Yl,this).buildTree(),Fv(sm,this,Lv(oo(Yl,this).getRoots()))}mapState(e){oo(oh,this).map(e),oo(Yl,this).buildTree(),Fv(sm,this,Lv(oo(Yl,this).getRoots()))}mapNodes(e){return(0,W.arrayReduce)(oo(Yl,this).getRoots(),(t,r)=>(r.walkDown(s=>{const l=e(s.data);l!==void 0&&t.push(l)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const s=oo(Yl,this).getNode(t,r);let l;return s&&(l=vx(e,s,r),Fv(sm,this,Lv(oo(Yl,this).getRoots()))),l}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(s=oo(sm,this)[e])===null||s===void 0?void 0:s[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?hi({},r.data):null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=oo(Yl,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=t-e+1;let s=!1,l=null;for(let g=e;g<=t;g++){const S=oo(Yl,this).getRootByColumn(g);if(!S)break;s=!0,S.walkDown(M=>{const{columnIndex:P,headerLevel:j,origColspan:oe,isHidden:ye}=M.data;ye||oe<=r&&P>=e&&P+oe-1<=t&&(l===null||j<l)&&(l=j)},NS)}return s&&l===null?-1:this.levelToRowCoords(l!=null?l:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(s)return t;let l=t-1;for(;l>=0;){var g;const{isRoot:S}=(g=this.getHeaderSettings(e,l))!==null&&g!==void 0?g:{isRoot:!0};if(S)break;l-=1}return l}findRightMostColumnIndex(e,t){var r;const{isRoot:s,origColspan:l}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(s)return t+l-1;let g=t+1;for(;g<this.getColumnsCount();){var S;const{isRoot:M}=(S=this.getHeaderSettings(e,g))!==null&&S!==void 0?S:{isRoot:!0};if(M)break;g+=1}return g-1}getLayersCount(){return oo(oh,this).getLayersCount()}getColumnsCount(){return oo(oh,this).getColumnsCount()}clear(){Fv(sm,this,[]),oo(oh,this).clear(),oo(Yl,this).clear()}}function mp(n,e,t){return(e=yx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yx(n){var e=Sx(n,"string");return typeof e=="symbol"?e:e+""}function Sx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _x{constructor(e,t){mp(this,"hot",void 0),mp(this,"nestedHeaderSettingsGetter",void 0),mp(this,"layersCount",0),mp(this,"container",void 0),mp(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),r=t.length;this.widthsMap.clear();for(let s=0;s<r;s++){const l=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),g=this.hot.toPhysicalColumn(l);this.widthsMap.setValueAtIndex(g,t[s].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,s=t.createDocumentFragment(),l=t.createElement("table"),g=!!this.hot.getSettings().dropdownMenu,S=r.getRenderableIndexesLength();for(let M=0;M<this.layersCount;M++){const P=t.createElement("tr");for(let j=0;j<S;j++){let oe=r.getVisualFromRenderableIndex(j);oe===null&&(oe=j);const ye=t.createElement("th"),xe=this.nestedHeaderSettingsGetter(M,oe);if(xe&&(!xe.isPlaceholder||xe.isHidden)){let Ze=xe.label;g&&(Ze+='<button class="changeType"></button>'),(0,N.fastInnerHTML)(ye,Ze),ye.colSpan=xe.colspan,P.appendChild(ye)}}l.appendChild(P)}s.appendChild(l),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}var bx=_x;function jR(n,e){zR(n,e),e.add(n)}function UR(n,e,t){return(e=Ex(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ex(n){var e=Rx(n,"string");return typeof e=="symbol"?e:e+""}function Rx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wv(n,e,t){zR(n,e),e.set(n,t)}function zR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mc(n,e,t){return n.set(wo(n,e),t),t}function wi(n,e){return n.get(wo(n,e))}function wo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const KR="nestedHeaders",Tx=280;var ds=new WeakMap,Kf=new WeakMap,Yf=new WeakMap,sy=new WeakMap,oy=new WeakMap,yo=new WeakSet;class Mx extends jr.vq{constructor(){super(...arguments),jR(this,yo),Wv(this,ds,new wx),Wv(this,Kf,null),Wv(this,Yf,null),Wv(this,sy,!1),Wv(this,oy,null),UR(this,"ghostTable",new bx(this.hot,(e,t)=>this.getHeaderSettings(e,t))),UR(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return KR}static get PLUGIN_PRIORITY(){return Tx}isEnabled(){return!!this.hot.getSettings()[KR]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&(0,v.ZK)((0,Nn.e)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>wo(yo,this,om).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Fx).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Px).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,pp).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,xx).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,kS).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Ax).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Nx).call(e,...s)}),this.addHook("afterSelection",()=>wo(yo,this,Bv).call(this)),this.addHook("afterSelectionFocusSet",()=>wo(yo,this,Bv).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Ox).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",r=>wo(yo,this,Dx).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Hx).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,$R).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Ix).call(e,...s)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,YR).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,GR).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,VS).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return wo(yo,e,Lx).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>wo(yo,this,Bv).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>wo(yo,this,Bv).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();wi(ds,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=wi(ds,this).setState(e)),this.detectedOverlappedHeaders&&(0,v.ZK)((0,Nn.e)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const s=t===!0?"hide-column":"show-column";wi(ds,this).triggerColumnModification(s,r)}),!wi(Kf,this)&&this.enabled&&Mc(Kf,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:s,index:l,newValue:g}=r;if(s==="replace"){const S=g===!0?"hide-column":"show-column";wi(ds,this).triggerColumnModification(S,l)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),wi(ds,this).clear(),wi(Kf,this).unsubscribe(),Mc(Kf,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return wi(ds,this)}getLayersCount(){return wi(ds,this).getLayersCount()}getHeaderSettings(e,t){return wi(ds,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,l=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let g=0;g<t;g++){const S=r.childNodes[g];if(!S)break;const M=s.childNodes[g],P=l?l.childNodes[g]:null;for(let j=0,oe=S.childNodes.length;j<oe;j++)S.childNodes[j].removeAttribute("colspan"),(0,N.removeClass)(S.childNodes[j],"hiddenHeader"),M&&M.childNodes[j]&&(M.childNodes[j].removeAttribute("colspan"),(0,N.removeClass)(M.childNodes[j],"hiddenHeader")),l&&P&&P.childNodes[j]&&(P.childNodes[j].removeAttribute("colspan"),(0,N.removeClass)(P.childNodes[j],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,l)=>{var g;const{columnIndexMapper:S,view:M}=this.hot;let P=S.getVisualFromRenderableIndex(s);P===null&&(P=s),l.removeAttribute("colspan"),(0,N.removeClass)(l,"hiddenHeader"),(0,N.removeClass)(l,"hiddenHeaderText");const{colspan:j,isHidden:oe,isPlaceholder:ye,headerClassNames:xe}=(g=wi(ds,this).getHeaderSettings(e,P))!==null&&g!==void 0?g:{label:""};if(ye||oe)(0,N.addClass)(l,"hiddenHeader");else if(j>1){var Ze,Ct,ot;const{wtOverlays:Jt}=M._wt,Pt=(Ze=Jt.topInlineStartCornerOverlay)===null||Ze===void 0?void 0:Ze.clone.wtTable.THEAD.contains(l),Un=(Ct=Jt.inlineStartOverlay)===null||Ct===void 0?void 0:Ct.clone.wtTable.THEAD.contains(l);((ot=Jt.topOverlay)===null||ot===void 0?void 0:ot.clone.wtTable.THEAD.contains(l))&&P<r&&(0,N.addClass)(l,"hiddenHeaderText");const jn=Pt||Un?Math.min(j,r-s):j;jn>1&&l.setAttribute("colspan",jn)}if(this.hot.view.appendColHeader(P,l,function(){return t.getColumnHeaderValue(...arguments)},e),!ye&&!oe){const Jt=l.querySelector("div.relative");Jt&&xe&&xe.length>0&&((0,N.removeClass)(Jt,this.hot.getColumnMeta(P).headerClassName),(0,N.addClass)(Jt,xe))}}}getColumnHeaderValue(e,t){var r;const{isHidden:s,isPlaceholder:l}=(r=wi(ds,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return l||s?"":this.hot.getColHeader(e,t)}destroy(){Mc(ds,this,null),wi(Kf,this)!==null&&(wi(Kf,this).unsubscribe(),Mc(Kf,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return wi(ds,this).getHeaderTreeNodeData(e.row,e.col)}}function Bv(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const s=wi(ds,this).findLeftMostColumnIndex(t.row,t.col),l=this.hot.selection.highlight.getFocus();l.visualCellRange.highlight.col=s,l.visualCellRange.from.col=s,l.visualCellRange.to.col=s,l.commit()}}function Ox(n,e){var t;const r=this.hot.getSelectedRangeLast();if(!r)return n;const{highlight:s}=r,{navigableHeaders:l}=this.hot.getSettings(),g=this.hot.selection.isSelectedByColumnHeader(),S=l?s.row:(t=wi(oy,this))===null||t===void 0?void 0:t.row,M=g?n:s.col,P=S<0&&M>=0;if(Mc(oy,this,null),!P)return n;const j=this.hot.getFirstFullyVisibleColumn(),oe=this.hot.getLastFullyVisibleColumn(),ye=oe-j+1,xe=wi(ds,this).findLeftMostColumnIndex(S,M),Ze=wi(ds,this).findRightMostColumnIndex(S,M),Ct=Ze-xe+1;if(xe<j&&Ze>oe)return xe;if(g){let ot=null;return xe>=j&&Ze>oe?Ct>ye?(e.value="start",ot=xe):(e.value="end",ot=Ze):xe<j&&Ze<=oe&&(Ct>ye?(e.value="end",ot=Ze):(e.value="start",ot=xe)),ot}return xe<=j?xe:Ze}function Ix(n,e,t){const r=wi(ds,this).getHeaderTreeNodeData(e,n);if(!r)return n;const{columnCursor:s,selectionType:l,selectionWidth:g}=t,{isRoot:S,colspan:M}=wi(ds,this).getHeaderSettings(e,n);if(l===MR.Nc){if(!S)return r.columnIndex}else if(l===MR.CD&&(M>g-s||!S))return null;return n}function YR(n,e,t){let{columnHeadersCount:r}=t;if(r!==0)for(let l=0;l<e.length;l++){const{startRow:g,startCol:S,endRow:M,endCol:P}=e[l],j=M-g+1,oe=S-P+1;if(g>=0||oe===1)break;for(let ye=S;ye<=P;ye++)for(let xe=g;xe<=M;xe++){var s;const Ze=j+xe,Ct=ye-S;if(Ct===0)continue;((s=wi(ds,this).getHeaderTreeNodeData(xe,ye))===null||s===void 0?void 0:s.isRoot)===!1&&(n[Ze][Ct]="")}}}function Px(n,e,t,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function pp(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;Mc(Yf,this,e.clone()),Mc(sy,this,!0);const{selection:r}=this.hot,s=r.isSelected()?r.getSelectedRange().current():null,l=[],{columnIndex:g,origColspan:S}=t,M=!r.inInSelection(e);n.shiftKey&&s?e.col<s.from.col?l.push(s.getTopEndCorner().col,g,e.row):e.col>s.from.col?l.push(s.getTopStartCorner().col,g+S-1,e.row):l.push(g,g+S-1,e.row):((0,ce.isLeftClick)(n)||(0,ce.isRightClick)(n)&&M||(0,ce.isTouchEvent)(n))&&l.push(g,g+S-1,e.row),r.selectColumns(...l)}function xx(n,e,t,r){if(!this.hot.view.isMouseDown()||r.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:l,origColspan:g}=s,S=this.hot.getSelectedRangeLast(),M=S.getTopStartCorner(),P=S.getBottomEndCorner(),{from:j}=S;r.column=!0,r.cell=!0;const oe=[],ye=(0,Rn.clamp)(e.row,-1/0,-1);e.col<j.col?oe.push(P.col,l,ye):e.col>j.col?oe.push(M.col,l+g-1,ye):oe.push(l,l+g-1,ye),this.hot.selection.selectColumns(...oe)}function kS(){Mc(sy,this,!1)}function Ax(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!wi(sy,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:s,origColspan:l}=wi(ds,this).getHeaderTreeNodeData(wi(Yf,this).row,wi(Yf,this).col);if(e.setHighlight(wi(Yf,this)),l>e.getWidth()||s<t||s+l-1>r){const g=wi(ds,this).findTopMostEntireHeaderLevel((0,Rn.clamp)(t,s,s+l-1),(0,Rn.clamp)(r,s,s+l-1));e.highlight.row=g,e.highlight.col=e.from.col}}function Nx(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const s=wi(ds,this).findLeftMostColumnIndex(t.row,t.col),l=wi(ds,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const g=e.col>=s&&e.col<=l?s-1:l,S=this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,-1);S===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(S,e.col)-1,1)}else if(n.col>0){const g=e.col>=s&&e.col<=l?l+1:s,S=this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1);S===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,S)-1,1)}}function GR(n,e,t){const r=n.row,s=this._getHeaderTreeNodeDataByCoords({row:r,col:n.col}),l=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Mc(oy,this,t.clone()),e.col<n.col?(s&&(n.col=s.columnIndex+s.origColspan-1),l&&(e.col=l.columnIndex)):e.col>=n.col&&(s&&(n.col=s.columnIndex),l&&(e.col=l.columnIndex+l.origColspan-1))}function Dx(n){if(wi(ds,this).getLayersCount()>0){n.length=0;for(let e=0;e<wi(ds,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}}function VS(n){const e=wi(ds,this).getLayersCount();let t=n.startColumn,r=!!e;for(let s=0;s<e;s++){const l=wi(ds,this).findLeftMostColumnIndex(s,n.startColumn),g=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(r=!1),(0,Rn.isNumeric)(g)&&g<n.startColumn){t=g;break}}n.startColumn=r?wi(ds,this).getHeaderTreeNodeData(0,t).columnIndex:t}function Hx(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function $R(n,e,t){var r;const{label:s}=(r=wi(ds,this).getHeaderTreeNodeData(t,e))!==null&&r!==void 0?r:{label:""};return s}function Lx(n,e){if(n<0)return this.hot.getCell(n,wi(ds,this).findLeftMostColumnIndex(n,e),!0)}function om(){this.updatePlugin()}function Fx(n,e){e||this.updatePlugin()}function vp(n,e,t){return(e=Wx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wx(n){var e=XR(n,"string");return typeof e=="symbol"?e:e+""}function XR(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ZR{constructor(e,t){vp(this,"hot",void 0),vp(this,"data",null),vp(this,"plugin",void 0),vp(this,"parentReference",new WeakMap),vp(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,Rn.rangeEach)(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&(0,W.arrayEach)(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,s){let l=!1,g=t;if(isNaN(g)&&g.end)return g;let S=e;return S||(S={__children:this.data},l=!0,g-=1),r!=null&&g===r?{result:S,end:!0}:s!=null&&S===s?{result:g,end:!0}:(g+=1,S.__children&&(0,W.arrayEach)(S.__children,M=>{if(this.parentReference.set(M,l?null:S),g=this.readTreeNodes(M,g,r,s),isNaN(g)&&g.end)return!1}),g)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return(0,Y.objectEach)(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:((0,W.arrayEach)(r.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let l=e;e||(l=this.mockParent()),l.__children||(l.__children=[]),r||(r=this.mockNode()),l.__children.push(r),this.rewriteCache();const g=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(g,1),this.hot.runHooks("afterCreateRow",g,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let s=r,l;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){const S=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",S,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(S,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",S,1),l=S}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),l=this.getRowIndex(this.data[t]);s=this.getDataObject(l),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(s,l+1,null);break;case"above":this.addChildAtIndex(s,l,null);break;default:break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const s=[];Array.isArray(e)?((0,Rn.rangeEach)(e[0],e[2],ye=>{const xe=this.translateTrimmedRow(ye);s.push(this.getDataObject(xe))}),(0,Rn.rangeEach)(0,s.length-2,ye=>{this.detachFromParent(s[ye],!1)}),r=s[s.length-1]):r=e;const l=this.getRowIndex(r),g=this.countChildren(r),S=this.getRowIndexWithinParent(r),M=this.getRowParent(r),P=this.getRowParent(M),j=this.getRowIndex(P);let oe=null;if(this.hot.runHooks("beforeDetachChild",M,r),S!=null){const ye=Array.from(new Array(l+g+1).keys()).splice(-1*(g+1));if(this.hot.runHooks("beforeRemoveRow",l,g+1,ye,this.plugin.pluginName),M.__children.splice(S,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,g+1,ye,this.plugin.pluginName),P){oe=j+this.countChildren(P);const xe=this.getChild(P,this.countChildren(P)-1),Ze=this.getRowIndex(xe);this.hot.runHooks("beforeCreateRow",Ze+1,g+1,this.plugin.pluginName),P.__children.push(r)}else oe=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",oe-2,g+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",oe-2,g+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",M,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const s=[];(0,W.arrayEach)(r,l=>{s.push(this.getDataObject(l))}),(0,W.arrayEach)(s,l=>{const g=this.getRowIndexWithinParent(l),S=this.getRowParent(l);S===null?this.data.splice(g,1):S.__children.splice(g,1)}),this.rewriteCache()}spliceData(e,t,r){const s=this.getDataObject(e-1);let l=null,g=e;s&&s.__children&&s.__children.length===0?(l=s,g=0):e<this.countAllRows()&&(l=this.getRowParent(e),g=this.getRowIndexWithinParent(e)),l?r?l.__children.splice(g,t,...r):l.__children.splice(g,t):r?this.data.splice(g,t,...r):this.data.splice(g,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=t;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,s){const l=t===this.hot.countRows(),g=this.getRowParent(e),S=this.getRowIndexWithinParent(e),M=g.__children.slice(S,S+1),P=e>t;let j=l?this.getRowParent(t-1):this.getRowParent(t);j==null&&(j=this.getRowParent(t-1)),j==null&&(j=this.getDataObject(t-1)),j?j.__children||(j.__children=[]):(j=this.getDataObject(t),j.__children=[]);const oe=l||r||s?j.__children.length:this.getRowIndexWithinParent(t),ye=g===j;j.__children.splice(oe,0,M[0]),g.__children.splice(S+(P&&ye?1:0),1),this.syncRowWithRawSource(g),ye||this.syncRowWithRawSource(j)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}var Bx=ZR;function jS(n,e,t){return(e=kx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kx(n){var e=JR(n,"string");return typeof e=="symbol"?e:e+""}function JR(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vx{constructor(e,t){jS(this,"hot",void 0),jS(this,"plugin",void 0),this.hot=t,this.plugin=e}}var ay=Vx;class jd extends ay{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(r),l=this.dataManager.getDataObject(r),g=t.getElementsByTagName("DIV")[0],S=g.querySelector("span.rowHeader"),M=g.querySelectorAll('[class^="ht_nesting"]'),P=this.hot.getSettings().ariaTags;if((0,W.arrayEach)(M,j=>{j&&g.removeChild(j)}),(0,N.addClass)(t,jd.CSS_CLASSES.indicatorContainer),s){const{rootDocument:j}=this.hot,oe=S.cloneNode(!0);g.innerHTML="",(0,Rn.rangeEach)(0,s-1,()=>{const ye=j.createElement("SPAN");(0,N.addClass)(ye,jd.CSS_CLASSES.emptyIndicator),g.appendChild(ye)}),g.appendChild(oe)}if(this.dataManager.hasChildren(l)){const j=this.hot.rootDocument.createElement("DIV");P&&(0,N.setAttribute)(j,[(0,ue.cV)()]),(0,N.addClass)(t,jd.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?((0,N.addClass)(j,`${jd.CSS_CLASSES.button} ${jd.CSS_CLASSES.expandButton}`),P&&(0,N.setAttribute)(t,[(0,ue.JV)(!1)])):((0,N.addClass)(j,`${jd.CSS_CLASSES.button} ${jd.CSS_CLASSES.collapseButton}`),P&&(0,N.setAttribute)(t,[(0,ue.JV)(!0)])),g.appendChild(j)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let s=11;r.isClassicTheme()||(s=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*t+25),this.hot.render()}}var US=jd;class jx extends ay{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,s)},shiftStash:function(s,l){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),(0,W.arrayEach)(r.lastCollapsedRows,(S,M)=>{S>=s&&S<l&&(r.lastCollapsedRows[M]=S+g)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,s),r.lastCollapsedRows=void 0},trimStash:(s,l)=>{(0,Rn.rangeEach)(s,s+l-1,g=>{const S=this.lastCollapsedRows.indexOf(g);S>-1&&this.lastCollapsedRows.splice(S,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let l=null,g=null,S=null;return isNaN(e)?(l=e,g=this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(e),g=e),this.dataManager.hasChildren(l)&&(0,W.arrayEach)(l.__children,M=>{s.push(this.dataManager.getRowIndex(M))}),S=this.collapseRows(s,!0,!1),r&&this.trimRows(S),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(g)===-1&&this.collapsedRows.push(g),S}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];(0,W.arrayEach)(e,l=>{s.push(...this.collapseChildren(l,!1,!1))}),r&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return(0,W.arrayEach)(e,l=>{s.push(l),t&&this.collapseChildRows(l,s)}),r&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const l=this.dataManager.getDataObject(e);(0,W.arrayEach)(l.__children,g=>{const S=this.dataManager.getRowIndex(g);t.push(S),this.collapseChildRows(S,t)})}s&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return(0,W.arrayEach)(e,l=>{s.push(l),t&&this.expandChildRows(l,s)}),r&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const l=this.dataManager.getDataObject(e);(0,W.arrayEach)(l.__children,g=>{if(!this.isAnyParentCollapsed(g)){const S=this.dataManager.getRowIndex(g);t.push(S),this.expandChildRows(S,t)}})}s&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let l=null,g=null,S=null;return isNaN(e)?(l=e,g=this.dataManager.getRowIndex(e)):(l=this.dataManager.getDataObject(e),g=e),this.collapsedRows.splice(this.collapsedRows.indexOf(g),1),this.dataManager.hasChildren(l)&&(0,W.arrayEach)(l.__children,M=>{const P=this.dataManager.getRowIndex(M);s.push(P)}),S=this.expandRows(s,!0,!1),r&&this.untrimRows(S),t&&this.renderAndAdjust(),S}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];(0,W.arrayEach)(e,l=>{s.push(...this.expandChildren(l,!1,!1))}),r&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];(0,W.arrayEach)(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];(0,W.arrayEach)(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{(0,W.arrayEach)(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{(0,W.arrayEach)(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&(0,W.arrayEach)(t.__children,s=>{const l=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(l))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);(0,N.hasClass)(e.target,US.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),(0,ce.stopImmediatePropagation)(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var QR=jx;function Ux(n,e,t){qR(n,e),e.set(n,t)}function qR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zx(n,e,t){return(e=eT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eT(n){var e=Kx(n,"string");return typeof e=="symbol"?e:e+""}function Kx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Yx(n,e){return n.get(tT(n,e))}function tT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var nT=new WeakMap;class Gx extends ay{constructor(){super(...arguments),zx(this,"dataManager",this.plugin.dataManager),Ux(this,nT,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(r);this.dataManager.addChild(s)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(tn.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(s)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,Rn.rangeEach)(0,e.items.length-1,r=>{if(r===0)return(0,W.arrayEach)(t,(s,l)=>{e.items.splice(r+l,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return(0,Rn.rangeEach)(0,e.items.length-1,t=>{const r=Yx(nT,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}}var $x=Gx;function ly(n,e,t){return(e=rT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rT(n){var e=Xx(n,"string");return typeof e=="symbol"?e:e+""}function Xx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iT{constructor(e){ly(this,"plugin",void 0),ly(this,"hot",void 0),ly(this,"dataManager",void 0),ly(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:s}))return!1;this.movedToCollapsed=!1;const g=r===this.hot.countRows(),S=g?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let M=!0;const P=e.map(Ze=>{if(!M)return!1;const Ct=this.dataManager.translateTrimmedRow(Ze);return M=this.shouldAllowMoving(Ct,S),Ct}),j=P.indexOf(S)===-1;if(!M||!j)return!1;const oe=this.getBaseParent(P),ye=this.getTargetParent(g,S),xe=oe===ye;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(ye),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(P,S,xe),this.moveRows(P,S,ye),this.dataManager.rewriteCache(),this.moveCellsMeta(P,S),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:s,movePossible:l}=e;let g=!1;return(0,I.isUndefined)(s)&&((0,v.ZK)((0,Nn.e)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,s,l,!1),g=!0),g}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const s=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(l=>{this.dataManager.moveRow(l,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){const r=[],s=Math.max(...e)<t;e.forEach(l=>{r.push(this.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let s=0,l=0;if(this.movedToCollapsed){let g=null;e[r-1]<t?g=this.dataManager.translateTrimmedRow(t-r):g=this.dataManager.translateTrimmedRow(t);const S=this.dataManager.getRowParent(g===null?this.hot.countSourceRows()-1:g-1),M=this.dataManager.getRowIndex(S);s=this.dataManager.untranslateTrimmedRow(M),l=s}else e[r-1]<t?(l=t-1,s=l-r+1):(s=t,l=s+r-1);this.hot.selectCells([[s,0,l,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}}function Zx(n,e){oT(n,e),e.add(n)}function sT(n,e,t){oT(n,e),e.set(n,t)}function oT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uy(n,e,t){return(e=Jx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Jx(n){var e=Qx(n,"string");return typeof e=="symbol"?e:e+""}function Qx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kv(n,e){return n.get(wa(n,e))}function cy(n,e,t){return n.set(wa(n,e),t),t}function wa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hy="nestedRows",qx=300,aT=hy,Gf="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var dy=new WeakMap,am=new WeakMap,Wa=new WeakSet;class lT extends jr.vq{constructor(){super(...arguments),Zx(this,Wa),uy(this,"dataManager",null),uy(this,"headersUI",null),uy(this,"collapsedRowsMap",null),sT(this,dy,!1),sT(this,am,!1)}static get PLUGIN_KEY(){return hy}static get PLUGIN_PRIORITY(){return qx}isEnabled(){return!!this.hot.getSettings()[hy]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new mw.n),this.dataManager=new Bx(this,this.hot),this.collapsingUI=new QR(this,this.hot),this.headersUI=new US(this,this.hot),this.contextMenuUI=new $x(this,this.hot),this.rowMoveController=new iT(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,aA).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,lA).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,tA).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,cT).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,nA).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,uT).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,dT).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,rA).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,iA).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,sA).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,fT).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,oA).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,hT).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,gT).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return wa(Wa,e,eA).call(e,...r)}),this.addHook("beforeLoadData",t=>wa(Wa,this,Vv).call(this,t)),this.addHook("beforeUpdateData",t=>wa(Wa,this,Vv).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:aT,relativeToGroup:Z.I,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aT)}disableCoreAPIModifiers(){cy(am,this,!0)}enableCoreAPIModifiers(){cy(am,this,!1)}onModifyRowData(e){if(!kv(am,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!kv(am,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return kv(am,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function eA(n,e,t,r){return this.rowMoveController.onBeforeRowMove(n,e,t,r)}function uT(n,e,t){this.collapsingUI.toggleState(n,e,t)}function tA(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),cy(dy,this,!0),this.dataManager.getData().slice()}function cT(n){return this.contextMenuUI.appendOptions(n)}function nA(n,e){this.headersUI.appendLevelIndicators(n,e)}function hT(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function rA(n,e,t,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{cy(dy,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function dT(n,e,t){const r=Array.from(t.reduce((s,l)=>{if(this.dataManager.isParent(l)){const g=this.dataManager.getDataObject(l).__children;return s.add(l),Array.isArray(g)&&g.forEach(S=>s.add(this.dataManager.getRowIndex(S))),s}return s.add(l)},new Set));t.length=0,t.push(...r)}function iA(){this.collapsingUI.collapsedRowsStash.stash()}function sA(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function fT(){this.collapsingUI.collapsedRowsStash.stash()}function oA(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function gT(){this.dataManager.rewriteCache()}function aA(){this.headersUI.updateRowHeaderWidth()}function lA(n,e){kv(dy,this)&&(e.skipRender=!0)}function Vv(n){if(!(0,xg.isArrayOfObjects)(n)){(0,v.vU)(Gf),this.hot.getSettings()[hy]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function zS(n,e,t){return(e=KS(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KS(n){var e=uA(n,"string");return typeof e=="symbol"?e:e+""}function uA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mT{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;zS(this,"rootWindow",void 0),zS(this,"prefix",void 0),zS(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e=="undefined"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){(0,W.arrayEach)(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var cA=mT;function pT(n,e,t){return(e=hA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hA(n){var e=vT(n,"string");return typeof e=="symbol"?e:e+""}function vT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}xn.P.getSingleton().register("persistentStateSave"),xn.P.getSingleton().register("persistentStateLoad"),xn.P.getSingleton().register("persistentStateReset");const CT="persistentState",wT=0;class dA extends jr.vq{constructor(){super(...arguments),pT(this,"storage",void 0)}static get PLUGIN_KEY(){return CT}static get PLUGIN_PRIORITY(){return wT}isEnabled(){return!!this.hot.getSettings()[CT]}enablePlugin(){this.enabled||(this.storage||(this.storage=new cA(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e=="undefined"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function yT(n,e){fA(n,e),e.add(n)}function fA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fy(n,e,t){return(e=gA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gA(n){var e=ST(n,"string");return typeof e=="symbol"?e:e+""}function ST(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _T(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const gy="search",mA=190,bT="htSearchResult",pA=function(n,e,t,r,s){n.getCellMeta(e,t).isSearchResult=s},ET=function(n,e,t){return(0,I.isUndefined)(n)||n===null||!n.toLocaleLowerCase||n.length===0||(0,I.isUndefined)(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var YS=new WeakSet;class GS extends jr.vq{constructor(){super(...arguments),yT(this,YS),fy(this,"callback",pA),fy(this,"queryMethod",ET),fy(this,"searchResultClass",bT)}static get PLUGIN_KEY(){return gy}static get PLUGIN_PRIORITY(){return mA}isEnabled(){return this.hot.getSettings()[gy]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[gy];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return _T(YS,e,RT).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return _T(YS,e,RT).call(e,...s)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),l=this.hot.countCols(),g=[],S=this.hot;return(0,Rn.rangeEach)(0,s-1,M=>{(0,Rn.rangeEach)(0,l-1,P=>{const j=this.hot.getDataAtCell(M,P),oe=this.hot.getCellMeta(M,P),ye=oe.search.callback||t,Ze=(oe.search.queryMethod||r)(e,j,oe);if(Ze){const Ct={row:M,col:P,data:j};g.push(Ct)}ye&&ye(S,M,P,j,Ze)})}),g}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){(0,Y.isObject)(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function RT(n,e,t,r,s,l){const g=l.className||[];let S=[];typeof g=="string"?S=g.split(" "):S.push(...g),this.isEnabled()&&l.isSearchResult?S.includes(this.searchResultClass)||S.push(`${this.searchResultClass}`):S.includes(this.searchResultClass)&&S.splice(S.indexOf(this.searchResultClass),1),l.className=S.join(" ")}function jv(n,e,t){return(e=vA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vA(n){var e=TT(n,"string");return typeof e=="symbol"?e:e+""}function TT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MT{constructor(e){jv(this,"viewportWidth",void 0),jv(this,"overwriteColumnWidthFn",void 0),jv(this,"baseWidths",new Map),jv(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class OT extends MT{calculate(){const e=Array.from(this.baseWidths).reduce((oe,ye)=>{let[,xe]=ye;return oe+xe},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,s=[],l=[];let g=this.viewportWidth,S=0;if(this.baseWidths.forEach((oe,ye)=>{const xe=Math.round(oe*r),Ze=this.overwriteColumnWidthFn(xe,ye);xe===Ze&&xe>=Nl.$?(s.push([ye,Ze]),S+=Ze):xe!==Ze&&(s.push([ye,Ze]),l.push(ye),g-=Ze)}),g<=Nl.$){this.stretchedWidths.clear();return}const M=g/S;let P=-1,j=0;s.forEach((oe,ye)=>{let[xe,Ze]=oe,Ct=Ze;l.includes(xe)||(Ct=Math.round(Ze*M)),this.stretchedWidths.set(xe,Ct),P=xe,ye<s.length-1&&(j+=Ct)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(P,Math.round(this.viewportWidth-j))}}function IT(n,e,t){PT(n,e),e.set(n,t)}function PT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $S(n,e){return n.get(xT(n,e))}function Uv(n,e,t){return n.set(xT(n,e),t),t}function xT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zv=new WeakMap,Kv=new WeakMap;class AT extends MT{constructor(){super(...arguments),IT(this,zv,0),IT(this,Kv,-1)}prepare(e){super.prepare(e),Uv(zv,this,0),Uv(Kv,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),Uv(Kv,this,e),Uv(zv,this,t)}calculate(){if($S(Kv,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,s)=>{let[,l]=s;return r+l},0),t=Math.max(this.viewportWidth-e+$S(zv,this),0);this.stretchedWidths.set($S(Kv,this),t)}}function CA(n,e){Jn(n,e),e.add(n)}function Yv(n,e,t){Jn(n,e),e.set(n,t)}function Jn(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dr(n,e){return n.get(Ws(n,e))}function XS(n,e,t){return n.set(Ws(n,e),t),t}function Ws(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yr="stretchColumns";var fs=new WeakMap,$f=new WeakMap,Wr=new WeakMap,Ku=new WeakMap,Ai=new WeakSet;class gs{constructor(e){CA(this,Ai),Yv(this,fs,void 0),Yv(this,$f,void 0),Yv(this,Wr,new Map([["all",new OT(Ws(Ai,this,NT).bind(this))],["last",new AT(Ws(Ai,this,NT).bind(this))]])),Yv(this,Ku,"none"),XS(fs,this,e),XS($f,this,Dr(fs,this).columnIndexMapper.createAndRegisterIndexMap(yr,"physicalIndexToValue"))}useStrategy(e){XS(Ku,this,Dr(Wr,this).has(e)?e:"none")}refreshStretching(){if(Dr(Ku,this)==="none"){Dr($f,this).clear();return}Dr(fs,this).batchExecution(()=>{Dr($f,this).clear();const e=Dr(Wr,this).get(Dr(Ku,this));let r=Dr(fs,this).view.getViewportWidth();Ws(Ai,this,wA).call(this)&&(r-=(0,N.getScrollbarWidth)(Dr(fs,this).rootDocument)),e.prepare({viewportWidth:r});for(let s=0;s<Dr(fs,this).countCols();s++)Dr(fs,this).columnIndexMapper.isHidden(Dr(fs,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,Ws(Ai,this,yA).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[l,g]=s;Dr($f,this).setValueAtIndex(Dr(fs,this).toPhysicalColumn(l),g)})},!0)}getStretchedWidth(e){return Dr($f,this).getValueAtIndex(Dr(fs,this).toPhysicalColumn(e))}}function wA(){const{view:n}=Dr(fs,this);if(n.isVerticallyScrollableByWindow())return!1;const e=n.getViewportHeight(),t=Dr(fs,this).countRows(),r=n.getStylesHandler().getDefaultRowHeight();let s=0,l=!1;for(let S=0;S<t;S++){var g;if(s+=((g=Dr(fs,this).getRowHeight(S))!==null&&g!==void 0?g:r)+(S===0?1:0),s>e){l=!0;break}}return l}function yA(n){var e;return(e=Dr(fs,this).getColWidth(n,"StretchColumns"))!==null&&e!==void 0?e:Nl.$}function NT(n,e){return Dr(fs,this).runHooks("beforeStretchingColumnWidth",n,e)}function SA(n,e){DT(n,e),e.add(n)}function ZS(n,e,t){DT(n,e),e.set(n,t)}function DT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JS(n,e,t){return n.set(my(n,e),t),t}function Ud(n,e){return n.get(my(n,e))}function my(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _A="stretchColumns",bA=155;var Cp=new WeakMap,py=new WeakMap,Gv=new WeakMap,QS=new WeakSet;class EA extends jr.vq{constructor(){super(...arguments),SA(this,QS),ZS(this,Cp,new gs(this.hot)),ZS(this,py,null),ZS(this,Gv,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;(t=this.hot)!==null&&t!==void 0&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:s}=r;Ud(py,this)!==null&&Ud(py,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),JS(py,this,s.width)})})}))}static get PLUGIN_KEY(){return _A}static get PLUGIN_PRIORITY(){return bA}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ud(Cp,this).useStrategy(this.hot.getSettings().stretchH),Ud(Gv,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return my(QS,e,HT).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return my(QS,e,RA).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Ud(Cp,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ud(Gv,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ud(Cp,this).getStretchedWidth(e)}destroy(){Ud(Gv,this).disconnect(),JS(Gv,this,null),JS(Cp,this,null),super.destroy()}}function RA(n,e,t){if(t===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:n}function HT(n){n&&Ud(Cp,this).refreshStretching()}function TA(n,e){MA(n,e),e.add(n)}function MA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $v(n,e,t){return(e=LT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LT(n){var e=OA(n,"string");return typeof e=="symbol"?e:e+""}function OA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const qS="touchScroll",IA=200;var o=new WeakSet;class h extends jr.vq{constructor(){super(...arguments),TA(this,o),$v(this,"scrollbars",[]),$v(this,"clones",[]),$v(this,"lockedCollection",!1),$v(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return qS}static get PLUGIN_PRIORITY(){return IA}static get SETTING_KEYS(){return!0}isEnabled(){return(0,Qo.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>vy(o,this,y).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>vy(o,this,A).call(this)),this.addHook("afterMomentumScroll",()=>vy(o,this,G).call(this))}}function y(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),r&&this.scrollbars.push(r),s&&s.clone&&this.scrollbars.push(s),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function A(){this.freezeOverlays=!0,(0,W.arrayEach)(this.clones,n=>{(0,N.addClass)(n,"hide-tween")})}function G(){this.freezeOverlays=!1,(0,W.arrayEach)(this.clones,n=>{(0,N.removeClass)(n,"hide-tween"),(0,N.addClass)(n,"show-tween")}),this.hot._registerTimeout(()=>{(0,W.arrayEach)(this.clones,n=>{(0,N.removeClass)(n,"show-tween")})},400),(0,W.arrayEach)(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ge(n,e){Re(n,e),e.add(n)}function Re(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ve(n,e,t){return(e=st(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function st(n){var e=kt(n,"string");return typeof e=="symbol"?e:e+""}function kt(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Vt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Zt="trimRows",kn=330;var rr=new WeakSet;class Or extends jr.vq{constructor(){super(...arguments),ge(this,rr),Ve(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Zt}static get PLUGIN_PRIORITY(){return kn}isEnabled(){return!!this.hot.getSettings()[Zt]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new mw.n),this.trimmedRowsMap.addLocalHook("init",()=>Vt(rr,this,ci).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Zt];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,W.arrayEach)(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{(0,W.arrayEach)(e,g=>{this.trimmedRowsMap.setValueAtIndex(g,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,r,r&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let s=t;const l=this.trimmedRowsMap.getValues().slice(),g=e.length>0;r&&g&&((0,W.arrayEach)(e,M=>{l[M]=!1}),s=(0,W.arrayReduce)(l,(M,P,j)=>(P&&M.push(j),M),[])),this.hot.runHooks("beforeUntrimRow",t,s,r&&g)!==!1&&(r&&g&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",t,s,r&&g,r&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}}function ci(){const n=this.hot.getSettings()[Zt];Array.isArray(n)&&this.hot.batchExecution(()=>{(0,W.arrayEach)(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Ir(n,e,t){return(e=yi(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yi(n){var e=Ni(n,"string");return typeof e=="symbol"?e:e+""}function Ni(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ao{constructor(e){Ir(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Ba(n,e,t){return(e=Yu(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yu(n){var e=zo(n,"string");return typeof e=="symbol"?e:e+""}function zo(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Gu extends ao{constructor(e){let{stateBefore:t,range:r,type:s,alignment:l}=e;super("cell_alignment"),Ba(this,"stateBefore",void 0),Ba(this,"range",void 0),Ba(this,"type",void 0),Ba(this,"alignment",void 0),this.stateBefore=t,this.range=r,this.type=s,this.alignment=l}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(r,s,l,g)=>{t.done(()=>new Gu({stateBefore:r,range:s,type:l,alignment:g}))})}undo(e,t){(0,W.arrayEach)(this.range,r=>{r.forAll((s,l)=>{s>=0&&l>=0&&e.setCellMeta(s,l,"className",this.stateBefore[s][l]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){Nu(this.range,this.type,this.alignment,(r,s)=>e.getCellMeta(r,s),(r,s,l,g)=>e.setCellMeta(r,s,l,g)),e.addHookOnce("afterViewRender",t),e.render()}}function ed(n,e,t){return(e=FT(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FT(n){var e=g1(n,"string");return typeof e=="symbol"?e:e+""}function g1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PA extends ao{constructor(e){let{columns:t,finalIndex:r}=e;super("col_move"),ed(this,"columns",void 0),ed(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(r,s)=>{r!==!1&&t.done(()=>new PA({columns:r,finalIndex:s}))})}undo(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),U0(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(l=>{let{from:g,to:S}=l;g<S&&(S-=1),r.moveColumn(S,g)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function t1(n,e,t){return(e=m1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m1(n){var e=p1(n,"string");return typeof e=="symbol"?e:e+""}function p1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xA extends ao{constructor(e){let{currentSortState:t,newSortState:r}=e;super("col_sort"),t1(this,"previousSortState",void 0),t1(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=r}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(r,s,l)=>{l&&t.done(()=>new xA({currentSortState:r,newSortState:s}))})}undo(e,t){const r=e.getPlugin("columnSorting"),s=e.getPlugin("multiColumnSorting"),l=s.isEnabled()?s:r;this.previousSortState.length?l.sort(this.previousSortState):l.clearSort(),t()}redo(e,t){const r=e.getPlugin("columnSorting"),s=e.getPlugin("multiColumnSorting");(s.isEnabled()?s:r).sort(this.nextSortState),t()}}function n1(n,e,t){return(e=v1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v1(n){var e=C1(n,"string");return typeof e=="symbol"?e:e+""}function C1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class AA extends ao{constructor(e){let{index:t,amount:r}=e;super("insert_col"),n1(this,"index",void 0),n1(this,"amount",void 0),this.index=t,this.amount=r}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(r,s,l)=>{t.done(()=>new AA({index:r,amount:s}),l)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function r1(n,e,t){return(e=w1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function w1(n){var e=y1(n,"string");return typeof e=="symbol"?e:e+""}function y1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class NA extends ao{constructor(e){let{index:t,amount:r}=e;super("insert_row"),r1(this,"index",void 0),r1(this,"amount",void 0),this.index=t,this.amount=r}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(r,s,l)=>{t.done(()=>new NA({index:r,amount:s}),l)})}undo(e,t){const r=e.countRows(),s=e.getSettings().minSpareRows;this.index>=r&&this.index-s<r&&(this.index-=s),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function WT(n,e,t){return(e=S1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function S1(n){var e=_1(n,"string");return typeof e=="symbol"?e:e+""}function _1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class DA extends ao{constructor(e){let{changes:t,selected:r,countCols:s,countRows:l}=e;super("change"),WT(this,"changes",void 0),WT(this,"selected",void 0),WT(this,"countCols",void 0),WT(this,"countRows",void 0),this.changes=t,this.selected=r,this.countCols=s,this.countRows=l}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(r,s){const l=r&&r.length;if(!l||!r.find(M=>{const[,,P,j]=M;return P!==j}))return;const S=()=>{const M=r.reduce((j,oe)=>(j.push([...oe]),j),[]);M.forEach(j=>{j[1]=e.propToCol(j[1])});const P=l>1?this.getSelected():[[M[0][0],M[0][1]]];return new DA({changes:M,selected:P,countCols:e.countCols(),countRows:e.countRows()})};t.done(S,s)})}undo(e,t){const r=(0,Y.deepClone)(this.changes);for(let g=0,S=r.length;g<S;g++)r[g].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");const s=e.countRows()-this.countRows;s>0&&e.alter("remove_row",null,s,"UndoRedo.undo");const l=e.countCols()-this.countCols;l>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,l,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){const r=(0,Y.deepClone)(this.changes);for(let s=0,l=r.length;s<l;s++)r[s].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function i1(n,e,t){return(e=b1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function b1(n){var e=E1(n,"string");return typeof e=="symbol"?e:e+""}function E1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class HA extends ao{constructor(e){let{conditionsStack:t,previousConditionsStack:r}=e;super("filter"),i1(this,"conditionsStack",void 0),i1(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=r}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(r,s)=>{t.done(()=>new HA({conditionsStack:r,previousConditionsStack:s}))})}undo(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.importConditions(this.conditionsStack),r.filter()}}function R1(n,e,t){return(e=T1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T1(n){var e=M1(n,"string");return typeof e=="symbol"?e:e+""}function M1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class LA extends ao{constructor(e){let{data:t,cellRange:r}=e;super("merge_cells"),R1(this,"cellRange",void 0),this.cellRange=r,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(r,s)=>{if(s)return;const l=r.getTopStartCorner(),g=r.getBottomEndCorner(),S=e.getData(l.row,l.col,g.row,g.col);t.done(()=>new LA({data:S,cellRange:r}))})}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}var Q1=f(13588);function s1(n,e,t,r,s){const l=["visualRow","visualCol","row","col","prop"],g=l.length,S=[];return(0,Rn.rangeEach)(r,s,M=>{(0,Rn.rangeEach)(e,t,P=>{const j=n.getCellMeta(P,M);if(Object.keys(j).length!==g){const oe=Object.fromEntries(Object.entries(j).filter(ye=>{let[xe]=ye;return l.includes(xe)===!1}));S.push([j.visualRow,j.visualCol,oe])}})}),S}function lm(n,e,t){return(e=O1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function O1(n){var e=I1(n,"string");return typeof e=="symbol"?e:e+""}function I1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class FA extends ao{constructor(e){let{index:t,indexes:r,data:s,amount:l,headers:g,columnPositions:S,rowPositions:M,fixedColumnsStart:P,removedCellMetas:j}=e;super("remove_col"),lm(this,"index",void 0),lm(this,"indexes",void 0),lm(this,"data",void 0),lm(this,"amount",void 0),lm(this,"headers",void 0),lm(this,"columnPositions",void 0),lm(this,"rowPositions",void 0),lm(this,"fixedColumnsStart",void 0),lm(this,"removedCellMetas",void 0),this.index=t,this.indexes=r,this.data=s,this.amount=l,this.headers=g,this.columnPositions=S.slice(0),this.rowPositions=M.slice(0),this.fixedColumnsStart=P,this.removedCellMetas=j}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(r,s,l,g)=>{const S=()=>{const M=e.getSourceDataArray(),P=(e.countCols()+r)%e.countCols(),j=P+s-1,oe=[],ye=[],xe=[];return(0,Rn.rangeEach)(M.length-1,Ze=>{const Ct=[],ot=M[Ze];(0,Rn.rangeEach)(P,j,Jt=>{Ct.push(ot[e.toPhysicalColumn(Jt)])}),oe.push(Ct)}),(0,Rn.rangeEach)(s-1,Ze=>{xe.push(e.toPhysicalColumn(P+Ze))}),Array.isArray(e.getSettings().colHeaders)&&(0,Rn.rangeEach)(s-1,Ze=>{ye.push(e.getSettings().colHeaders[e.toPhysicalColumn(P+Ze)]||null)}),new FA({index:P,indexes:xe,data:oe,amount:s,headers:ye,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:s1(e,0,e.countRows(),P,j)})};t.done(S,g)})}undo(e,t){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const s=this.indexes.slice(0).sort(),l=(j,oe,ye)=>ye[this.indexes.indexOf(s[oe])],g=this.data.length,S=[];for(let j=0;j<g;j++)S.push((0,W.arrayMap)(this.data[j],l));const M=(0,W.arrayMap)(this.headers,l),P=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),(0,W.arrayEach)(e.getSourceDataArray(),(j,oe)=>{(0,W.arrayEach)(s,(ye,xe)=>{j[ye]=S[oe][xe],P.push([oe,ye,j[ye]])})}),typeof this.headers!="undefined"&&(0,W.arrayEach)(M,(j,oe)=>{e.getSettings().colHeaders[s[oe]]=j}),this.removedCellMetas.forEach(j=>{let[oe,ye,xe]=j;e.setCellMetaObject(oe,ye,xe)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(P,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Cy(n,e,t){return(e=P1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P1(n){var e=x1(n,"string");return typeof e=="symbol"?e:e+""}function x1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class WA extends ao{constructor(e){let{index:t,data:r,fixedRowsBottom:s,fixedRowsTop:l,rowIndexesSequence:g,removedCellMetas:S}=e;super("remove_row"),Cy(this,"index",void 0),Cy(this,"data",void 0),Cy(this,"fixedRowsBottom",void 0),Cy(this,"fixedRowsTop",void 0),Cy(this,"rowIndexesSequence",void 0),Cy(this,"removedCellMetas",void 0),this.index=t,this.data=r,this.fixedRowsBottom=s,this.fixedRowsTop=l,this.rowIndexesSequence=g,this.removedCellMetas=S}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(r,s,l,g)=>{const S=()=>{const M=e.toPhysicalRow(r),P=M+s-1,j=(0,Y.deepClone)(e.getSourceData(M,0,M+s-1,e.countSourceCols()-1));return new WA({index:M,data:j,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:s1(e,M,P,0,e.countCols()-1)})};t.done(S,g)})}undo(e,t){const r=e.getSettings(),s=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((l,g)=>{Object.keys(l).forEach(S=>{const M=parseInt(S,10);s.push([this.index+g,isNaN(M)?S:M,l[S]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(l=>{let[g,S,M]=l;e.setCellMetaObject(g,S,M)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(s,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function o1(n,e,t){return(e=A1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A1(n){var e=N1(n,"string");return typeof e=="symbol"?e:e+""}function N1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class BA extends ao{constructor(e){let{rows:t,finalIndex:r}=e;super("row_move"),o1(this,"rows",void 0),o1(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(r,s)=>{r!==!1&&t.done(()=>new BA({rows:r,finalIndex:s}))})}undo(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),U0(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(l=>{let{from:g,to:S}=l;g<S&&(S-=1),r.moveRow(S,g)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function D1(n,e,t){return(e=H1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H1(n){var e=L1(n,"string");return typeof e=="symbol"?e:e+""}function L1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kA extends ao{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),D1(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(r,s)=>{s||t.done(()=>new kA({cellRange:r}))})}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}function F1(n,e){[Gu,PA,xA,AA,NA,DA,HA,LA,FA,WA,BA,kA].forEach(t=>t.startRegisteringEvents(n,e))}function W1(n,e){B1(n,e),e.add(n)}function B1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VA(n,e,t){return(e=k1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k1(n){var e=V1(n,"string");return typeof e=="symbol"?e:e+""}function V1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const a1="undoRedo",j1="undoRedo",U1=1e3;xn.P.getSingleton().register("beforeUndo"),xn.P.getSingleton().register("afterUndo"),xn.P.getSingleton().register("beforeRedo"),xn.P.getSingleton().register("afterRedo");const l1=new Set;var BT=new WeakSet;class z1 extends jr.vq{static get PLUGIN_KEY(){return j1}static get PLUGIN_PRIORITY(){return U1}static get SETTING_KEYS(){return!0}constructor(e){super(e),W1(this,BT),VA(this,"doneActions",[]),VA(this,"undoneActions",[]),VA(this,"ignoreNewActions",!1),F1(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return jA(BT,e,K1).call(e,...r)}),this.registerShortcuts(),jA(BT,this,Y1).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),jA(BT,this,G1).call(this)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),s={runOnlyIf:l=>!l.altKey,group:a1};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],s)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(a1)}done(e,t){if(this.ignoreNewActions||t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto")return;const s=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",s,t)===!1)return;const g=e(),S=this.undoneActions.slice();this.doneActions.push(g),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",S),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",S,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=(0,Y.deepClone)(t);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const l=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",l),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",l,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=(0,Y.deepClone)(t);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const l=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",l),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",l,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function K1(n,e){e==="loadData"&&this.clear()}function Y1(){const n=e=>{l1.has(e)||((0,v.ZK)((0,Nn.e)`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),l1.add(e))};this.hot.undo=()=>{n("undo"),this.undo()},this.hot.redo=()=>{n("redo"),this.redo()},this.hot.isUndoAvailable=()=>(n("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(n("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{n("clear"),this.clear()},this.hot.undoRedo=this}function G1(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}var Ji=f(59189);function u1(){(0,Ji.fo)(ea),(0,Ji.fo)(Bl),(0,Ji.fo)(wh),(0,Ji.fo)(ug),(0,Ji.fo)(An),(0,Ji.fo)(Uc),(0,Ji.fo)(go),(0,Ji.fo)(_d),(0,Ji.fo)(ss),(0,Ji.fo)(Sc),(0,Ji.fo)(oM),(0,Ji.fo)(hM),(0,Ji.fo)(Jp),(0,Ji.fo)(FM),(0,Ji.fo)(jO),(0,Ji.fo)(Yb),(0,Ji.fo)(bI),(0,Ji.fo)(PI),(0,Ji.fo)(WI),(0,Ji.fo)(IE),(0,Ji.fo)(aS),(0,Ji.fo)(VE),(0,Ji.fo)(vS),(0,Ji.fo)(WP),(0,Ji.fo)(ox),(0,Ji.fo)(qw),(0,Ji.fo)(Mx),(0,Ji.fo)(lT),(0,Ji.fo)(dA),(0,Ji.fo)(GS),(0,Ji.fo)(EA),(0,Ji.fo)(h),(0,Ji.fo)(Or),(0,Ji.fo)(z1)}function $1(){Xr(),Qd(),dh(),ad(),u1()}},50598:function($,ie,f){"use strict";f.d(ie,{Z:function(){return Q}});var C=f(25813),_=f.n(C),B=f(88555),K=f(40629);const k="base";function Q(X,N,ce,Y,Z,ee,le){const J=le.ariaTags,W=[],I=[],V=[],q=[];le.className&&(0,B.addClass)(N,le.className),le.readOnly?(W.push(le.readOnlyCellClassName),J&&q.push((0,K.zR)())):J&&V.push((0,K.zR)()[0]),le.valid===!1&&le.invalidCellClassName?(W.push(le.invalidCellClassName),J&&q.push((0,K.w1)())):(I.push(le.invalidCellClassName),J&&V.push((0,K.w1)()[0])),le.wordWrap===!1&&le.noWordWrapClassName&&W.push(le.noWordWrapClassName),!ee&&le.placeholder&&W.push(le.placeholderCellClassName),(0,B.removeClass)(N,I),(0,B.addClass)(N,W),(0,B.removeAttribute)(N,V),(0,B.setAttribute)(N,q)}Q.RENDERER_TYPE=k},70959:function($,ie,f){"use strict";f.d(ie,{Bp:function(){return ce},LX:function(){return X},Y3:function(){return Q},zn:function(){return Y}});var C=f(29297),_=f.n(C),B=f(80534);const{register:K,getItem:k,hasItem:Q,getNames:X,getValues:N}=(0,B.Z)("renderers");function ce(Z){if(typeof Z=="function")return Z;if(!Q(Z))throw Error(`No registered renderer found under "${Z}" name`);return k(Z)}function Y(Z,ee){typeof Z!="string"&&(ee=Z,Z=ee.RENDERER_TYPE),K(Z,ee)}},64258:function($,ie,f){"use strict";f.d(ie,{V:function(){return k}});var C=f(50598),_=f(88555),B=f(13617);const K="text";function k(Q,X,N,ce,Y,Z,ee){C.Z.apply(this,[Q,X,N,ce,Y,Z,ee]);let le=Z;!le&&ee.placeholder&&(le=ee.placeholder),le=(0,B.stringify)(le),ee.trimWhitespace&&(le=le.trim()),(0,_.fastInnerText)(X,le)}k.RENDERER_TYPE=K},11043:function($,ie,f){"use strict";f.d(ie,{AV:function(){return jt},I8:function(){return hn},Kk:function(){return Fe},S5:function(){return Ye},X8:function(){return Be},gk:function(){return et}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(71441),Q=f.n(k),X=f(31702),N=f.n(X),ce=f(89050),Y=f.n(ce),Z=f(16110),ee=f.n(Z),le=f(8274),J=f.n(le),W=f(64109),I=f.n(W),V=f(92128),q=f.n(V),de=f(48442),ue=f.n(de),ve=f(5499),pe=f.n(ve),Se=f(6146),Ee=f(11981),He=f(13617);const Fe=0,et=1,Oe=2,ct=3,ze=[ct,Oe],dt=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],It=Symbol("root"),Sn=Symbol("child");function jt(Je){let mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:It;if(mt!==It&&mt!==Sn)throw new Error("The second argument is used internally only and cannot be overwritten.");const Ae=Array.isArray(Je),rt=mt===It;let Ft=Fe;if(Ae){const zt=Je[0];Je.length===0?Ft=et:rt&&zt instanceof Se.Z?Ft=ct:rt&&Array.isArray(zt)?Ft=jt(zt,Sn):Je.length>=2&&Je.length<=4&&!Je.some((Qe,an)=>!dt[an].includes(typeof Qe))&&(Ft=Oe)}return Ft}function Ye(Je){let{createCellCoords:mt,createCellRange:Ae,keepDirection:rt=!1,propToCol:Ft}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ze.includes(Je))throw new Error("Unsupported selection ranges schema type was provided.");return function(zt){const Et=Je===ct;let Qe=Et?zt.from.row:zt[0],an=Et?zt.from.col:zt[1],Mt=Et?zt.to.row:zt[2],Cn=Et?zt.to.col:zt[3];if(typeof Ft=="function"&&(typeof an=="string"&&(an=Ft(an)),typeof Cn=="string"&&(Cn=Ft(Cn))),(0,He.isUndefined)(Mt)&&(Mt=Qe),(0,He.isUndefined)(Cn)&&(Cn=an),!rt){const br=Qe,qr=an,ir=Mt,Qn=Cn;Qe=Math.min(br,ir),an=Math.min(qr,Qn),Mt=Math.max(br,ir),Cn=Math.max(qr,Qn)}const bn=mt(Qe,an),mr=mt(Mt,Cn);return Ae(bn,bn,mr)}}function Be(Je){const mt=jt(Je.getSelected());if(mt===Fe||mt===et)return[];const Ae=Ye(mt,{createCellCoords:Je._createCellCoords.bind(Je),createCellRange:Je._createCellRange.bind(Je)}),rt=new Set;(0,Ee.arrayEach)(Je.getSelected(),Et=>{const{from:Qe,to:an}=Ae(Et),Mt=Math.max(Qe.col,0),Cn=an.col-Mt+1;(0,Ee.arrayEach)(Array.from(new Array(Cn),(bn,mr)=>Mt+mr),bn=>{rt.has(bn)||rt.add(bn)})});const Ft=Array.from(rt).sort((Et,Qe)=>Et-Qe);return(0,Ee.arrayReduce)(Ft,(Et,Qe,an,Mt)=>(an!==0&&Qe===Mt[an-1]+1?Et[Et.length-1][1]+=1:Et.push([Qe,1]),Et),[])}function hn(Je){const mt=jt(Je.getSelected());if(mt===Fe||mt===et)return[];const Ae=Ye(mt,{createCellCoords:Je._createCellCoords.bind(Je),createCellRange:Je._createCellRange.bind(Je)}),rt=new Set;(0,Ee.arrayEach)(Je.getSelected(),Et=>{const{from:Qe,to:an}=Ae(Et),Mt=Math.max(Qe.row,0),Cn=an.row-Mt+1;(0,Ee.arrayEach)(Array.from(new Array(Cn),(bn,mr)=>Mt+mr),bn=>{rt.has(bn)||rt.add(bn)})});const Ft=Array.from(rt).sort((Et,Qe)=>Et-Qe);return(0,Ee.arrayReduce)(Ft,(Et,Qe,an,Mt)=>(an!==0&&Qe===Mt[an-1]+1?Et[Et.length-1][1]+=1:Et.push([Qe,1]),Et),[])}},95188:function($,ie,f){"use strict";f.d(ie,{I:function(){return _},W:function(){return C}});const C="gridDefault",_="editorManager.handlingEditor"},56218:function($,ie,f){"use strict";f.d(ie,{P:function(){return W},f:function(){return J}});var C=f(29297),_=f.n(C),B=f(48442),K=f.n(B),k=f(97487),Q=f.n(k),X=f(13617),N=f(33987),ce=f(25506);function Y(I,V,q){return(V=Z(V))in I?Object.defineProperty(I,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):I[V]=q,I}function Z(I){var V=ee(I,"string");return typeof V=="symbol"?V:V+""}function ee(I,V){if(typeof I!="object"||!I)return I;var q=I[Symbol.toPrimitive];if(q!==void 0){var de=q.call(I,V||"default");if(typeof de!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(I)}let le=0;class J{constructor(){Y(this,"collection",new Map)}register(V,q){this.collection.has(V)===!1&&(this.collection.set(V,q),q.addLocalHook("change",()=>this.runLocalHooks("change",q)),le+=1)}unregister(V){const q=this.collection.get(V);(0,X.isDefined)(q)&&(q.destroy(),this.collection.delete(V),this.runLocalHooks("change",q),le-=1)}unregisterAll(){this.collection.forEach((V,q)=>this.unregister(q)),this.collection.clear()}get(V){return(0,X.isUndefined)(V)?Array.from(this.collection.values()):this.collection.get(V)}getLength(){return this.collection.size}removeFromEvery(V){this.collection.forEach(q=>{q.remove(V)})}insertToEvery(V,q){this.collection.forEach(de=>{de.insert(V,q)})}initEvery(V){this.collection.forEach(q=>{q.init(V)})}}(0,N.mixin)(J,ce.Z);function W(){return le}},67822:function($,ie,f){"use strict";f.d(ie,{o:function(){return k}});var C=f(25813),_=f.n(C),B=f(55556),K=f(11981);class k extends B.L{constructor(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(X)}getHiddenIndexes(){return(0,K.arrayReduce)(this.getValues(),(X,N,ce)=>(N&&X.push(ce),X),[])}}},2135:function($,ie,f){"use strict";f.d(ie,{n:function(){return ee}});var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(46495),Q=f(33987),X=f(27122),N=f(25506);function ce(le,J,W){return(J=Y(J))in le?Object.defineProperty(le,J,{value:W,enumerable:!0,configurable:!0,writable:!0}):le[J]=W,le}function Y(le){var J=Z(le,"string");return typeof J=="symbol"?J:J+""}function Z(le,J){if(typeof le!="object"||!le)return le;var W=le[Symbol.toPrimitive];if(W!==void 0){var I=W.call(le,J||"default");if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(J==="string"?String:Number)(le)}class ee{constructor(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ce(this,"indexedValues",[]),ce(this,"initValueOrFn",void 0),this.initValueOrFn=J}getValues(){return this.indexedValues}getValueAtIndex(J){const W=this.indexedValues;if(J<W.length)return W[J]}setValues(J){this.indexedValues=J.slice(),this.runLocalHooks("change")}setValueAtIndex(J,W){return J<this.indexedValues.length?(this.indexedValues[J]=W,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,X.isFunction)(this.initValueOrFn)?(0,k.rangeEach)(J-1,W=>this.indexedValues.push(this.initValueOrFn(W))):(0,k.rangeEach)(J-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(J){return this.setDefaultValues(J),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,Q.mixin)(ee,N.Z)},85231:function($,ie,f){"use strict";f.d(ie,{b:function(){return K}});var C=f(2135),_=f(85738),B=f(19468);class K extends C.n{constructor(){super(Q=>Q)}insert(Q,X){const N=(0,B.X)(this.indexedValues,X);this.indexedValues=(0,_.S)(N,Q,X),super.insert(Q,X)}remove(Q){const X=(0,_.t)(this.indexedValues,Q);this.indexedValues=(0,B.i)(X,Q),super.remove(Q)}}},26665:function($,ie,f){"use strict";f.d(ie,{A:function(){return W}});var C=f(29297),_=f.n(C),B=f(48442),K=f.n(B),k=f(73190),Q=f.n(k),X=f(2135),N=f(87167),ce=f(85738),Y=f(19468),Z=f(27122);function ee(I,V,q){return(V=le(V))in I?Object.defineProperty(I,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):I[V]=q,I}function le(I){var V=J(I,"string");return typeof V=="symbol"?V:V+""}function J(I,V){if(typeof I!="object"||!I)return I;var q=I[Symbol.toPrimitive];if(q!==void 0){var de=q.call(I,V||"default");if(typeof de!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(I)}class W extends X.n{constructor(){super(...arguments),ee(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(V=>this.indexedValues[V])}setValues(V){this.orderOfIndexes=[...Array(V.length).keys()],super.setValues(V)}setValueAtIndex(V,q){let de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return V<this.indexedValues.length?(this.indexedValues[V]=q,this.orderOfIndexes.includes(V)===!1&&this.orderOfIndexes.splice(de,0,V),this.runLocalHooks("change"),!0):!1}clearValue(V){this.orderOfIndexes=(0,ce.t)(this.orderOfIndexes,[V]),(0,Z.isFunction)(this.initValueOrFn)?super.setValueAtIndex(V,this.initValueOrFn(V)):super.setValueAtIndex(V,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(V)}insert(V,q){this.indexedValues=(0,N.S)(this.indexedValues,V,q,this.initValueOrFn),this.orderOfIndexes=(0,Y.X)(this.orderOfIndexes,q),super.insert(V,q)}remove(V){this.indexedValues=(0,N.t)(this.indexedValues,V),this.orderOfIndexes=(0,ce.t)(this.orderOfIndexes,V),this.orderOfIndexes=(0,Y.i)(this.orderOfIndexes,V),super.remove(V)}getEntries(){return this.orderOfIndexes.map(V=>[V,this.getValueAtIndex(V)])}}},55556:function($,ie,f){"use strict";f.d(ie,{L:function(){return B}});var C=f(2135),_=f(87167);class B extends C.n{insert(k,Q){this.indexedValues=(0,_.S)(this.indexedValues,k,Q,this.initValueOrFn),super.insert(k,Q)}remove(k){this.indexedValues=(0,_.t)(this.indexedValues,k),super.remove(k)}}},55315:function($,ie,f){"use strict";f.d(ie,{n:function(){return k}});var C=f(25813),_=f.n(C),B=f(55556),K=f(11981);class k extends B.L{constructor(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(X)}getTrimmedIndexes(){return(0,K.arrayReduce)(this.getValues(),(X,N,ce)=>(N&&X.push(ce),X),[])}}},19468:function($,ie,f){"use strict";f.d(ie,{X:function(){return X},i:function(){return Q}});var C=f(48442),_=f.n(C),B=f(78127),K=f.n(B),k=f(11981);function Q(N,ce){return(0,k.arrayMap)(N,Y=>Y-ce.filter(Z=>Z<Y).length)}function X(N,ce){const Y=ce[0],Z=ce.length;return(0,k.arrayMap)(N,ee=>ee>=Y?ee+Z:ee)}},85738:function($,ie,f){"use strict";f.d(ie,{S:function(){return _},t:function(){return B}});var C=f(11981);function _(K,k,Q){return[...K.slice(0,k),...Q,...K.slice(k)]}function B(K,k){return(0,C.arrayFilter)(K,Q=>k.includes(Q)===!1)}},87167:function($,ie,f){"use strict";f.d(ie,{S:function(){return X},t:function(){return N}});var C=f(48442),_=f.n(C),B=f(73190),K=f.n(B),k=f(27122),Q=f(11981);function X(ce,Y,Z,ee){const le=Z.length?Z[0]:void 0;return[...ce.slice(0,le),...Z.map((J,W)=>(0,k.isFunction)(ee)?ee(J,W):ee),...le===void 0?[]:ce.slice(le)]}function N(ce,Y){return(0,Q.arrayFilter)(ce,(Z,ee)=>Y.includes(ee)===!1)}},76745:function($,ie,f){"use strict";f.d(ie,{x:function(){return K}});function C(k,Q,X){k.addEventListener(Q,X,!1)}function _(k,Q,X){k.removeEventListener(Q,X,!1)}function B(k){return k.ownerDocument.defaultView.getComputedStyle(k)}function K(k){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const X=hi({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:I=>I.value},Q),N=k.body,ce=k.createTextNode(""),Y=k.createElement("span");let Z;function ee(){var I,V;ce.textContent=X.textContent(Z),Y.style.position="absolute",Y.style.fontSize=B(Z).fontSize,Y.style.fontFamily=B(Z).fontFamily,Y.style.whiteSpace="pre",N.appendChild(Y);const q=parseInt(((I=B(Z))===null||I===void 0?void 0:I.paddingInlineStart)||0,10),de=parseInt(((V=B(Z))===null||V===void 0?void 0:V.paddingInlineEnd)||0,10),ue=Y.clientWidth+q+de+1;N.removeChild(Y);const ve=Z.style;ve.height=`${X.minHeight}px`,X.minWidth>ue?ve.width=`${X.minWidth}px`:ue>X.maxWidth?ve.width=`${X.maxWidth}px`:ve.width=`${ue}px`;const pe=Z.scrollHeight?Z.scrollHeight-1:0;X.minHeight>pe?ve.height=`${X.minHeight}px`:X.maxHeight<pe?(ve.height=`${X.maxHeight}px`,ve.overflowY="visible"):ve.height=`${pe}px`}function le(){k.defaultView.setTimeout(ee,0)}function J(I){if(I&&I.minHeight)if(I.minHeight==="inherit")X.minHeight=Z.clientHeight;else{const V=parseInt(I.minHeight,10);isNaN(V)||(X.minHeight=V)}if(I&&I.maxHeight)if(I.maxHeight==="inherit")X.maxHeight=Z.clientHeight;else{const V=parseInt(I.maxHeight,10);isNaN(V)||(X.maxHeight=V)}if(I&&I.minWidth)if(I.minWidth==="inherit")X.minWidth=Z.clientWidth;else{const V=parseInt(I.minWidth,10);isNaN(V)||(X.minWidth=V)}if(I&&I.maxWidth)if(I.maxWidth==="inherit")X.maxWidth=Z.clientWidth;else{const V=parseInt(I.maxWidth,10);isNaN(V)||(X.maxWidth=V)}Y.firstChild||(Y.className="autoResize",Y.style.display="inline-block",Y.appendChild(ce))}function W(I,V){let q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Z=I,J(V),Z.nodeName==="TEXTAREA"&&(Z.style.resize="none",Z.style.height=`${X.minHeight}px`,Z.style.minWidth=`${X.minWidth}px`,Z.style.maxWidth=`${X.maxWidth}px`,Z.style.overflowY="hidden"),q&&(C(Z,"input",ee),C(Z,"keydown",le)),ee()}return{init:W,resize:ee,unObserve(){_(Z,"input",ee),_(Z,"keydown",le)}}}},98407:function($,ie,f){"use strict";f.d(ie,{I:function(){return ce}});var C=f(29297),_=f.n(C),B=f(48442),K=f.n(B),k=f(11174),Q=f.n(k),X=f(27122);const N=Y=>`The id '${Y}' is already declared in a map.`;function ce(){let{errorIdExists:Y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const Z=new Map;Y=(0,X.isFunction)(Y)?Y:N;function ee(de,ue){if(q(de))throw new Error(Y(de));Z.set(de,ue)}function le(de){return Z.delete(de)}function J(){Z.clear()}function W(de){const[ue]=V().find(ve=>{let[pe,Se]=ve;return de===Se?pe:!1})||[null];return ue}function I(de){return Z.get(de)}function V(){return[...Z]}function q(de){return Z.has(de)}return{addItem:ee,clear:J,getId:W,getItem:I,getItems:V,hasItem:q,removeItem:le}}},46806:function($,ie,f){"use strict";var C=f(29297),_=f.n(C),B=f(25813),K=f.n(B),k=f(48442),Q=f.n(k),X=f(97487),N=f.n(X),ce=f(88555),Y=f(11981);function Z(W,I,V){return(I=ee(I))in W?Object.defineProperty(W,I,{value:V,enumerable:!0,configurable:!0,writable:!0}):W[I]=V,W}function ee(W){var I=le(W,"string");return typeof I=="symbol"?I:I+""}function le(W,I){if(typeof W!="object"||!W)return W;var V=W[Symbol.toPrimitive];if(V!==void 0){var q=V.call(W,I||"default");if(typeof q!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(W)}class J{constructor(I){Z(this,"hot",null),Z(this,"container",null),Z(this,"injected",!1),Z(this,"rows",[]),Z(this,"columns",[]),Z(this,"samples",null),Z(this,"settings",{useHeaders:!0}),this.hot=I}addRow(I,V){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const q={row:I};this.rows.push(q),this.samples=V,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(I)),this.table.tr.appendChild(this.createRow(I)),I===0&&(0,ce.addClass)(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),q.table=this.table.table}addColumnHeadersRow(I){const V=this.hot.getColHeader(0);if(V!=null){const q={row:-1};this.rows.push(q),this.container=this.createContainer(this.hot.rootElement.className),this.samples=I,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),q.table=this.table.table}}addColumn(I,V){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const q={col:I};this.columns.push(q),this.samples=V,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(I)!==null&&this.hot.view.appendColHeader(I,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(I)),this.container.container.appendChild(this.table.fragment),q.table=this.table.table}getHeights(I){this.injected||this.injectTable(),(0,Y.arrayEach)(this.rows,V=>{const{height:q}=V.table.getBoundingClientRect();I(V.row,Math.ceil(q))})}getWidths(I){this.injected||this.injectTable(),(0,Y.arrayEach)(this.columns,V=>{const{width:q}=V.table.getBoundingClientRect();I(V.col,Math.ceil(q))})}setSettings(I){this.settings=I}setSetting(I,V){this.settings||(this.settings={}),this.settings[I]=V}getSettings(){return this.settings}getSetting(I){return this.settings?this.settings[I]:null}createColGroupsCol(I){const V=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&V.appendChild(this.createColElement(-1,-1)),this.samples.forEach(q=>{(0,Y.arrayEach)(q.strings,de=>{V.appendChild(this.createColElement(de.col,I))})}),V}createRow(I){const{rootDocument:V}=this.hot,q=V.createDocumentFragment(),de=V.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(I,de),q.appendChild(de)),this.samples.forEach(ue=>{(0,Y.arrayEach)(ue.strings,ve=>{const pe=ve.col,Se=this.hot.getCellMeta(I,pe),Ee=this.hot.getCellRenderer(Se),He=V.createElement("td");He.setAttribute("ghost-table",1),Ee(this.hot,He,I,pe,this.hot.colToProp(pe),ve.value,Se),q.appendChild(He)})}),q}appendColumnHeadersRow(){const{rootDocument:I}=this.hot,V=I.createDocumentFragment(),q=[];if(this.hot.hasRowHeaders()){const de=I.createElement("th");q.push([-1,de]),V.appendChild(de)}this.samples.forEach(de=>{(0,Y.arrayEach)(de.strings,ue=>{const ve=ue.col,pe=I.createElement("th");q.push([ve,pe]),V.appendChild(pe)})}),this.table.tHead.appendChild(V),(0,Y.arrayEach)(q,de=>{const[ue,ve]=de;this.hot.view.appendColHeader(ue,ve)})}createCol(I){const{rootDocument:V}=this.hot,q=V.createDocumentFragment();return this.samples.forEach(de=>{(0,Y.arrayEach)(de.strings,ue=>{const ve=ue.row,pe=this.hot.getCellMeta(ve,I),Se=this.hot.getCellRenderer(pe),Ee=V.createElement("td"),He=V.createElement("tr");Ee.setAttribute("ghost-table",1),Se(this.hot,Ee,ve,I,this.hot.colToProp(I),ue.value,pe),He.appendChild(Ee),q.appendChild(He)})}),q}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((I||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(I,V){const q=this.hot.rootDocument.createElement("col");let de=0;V>=0&&I>=0&&(de=this.hot.getCellMeta(V,I).colspan);let ue=this.hot.getColWidth(I);if(de>1)for(let ve=I+1;ve<I+de;ve++)ue+=this.hot.getColWidth(ve);return q.style.width=`${ue}px`,q}createTable(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:V}=this.hot,q=V.createDocumentFragment(),de=V.createElement("table"),ue=V.createElement("thead"),ve=V.createElement("tbody"),pe=V.createElement("colgroup"),Se=V.createElement("tr"),Ee=V.createElement("th");return this.isVertical()&&de.appendChild(pe),this.isHorizontal()&&(Se.appendChild(Ee),ue.appendChild(Se),de.style.tableLayout="auto",de.style.width="auto"),de.appendChild(ue),this.isVertical()&&ve.appendChild(Se),de.appendChild(ve),(0,ce.addClass)(de,I),q.appendChild(de),{fragment:q,table:de,tHead:ue,tBody:ve,colGroup:pe,tr:Se,th:Ee}}createContainer(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:V}=this.hot,q=V.createDocumentFragment(),de=V.createElement("div"),ue=`htGhostTable htAutoSize ${I.trim()}`;return(0,ce.addClass)(de,ue),q.appendChild(de),{fragment:q,container:de}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}ie.Z=J},67910:function($,ie,f){"use strict";f.r(ie),f.d(ie,{_dataToHTML:function(){return q},htmlToGridSettings:function(){return de},instanceToHTML:function(){return V}});var C=f(25813),_=f.n(C),B=f(34499),K=f.n(B),k=f(48442),Q=f.n(k),X=f(78127),N=f.n(X),ce=f(73190),Y=f.n(ce),Z=f(66515),ee=f.n(Z),le=f(13617);const J={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},W=new RegExp(Object.keys(J).map(ue=>`(${ue})`).join("|"),"gi");function I(ue){return(ue&&ue.nodeName||"")==="TABLE"}function V(ue){const ve=ue.hasColHeaders(),pe=ue.hasRowHeaders(),Se=[ve?-1:0,pe?-1:0,ue.countRows()-1,ue.countCols()-1],Ee=ue.getData(...Se),He=Ee.length,Fe=He>0?Ee[0].length:0,et=["<table>","</table>"],Oe=ve?["<thead>","</thead>"]:[],ct=["<tbody>","</tbody>"],ze=pe?1:0,dt=ve?1:0;for(let It=0;It<He;It+=1){const Sn=ve&&It===0,jt=[];for(let Be=0;Be<Fe;Be+=1){const hn=!Sn&&pe&&Be===0;let Je="";if(Sn)Je=`<th>${ue.getColHeader(Be-ze)}</th>`;else if(hn)Je=`<th>${ue.getRowHeader(It-dt)}</th>`;else{const mt=Ee[It][Be],{hidden:Ae,rowspan:rt,colspan:Ft}=ue.getCellMeta(It-dt,Be-ze);if(!Ae){const zt=[];if(rt&&zt.push(`rowspan="${rt}"`),Ft&&zt.push(`colspan="${Ft}"`),(0,le.isEmpty)(mt))Je=`<td ${zt.join(" ")}></td>`;else{const Et=mt.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");Je=`<td ${zt.join(" ")}>${Et}</td>`}}}jt.push(Je)}const Ye=["<tr>",...jt,"</tr>"].join("");Sn?Oe.splice(1,0,Ye):ct.splice(-1,0,Ye)}return et.splice(1,0,Oe.join(""),ct.join("")),et.join("")}function q(ue){const ve=ue.length,pe=["<table>"];for(let Se=0;Se<ve;Se+=1){const Ee=ue[Se],He=Ee.length,Fe=[];Se===0&&pe.push("<tbody>");for(let et=0;et<He;et+=1){const Oe=Ee[et],ct=(0,le.isEmpty)(Oe)?"":Oe.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,ze=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(ze.length-1)} </span>`).replace(/\t/gi,"&#9;");Fe.push(`<td>${ct}</td>`)}pe.push("<tr>",...Fe,"</tr>"),Se+1===ve&&pe.push("</tbody>")}return pe.push("</table>"),pe.join("")}function de(ue){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const pe={},Se=ve.createDocumentFragment(),Ee=ve.createElement("div");Se.appendChild(Ee);let He=ue;if(typeof He=="string"){const mt=He.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,Ae=>{const rt=Ae.match(/<td\b[^>]*?>/g)[0],Ft=/<p.*?>/g,zt=Ae.substring(rt.length,Ae.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(Ft,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${rt}${zt}</td>`});Ee.insertAdjacentHTML("afterbegin",`${mt}`),He=Ee.querySelector("table")}if(!He||!I(He))return;const Fe=Ee.querySelector('meta[name$="enerator"]'),et=He.querySelector("tbody th")!==null,Oe=He.querySelector("tr"),ct=Oe?Array.from(Oe.cells).reduce((mt,Ae)=>mt+Ae.colSpan,0)-(et?1:0):0,ze=He.tFoot&&Array.from(He.tFoot.rows)||[],dt=[];let It=!1,Sn=0,jt=0;if(He.tHead){const mt=Array.from(He.tHead.rows).filter(Ae=>{const rt=Ae.querySelector("td")!==null;return rt&&dt.push(Ae),!rt});Sn=mt.length,It=Sn>0,Sn>1?pe.nestedHeaders=Array.from(mt).reduce((Ae,rt)=>{const Ft=Array.from(rt.cells).reduce((zt,Et,Qe)=>{if(et&&Qe===0)return zt;const{colSpan:an,innerHTML:Mt}=Et,Cn=an>1?{label:Mt,colspan:an}:Mt;return zt.push(Cn),zt},[]);return Ae.push(Ft),Ae},[]):It&&(pe.colHeaders=Array.from(mt[0].children).reduce((Ae,rt,Ft)=>(et&&Ft===0||Ae.push(rt.innerHTML),Ae),[]))}dt.length&&(pe.fixedRowsTop=dt.length),ze.length&&(pe.fixedRowsBottom=ze.length);const Ye=[...dt,...Array.from(He.tBodies).reduce((mt,Ae)=>(mt.push(...Array.from(Ae.rows)),mt),[]),...ze];jt=Ye.length;const Be=new Array(jt);for(let mt=0;mt<jt;mt++)Be[mt]=new Array(ct);const hn=[],Je=[];for(let mt=0;mt<jt;mt++){const Ae=Ye[mt],rt=Array.from(Ae.cells),Ft=rt.length;for(let zt=0;zt<Ft;zt++){const Et=rt[zt],{nodeName:Qe,innerHTML:an,rowSpan:Mt,colSpan:Cn}=Et,bn=Be[mt].findIndex(mr=>mr===void 0);if(Qe==="TD"){if(Mt>1||Cn>1){for(let ir=mt;ir<mt+Mt;ir++)if(ir<jt)for(let Qn=bn;Qn<bn+Cn;Qn++)Be[ir][Qn]=null;const br=Et.getAttribute("style");br&&br.includes("mso-ignore:colspan")||hn.push({col:bn,row:mt,rowspan:Mt,colspan:Cn})}let mr="";Fe&&/excel/gi.test(Fe.content)?mr=an.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):mr=an.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),Be[mt][bn]=mr.replace(W,br=>J[br])}else Je.push(an)}}return hn.length&&(pe.mergeCells=hn),Je.length&&(pe.rowHeaders=Je),Be.length&&(pe.data=Be),pe}},80534:function($,ie,f){"use strict";f.d(ie,{Z:function(){return _}});const C=new Map;function _(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";C.has(B)||C.set(B,new Map);const K=C.get(B);function k(Y,Z){K.set(Y,Z)}function Q(Y){return K.get(Y)}function X(Y){return K.has(Y)}function N(){return[...K.keys()]}function ce(){return[...K.values()]}return{register:k,getItem:Q,hasItem:X,getNames:N,getValues:ce}}},72095:function($,ie,f){"use strict";f.d(ie,{Ie:function(){return Y},Te:function(){return ce},k_:function(){return X},oh:function(){return Q}});var C=f(29297),_=f.n(C),B=f(80534);const{register:K,getItem:k,hasItem:Q,getNames:X,getValues:N}=(0,B.Z)("validators");function ce(Z){if(typeof Z=="function")return Z;if(!Q(Z))throw Error(`No registered validator found under "${Z}" name`);return k(Z)}function Y(Z,ee){typeof Z!="string"&&(ee=Z,Z=ee.VALIDATOR_TYPE),K(Z,ee)}},15266:function($,ie,f){"use strict";var C=f(99187);$=f.hmd($);var _=typeof exports=="object"&&exports&&!exports.nodeType&&exports,B=_&&!0&&$&&!$.nodeType&&$,K=B&&B.exports===_,k=K?C.Z.Buffer:void 0,Q=k?k.allocUnsafe:void 0;function X(N,ce){if(ce)return N.slice();var Y=N.length,Z=Q?Q(Y):new N.constructor(Y);return N.copy(Z),Z}ie.Z=X},944:function($,ie,f){"use strict";var C=typeof f.g=="object"&&f.g&&f.g.Object===Object&&f.g;ie.Z=C},70301:function($,ie,f){"use strict";var C=f(944);$=f.hmd($);var _=typeof exports=="object"&&exports&&!exports.nodeType&&exports,B=_&&!0&&$&&!$.nodeType&&$,K=B&&B.exports===_,k=K&&C.Z.process,Q=function(){try{var X=B&&B.require&&B.require("util").types;return X||k&&k.binding&&k.binding("util")}catch(N){}}();ie.Z=Q},99187:function($,ie,f){"use strict";var C=f(944),_=typeof self=="object"&&self&&self.Object===Object&&self,B=C.Z||_||Function("return this")();ie.Z=B},9792:function($,ie,f){"use strict";var C=f(99187),_=f(74371);$=f.hmd($);var B=typeof exports=="object"&&exports&&!exports.nodeType&&exports,K=B&&!0&&$&&!$.nodeType&&$,k=K&&K.exports===B,Q=k?C.Z.Buffer:void 0,X=Q?Q.isBuffer:void 0,N=X||_.Z;ie.Z=N},72271:function($,ie,f){"use strict";f.r(ie),f.d(ie,{add:function(){return mt},after:function(){return Vs},ary:function(){return sl},assign:function(){return Ss},assignIn:function(){return ga},assignInWith:function(){return eu},assignWith:function(){return hc},at:function(){return Nn},attempt:function(){return mm},before:function(){return Sp},bind:function(){return hf},bindAll:function(){return eC},bindKey:function(){return nC},camelCase:function(){return Pm},capitalize:function(){return yd},castArray:function(){return vg},ceil:function(){return SC},chain:function(){return Dp},chunk:function(){return _f},clamp:function(){return yg},clone:function(){return s_},cloneDeep:function(){return o_},cloneDeepWith:function(){return a_},cloneWith:function(){return l_},commit:function(){return i0},compact:function(){return u_},concat:function(){return s0},cond:function(){return Of},conforms:function(){return E_},conformsTo:function(){return R_},constant:function(){return Go},countBy:function(){return D_},create:function(){return L_},curry:function(){return y0},curryRight:function(){return F_},debounce:function(){return S0},deburr:function(){return Op},default:function(){return IA},defaultTo:function(){return j_},defaults:function(){return QC},defaultsDeep:function(){return io},defer:function(){return iw},delay:function(){return sv},difference:function(){return M0},differenceBy:function(){return ow},differenceWith:function(){return K_},divide:function(){return Ym},drop:function(){return Y_},dropRight:function(){return Td},dropRightWhile:function(){return G_},dropWhile:function(){return uw},each:function(){return cw},eachRight:function(){return hw},endsWith:function(){return Q_},entries:function(){return Xm},entriesIn:function(){return xg},eq:function(){return ha},escape:function(){return Ag},escapeRegExp:function(){return Yr},every:function(){return dw},extend:function(){return ga},extendWith:function(){return eu},fill:function(){return ab},filter:function(){return ub},find:function(){return cb},findIndex:function(){return N0},findKey:function(){return hb},findLast:function(){return fb},findLastIndex:function(){return fw},findLastKey:function(){return gb},first:function(){return gw},flatMap:function(){return pb},flatMapDeep:function(){return D0},flatMapDepth:function(){return yb},flatten:function(){return cn},flattenDeep:function(){return H0},flattenDepth:function(){return Sb},flip:function(){return _b},floor:function(){return gv},flow:function(){return mw},flowRight:function(){return pw},forEach:function(){return cw},forEachRight:function(){return hw},forIn:function(){return qm},forInRight:function(){return Rb},forOwn:function(){return Fu},forOwnRight:function(){return Cw},fromPairs:function(){return F0},functions:function(){return cu},functionsIn:function(){return Tb},get:function(){return Mu},groupBy:function(){return Mb},gt:function(){return GO},gte:function(){return yw},has:function(){return mv},hasIn:function(){return YC},head:function(){return gw},identity:function(){return Ln},inRange:function(){return Hb},includes:function(){return j0},indexOf:function(){return Bb},initial:function(){return kb},intersection:function(){return tp},intersectionBy:function(){return hu},intersectionWith:function(){return _w},invert:function(){return Nf},invertBy:function(){return Tw},invoke:function(){return jb},invokeMap:function(){return Ub},isArguments:function(){return Ka},isArray:function(){return ze},isArrayBuffer:function(){return xi},isArrayLike:function(){return Ys},isArrayLikeObject:function(){return Ao},isBoolean:function(){return Kb},isBuffer:function(){return Dl.Z},isDate:function(){return Yb},isElement:function(){return Gb},isEmpty:function(){return Zb},isEqual:function(){return Qb},isEqualWith:function(){return qb},isError:function(){return cf},isFinite:function(){return eE},isFunction:function(){return en},isInteger:function(){return Q0},isLength:function(){return Su},isMap:function(){return Xi},isMatch:function(){return tE},isMatchWith:function(){return nE},isNaN:function(){return rE},isNative:function(){return Df},isNil:function(){return Ad},isNull:function(){return lE},isNumber:function(){return q0},isObject:function(){return Mt},isObjectLike:function(){return ue},isPlainObject:function(){return Ou},isRegExp:function(){return Iw},isSafeInteger:function(){return hE},isSet:function(){return oa},isString:function(){return pv},isSymbol:function(){return Se},isTypedArray:function(){return Ma},isUndefined:function(){return dE},isWeakMap:function(){return tS},isWeakSet:function(){return Nd},iteratee:function(){return nh},join:function(){return mE},kebabCase:function(){return pE},keyBy:function(){return vE},keys:function(){return Ar},keysIn:function(){return ns},last:function(){return lu},lastIndexOf:function(){return Pw},lodash:function(){return fe},lowerCase:function(){return wv},lowerFirst:function(){return yE},lt:function(){return SE},lte:function(){return Sv},map:function(){return Dg},mapKeys:function(){return _E},mapValues:function(){return iS},matches:function(){return EE},matchesProperty:function(){return TE},max:function(){return ME},maxBy:function(){return bc},mean:function(){return sS},meanBy:function(){return Dw},memoize:function(){return ti},merge:function(){return vl},mergeWith:function(){return nw},method:function(){return Yh},methodOf:function(){return Dd},min:function(){return _v},minBy:function(){return Yg},mixin:function(){return Gg},multiply:function(){return IE},negate:function(){return sp},next:function(){return Wu},noop:function(){return O},now:function(){return tv},nth:function(){return Gh},nthArg:function(){return du},omit:function(){return bv},omitBy:function(){return NE},once:function(){return DE},orderBy:function(){return cS},over:function(){return hS},overArgs:function(){return WE},overEvery:function(){return BE},overSome:function(){return dS},pad:function(){return kd},padEnd:function(){return Qg},padStart:function(){return yl},parseInt:function(){return cp},partial:function(){return em},partialRight:function(){return GE},partition:function(){return $E},pick:function(){return XE},pickBy:function(){return aS},plant:function(){return ZE},property:function(){return g0},propertyOf:function(){return JE},pull:function(){return QE},pullAll:function(){return wS},pullAllBy:function(){return Iv},pullAllWith:function(){return qE},pullAt:function(){return tR},random:function(){return nR},range:function(){return sR},rangeRight:function(){return oR},rearg:function(){return Zi},reduce:function(){return rh},reduceRight:function(){return Nv},reject:function(){return Xw},remove:function(){return ES},repeat:function(){return uR},replace:function(){return Dv},rest:function(){return hR},result:function(){return hp},reverse:function(){return Zw},round:function(){return zu},sample:function(){return gR},sampleSize:function(){return MS},set:function(){return pR},setWith:function(){return vR},shuffle:function(){return CR},size:function(){return wR},slice:function(){return yR},snakeCase:function(){return SR},some:function(){return bR},sortBy:function(){return ER},sortedIndex:function(){return ey},sortedIndexBy:function(){return IR},sortedIndexOf:function(){return PR},sortedLastIndex:function(){return dp},sortedLastIndexBy:function(){return PS},sortedLastIndexOf:function(){return Uf},sortedUniq:function(){return NR},sortedUniqBy:function(){return NS},split:function(){return DS},spread:function(){return HS},startCase:function(){return ny},startsWith:function(){return Sl},stubArray:function(){return Hm},stubFalse:function(){return eS.Z},stubObject:function(){return LS},stubString:function(){return zf},stubTrue:function(){return LR},subtract:function(){return Hv},sum:function(){return iy},sumBy:function(){return WR},tail:function(){return WS},take:function(){return Lv},takeRight:function(){return BR},takeRightWhile:function(){return kR},takeWhile:function(){return oo},tap:function(){return oh},template:function(){return Bv},templateSettings:function(){return Mc},throttle:function(){return YR},thru:function(){return pp},times:function(){return GR},toArray:function(){return so},toFinite:function(){return Mi},toInteger:function(){return Hn},toIterator:function(){return VS},toJSON:function(){return om},toLength:function(){return Uh},toLower:function(){return vp},toNumber:function(){return Qn},toPairs:function(){return Xm},toPairsIn:function(){return xg},toPath:function(){return XR},toPlainObject:function(){return b0},toSafeInteger:function(){return jS},toString:function(){return ri},toUpper:function(){return JR},transform:function(){return ay},trim:function(){return qR},trimEnd:function(){return eT},trimStart:function(){return tT},truncate:function(){return rT},unary:function(){return iT},unescape:function(){return kv},union:function(){return am},unionBy:function(){return lT},unionWith:function(){return uT},uniq:function(){return cT},uniqBy:function(){return hT},uniqWith:function(){return dT},uniqueId:function(){return fT},unset:function(){return gT},unzip:function(){return Vv},unzipWith:function(){return KS},update:function(){return pT},updateWith:function(){return vT},upperCase:function(){return wT},upperFirst:function(){return vi},value:function(){return om},valueOf:function(){return om},values:function(){return Fg},valuesIn:function(){return yT},without:function(){return fy},words:function(){return xp},wrap:function(){return ST},wrapperAt:function(){return gy},wrapperChain:function(){return bT},wrapperCommit:function(){return i0},wrapperLodash:function(){return fe},wrapperNext:function(){return Wu},wrapperPlant:function(){return ZE},wrapperReverse:function(){return ET},wrapperToIterator:function(){return VS},wrapperValue:function(){return om},xor:function(){return jv},xorBy:function(){return TT},xorWith:function(){return OT},zip:function(){return PT},zipObject:function(){return zv},zipObjectDeep:function(){return AT},zipWith:function(){return Yv}});var C=f(99187),_=C.Z.Symbol,B=_,K=Object.prototype,k=K.hasOwnProperty,Q=K.toString,X=B?B.toStringTag:void 0;function N(o){var h=k.call(o,X),y=o[X];try{o[X]=void 0;var A=!0}catch(ge){}var G=Q.call(o);return A&&(h?o[X]=y:delete o[X]),G}var ce=N,Y=Object.prototype,Z=Y.toString;function ee(o){return Z.call(o)}var le=ee,J="[object Null]",W="[object Undefined]",I=B?B.toStringTag:void 0;function V(o){return o==null?o===void 0?W:J:I&&I in Object(o)?ce(o):le(o)}var q=V;function de(o){return o!=null&&typeof o=="object"}var ue=de,ve="[object Symbol]";function pe(o){return typeof o=="symbol"||ue(o)&&q(o)==ve}var Se=pe,Ee=NaN;function He(o){return typeof o=="number"?o:Se(o)?Ee:+o}var Fe=He;function et(o,h){for(var y=-1,A=o==null?0:o.length,G=Array(A);++y<A;)G[y]=h(o[y],y,o);return G}var Oe=et,ct=Array.isArray,ze=ct,dt=1/0,It=B?B.prototype:void 0,Sn=It?It.toString:void 0;function jt(o){if(typeof o=="string")return o;if(ze(o))return Oe(o,jt)+"";if(Se(o))return Sn?Sn.call(o):"";var h=o+"";return h=="0"&&1/o==-dt?"-0":h}var Ye=jt;function Be(o,h){return function(y,A){var G;if(y===void 0&&A===void 0)return h;if(y!==void 0&&(G=y),A!==void 0){if(G===void 0)return A;typeof y=="string"||typeof A=="string"?(y=Ye(y),A=Ye(A)):(y=Fe(y),A=Fe(A)),G=o(y,A)}return G}}var hn=Be,Je=hn(function(o,h){return o+h},0),mt=Je,Ae=/\s/;function rt(o){for(var h=o.length;h--&&Ae.test(o.charAt(h)););return h}var Ft=rt,zt=/^\s+/;function Et(o){return o&&o.slice(0,Ft(o)+1).replace(zt,"")}var Qe=Et;function an(o){var h=typeof o;return o!=null&&(h=="object"||h=="function")}var Mt=an,Cn=NaN,bn=/^[-+]0x[0-9a-f]+$/i,mr=/^0b[01]+$/i,br=/^0o[0-7]+$/i,qr=parseInt;function ir(o){if(typeof o=="number")return o;if(Se(o))return Cn;if(Mt(o)){var h=typeof o.valueOf=="function"?o.valueOf():o;o=Mt(h)?h+"":h}if(typeof o!="string")return o===0?o:+o;o=Qe(o);var y=mr.test(o);return y||br.test(o)?qr(o.slice(2),y?2:8):bn.test(o)?Cn:+o}var Qn=ir,kr=1/0,mn=17976931348623157e292;function Rs(o){if(!o)return o===0?o:0;if(o=Qn(o),o===kr||o===-kr){var h=o<0?-1:1;return h*mn}return o===o?o:0}var Mi=Rs;function _o(o){var h=Mi(o),y=h%1;return h===h?y?h-y:h:0}var Hn=_o,Oi="Expected a function";function pr(o,h){if(typeof h!="function")throw new TypeError(Oi);return o=Hn(o),function(){if(--o<1)return h.apply(this,arguments)}}var Vs=pr;function Qi(o){return o}var Ln=Qi,yn="[object AsyncFunction]",qi="[object Function]",In="[object GeneratorFunction]",un="[object Proxy]";function Xn(o){if(!Mt(o))return!1;var h=q(o);return h==qi||h==In||h==yn||h==un}var en=Xn,Vr=C.Z["__core-js_shared__"],di=Vr,Mr=function(){var o=/[^.]+$/.exec(di&&di.keys&&di.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function js(o){return!!Mr&&Mr in o}var as=js,Te=Function.prototype,tt=Te.toString;function St(o){if(o!=null){try{return tt.call(o)}catch(h){}try{return o+""}catch(h){}}return""}var Ke=St,Gt=/[\\^$.*+?()[\]{}|]/g,Vn=/^\[object .+?Constructor\]$/,$r=Function.prototype,Ur=Object.prototype,sr=$r.toString,Ps=Ur.hasOwnProperty,ur=RegExp("^"+sr.call(Ps).replace(Gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Hr(o){if(!Mt(o)||as(o))return!1;var h=en(o)?ur:Vn;return h.test(Ke(o))}var Rr=Hr;function bo(o,h){return o==null?void 0:o[h]}var Kn=bo;function zi(o,h){var y=Kn(o,h);return Rr(y)?y:void 0}var Pr=zi,gi=Pr(C.Z,"WeakMap"),Lr=gi,ps=Lr&&new Lr,Ue=ps,xt=Ue?function(o,h){return Ue.set(o,h),o}:Ln,$t=xt,_n=Object.create,Xr=function(){function o(){}return function(h){if(!Mt(h))return{};if(_n)return _n(h);o.prototype=h;var y=new o;return o.prototype=void 0,y}}(),Er=Xr;function Di(o){return function(){var h=arguments;switch(h.length){case 0:return new o;case 1:return new o(h[0]);case 2:return new o(h[0],h[1]);case 3:return new o(h[0],h[1],h[2]);case 4:return new o(h[0],h[1],h[2],h[3]);case 5:return new o(h[0],h[1],h[2],h[3],h[4]);case 6:return new o(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new o(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var y=Er(o.prototype),A=o.apply(y,h);return Mt(A)?A:y}}var fi=Di,fr=1;function tl(o,h,y){var A=h&fr,G=fi(o);function ge(){var Re=this&&this!==C.Z&&this instanceof ge?G:o;return Re.apply(A?y:this,arguments)}return ge}var li=tl;function Eo(o,h,y){switch(y.length){case 0:return o.call(h);case 1:return o.call(h,y[0]);case 2:return o.call(h,y[0],y[1]);case 3:return o.call(h,y[0],y[1],y[2])}return o.apply(h,y)}var Wn=Eo,vs=Math.max;function bl(o,h,y,A){for(var G=-1,ge=o.length,Re=y.length,Ve=-1,st=h.length,kt=vs(ge-Re,0),Vt=Array(st+kt),Zt=!A;++Ve<st;)Vt[Ve]=h[Ve];for(;++G<Re;)(Zt||G<ge)&&(Vt[y[G]]=o[G]);for(;kt--;)Vt[Ve++]=o[G++];return Vt}var xn=bl,tn=Math.max;function Ko(o,h,y,A){for(var G=-1,ge=o.length,Re=-1,Ve=y.length,st=-1,kt=h.length,Vt=tn(ge-Ve,0),Zt=Array(Vt+kt),kn=!A;++G<Vt;)Zt[G]=o[G];for(var rr=G;++st<kt;)Zt[rr+st]=h[st];for(;++Re<Ve;)(kn||G<ge)&&(Zt[rr+y[Re]]=o[G++]);return Zt}var nl=Ko;function lo(o,h){for(var y=o.length,A=0;y--;)o[y]===h&&++A;return A}var xs=lo;function Yi(){}var ya=Yi,ka=4294967295;function ls(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ka,this.__views__=[]}ls.prototype=Er(ya.prototype),ls.prototype.constructor=ls;var dr=ls;function se(){}var O=se,x=Ue?function(o){return Ue.get(o)}:O,re=x,he={},Me=he,Xe=Object.prototype,nt=Xe.hasOwnProperty;function Tt(o){for(var h=o.name+"",y=Me[h],A=nt.call(Me,h)?y.length:0;A--;){var G=y[A],ge=G.func;if(ge==null||ge==o)return G.name}return h}var En=Tt;function Tn(o,h){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=void 0}Tn.prototype=Er(ya.prototype),Tn.prototype.constructor=Tn;var pn=Tn;function vr(o,h){var y=-1,A=o.length;for(h||(h=Array(A));++y<A;)h[y]=o[y];return h}var Cr=vr;function Cs(o){if(o instanceof dr)return o.clone();var h=new pn(o.__wrapped__,o.__chain__);return h.__actions__=Cr(o.__actions__),h.__index__=o.__index__,h.__values__=o.__values__,h}var Gi=Cs,As=Object.prototype,Ro=As.hasOwnProperty;function Ns(o){if(ue(o)&&!ze(o)&&!(o instanceof dr)){if(o instanceof pn)return o;if(Ro.call(o,"__wrapped__"))return Gi(o)}return new pn(o)}Ns.prototype=ya.prototype,Ns.prototype.constructor=Ns;var fe=Ns;function Do(o){var h=En(o),y=fe[h];if(typeof y!="function"||!(h in dr.prototype))return!1;if(o===y)return!0;var A=re(y);return!!A&&o===A[0]}var Yn=Do,Us=800,To=16,qs=Date.now;function Zu(o){var h=0,y=0;return function(){var A=qs(),G=To-(A-y);if(y=A,G>0){if(++h>=Us)return arguments[0]}else h=0;return o.apply(void 0,arguments)}}var Si=Zu,Sa=Si($t),El=Sa,or=/\{\n\/\* \[wrapped with (.+)\] \*/,Ts=/,? & /;function ua(o){var h=o.match(or);return h?h[1].split(Ts):[]}var rl=ua,mu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function zs(o,h){var y=h.length;if(!y)return o;var A=y-1;return h[A]=(y>1?"& ":"")+h[A],h=h.join(y>2?", ":" "),o.replace(mu,`{
/* [wrapped with `+h+`] */
`)}var ws=zs;function Yo(o){return function(){return o}}var Go=Yo,Mo=function(){try{var o=Pr(Object,"defineProperty");return o({},"",{}),o}catch(h){}}(),Rl=Mo,Va=Rl?function(o,h){return Rl(o,"toString",{configurable:!0,enumerable:!1,value:Go(h),writable:!0})}:Ln,Ho=Va,Ju=Si(Ho),pu=Ju;function Lo(o,h){for(var y=-1,A=o==null?0:o.length;++y<A&&h(o[y],y,o)!==!1;);return o}var Fr=Lo;function Gn(o,h,y,A){for(var G=o.length,ge=y+(A?1:-1);A?ge--:++ge<G;)if(h(o[ge],ge,o))return ge;return-1}var je=Gn;function Wt(o){return o!==o}var Pn=Wt;function Hi(o,h,y){for(var A=y-1,G=o.length;++A<G;)if(o[A]===h)return A;return-1}var es=Hi;function _i(o,h,y){return h===h?es(o,h,y):je(o,Pn,y)}var Li=_i;function _a(o,h){var y=o==null?0:o.length;return!!y&&Li(o,h,0)>-1}var Tl=_a,ba=1,uo=2,Ml=8,vu=16,Oc=32,Zf=64,Ic=128,ah=256,Jf=512,Kd=[["ary",Ic],["bind",ba],["bindKey",uo],["curry",Ml],["curryRight",vu],["flip",Jf],["partial",Oc],["partialRight",Zf],["rearg",ah]];function Pc(o,h){return Fr(Kd,function(y){var A="_."+y[0];h&y[1]&&!Tl(o,A)&&o.push(A)}),o.sort()}var $o=Pc;function xc(o,h,y){var A=h+"";return pu(o,ws(A,$o(rl(A),y)))}var Yd=xc,rd=1,Gd=2,Qf=4,qf=8,lh=32,Cu=64;function eg(o,h,y,A,G,ge,Re,Ve,st,kt){var Vt=h&qf,Zt=Vt?Re:void 0,kn=Vt?void 0:Re,rr=Vt?ge:void 0,Or=Vt?void 0:ge;h|=Vt?lh:Cu,h&=~(Vt?Cu:lh),h&Qf||(h&=~(rd|Gd));var ci=[o,h,G,rr,Zt,Or,kn,Ve,st,kt],Ir=y.apply(void 0,ci);return Yn(o)&&El(Ir,ci),Ir.placeholder=A,Yd(Ir,o,h)}var Ol=eg;function ja(o){var h=o;return h.placeholder}var Ea=ja,Ra=9007199254740991,tg=/^(?:0|[1-9]\d*)$/;function id(o,h){var y=typeof o;return h=h==null?Ra:h,!!h&&(y=="number"||y!="symbol"&&tg.test(o))&&o>-1&&o%1==0&&o<h}var Il=id,uh=Math.min;function Oo(o,h){for(var y=o.length,A=uh(h.length,y),G=Cr(o);A--;){var ge=h[A];o[A]=Il(ge,y)?G[ge]:void 0}return o}var wu=Oo,Ii="__lodash_placeholder__";function ng(o,h){for(var y=-1,A=o.length,G=0,ge=[];++y<A;){var Re=o[y];(Re===h||Re===Ii)&&(o[y]=Ii,ge[G++]=y)}return ge}var eo=ng,$d=1,rg=2,yu=8,$l=16,Io=128,Xd=512;function ch(o,h,y,A,G,ge,Re,Ve,st,kt){var Vt=h&Io,Zt=h&$d,kn=h&rg,rr=h&(yu|$l),Or=h&Xd,ci=kn?void 0:fi(o);function Ir(){for(var yi=arguments.length,Ni=Array(yi),ao=yi;ao--;)Ni[ao]=arguments[ao];if(rr)var Ba=Ea(Ir),Yu=xs(Ni,Ba);if(A&&(Ni=xn(Ni,A,G,rr)),ge&&(Ni=nl(Ni,ge,Re,rr)),yi-=Yu,rr&&yi<kt){var zo=eo(Ni,Ba);return Ol(o,h,ch,Ir.placeholder,y,Ni,zo,Ve,st,kt-yi)}var Gu=Zt?y:this,ed=kn?Gu[o]:o;return yi=Ni.length,Ve?Ni=wu(Ni,Ve):Or&&yi>1&&Ni.reverse(),Vt&&st<yi&&(Ni.length=st),this&&this!==C.Z&&this instanceof Ir&&(ed=ci||fi(ed)),ed.apply(Gu,Ni)}return Ir}var Qu=ch;function Fi(o,h,y){var A=fi(o);function G(){for(var ge=arguments.length,Re=Array(ge),Ve=ge,st=Ea(G);Ve--;)Re[Ve]=arguments[Ve];var kt=ge<3&&Re[0]!==st&&Re[ge-1]!==st?[]:eo(Re,st);if(ge-=kt.length,ge<y)return Ol(o,h,Qu,G.placeholder,void 0,Re,kt,void 0,void 0,y-ge);var Vt=this&&this!==C.Z&&this instanceof G?A:o;return Wn(Vt,this,Re)}return G}var qu=Fi,Xl=1;function Rn(o,h,y,A){var G=h&Xl,ge=fi(o);function Re(){for(var Ve=-1,st=arguments.length,kt=-1,Vt=A.length,Zt=Array(Vt+st),kn=this&&this!==C.Z&&this instanceof Re?ge:o;++kt<Vt;)Zt[kt]=A[kt];for(;st--;)Zt[kt++]=arguments[++Ve];return Wn(kn,G?y:this,Zt)}return Re}var Ac=Rn,Nc="__lodash_placeholder__",Zl=1,hh=2,ec=4,Zd=8,Jl=128,Jd=256,sd=Math.min;function Xo(o,h){var y=o[1],A=h[1],G=y|A,ge=G<(Zl|hh|Jl),Re=A==Jl&&y==Zd||A==Jl&&y==Jd&&o[7].length<=h[8]||A==(Jl|Jd)&&h[7].length<=h[8]&&y==Zd;if(!(ge||Re))return o;A&Zl&&(o[2]=h[2],G|=y&Zl?0:ec);var Ve=h[3];if(Ve){var st=o[3];o[3]=st?xn(st,Ve,h[4]):Ve,o[4]=st?eo(o[3],Nc):h[4]}return Ve=h[5],Ve&&(st=o[5],o[5]=st?nl(st,Ve,h[6]):Ve,o[6]=st?eo(o[5],Nc):h[6]),Ve=h[7],Ve&&(o[7]=Ve),A&Jl&&(o[8]=o[8]==null?h[8]:sd(o[8],h[8])),o[9]==null&&(o[9]=h[9]),o[0]=h[0],o[1]=G,o}var Qd=Xo,il="Expected a function",tc=1,qd=2,Ua=8,Zo=16,nc=32,Ql=64,Po=Math.max;function Fo(o,h,y,A,G,ge,Re,Ve){var st=h&qd;if(!st&&typeof o!="function")throw new TypeError(il);var kt=A?A.length:0;if(kt||(h&=~(nc|Ql),A=G=void 0),Re=Re===void 0?Re:Po(Hn(Re),0),Ve=Ve===void 0?Ve:Hn(Ve),kt-=G?G.length:0,h&Ql){var Vt=A,Zt=G;A=G=void 0}var kn=st?void 0:re(o),rr=[o,h,y,A,G,Vt,Zt,ge,Re,Ve];if(kn&&Qd(rr,kn),o=rr[0],h=rr[1],y=rr[2],A=rr[3],G=rr[4],Ve=rr[9]=rr[9]===void 0?st?0:o.length:Po(rr[9]-kt,0),!Ve&&h&(Ua|Zo)&&(h&=~(Ua|Zo)),!h||h==tc)var Or=li(o,h,y);else h==Ua||h==Zo?Or=qu(o,h,Ve):(h==nc||h==(tc|nc))&&!G.length?Or=Ac(o,h,y,A):Or=Qu.apply(void 0,rr);var ci=kn?$t:El;return Yd(ci(Or,rr),o,h)}var ca=Fo,od=128;function rc(o,h,y){return h=y?void 0:h,h=o&&h==null?o.length:h,ca(o,od,void 0,void 0,void 0,void 0,h)}var sl=rc;function ef(o,h,y){h=="__proto__"&&Rl?Rl(o,h,{configurable:!0,enumerable:!0,value:y,writable:!0}):o[h]=y}var Ta=ef;function dh(o,h){return o===h||o!==o&&h!==h}var ha=dh,Ks=Object.prototype,fh=Ks.hasOwnProperty;function ig(o,h,y){var A=o[h];(!(fh.call(o,h)&&ha(A,y))||y===void 0&&!(h in o))&&Ta(o,h,y)}var ic=ig;function gh(o,h,y,A){var G=!y;y||(y={});for(var ge=-1,Re=h.length;++ge<Re;){var Ve=h[ge],st=A?A(y[Ve],o[Ve],Ve,y,o):void 0;st===void 0&&(st=o[Ve]),G?Ta(y,Ve,st):ic(y,Ve,st)}return y}var Jo=gh,tf=Math.max;function sc(o,h,y){return h=tf(h===void 0?o.length-1:h,0),function(){for(var A=arguments,G=-1,ge=tf(A.length-h,0),Re=Array(ge);++G<ge;)Re[G]=A[h+G];G=-1;for(var Ve=Array(h+1);++G<h;)Ve[G]=A[G];return Ve[h]=y(Re),Wn(o,this,Ve)}}var nf=sc;function sg(o,h){return pu(nf(o,h,Ln),o+"")}var xr=sg,rf=9007199254740991;function sf(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=rf}var Su=sf;function og(o){return o!=null&&Su(o.length)&&!en(o)}var Ys=og;function Dc(o,h,y){if(!Mt(y))return!1;var A=typeof h;return(A=="number"?Ys(y)&&Il(h,y.length):A=="string"&&h in y)?ha(y[h],o):!1}var Gs=Dc;function cm(o){return xr(function(h,y){var A=-1,G=y.length,ge=G>1?y[G-1]:void 0,Re=G>2?y[2]:void 0;for(ge=o.length>3&&typeof ge=="function"?(G--,ge):void 0,Re&&Gs(y[0],y[1],Re)&&(ge=G<3?void 0:ge,G=1),h=Object(h);++A<G;){var Ve=y[A];Ve&&o(h,Ve,A,ge)}return h})}var za=cm,ol=Object.prototype;function ad(o){var h=o&&o.constructor,y=typeof h=="function"&&h.prototype||ol;return o===y}var Hc=ad;function jr(o,h){for(var y=-1,A=Array(o);++y<o;)A[y]=h(y);return A}var Qo=jr,Lc="[object Arguments]";function Pl(o){return ue(o)&&q(o)==Lc}var xl=Pl,of=Object.prototype,Al=of.hasOwnProperty,ld=of.propertyIsEnumerable,Nl=xl(function(){return arguments}())?xl:function(o){return ue(o)&&Al.call(o,"callee")&&!ld.call(o,"callee")},Ka=Nl,Dl=f(9792),mh="[object Arguments]",Fc="[object Array]",$s="[object Boolean]",ud="[object Date]",hm="[object Error]",ql="[object Function]",Hl="[object Map]",qo="[object Number]",cd="[object Object]",yp="[object RegExp]",af="[object Set]",ph="[object String]",_u="[object WeakMap]",Pi="[object ArrayBuffer]",Wo="[object DataView]",ea="[object Float32Array]",Ya="[object Float64Array]",ui="[object Int8Array]",da="[object Int16Array]",ys="[object Int32Array]",Ll="[object Uint8Array]",oc="[object Uint8ClampedArray]",co="[object Uint16Array]",ac="[object Uint32Array]",Wi={};Wi[ea]=Wi[Ya]=Wi[ui]=Wi[da]=Wi[ys]=Wi[Ll]=Wi[oc]=Wi[co]=Wi[ac]=!0,Wi[mh]=Wi[Fc]=Wi[Pi]=Wi[$s]=Wi[Wo]=Wi[ud]=Wi[hm]=Wi[ql]=Wi[Hl]=Wi[qo]=Wi[cd]=Wi[yp]=Wi[af]=Wi[ph]=Wi[_u]=!1;function Ds(o){return ue(o)&&Su(o.length)&&!!Wi[q(o)]}var vh=Ds;function Br(o){return function(h){return o(h)}}var ta=Br,ho=f(70301),bi=ho.Z&&ho.Z.isTypedArray,us=bi?ta(bi):vh,Ma=us,Fl=Object.prototype,hd=Fl.hasOwnProperty;function Wl(o,h){var y=ze(o),A=!y&&Ka(o),G=!y&&!A&&(0,Dl.Z)(o),ge=!y&&!A&&!G&&Ma(o),Re=y||A||G||ge,Ve=Re?Qo(o.length,String):[],st=Ve.length;for(var kt in o)(h||hd.call(o,kt))&&!(Re&&(kt=="length"||G&&(kt=="offset"||kt=="parent")||ge&&(kt=="buffer"||kt=="byteLength"||kt=="byteOffset")||Il(kt,st)))&&Ve.push(kt);return Ve}var lc=Wl;function dd(o,h){return function(y){return o(h(y))}}var cs=dd,na=cs(Object.keys,Object),Bl=na,Oa=Object.prototype,ts=Oa.hasOwnProperty;function fa(o){if(!Hc(o))return Bl(o);var h=[];for(var y in Object(o))ts.call(o,y)&&y!="constructor"&&h.push(y);return h}var Ut=fa;function lf(o){return Ys(o)?lc(o):Ut(o)}var Ar=lf,to=Object.prototype,ei=to.hasOwnProperty,Ia=za(function(o,h){if(Hc(h)||Ys(h)){Jo(h,Ar(h),o);return}for(var y in h)ei.call(h,y)&&ic(o,y,h[y])}),Ss=Ia;function bu(o){var h=[];if(o!=null)for(var y in Object(o))h.push(y);return h}var uc=bu,ra=Object.prototype,Bi=ra.hasOwnProperty;function al(o){if(!Mt(o))return uc(o);var h=Hc(o),y=[];for(var A in o)A=="constructor"&&(h||!Bi.call(o,A))||y.push(A);return y}var Ch=al;function Pa(o){return Ys(o)?lc(o,!0):Ch(o)}var ns=Pa,cc=za(function(o,h){Jo(h,ns(h),o)}),ga=cc,wh=za(function(o,h,y,A){Jo(h,ns(h),o,A)}),eu=wh,tu=za(function(o,h,y,A){Jo(h,Ar(h),o,A)}),hc=tu,fd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gd=/^\w*$/;function ma(o,h){if(ze(o))return!1;var y=typeof o;return y=="number"||y=="symbol"||y=="boolean"||o==null||Se(o)?!0:gd.test(o)||!fd.test(o)||h!=null&&o in Object(h)}var Eu=ma,yh=Pr(Object,"create"),dc=yh;function md(){this.__data__=dc?dc(null):{},this.size=0}var Wc=md;function ag(o){var h=this.has(o)&&delete this.__data__[o];return this.size-=h?1:0,h}var ll=ag,fc="__lodash_hash_undefined__",nu=Object.prototype,lg=nu.hasOwnProperty;function Bc(o){var h=this.__data__;if(dc){var y=h[o];return y===fc?void 0:y}return lg.call(h,o)?h[o]:void 0}var _s=Bc,Hs=Object.prototype,Ru=Hs.hasOwnProperty;function pd(o){var h=this.__data__;return dc?h[o]!==void 0:Ru.call(h,o)}var Sh=pd,_h="__lodash_hash_undefined__";function ul(o,h){var y=this.__data__;return this.size+=this.has(o)?0:1,y[o]=dc&&h===void 0?_h:h,this}var xa=ul;function ru(o){var h=-1,y=o==null?0:o.length;for(this.clear();++h<y;){var A=o[h];this.set(A[0],A[1])}}ru.prototype.clear=Wc,ru.prototype.delete=ll,ru.prototype.get=_s,ru.prototype.has=Sh,ru.prototype.set=xa;var bh=ru;function Bo(){this.__data__=[],this.size=0}var cl=Bo;function dm(o,h){for(var y=o.length;y--;)if(ha(o[y][0],h))return y;return-1}var gc=dm,uf=Array.prototype,ug=uf.splice;function cg(o){var h=this.__data__,y=gc(h,o);if(y<0)return!1;var A=h.length-1;return y==A?h.pop():ug.call(h,y,1),--this.size,!0}var v=cg;function b(o){var h=this.__data__,y=gc(h,o);return y<0?void 0:h[y][1]}var D=b;function F(o){return gc(this.__data__,o)>-1}var c=F;function m(o,h){var y=this.__data__,A=gc(y,o);return A<0?(++this.size,y.push([o,h])):y[A][1]=h,this}var E=m;function R(o){var h=-1,y=o==null?0:o.length;for(this.clear();++h<y;){var A=o[h];this.set(A[0],A[1])}}R.prototype.clear=cl,R.prototype.delete=v,R.prototype.get=D,R.prototype.has=c,R.prototype.set=E;var L=R,ae=Pr(C.Z,"Map"),Ce=ae;function _e(){this.size=0,this.__data__={hash:new bh,map:new(Ce||L),string:new bh}}var Ge=_e;function ht(o){var h=typeof o;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?o!=="__proto__":o===null}var Dt=ht;function Ht(o,h){var y=o.__data__;return Dt(h)?y[typeof h=="string"?"string":"hash"]:y.map}var tr=Ht;function cr(o){var h=tr(this,o).delete(o);return this.size-=h?1:0,h}var An=cr;function lt(o){return tr(this,o).get(o)}var Nt=lt;function At(o){return tr(this,o).has(o)}var vn=At;function qn(o,h){var y=tr(this,o),A=y.size;return y.set(o,h),this.size+=y.size==A?0:1,this}var hr=qn;function Qt(o){var h=-1,y=o==null?0:o.length;for(this.clear();++h<y;){var A=o[h];this.set(A[0],A[1])}}Qt.prototype.clear=Ge,Qt.prototype.delete=An,Qt.prototype.get=Nt,Qt.prototype.has=vn,Qt.prototype.set=hr;var dn=Qt,ar="Expected a function";function ai(o,h){if(typeof o!="function"||h!=null&&typeof h!="function")throw new TypeError(ar);var y=function(){var A=arguments,G=h?h.apply(this,A):A[0],ge=y.cache;if(ge.has(G))return ge.get(G);var Re=o.apply(this,A);return y.cache=ge.set(G,Re)||ge,Re};return y.cache=new(ai.Cache||dn),y}ai.Cache=dn;var ti=ai,Ei=500;function bs(o){var h=ti(o,function(A){return y.size===Ei&&y.clear(),A}),y=h.cache;return h}var $n=bs,ni=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lr=/\\(\\)?/g,Ls=$n(function(o){var h=[];return o.charCodeAt(0)===46&&h.push(""),o.replace(ni,function(y,A,G,ge){h.push(G?ge.replace(lr,"$1"):A||y)}),h}),Tu=Ls;function kc(o){return o==null?"":Ye(o)}var ri=kc;function iu(o,h){return ze(o)?o:Eu(o,h)?[o]:Tu(ri(o))}var mc=iu,ia=1/0;function fm(o){if(typeof o=="string"||Se(o))return o;var h=o+"";return h=="0"&&1/o==-ia?"-0":h}var Aa=fm;function hg(o,h){h=mc(h,o);for(var y=0,A=h.length;o!=null&&y<A;)o=o[Aa(h[y++])];return y&&y==A?o:void 0}var kl=hg;function ko(o,h,y){var A=o==null?void 0:kl(o,h);return A===void 0?y:A}var Mu=ko;function gm(o,h){for(var y=-1,A=h.length,G=Array(A),ge=o==null;++y<A;)G[y]=ge?void 0:Mu(o,h[y]);return G}var Eh=gm;function Ne(o,h){for(var y=-1,A=h.length,G=o.length;++y<A;)o[G+y]=h[y];return o}var We=Ne,Rt=B?B.isConcatSpreadable:void 0;function ln(o){return ze(o)||Ka(o)||!!(Rt&&o&&o[Rt])}var Xt=ln;function rn(o,h,y,A,G){var ge=-1,Re=o.length;for(y||(y=Xt),G||(G=[]);++ge<Re;){var Ve=o[ge];h>0&&y(Ve)?h>1?rn(Ve,h-1,y,A,G):We(G,Ve):A||(G[G.length]=Ve)}return G}var fn=rn;function gt(o){var h=o==null?0:o.length;return h?fn(o,1):[]}var cn=gt;function Lt(o){return pu(nf(o,void 0,cn),o+"")}var wn=Lt,Dn=wn(Eh),Nn=Dn,wr=cs(Object.getPrototypeOf,Object),Zr=wr,rs="[object Object]",ki=Function.prototype,Na=Object.prototype,fo=ki.toString,Da=Na.hasOwnProperty,Ga=fo.call(Object);function Vc(o){if(!ue(o)||q(o)!=rs)return!1;var h=Zr(o);if(h===null)return!0;var y=Da.call(h,"constructor")&&h.constructor;return typeof y=="function"&&y instanceof y&&fo.call(y)==Ga}var Ou=Vc,$a="[object DOMException]",su="[object Error]";function sa(o){if(!ue(o))return!1;var h=q(o);return h==su||h==$a||typeof o.message=="string"&&typeof o.name=="string"&&!Ou(o)}var cf=sa,Qv=xr(function(o,h){try{return Wn(o,void 0,h)}catch(y){return cf(y)?y:new Error(y)}}),mm=Qv,qv="Expected a function";function wy(o,h){var y;if(typeof h!="function")throw new TypeError(qv);return o=Hn(o),function(){return--o>0&&(y=h.apply(this,arguments)),o<=1&&(h=void 0),y}}var Sp=wy,jc=1,_p=32,bp=xr(function(o,h,y){var A=jc;if(y.length){var G=eo(y,Ea(bp));A|=_p}return ca(o,A,h,y,G)});bp.placeholder={};var hf=bp,yy=wn(function(o,h){return Fr(h,function(y){y=Aa(y),Ta(o,y,hf(o[y],o))}),o}),eC=yy,df=1,pm=2,tC=32,ff=xr(function(o,h,y){var A=df|pm;if(y.length){var G=eo(y,Ea(ff));A|=tC}return ca(h,A,o,y,G)});ff.placeholder={};var nC=ff;function rC(o,h,y){var A=-1,G=o.length;h<0&&(h=-h>G?0:G+h),y=y>G?G:y,y<0&&(y+=G),G=h>y?0:y-h>>>0,h>>>=0;for(var ge=Array(G);++A<G;)ge[A]=o[A+h];return ge}var is=rC;function vd(o,h,y){var A=o.length;return y=y===void 0?A:y,!h&&y>=A?o:is(o,h,y)}var Uc=vd,Iu="\\ud800-\\udfff",pc="\\u0300-\\u036f",Sy="\\ufe20-\\ufe2f",zc="\\u20d0-\\u20ff",Cd=pc+Sy+zc,iC="\\ufe0e\\ufe0f",_y="\\u200d",by=RegExp("["+_y+Iu+Cd+iC+"]");function Ey(o){return by.test(o)}var Rh=Ey;function Ry(o){return o.split("")}var Ep=Ry,Rp="\\ud800-\\udfff",Ri="\\u0300-\\u036f",vm="\\ufe20-\\ufe2f",Xs="\\u20d0-\\u20ff",gf=Ri+vm+Xs,Ms="\\ufe0e\\ufe0f",Xa="["+Rp+"]",go="["+gf+"]",Cm="\\ud83c[\\udffb-\\udfff]",sC="(?:"+go+"|"+Cm+")",Tp="[^"+Rp+"]",wm="(?:\\ud83c[\\udde6-\\uddff]){2}",Pu="[\\ud800-\\udbff][\\udc00-\\udfff]",oC="\\u200d",Kc=sC+"?",ym="["+Ms+"]?",Yc="(?:"+oC+"(?:"+[Tp,wm,Pu].join("|")+")"+ym+Kc+")*",Th=ym+Kc+Yc,Mp="(?:"+[Tp+go+"?",go,wm,Pu,Xa].join("|")+")",vc=RegExp(Cm+"(?="+Cm+")|"+Mp+Th,"g");function Sm(o){return o.match(vc)||[]}var _m=Sm;function Os(o){return Rh(o)?_m(o):Ep(o)}var mo=Os;function aC(o){return function(h){h=ri(h);var y=Rh(h)?mo(h):void 0,A=y?y[0]:h.charAt(0),G=y?Uc(y,1).join(""):h.slice(1);return A[o]()+G}}var Zs=aC,wd=Zs("toUpperCase"),vi=wd;function Vl(o){return vi(ri(o).toLowerCase())}var yd=Vl;function xu(o,h,y,A){var G=-1,ge=o==null?0:o.length;for(A&&ge&&(y=o[++G]);++G<ge;)y=h(y,o[G],G,o);return y}var mf=xu;function Gc(o){return function(h){return o==null?void 0:o[h]}}var Au=Gc,Mh={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Sd=Au(Mh),pf=Sd,Cc=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bm="\\u0300-\\u036f",vf="\\ufe20-\\ufe2f",lC="\\u20d0-\\u20ff",uC=bm+vf+lC,Ty="["+uC+"]",My=RegExp(Ty,"g");function cC(o){return o=ri(o),o&&o.replace(Cc,pf).replace(My,"")}var Op=cC,ii=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Oy(o){return o.match(ii)||[]}var Iy=Oy,Py=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Em(o){return Py.test(o)}var xy=Em,Oh="\\ud800-\\udfff",Nu="\\u0300-\\u036f",hC="\\ufe20-\\ufe2f",dC="\\u20d0-\\u20ff",Rm=Nu+hC+dC,dg="\\u2700-\\u27bf",Ay="a-z\\xdf-\\xf6\\xf8-\\xff",fC="\\xac\\xb1\\xd7\\xf7",Ny="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Cf="\\u2000-\\u206f",gC=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ip="A-Z\\xc0-\\xd6\\xd8-\\xde",mC="\\ufe0e\\ufe0f",pC=fC+Ny+Cf+gC,$c="['\u2019]",Jr="["+pC+"]",hl="["+Rm+"]",fg="\\d+",Pp="["+dg+"]",wc="["+Ay+"]",wf="[^"+Oh+pC+fg+dg+Ay+Ip+"]",vC="\\ud83c[\\udffb-\\udfff]",Tm="(?:"+hl+"|"+vC+")",yf="[^"+Oh+"]",Mm="(?:\\ud83c[\\udde6-\\uddff]){2}",Vi="[\\ud800-\\udbff][\\udc00-\\udfff]",po="["+Ip+"]",Om="\\u200d",gg="(?:"+wc+"|"+wf+")",Ih="(?:"+po+"|"+wf+")",mg="(?:"+$c+"(?:d|ll|m|re|s|t|ve))?",Za="(?:"+$c+"(?:D|LL|M|RE|S|T|VE))?",_d=Tm+"?",pg="["+mC+"]?",Dy="(?:"+Om+"(?:"+[yf,Mm,Vi].join("|")+")"+pg+_d+")*",Hy="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ly="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fy=pg+_d+Dy,Wy="(?:"+[Pp,Mm,Vi].join("|")+")"+Fy,By=RegExp([po+"?"+wc+"+"+mg+"(?="+[Jr,po,"$"].join("|")+")",Ih+"+"+Za+"(?="+[Jr,po+gg,"$"].join("|")+")",po+"?"+gg+"+"+mg,po+"+"+Za,Ly,Hy,fg,Wy].join("|"),"g");function ky(o){return o.match(By)||[]}var CC=ky;function Im(o,h,y){return o=ri(o),h=y?void 0:h,h===void 0?xy(o)?CC(o):Iy(o):o.match(h)||[]}var xp=Im,Vy="['\u2019]",Ap=RegExp(Vy,"g");function Np(o){return function(h){return mf(xp(Op(h).replace(Ap,"")),o,"")}}var Ph=Np,wC=Ph(function(o,h,y){return h=h.toLowerCase(),o+(y?yd(h):h)}),Pm=wC;function jl(){if(!arguments.length)return[];var o=arguments[0];return ze(o)?o:[o]}var vg=jl,xm=C.Z.isFinite,yC=Math.min;function bd(o){var h=Math[o];return function(y,A){if(y=Qn(y),A=A==null?0:yC(Hn(A),292),A&&xm(y)){var G=(ri(y)+"e").split("e"),ge=h(G[0]+"e"+(+G[1]+A));return G=(ri(ge)+"e").split("e"),+(G[0]+"e"+(+G[1]-A))}return h(y)}}var Am=bd,Sf=Am("ceil"),SC=Sf;function Cg(o){var h=fe(o);return h.__chain__=!0,h}var Dp=Cg,xh=Math.ceil,wg=Math.max;function Xc(o,h,y){(y?Gs(o,h,y):h===void 0)?h=1:h=wg(Hn(h),0);var A=o==null?0:o.length;if(!A||h<1)return[];for(var G=0,ge=0,Re=Array(xh(A/h));G<A;)Re[ge++]=is(o,G,G+=h);return Re}var _f=Xc;function jy(o,h,y){return o===o&&(y!==void 0&&(o=o<=y?o:y),h!==void 0&&(o=o>=h?o:h)),o}var yc=jy;function _C(o,h,y){return y===void 0&&(y=h,h=void 0),y!==void 0&&(y=Qn(y),y=y===y?y:0),h!==void 0&&(h=Qn(h),h=h===h?h:0),yc(Qn(o),h,y)}var yg=_C;function Uy(){this.__data__=new L,this.size=0}var Nm=Uy;function zy(o){var h=this.__data__,y=h.delete(o);return this.size=h.size,y}var Sg=zy;function Ky(o){return this.__data__.get(o)}var Dm=Ky;function Yy(o){return this.__data__.has(o)}var bC=Yy,EC=200;function RC(o,h){var y=this.__data__;if(y instanceof L){var A=y.__data__;if(!Ce||A.length<EC-1)return A.push([o,h]),this.size=++y.size,this;y=this.__data__=new dn(A)}return y.set(o,h),this.size=y.size,this}var n_=RC;function Ah(o){var h=this.__data__=new L(o);this.size=h.size}Ah.prototype.clear=Nm,Ah.prototype.delete=Sg,Ah.prototype.get=Dm,Ah.prototype.has=bC,Ah.prototype.set=n_;var bf=Ah;function Gy(o,h){return o&&Jo(h,Ar(h),o)}var Hp=Gy;function $y(o,h){return o&&Jo(h,ns(h),o)}var Nh=$y,TC=f(15266);function Xy(o,h){for(var y=-1,A=o==null?0:o.length,G=0,ge=[];++y<A;){var Re=o[y];h(Re,y,o)&&(ge[G++]=Re)}return ge}var Dh=Xy;function _g(){return[]}var Hm=_g,zr=Object.prototype,Lm=zr.propertyIsEnumerable,Lp=Object.getOwnPropertySymbols,Ja=Lp?function(o){return o==null?[]:(o=Object(o),Dh(Lp(o),function(h){return Lm.call(o,h)}))}:Hm,Ha=Ja;function dl(o,h){return Jo(o,Ha(o),h)}var Fp=dl,Ef=Object.getOwnPropertySymbols,Zy=Ef?function(o){for(var h=[];o;)We(h,Ha(o)),o=Zr(o);return h}:Hm,Wp=Zy;function Jy(o,h){return Jo(o,Wp(o),h)}var Bp=Jy;function kp(o,h,y){var A=h(o);return ze(o)?A:We(A,y(o))}var bg=kp;function MC(o){return bg(o,Ar,Ha)}var Vp=MC;function Qy(o){return bg(o,ns,Wp)}var jp=Qy,qy=Pr(C.Z,"DataView"),Up=qy,OC=Pr(C.Z,"Promise"),Fm=OC,e0=Pr(C.Z,"Set"),Rf=e0,IC="[object Map]",PC="[object Object]",Wm="[object Promise]",Eg="[object Set]",xC="[object WeakMap]",zp="[object DataView]",t0=Ke(Up),Ul=Ke(Ce),n0=Ke(Fm),u=Ke(Rf),i=Ke(Lr),a=q;(Up&&a(new Up(new ArrayBuffer(1)))!=zp||Ce&&a(new Ce)!=IC||Fm&&a(Fm.resolve())!=Wm||Rf&&a(new Rf)!=Eg||Lr&&a(new Lr)!=xC)&&(a=function(o){var h=q(o),y=h==PC?o.constructor:void 0,A=y?Ke(y):"";if(A)switch(A){case t0:return zp;case Ul:return IC;case n0:return Wm;case u:return Eg;case i:return xC}return h});var d=a,w=Object.prototype,p=w.hasOwnProperty;function T(o){var h=o.length,y=new o.constructor(h);return h&&typeof o[0]=="string"&&p.call(o,"index")&&(y.index=o.index,y.input=o.input),y}var H=T,z=C.Z.Uint8Array,te=z;function we(o){var h=new o.constructor(o.byteLength);return new te(h).set(new te(o)),h}var Ie=we;function De(o,h){var y=h?Ie(o.buffer):o.buffer;return new o.constructor(y,o.byteOffset,o.byteLength)}var Le=De,ut=/\w*$/;function Bt(o){var h=new o.constructor(o.source,ut.exec(o));return h.lastIndex=o.lastIndex,h}var zn=Bt,Mn=B?B.prototype:void 0,_t=Mn?Mn.valueOf:void 0;function Ci(o){return _t?Object(_t.call(o)):{}}var mi=Ci;function ss(o,h){var y=h?Ie(o.buffer):o.buffer;return new o.constructor(y,o.byteOffset,o.length)}var si=ss,Ti="[object Boolean]",Qa="[object Date]",Kr="[object Map]",Du="[object Number]",Hh="[object RegExp]",Rg="[object Set]",Lh="[object String]",Tg="[object Symbol]",Mg="[object ArrayBuffer]",Og="[object DataView]",fl="[object Float32Array]",qa="[object Float64Array]",xo="[object Int8Array]",Bm="[object Int16Array]",Vo="[object Int32Array]",U="[object Uint8Array]",ne="[object Uint8ClampedArray]",me="[object Uint16Array]",$e="[object Uint32Array]";function it(o,h,y){var A=o.constructor;switch(h){case Mg:return Ie(o);case Ti:case Qa:return new A(+o);case Og:return Le(o,y);case fl:case qa:case xo:case Bm:case Vo:case U:case ne:case me:case $e:return si(o,y);case Kr:return new A;case Du:case Lh:return new A(o);case Hh:return zn(o);case Rg:return new A;case Tg:return mi(o)}}var vt=it;function qt(o){return typeof o.constructor=="function"&&!Hc(o)?Er(Zr(o)):{}}var sn=qt,nr="[object Map]";function er(o){return ue(o)&&d(o)==nr}var nn=er,pi=ho.Z&&ho.Z.isMap,$i=pi?ta(pi):nn,Xi=$i,La="[object Set]";function Js(o){return ue(o)&&d(o)==La}var vo=Js,gl=ho.Z&&ho.Z.isSet,no=gl?ta(gl):vo,oa=no,Bs=1,pa=2,jo=4,ou="[object Arguments]",Zc="[object Array]",Jc="[object Boolean]",Tf="[object Date]",Ed="[object Error]",Ig="[object Function]",km="[object GeneratorFunction]",Fh="[object Map]",au="[object Number]",Wh="[object Object]",Hu="[object RegExp]",Bh="[object Set]",ro="[object String]",Sc="[object Symbol]",Kp="[object WeakMap]",AC="[object ArrayBuffer]",UT="[object DataView]",r_="[object Float32Array]",zT="[object Float64Array]",KT="[object Int8Array]",YT="[object Int16Array]",GT="[object Int32Array]",$T="[object Uint8Array]",XT="[object Uint8ClampedArray]",i_="[object Uint16Array]",Yp="[object Uint32Array]",ji={};ji[ou]=ji[Zc]=ji[AC]=ji[UT]=ji[Jc]=ji[Tf]=ji[r_]=ji[zT]=ji[KT]=ji[YT]=ji[GT]=ji[Fh]=ji[au]=ji[Wh]=ji[Hu]=ji[Bh]=ji[ro]=ji[Sc]=ji[$T]=ji[XT]=ji[i_]=ji[Yp]=!0,ji[Ed]=ji[Ig]=ji[Kp]=!1;function NC(o,h,y,A,G,ge){var Re,Ve=h&Bs,st=h&pa,kt=h&jo;if(y&&(Re=G?y(o,A,G,ge):y(o)),Re!==void 0)return Re;if(!Mt(o))return o;var Vt=ze(o);if(Vt){if(Re=H(o),!Ve)return Cr(o,Re)}else{var Zt=d(o),kn=Zt==Ig||Zt==km;if((0,Dl.Z)(o))return(0,TC.Z)(o,Ve);if(Zt==Wh||Zt==ou||kn&&!G){if(Re=st||kn?{}:sn(o),!Ve)return st?Bp(o,Nh(Re,o)):Fp(o,Hp(Re,o))}else{if(!ji[Zt])return G?o:{};Re=vt(o,Zt,Ve)}}ge||(ge=new bf);var rr=ge.get(o);if(rr)return rr;ge.set(o,Re),oa(o)?o.forEach(function(Ir){Re.add(NC(Ir,h,y,Ir,o,ge))}):Xi(o)&&o.forEach(function(Ir,yi){Re.set(yi,NC(Ir,h,y,yi,o,ge))});var Or=kt?st?jp:Vp:st?ns:Ar,ci=Vt?void 0:Or(o);return Fr(ci||o,function(Ir,yi){ci&&(yi=Ir,Ir=o[yi]),ic(Re,yi,NC(Ir,h,y,yi,o,ge))}),Re}var Qc=NC,Gp=4;function r0(o){return Qc(o,Gp)}var s_=r0,Rd=1,DC=4;function ZT(o){return Qc(o,Rd|DC)}var o_=ZT,JT=1,QT=4;function qT(o,h){return h=typeof h=="function"?h:void 0,Qc(o,JT|QT,h)}var a_=qT,eM=4;function tM(o,h){return h=typeof h=="function"?h:void 0,Qc(o,eM,h)}var l_=tM;function nM(){return new pn(this.value(),this.__chain__)}var i0=nM;function rM(o){for(var h=-1,y=o==null?0:o.length,A=0,G=[];++h<y;){var ge=o[h];ge&&(G[A++]=ge)}return G}var u_=rM;function iM(){var o=arguments.length;if(!o)return[];for(var h=Array(o-1),y=arguments[0],A=o;A--;)h[A-1]=arguments[A];return We(ze(y)?Cr(y):[y],fn(h,1))}var s0=iM,HC="__lodash_hash_undefined__";function sM(o){return this.__data__.set(o,HC),this}var o0=sM;function oM(o){return this.__data__.has(o)}var aM=oM;function LC(o){var h=-1,y=o==null?0:o.length;for(this.__data__=new dn;++h<y;)this.add(o[h])}LC.prototype.add=LC.prototype.push=o0,LC.prototype.has=aM;var FC=LC;function lM(o,h){for(var y=-1,A=o==null?0:o.length;++y<A;)if(h(o[y],y,o))return!0;return!1}var $p=lM;function uM(o,h){return o.has(h)}var Xp=uM,c_=1,h_=2;function cM(o,h,y,A,G,ge){var Re=y&c_,Ve=o.length,st=h.length;if(Ve!=st&&!(Re&&st>Ve))return!1;var kt=ge.get(o),Vt=ge.get(h);if(kt&&Vt)return kt==h&&Vt==o;var Zt=-1,kn=!0,rr=y&h_?new FC:void 0;for(ge.set(o,h),ge.set(h,o);++Zt<Ve;){var Or=o[Zt],ci=h[Zt];if(A)var Ir=Re?A(ci,Or,Zt,h,o,ge):A(Or,ci,Zt,o,h,ge);if(Ir!==void 0){if(Ir)continue;kn=!1;break}if(rr){if(!$p(h,function(yi,Ni){if(!Xp(rr,Ni)&&(Or===yi||G(Or,yi,y,A,ge)))return rr.push(Ni)})){kn=!1;break}}else if(!(Or===ci||G(Or,ci,y,A,ge))){kn=!1;break}}return ge.delete(o),ge.delete(h),kn}var WC=cM;function hM(o){var h=-1,y=Array(o.size);return o.forEach(function(A,G){y[++h]=[G,A]}),y}var BC=hM;function dM(o){var h=-1,y=Array(o.size);return o.forEach(function(A){y[++h]=A}),y}var kC=dM,d_=1,a0=2,fM="[object Boolean]",gM="[object Date]",mM="[object Error]",f_="[object Map]",_c="[object Number]",VC="[object RegExp]",pM="[object Set]",Zp="[object String]",l0="[object Symbol]",jC="[object ArrayBuffer]",qc="[object DataView]",Jp=B?B.prototype:void 0,UC=Jp?Jp.valueOf:void 0;function vM(o,h,y,A,G,ge,Re){switch(y){case qc:if(o.byteLength!=h.byteLength||o.byteOffset!=h.byteOffset)return!1;o=o.buffer,h=h.buffer;case jC:return!(o.byteLength!=h.byteLength||!ge(new te(o),new te(h)));case fM:case gM:case _c:return ha(+o,+h);case mM:return o.name==h.name&&o.message==h.message;case VC:case Zp:return o==h+"";case f_:var Ve=BC;case pM:var st=A&d_;if(Ve||(Ve=kC),o.size!=h.size&&!st)return!1;var kt=Re.get(o);if(kt)return kt==h;A|=a0,Re.set(o,h);var Vt=WC(Ve(o),Ve(h),A,G,ge,Re);return Re.delete(o),Vt;case l0:if(UC)return UC.call(o)==UC.call(h)}return!1}var CM=vM,wM=1,yM=Object.prototype,SM=yM.hasOwnProperty;function _M(o,h,y,A,G,ge){var Re=y&wM,Ve=Vp(o),st=Ve.length,kt=Vp(h),Vt=kt.length;if(st!=Vt&&!Re)return!1;for(var Zt=st;Zt--;){var kn=Ve[Zt];if(!(Re?kn in h:SM.call(h,kn)))return!1}var rr=ge.get(o),Or=ge.get(h);if(rr&&Or)return rr==h&&Or==o;var ci=!0;ge.set(o,h),ge.set(h,o);for(var Ir=Re;++Zt<st;){kn=Ve[Zt];var yi=o[kn],Ni=h[kn];if(A)var ao=Re?A(Ni,yi,kn,h,o,ge):A(yi,Ni,kn,o,h,ge);if(!(ao===void 0?yi===Ni||G(yi,Ni,y,A,ge):ao)){ci=!1;break}Ir||(Ir=kn=="constructor")}if(ci&&!Ir){var Ba=o.constructor,Yu=h.constructor;Ba!=Yu&&"constructor"in o&&"constructor"in h&&!(typeof Ba=="function"&&Ba instanceof Ba&&typeof Yu=="function"&&Yu instanceof Yu)&&(ci=!1)}return ge.delete(o),ge.delete(h),ci}var bM=_M,EM=1,u0="[object Arguments]",g_="[object Array]",zC="[object Object]",RM=Object.prototype,m_=RM.hasOwnProperty;function p_(o,h,y,A,G,ge){var Re=ze(o),Ve=ze(h),st=Re?g_:d(o),kt=Ve?g_:d(h);st=st==u0?zC:st,kt=kt==u0?zC:kt;var Vt=st==zC,Zt=kt==zC,kn=st==kt;if(kn&&(0,Dl.Z)(o)){if(!(0,Dl.Z)(h))return!1;Re=!0,Vt=!1}if(kn&&!Vt)return ge||(ge=new bf),Re||Ma(o)?WC(o,h,y,A,G,ge):CM(o,h,st,y,A,G,ge);if(!(y&EM)){var rr=Vt&&m_.call(o,"__wrapped__"),Or=Zt&&m_.call(h,"__wrapped__");if(rr||Or){var ci=rr?o.value():o,Ir=Or?h.value():h;return ge||(ge=new bf),G(ci,Ir,y,A,ge)}}return kn?(ge||(ge=new bf),bM(o,h,y,A,G,ge)):!1}var TM=p_;function v_(o,h,y,A,G){return o===h?!0:o==null||h==null||!ue(o)&&!ue(h)?o!==o&&h!==h:TM(o,h,y,A,v_,G)}var Vm=v_,MM=1,OM=2;function IM(o,h,y,A){var G=y.length,ge=G,Re=!A;if(o==null)return!ge;for(o=Object(o);G--;){var Ve=y[G];if(Re&&Ve[2]?Ve[1]!==o[Ve[0]]:!(Ve[0]in o))return!1}for(;++G<ge;){Ve=y[G];var st=Ve[0],kt=o[st],Vt=Ve[1];if(Re&&Ve[2]){if(kt===void 0&&!(st in o))return!1}else{var Zt=new bf;if(A)var kn=A(kt,Vt,st,o,h,Zt);if(!(kn===void 0?Vm(Vt,kt,MM|OM,A,Zt):kn))return!1}}return!0}var KC=IM;function C_(o){return o===o&&!Mt(o)}var w_=C_;function PM(o){for(var h=Ar(o),y=h.length;y--;){var A=h[y],G=o[A];h[y]=[A,G,w_(G)]}return h}var c0=PM;function xM(o,h){return function(y){return y==null?!1:y[o]===h&&(h!==void 0||o in Object(y))}}var y_=xM;function AM(o){var h=c0(o);return h.length==1&&h[0][2]?y_(h[0][0],h[0][1]):function(y){return y===o||KC(y,o,h)}}var S_=AM;function h0(o,h){return o!=null&&h in Object(o)}var NM=h0;function DM(o,h,y){h=mc(h,o);for(var A=-1,G=h.length,ge=!1;++A<G;){var Re=Aa(h[A]);if(!(ge=o!=null&&y(o,Re)))break;o=o[Re]}return ge||++A!=G?ge:(G=o==null?0:o.length,!!G&&Su(G)&&Il(Re,G)&&(ze(o)||Ka(o)))}var __=DM;function HM(o,h){return o!=null&&__(o,h,NM)}var YC=HM,XA=1,ZA=2;function d0(o,h){return Eu(o)&&w_(h)?y_(Aa(o),h):function(y){var A=Mu(y,o);return A===void 0&&A===h?YC(y,o):Vm(h,A,XA|ZA)}}var b_=d0;function LM(o){return function(h){return h==null?void 0:h[o]}}var f0=LM;function FM(o){return function(h){return kl(h,o)}}var JA=FM;function jm(o){return Eu(o)?f0(Aa(o)):JA(o)}var g0=jm;function WM(o){return typeof o=="function"?o:o==null?Ln:typeof o=="object"?ze(o)?b_(o[0],o[1]):S_(o):g0(o)}var Nr=WM,Qp="Expected a function";function Mf(o){var h=o==null?0:o.length,y=Nr;return o=h?Oe(o,function(A){if(typeof A[1]!="function")throw new TypeError(Qp);return[y(A[0]),A[1]]}):[],xr(function(A){for(var G=-1;++G<h;){var ge=o[G];if(Wn(ge[0],this,A))return Wn(ge[1],this,A)}})}var Of=Mf;function Uo(o,h,y){var A=y.length;if(o==null)return!A;for(o=Object(o);A--;){var G=y[A],ge=h[G],Re=o[G];if(Re===void 0&&!(G in o)||!ge(Re))return!1}return!0}var va=Uo;function BM(o){var h=Ar(o);return function(y){return va(y,o,h)}}var qp=BM,kM=1;function GC(o){return qp(Qc(o,kM))}var E_=GC;function ev(o,h){return h==null||va(o,h,Ar(h))}var R_=ev;function $C(o,h,y,A){for(var G=-1,ge=o==null?0:o.length;++G<ge;){var Re=o[G];h(A,Re,y(Re),o)}return A}var VM=$C;function T_(o){return function(h,y,A){for(var G=-1,ge=Object(h),Re=A(h),Ve=Re.length;Ve--;){var st=Re[o?Ve:++G];if(y(ge[st],st,ge)===!1)break}return h}}var M_=T_,O_=M_(),m0=O_;function I_(o,h){return o&&m0(o,h,Ar)}var kh=I_;function P_(o,h){return function(y,A){if(y==null)return y;if(!Ys(y))return o(y,A);for(var G=y.length,ge=h?G:-1,Re=Object(y);(h?ge--:++ge<G)&&A(Re[ge],ge,Re)!==!1;);return y}}var x_=P_,p0=x_(kh),If=p0;function v0(o,h,y,A){return If(o,function(G,ge,Re){h(A,G,y(G),Re)}),A}var jM=v0;function XC(o,h){return function(y,A){var G=ze(y)?VM:jM,ge=h?h():{};return G(y,o,Nr(A,2),ge)}}var ZC=XC,A_=Object.prototype,UM=A_.hasOwnProperty,N_=ZC(function(o,h,y){UM.call(o,y)?++o[y]:Ta(o,y,1)}),D_=N_;function H_(o,h){var y=Er(o);return h==null?y:Hp(y,h)}var L_=H_,C0=8;function w0(o,h,y){h=y?void 0:h;var A=ca(o,C0,void 0,void 0,void 0,void 0,void 0,h);return A.placeholder=w0.placeholder,A}w0.placeholder={};var y0=w0,zM=16;function JC(o,h,y){h=y?void 0:h;var A=ca(o,zM,void 0,void 0,void 0,void 0,void 0,h);return A.placeholder=JC.placeholder,A}JC.placeholder={};var F_=JC,W_=function(){return C.Z.Date.now()},tv=W_,B_="Expected a function",KM=Math.max,YM=Math.min;function k_(o,h,y){var A,G,ge,Re,Ve,st,kt=0,Vt=!1,Zt=!1,kn=!0;if(typeof o!="function")throw new TypeError(B_);h=Qn(h)||0,Mt(y)&&(Vt=!!y.leading,Zt="maxWait"in y,ge=Zt?KM(Qn(y.maxWait)||0,h):ge,kn="trailing"in y?!!y.trailing:kn);function rr(zo){var Gu=A,ed=G;return A=G=void 0,kt=zo,Re=o.apply(ed,Gu),Re}function Or(zo){return kt=zo,Ve=setTimeout(yi,h),Vt?rr(zo):Re}function ci(zo){var Gu=zo-st,ed=zo-kt,FT=h-Gu;return Zt?YM(FT,ge-ed):FT}function Ir(zo){var Gu=zo-st,ed=zo-kt;return st===void 0||Gu>=h||Gu<0||Zt&&ed>=ge}function yi(){var zo=tv();if(Ir(zo))return Ni(zo);Ve=setTimeout(yi,ci(zo))}function Ni(zo){return Ve=void 0,kn&&A?rr(zo):(A=G=void 0,Re)}function ao(){Ve!==void 0&&clearTimeout(Ve),kt=0,A=st=G=Ve=void 0}function Ba(){return Ve===void 0?Re:Ni(tv())}function Yu(){var zo=tv(),Gu=Ir(zo);if(A=arguments,G=this,st=zo,Gu){if(Ve===void 0)return Or(st);if(Zt)return clearTimeout(Ve),Ve=setTimeout(yi,h),rr(st)}return Ve===void 0&&(Ve=setTimeout(yi,h)),Re}return Yu.cancel=ao,Yu.flush=Ba,Yu}var S0=k_;function V_(o,h){return o==null||o!==o?h:o}var j_=V_,Um=Object.prototype,GM=Um.hasOwnProperty,$M=xr(function(o,h){o=Object(o);var y=-1,A=h.length,G=A>2?h[2]:void 0;for(G&&Gs(h[0],h[1],G)&&(A=1);++y<A;)for(var ge=h[y],Re=ns(ge),Ve=-1,st=Re.length;++Ve<st;){var kt=Re[Ve],Vt=o[kt];(Vt===void 0||ha(Vt,Um[kt])&&!GM.call(o,kt))&&(o[kt]=ge[kt])}return o}),QC=$M;function _0(o,h,y){(y!==void 0&&!ha(o[h],y)||y===void 0&&!(h in o))&&Ta(o,h,y)}var qC=_0;function Lu(o){return ue(o)&&Ys(o)}var Ao=Lu;function XM(o,h){if(!(h==="constructor"&&typeof o[h]=="function")&&h!="__proto__")return o[h]}var ew=XM;function tw(o){return Jo(o,ns(o))}var b0=tw;function E0(o,h,y,A,G,ge,Re){var Ve=ew(o,y),st=ew(h,y),kt=Re.get(st);if(kt){qC(o,y,kt);return}var Vt=ge?ge(Ve,st,y+"",o,h,Re):void 0,Zt=Vt===void 0;if(Zt){var kn=ze(st),rr=!kn&&(0,Dl.Z)(st),Or=!kn&&!rr&&Ma(st);Vt=st,kn||rr||Or?ze(Ve)?Vt=Ve:Ao(Ve)?Vt=Cr(Ve):rr?(Zt=!1,Vt=(0,TC.Z)(st,!0)):Or?(Zt=!1,Vt=si(st,!0)):Vt=[]:Ou(st)||Ka(st)?(Vt=Ve,Ka(Ve)?Vt=b0(Ve):(!Mt(Ve)||en(Ve))&&(Vt=sn(st))):Zt=!1}Zt&&(Re.set(st,Vt),G(Vt,st,A,ge,Re),Re.delete(st)),qC(o,y,Vt)}var zm=E0;function R0(o,h,y,A,G){o!==h&&m0(h,function(ge,Re){if(G||(G=new bf),Mt(ge))zm(o,h,Re,y,R0,A,G);else{var Ve=A?A(ew(o,Re),ge,Re+"",o,h,G):void 0;Ve===void 0&&(Ve=ge),qC(o,Re,Ve)}},ns)}var Vh=R0;function U_(o,h,y,A,G,ge){return Mt(o)&&Mt(h)&&(ge.set(h,o),Vh(o,h,void 0,U_,ge),ge.delete(h)),o}var ZM=U_,nv=za(function(o,h,y,A){Vh(o,h,y,A)}),nw=nv,Km=xr(function(o){return o.push(void 0,ZM),Wn(nw,void 0,o)}),io=Km,rv="Expected a function";function Ca(o,h,y){if(typeof o!="function")throw new TypeError(rv);return setTimeout(function(){o.apply(void 0,y)},h)}var iv=Ca,rw=xr(function(o,h){return iv(o,1,h)}),iw=rw,sw=xr(function(o,h,y){return iv(o,Qn(h)||0,y)}),sv=sw;function ov(o,h,y){for(var A=-1,G=o==null?0:o.length;++A<G;)if(y(h,o[A]))return!0;return!1}var T0=ov,JM=200;function QM(o,h,y,A){var G=-1,ge=Tl,Re=!0,Ve=o.length,st=[],kt=h.length;if(!Ve)return st;y&&(h=Oe(h,ta(y))),A?(ge=T0,Re=!1):h.length>=JM&&(ge=Xp,Re=!1,h=new FC(h));e:for(;++G<Ve;){var Vt=o[G],Zt=y==null?Vt:y(Vt);if(Vt=A||Vt!==0?Vt:0,Re&&Zt===Zt){for(var kn=kt;kn--;)if(h[kn]===Zt)continue e;st.push(Vt)}else ge(h,Zt,A)||st.push(Vt)}return st}var av=QM,qM=xr(function(o,h){return Ao(o)?av(o,fn(h,1,Ao,!0)):[]}),M0=qM;function eO(o){var h=o==null?0:o.length;return h?o[h-1]:void 0}var lu=eO,z_=xr(function(o,h){var y=lu(h);return Ao(y)&&(y=void 0),Ao(o)?av(o,fn(h,1,Ao,!0),Nr(y,2)):[]}),ow=z_,O0=xr(function(o,h){var y=lu(h);return Ao(y)&&(y=void 0),Ao(o)?av(o,fn(h,1,Ao,!0),void 0,y):[]}),K_=O0,tO=hn(function(o,h){return o/h},1),Ym=tO;function nO(o,h,y){var A=o==null?0:o.length;return A?(h=y||h===void 0?1:Hn(h),is(o,h<0?0:h,A)):[]}var Y_=nO;function I0(o,h,y){var A=o==null?0:o.length;return A?(h=y||h===void 0?1:Hn(h),h=A-h,is(o,0,h<0?0:h)):[]}var Td=I0;function rO(o,h,y,A){for(var G=o.length,ge=A?G:-1;(A?ge--:++ge<G)&&h(o[ge],ge,o););return y?is(o,A?0:ge,A?ge+1:G):is(o,A?ge+1:0,A?G:ge)}var aw=rO;function lw(o,h){return o&&o.length?aw(o,Nr(h,3),!0,!0):[]}var G_=lw;function iO(o,h){return o&&o.length?aw(o,Nr(h,3),!0):[]}var uw=iO;function sO(o){return typeof o=="function"?o:Ln}var jh=sO;function $_(o,h){var y=ze(o)?Fr:If;return y(o,jh(h))}var cw=$_;function lv(o,h){for(var y=o==null?0:o.length;y--&&h(o[y],y,o)!==!1;);return o}var X_=lv,Z_=M_(!0),Pg=Z_;function P0(o,h){return o&&Pg(o,h,Ar)}var Gm=P0,oO=x_(Gm,!0),J_=oO;function aO(o,h){var y=ze(o)?X_:J_;return y(o,jh(h))}var hw=aO;function lO(o,h,y){o=ri(o),h=Ye(h);var A=o.length;y=y===void 0?A:yc(Hn(y),0,A);var G=y;return y-=h.length,y>=0&&o.slice(y,G)==h}var Q_=lO;function q_(o,h){return Oe(h,function(y){return[y,o[y]]})}var eb=q_;function uO(o){var h=-1,y=Array(o.size);return o.forEach(function(A){y[++h]=[A,A]}),y}var cO=uO,hO="[object Map]",QA="[object Set]";function dO(o){return function(h){var y=d(h);return y==hO?BC(h):y==QA?cO(h):eb(h,o(h))}}var $m=dO,x0=$m(Ar),Xm=x0,tb=$m(ns),xg=tb,fO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gO=Au(fO),A0=gO,nb=/[&<>"']/g,rb=RegExp(nb.source);function uv(o){return o=ri(o),o&&rb.test(o)?o.replace(nb,A0):o}var Ag=uv,ib=/[\\^$.*+?()[\]{}|]/g,Zm=RegExp(ib.source);function sb(o){return o=ri(o),o&&Zm.test(o)?o.replace(ib,"\\$&"):o}var Yr=sb;function eh(o,h){for(var y=-1,A=o==null?0:o.length;++y<A;)if(!h(o[y],y,o))return!1;return!0}var Ng=eh;function ob(o,h){var y=!0;return If(o,function(A,G,ge){return y=!!h(A,G,ge),y}),y}var th=ob;function No(o,h,y){var A=ze(o)?Ng:th;return y&&Gs(o,h,y)&&(h=void 0),A(o,Nr(h,3))}var dw=No,Md=4294967295;function Pf(o){return o?yc(Hn(o),0,Md):0}var Uh=Pf;function cv(o,h,y,A){var G=o.length;for(y=Hn(y),y<0&&(y=-y>G?0:G+y),A=A===void 0||A>G?G:Hn(A),A<0&&(A+=G),A=y>A?0:Uh(A);y<A;)o[y++]=h;return o}var hv=cv;function mO(o,h,y,A){var G=o==null?0:o.length;return G?(y&&typeof y!="number"&&Gs(o,h,y)&&(y=0,A=G),hv(o,h,y,A)):[]}var ab=mO;function pO(o,h){var y=[];return If(o,function(A,G,ge){h(A,G,ge)&&y.push(A)}),y}var lb=pO;function qA(o,h){var y=ze(o)?Dh:lb;return y(o,Nr(h,3))}var ub=qA;function vO(o){return function(h,y,A){var G=Object(h);if(!Ys(h)){var ge=Nr(y,3);h=Ar(h),y=function(Ve){return ge(G[Ve],Ve,G)}}var Re=o(h,y,A);return Re>-1?G[ge?h[Re]:Re]:void 0}}var xf=vO,CO=Math.max;function wO(o,h,y){var A=o==null?0:o.length;if(!A)return-1;var G=y==null?0:Hn(y);return G<0&&(G=CO(A+G,0)),je(o,Nr(h,3),G)}var N0=wO,yO=xf(N0),cb=yO;function SO(o,h,y){var A;return y(o,function(G,ge,Re){if(h(G,ge,Re))return A=ge,!1}),A}var dv=SO;function fv(o,h){return dv(o,Nr(h,3),kh)}var hb=fv,_O=Math.max,db=Math.min;function bO(o,h,y){var A=o==null?0:o.length;if(!A)return-1;var G=A-1;return y!==void 0&&(G=Hn(y),G=y<0?_O(A+G,0):db(G,A-1)),je(o,Nr(h,3),G,!0)}var fw=bO,EO=xf(fw),fb=EO;function RO(o,h){return dv(o,Nr(h,3),Gm)}var gb=RO;function TO(o){return o&&o.length?o[0]:void 0}var gw=TO;function mb(o,h){var y=-1,A=Ys(o)?Array(o.length):[];return If(o,function(G,ge,Re){A[++y]=h(G,ge,Re)}),A}var Jm=mb;function MO(o,h){var y=ze(o)?Oe:Jm;return y(o,Nr(h,3))}var Dg=MO;function OO(o,h){return fn(Dg(o,h),1)}var pb=OO,vb=1/0;function Cb(o,h){return fn(Dg(o,h),vb)}var D0=Cb;function wb(o,h,y){return y=y===void 0?1:Hn(y),fn(Dg(o,h),y)}var yb=wb,IO=1/0;function PO(o){var h=o==null?0:o.length;return h?fn(o,IO):[]}var H0=PO;function xO(o,h){var y=o==null?0:o.length;return y?(h=h===void 0?1:Hn(h),fn(o,h)):[]}var Sb=xO,Hg=512;function AO(o){return ca(o,Hg)}var _b=AO,L0=Am("floor"),gv=L0,bb="Expected a function",NO=8,DO=32,HO=128,LO=256;function FO(o){return wn(function(h){var y=h.length,A=y,G=pn.prototype.thru;for(o&&h.reverse();A--;){var ge=h[A];if(typeof ge!="function")throw new TypeError(bb);if(G&&!Re&&En(ge)=="wrapper")var Re=new pn([],!0)}for(A=Re?A:y;++A<y;){ge=h[A];var Ve=En(ge),st=Ve=="wrapper"?re(ge):void 0;st&&Yn(st[0])&&st[1]==(HO|NO|DO|LO)&&!st[4].length&&st[9]==1?Re=Re[En(st[0])].apply(Re,st[3]):Re=ge.length==1&&Yn(ge)?Re[Ve]():Re.thru(ge)}return function(){var kt=arguments,Vt=kt[0];if(Re&&kt.length==1&&ze(Vt))return Re.plant(Vt).value();for(var Zt=0,kn=y?h[Zt].apply(this,kt):Vt;++Zt<y;)kn=h[Zt].call(this,kn);return kn}})}var Qm=FO,WO=Qm(),mw=WO,BO=Qm(!0),pw=BO;function Eb(o,h){return o==null?o:m0(o,jh(h),ns)}var qm=Eb;function kO(o,h){return o==null?o:Pg(o,jh(h),ns)}var Rb=kO;function vw(o,h){return o&&kh(o,jh(h))}var Fu=vw;function uu(o,h){return o&&Gm(o,jh(h))}var Cw=uu;function VO(o){for(var h=-1,y=o==null?0:o.length,A={};++h<y;){var G=o[h];A[G[0]]=G[1]}return A}var F0=VO;function Od(o,h){return Dh(h,function(y){return en(o[y])})}var ep=Od;function Lg(o){return o==null?[]:ep(o,Ar(o))}var cu=Lg;function jO(o){return o==null?[]:ep(o,ns(o))}var Tb=jO,UO=Object.prototype,zO=UO.hasOwnProperty,KO=ZC(function(o,h,y){zO.call(o,y)?o[y].push(h):Ta(o,y,[h])}),Mb=KO;function Ob(o,h){return o>h}var W0=Ob;function Ib(o){return function(h,y){return typeof h=="string"&&typeof y=="string"||(h=Qn(h),y=Qn(y)),o(h,y)}}var ww=Ib,YO=ww(W0),GO=YO,Pb=ww(function(o,h){return o>=h}),yw=Pb,xb=Object.prototype,Ab=xb.hasOwnProperty;function $O(o,h){return o!=null&&Ab.call(o,h)}var XO=$O;function ZO(o,h){return o!=null&&__(o,h,XO)}var mv=ZO,B0=Math.max,JO=Math.min;function QO(o,h,y){return o>=JO(h,y)&&o<B0(h,y)}var Nb=QO;function Db(o,h,y){return h=Mi(h),y===void 0?(y=h,h=0):y=Mi(y),o=Qn(o),Nb(o,h,y)}var Hb=Db,qO="[object String]";function eI(o){return typeof o=="string"||!ze(o)&&ue(o)&&q(o)==qO}var pv=eI;function Lb(o,h){return Oe(h,function(y){return o[y]})}var k0=Lb;function tI(o){return o==null?[]:k0(o,Ar(o))}var Fg=tI,V0=Math.max;function Fb(o,h,y,A){o=Ys(o)?o:Fg(o),y=y&&!A?Hn(y):0;var G=o.length;return y<0&&(y=V0(G+y,0)),pv(o)?y<=G&&o.indexOf(h,y)>-1:!!G&&Li(o,h,y)>-1}var j0=Fb,nI=Math.max;function Wb(o,h,y){var A=o==null?0:o.length;if(!A)return-1;var G=y==null?0:Hn(y);return G<0&&(G=nI(A+G,0)),Li(o,h,G)}var Bb=Wb;function rI(o){var h=o==null?0:o.length;return h?is(o,0,-1):[]}var kb=rI,U0=Math.min;function Wg(o,h,y){for(var A=y?T0:Tl,G=o[0].length,ge=o.length,Re=ge,Ve=Array(ge),st=1/0,kt=[];Re--;){var Vt=o[Re];Re&&h&&(Vt=Oe(Vt,ta(h))),st=U0(Vt.length,st),Ve[Re]=!y&&(h||G>=120&&Vt.length>=120)?new FC(Re&&Vt):void 0}Vt=o[0];var Zt=-1,kn=Ve[0];e:for(;++Zt<G&&kt.length<st;){var rr=Vt[Zt],Or=h?h(rr):rr;if(rr=y||rr!==0?rr:0,!(kn?Xp(kn,Or):A(kt,Or,y))){for(Re=ge;--Re;){var ci=Ve[Re];if(!(ci?Xp(ci,Or):A(o[Re],Or,y)))continue e}kn&&kn.push(Or),kt.push(rr)}}return kt}var z0=Wg;function Qs(o){return Ao(o)?o:[]}var zh=Qs,Vb=xr(function(o){var h=Oe(o,zh);return h.length&&h[0]===o[0]?z0(h):[]}),tp=Vb,Af=xr(function(o){var h=lu(o),y=Oe(o,zh);return h===lu(y)?h=void 0:y.pop(),y.length&&y[0]===o[0]?z0(y,Nr(h,2)):[]}),hu=Af,Sw=xr(function(o){var h=lu(o),y=Oe(o,zh);return h=typeof h=="function"?h:void 0,h&&y.pop(),y.length&&y[0]===o[0]?z0(y,void 0,h):[]}),_w=Sw;function K0(o,h,y,A){return kh(o,function(G,ge,Re){h(A,y(G),ge,Re)}),A}var bw=K0;function iI(o,h){return function(y,A){return bw(y,o,h(A),{})}}var Y0=iI,Bg=Object.prototype,sI=Bg.toString,Id=Y0(function(o,h,y){h!=null&&typeof h.toString!="function"&&(h=sI.call(h)),o[h]=y},Go(Ln)),Nf=Id,G0=Object.prototype,Ew=G0.hasOwnProperty,Rw=G0.toString,$0=Y0(function(o,h,y){h!=null&&typeof h.toString!="function"&&(h=Rw.call(h)),Ew.call(o,h)?o[h].push(y):o[h]=[y]},Nr),Tw=$0;function X0(o,h){return h.length<2?o:kl(o,is(h,0,-1))}var Mw=X0;function Z0(o,h,y){h=mc(h,o),o=Mw(o,h);var A=o==null?o:o[Aa(lu(h))];return A==null?void 0:Wn(A,o,y)}var vv=Z0,oI=xr(vv),jb=oI,kg=xr(function(o,h,y){var A=-1,G=typeof h=="function",ge=Ys(o)?Array(o.length):[];return If(o,function(Re){ge[++A]=G?Wn(h,Re,y):vv(Re,h,y)}),ge}),Ub=kg,aI="[object ArrayBuffer]";function J0(o){return ue(o)&&q(o)==aI}var zb=J0,Pd=ho.Z&&ho.Z.isArrayBuffer,Vg=Pd?ta(Pd):zb,xi=Vg,ml="[object Boolean]";function lI(o){return o===!0||o===!1||ue(o)&&q(o)==ml}var Kb=lI,np="[object Date]";function xd(o){return ue(o)&&q(o)==np}var Ow=xd,rp=ho.Z&&ho.Z.isDate,Ki=rp?ta(rp):Ow,Yb=Ki;function Cv(o){return ue(o)&&o.nodeType===1&&!Ou(o)}var Gb=Cv,uI="[object Map]",$b="[object Set]",cI=Object.prototype,Xb=cI.hasOwnProperty;function hI(o){if(o==null)return!0;if(Ys(o)&&(ze(o)||typeof o=="string"||typeof o.splice=="function"||(0,Dl.Z)(o)||Ma(o)||Ka(o)))return!o.length;var h=d(o);if(h==uI||h==$b)return!o.size;if(Hc(o))return!Ut(o).length;for(var y in o)if(Xb.call(o,y))return!1;return!0}var Zb=hI;function Jb(o,h){return Vm(o,h)}var Qb=Jb;function dI(o,h,y){y=typeof y=="function"?y:void 0;var A=y?y(o,h):void 0;return A===void 0?Vm(o,h,void 0,y):!!A}var qb=dI,fI=C.Z.isFinite;function gI(o){return typeof o=="number"&&fI(o)}var eE=gI;function mI(o){return typeof o=="number"&&o==Hn(o)}var Q0=mI;function pI(o,h){return o===h||KC(o,h,c0(h))}var tE=pI;function vI(o,h,y){return y=typeof y=="function"?y:void 0,KC(o,h,c0(h),y)}var nE=vI,CI="[object Number]";function wI(o){return typeof o=="number"||ue(o)&&q(o)==CI}var q0=wI;function yI(o){return q0(o)&&o!=+o}var rE=yI,eS=f(74371),iE=di?en:eS.Z,SI=iE,_I="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function sE(o){if(SI(o))throw new Error(_I);return Rr(o)}var Df=sE;function oE(o){return o==null}var Ad=oE;function aE(o){return o===null}var lE=aE,Kh="[object RegExp]";function jg(o){return ue(o)&&q(o)==Kh}var bI=jg,uE=ho.Z&&ho.Z.isRegExp,EI=uE?ta(uE):bI,Iw=EI,cE=9007199254740991;function RI(o){return Q0(o)&&o>=-cE&&o<=cE}var hE=RI;function TI(o){return o===void 0}var dE=TI,MI="[object WeakMap]";function OI(o){return ue(o)&&d(o)==MI}var tS=OI,Ug="[object WeakSet]";function fE(o){return ue(o)&&q(o)==Ug}var Nd=fE,gE=1;function II(o){return Nr(typeof o=="function"?o:Qc(o,gE))}var nh=II,zg=Array.prototype,PI=zg.join;function xI(o,h){return o==null?"":PI.call(o,h)}var mE=xI,AI=Ph(function(o,h,y){return o+(y?"-":"")+h.toLowerCase()}),pE=AI,NI=ZC(function(o,h,y){Ta(o,y,h)}),vE=NI;function DI(o,h,y){for(var A=y+1;A--;)if(o[A]===h)return A;return A}var HI=DI,LI=Math.max,FI=Math.min;function CE(o,h,y){var A=o==null?0:o.length;if(!A)return-1;var G=A;return y!==void 0&&(G=Hn(y),G=G<0?LI(A+G,0):FI(G,A-1)),h===h?HI(o,h,G):je(o,Pn,G,!0)}var Pw=CE,nS=Ph(function(o,h,y){return o+(y?" ":"")+h.toLowerCase()}),wv=nS,wE=Zs("toLowerCase"),yE=wE;function Kg(o,h){return o<h}var yv=Kg,WI=ww(yv),SE=WI,BI=ww(function(o,h){return o<=h}),Sv=BI;function kI(o,h){var y={};return h=Nr(h,3),kh(o,function(A,G,ge){Ta(y,h(A,G,ge),A)}),y}var _E=kI;function rS(o,h){var y={};return h=Nr(h,3),kh(o,function(A,G,ge){Ta(y,G,h(A,G,ge))}),y}var iS=rS,bE=1;function ip(o){return S_(Qc(o,bE))}var EE=ip,RE=1;function VI(o,h){return b_(o,Qc(h,RE))}var TE=VI;function jI(o,h,y){for(var A=-1,G=o.length;++A<G;){var ge=o[A],Re=h(ge);if(Re!=null&&(Ve===void 0?Re===Re&&!Se(Re):y(Re,Ve)))var Ve=Re,st=ge}return st}var xw=jI;function UI(o){return o&&o.length?xw(o,Ln,W0):void 0}var ME=UI;function zI(o,h){return o&&o.length?xw(o,Nr(h,2),W0):void 0}var bc=zI;function OE(o,h){for(var y,A=-1,G=o.length;++A<G;){var ge=h(o[A]);ge!==void 0&&(y=y===void 0?ge:y+ge)}return y}var pl=OE,Zn=NaN;function Hf(o,h){var y=o==null?0:o.length;return y?pl(o,h)/y:Zn}var Aw=Hf;function KI(o){return Aw(o,Ln)}var sS=KI;function Nw(o,h){return Aw(o,Nr(h,2))}var Dw=Nw,oS=za(function(o,h,y){Vh(o,h,y)}),vl=oS,Lf=xr(function(o,h){return function(y){return vv(y,o,h)}}),Yh=Lf,Hw=xr(function(o,h){return function(y){return vv(o,y,h)}}),Dd=Hw;function zl(o){return o&&o.length?xw(o,Ln,yv):void 0}var _v=zl;function Ec(o,h){return o&&o.length?xw(o,Nr(h,2),yv):void 0}var Yg=Ec;function Lw(o,h,y){var A=Ar(h),G=ep(h,A),ge=!(Mt(y)&&"chain"in y)||!!y.chain,Re=en(o);return Fr(G,function(Ve){var st=h[Ve];o[Ve]=st,Re&&(o.prototype[Ve]=function(){var kt=this.__chain__;if(ge||kt){var Vt=o(this.__wrapped__),Zt=Vt.__actions__=Cr(this.__actions__);return Zt.push({func:st,args:arguments,thisArg:o}),Vt.__chain__=kt,Vt}return st.apply(o,We([this.value()],arguments))})}),o}var Gg=Lw,$g=hn(function(o,h){return o*h},1),IE=$g,YI="Expected a function";function GI(o){if(typeof o!="function")throw new TypeError(YI);return function(){var h=arguments;switch(h.length){case 0:return!o.call(this);case 1:return!o.call(this,h[0]);case 2:return!o.call(this,h[0],h[1]);case 3:return!o.call(this,h[0],h[1],h[2])}return!o.apply(this,h)}}var sp=GI;function $I(o){for(var h,y=[];!(h=o.next()).done;)y.push(h.value);return y}var XI=$I,ZI="[object Map]",JI="[object Set]",Fa=B?B.iterator:void 0;function PE(o){if(!o)return[];if(Ys(o))return pv(o)?mo(o):Cr(o);if(Fa&&o[Fa])return XI(o[Fa]());var h=d(o),y=h==ZI?BC:h==JI?kC:Fg;return y(o)}var so=PE;function Bn(){this.__values__===void 0&&(this.__values__=so(this.value()));var o=this.__index__>=this.__values__.length,h=o?void 0:this.__values__[this.__index__++];return{done:o,value:h}}var Wu=Bn;function Fw(o,h){var y=o.length;if(y)return h+=h<0?y:0,Il(h,y)?o[h]:void 0}var xE=Fw;function AE(o,h){return o&&o.length?xE(o,Hn(h)):void 0}var Gh=AE;function Ww(o){return o=Hn(o),xr(function(h){return xE(h,o)})}var du=Ww;function Bw(o,h){return h=mc(h,o),o=Mw(o,h),o==null||delete o[Aa(lu(h))]}var Rc=Bw;function QI(o){return Ou(o)?void 0:o}var op=QI,kw=1,fu=2,Hd=4,Xg=wn(function(o,h){var y={};if(o==null)return y;var A=!1;h=Oe(h,function(ge){return ge=mc(ge,o),A||(A=ge.length>1),ge}),Jo(o,jp(o),y),A&&(y=Qc(y,kw|fu|Hd,op));for(var G=h.length;G--;)Rc(y,h[G]);return y}),bv=Xg;function Ev(o,h,y,A){if(!Mt(o))return o;h=mc(h,o);for(var G=-1,ge=h.length,Re=ge-1,Ve=o;Ve!=null&&++G<ge;){var st=Aa(h[G]),kt=y;if(st==="__proto__"||st==="constructor"||st==="prototype")return o;if(G!=Re){var Vt=Ve[st];kt=A?A(Vt,st,Ve):void 0,kt===void 0&&(kt=Mt(Vt)?Vt:Il(h[G+1])?[]:{})}ic(Ve,st,kt),Ve=Ve[st]}return o}var Ld=Ev;function Bu(o,h,y){for(var A=-1,G=h.length,ge={};++A<G;){var Re=h[A],Ve=kl(o,Re);y(Ve,Re)&&Ld(ge,mc(Re,o),Ve)}return ge}var ap=Bu;function $h(o,h){if(o==null)return{};var y=Oe(jp(o),function(A){return[A]});return h=Nr(h),ap(o,y,function(A,G){return h(A,G[0])})}var aS=$h;function qI(o,h){return aS(o,sp(Nr(h)))}var NE=qI;function eP(o){return Sp(2,o)}var DE=eP;function tP(o,h){var y=o.length;for(o.sort(h);y--;)o[y]=o[y].value;return o}var nP=tP;function rP(o,h){if(o!==h){var y=o!==void 0,A=o===null,G=o===o,ge=Se(o),Re=h!==void 0,Ve=h===null,st=h===h,kt=Se(h);if(!Ve&&!kt&&!ge&&o>h||ge&&Re&&st&&!Ve&&!kt||A&&Re&&st||!y&&st||!G)return 1;if(!A&&!ge&&!kt&&o<h||kt&&y&&G&&!A&&!ge||Ve&&y&&G||!Re&&G||!st)return-1}return 0}var HE=rP;function iP(o,h,y){for(var A=-1,G=o.criteria,ge=h.criteria,Re=G.length,Ve=y.length;++A<Re;){var st=HE(G[A],ge[A]);if(st){if(A>=Ve)return st;var kt=y[A];return st*(kt=="desc"?-1:1)}}return o.index-h.index}var lS=iP;function sP(o,h,y){h.length?h=Oe(h,function(ge){return ze(ge)?function(Re){return kl(Re,ge.length===1?ge[0]:ge)}:ge}):h=[Ln];var A=-1;h=Oe(h,ta(Nr));var G=Jm(o,function(ge,Re,Ve){var st=Oe(h,function(kt){return kt(ge)});return{criteria:st,index:++A,value:ge}});return nP(G,function(ge,Re){return lS(ge,Re,y)})}var LE=sP;function uS(o,h,y,A){return o==null?[]:(ze(h)||(h=h==null?[]:[h]),y=A?void 0:y,ze(y)||(y=y==null?[]:[y]),LE(o,h,y))}var cS=uS;function FE(o){return wn(function(h){return h=Oe(h,ta(Nr)),xr(function(y){var A=this;return o(h,function(G){return Wn(G,A,y)})})})}var Ff=FE,oP=Ff(Oe),hS=oP,aP=xr,lP=aP,uP=Math.min,cP=lP(function(o,h){h=h.length==1&&ze(h[0])?Oe(h[0],ta(Nr)):Oe(fn(h,1),ta(Nr));var y=h.length;return xr(function(A){for(var G=-1,ge=uP(A.length,y);++G<ge;)A[G]=h[G].call(this,A[G]);return Wn(o,this,A)})}),WE=cP,hP=Ff(Ng),BE=hP,lp=Ff($p),dS=lp,Zg=9007199254740991,Gr=Math.floor;function Wf(o,h){var y="";if(!o||h<1||h>Zg)return y;do h%2&&(y+=o),h=Gr(h/2),h&&(o+=o);while(h);return y}var Rv=Wf,dP=f0("length"),kE=dP,Tv="\\ud800-\\udfff",fS="\\u0300-\\u036f",gS="\\ufe20-\\ufe2f",Kl="\\u20d0-\\u20ff",Bf=fS+gS+Kl,Fd="\\ufe0e\\ufe0f",kf="["+Tv+"]",Cl="["+Bf+"]",up="\\ud83c[\\udffb-\\udfff]",Jg="(?:"+Cl+"|"+up+")",VE="[^"+Tv+"]",jE="(?:\\ud83c[\\udde6-\\uddff]){2}",UE="[\\ud800-\\udbff][\\udc00-\\udfff]",fP="\\u200d",zE=Jg+"?",KE="["+Fd+"]?",gP="(?:"+fP+"(?:"+[VE,jE,UE].join("|")+")"+KE+zE+")*",mP=KE+zE+gP,wl="(?:"+[VE+Cl+"?",Cl,jE,UE,kf].join("|")+")",mS=RegExp(up+"(?="+up+")|"+wl+mP,"g");function Co(o){for(var h=mS.lastIndex=0;mS.test(o);)++h;return h}var Fn=Co;function Wd(o){return Rh(o)?Fn(o):kE(o)}var Bd=Wd,pP=Math.ceil;function YE(o,h){h=h===void 0?" ":Ye(h);var y=h.length;if(y<2)return y?Rv(h,o):h;var A=Rv(h,pP(o/Bd(h)));return Rh(h)?Uc(mo(A),0,o).join(""):A.slice(0,o)}var ku=YE,Vw=Math.ceil,Vu=Math.floor;function Mv(o,h,y){o=ri(o),h=Hn(h);var A=h?Bd(o):0;if(!h||A>=h)return o;var G=(h-A)/2;return ku(Vu(G),y)+o+ku(Vw(G),y)}var kd=Mv;function pS(o,h,y){o=ri(o),h=Hn(h);var A=h?Bd(o):0;return h&&A<h?o+ku(h-A,y):o}var Qg=pS;function jw(o,h,y){o=ri(o),h=Hn(h);var A=h?Bd(o):0;return h&&A<h?ku(h-A,y)+o:o}var yl=jw,Xh=/^\s+/,qg=C.Z.parseInt;function Uw(o,h,y){return y||h==null?h=0:h&&(h=+h),qg(ri(o).replace(Xh,""),h||0)}var cp=Uw,Ov=32,ju=xr(function(o,h){var y=eo(h,Ea(ju));return ca(o,Ov,void 0,h,y)});ju.placeholder={};var em=ju,Vf=64,vS=xr(function(o,h){var y=eo(h,Ea(vS));return ca(o,Vf,void 0,h,y)});vS.placeholder={};var GE=vS,vP=ZC(function(o,h,y){o[y?0:1].push(h)},function(){return[[],[]]}),$E=vP;function CP(o,h){return ap(o,h,function(y,A){return YC(o,A)})}var wP=CP,yP=wn(function(o,h){return o==null?{}:wP(o,h)}),XE=yP;function e1(o){for(var h,y=this;y instanceof ya;){var A=Gi(y);A.__index__=0,A.__values__=void 0,h?G.__wrapped__=A:h=A;var G=A;y=y.__wrapped__}return G.__wrapped__=o,h}var ZE=e1;function SP(o){return function(h){return o==null?void 0:kl(o,h)}}var JE=SP;function tm(o,h,y,A){for(var G=y-1,ge=o.length;++G<ge;)if(A(o[G],h))return G;return-1}var _P=tm,bP=Array.prototype,CS=bP.splice;function zw(o,h,y,A){var G=A?_P:Li,ge=-1,Re=h.length,Ve=o;for(o===h&&(h=Cr(h)),y&&(Ve=Oe(o,ta(y)));++ge<Re;)for(var st=0,kt=h[ge],Vt=y?y(kt):kt;(st=G(Ve,Vt,st,A))>-1;)Ve!==o&&CS.call(Ve,st,1),CS.call(o,st,1);return o}var Kw=zw;function nm(o,h){return o&&o.length&&h&&h.length?Kw(o,h):o}var wS=nm,Zh=xr(wS),QE=Zh;function EP(o,h,y){return o&&o.length&&h&&h.length?Kw(o,h,Nr(y,2)):o}var Iv=EP;function RP(o,h,y){return o&&o.length&&h&&h.length?Kw(o,h,void 0,y):o}var qE=RP,rm=Array.prototype,jf=rm.splice;function Yw(o,h){for(var y=o?h.length:0,A=y-1;y--;){var G=h[y];if(y==A||G!==ge){var ge=G;Il(G)?jf.call(o,G,1):Rc(o,G)}}return o}var Pv=Yw,eR=wn(function(o,h){var y=o==null?0:o.length,A=Eh(o,h);return Pv(o,Oe(h,function(G){return Il(G,y)?+G:G}).sort(HE)),A}),tR=eR,TP=Math.floor,yS=Math.random;function MP(o,h){return o+TP(yS()*(h-o+1))}var SS=MP,OP=parseFloat,IP=Math.min,_S=Math.random;function PP(o,h,y){if(y&&typeof y!="boolean"&&Gs(o,h,y)&&(h=y=void 0),y===void 0&&(typeof h=="boolean"?(y=h,h=void 0):typeof o=="boolean"&&(y=o,o=void 0)),o===void 0&&h===void 0?(o=0,h=1):(o=Mi(o),h===void 0?(h=o,o=0):h=Mi(h)),o>h){var A=o;o=h,h=A}if(y||o%1||h%1){var G=_S();return IP(o+G*(h-o+OP("1e-"+((G+"").length-1))),h)}return SS(o,h)}var nR=PP,xP=Math.ceil,AP=Math.max;function NP(o,h,y,A){for(var G=-1,ge=AP(xP((h-o)/(y||1)),0),Re=Array(ge);ge--;)Re[A?ge:++G]=o,o+=y;return Re}var xv=NP;function DP(o){return function(h,y,A){return A&&typeof A!="number"&&Gs(h,y,A)&&(y=A=void 0),h=Mi(h),y===void 0?(y=h,h=0):y=Mi(y),A=A===void 0?h<y?1:-1:Mi(A),xv(h,y,A,o)}}var rR=DP,iR=rR(),sR=iR,Gw=rR(!0),oR=Gw,im=256,aR=wn(function(o,h){return ca(o,im,void 0,void 0,void 0,h)}),Zi=aR;function Uu(o,h,y,A,G){return G(o,function(ge,Re,Ve){y=A?(A=!1,ge):h(y,ge,Re,Ve)}),y}var Av=Uu;function Jh(o,h,y){var A=ze(o)?mf:Av,G=arguments.length<3;return A(o,Nr(h,4),y,G,If)}var rh=Jh;function Qh(o,h,y,A){var G=o==null?0:o.length;for(A&&G&&(y=o[--G]);G--;)y=h(y,o[G],G,o);return y}var qh=Qh;function bS(o,h,y){var A=ze(o)?qh:Av,G=arguments.length<3;return A(o,Nr(h,4),y,G,J_)}var Nv=bS;function $w(o,h){var y=ze(o)?Dh:lb;return y(o,sp(Nr(h,3)))}var Xw=$w;function HP(o,h){var y=[];if(!(o&&o.length))return y;var A=-1,G=[],ge=o.length;for(h=Nr(h,3);++A<ge;){var Re=o[A];h(Re,A,o)&&(y.push(Re),G.push(A))}return Pv(o,G),y}var ES=HP;function lR(o,h,y){return(y?Gs(o,h,y):h===void 0)?h=1:h=Hn(h),Rv(ri(o),h)}var uR=lR;function LP(){var o=arguments,h=ri(o[0]);return o.length<3?h:h.replace(o[1],o[2])}var Dv=LP,cR="Expected a function";function RS(o,h){if(typeof o!="function")throw new TypeError(cR);return h=h===void 0?h:Hn(h),xr(o,h)}var hR=RS;function FP(o,h,y){h=mc(h,o);var A=-1,G=h.length;for(G||(G=1,o=void 0);++A<G;){var ge=o==null?void 0:o[Aa(h[A])];ge===void 0&&(A=G,ge=y),o=en(ge)?ge.call(o):ge}return o}var hp=FP,Fs=Array.prototype,hs=Fs.reverse;function TS(o){return o==null?o:hs.call(o)}var Zw=TS,dR=Am("round"),zu=dR;function Tc(o){var h=o.length;return h?o[SS(0,h-1)]:void 0}var ih=Tc;function fR(o){return ih(Fg(o))}var Es=fR;function WP(o){var h=ze(o)?ih:Es;return h(o)}var gR=WP;function BP(o,h){var y=-1,A=o.length,G=A-1;for(h=h===void 0?A:h;++y<h;){var ge=SS(y,G),Re=o[ge];o[ge]=o[y],o[y]=Re}return o.length=h,o}var Jw=BP;function kP(o,h){return Jw(Cr(o),yc(h,0,o.length))}var VP=kP;function jP(o,h){var y=Fg(o);return Jw(y,yc(h,0,y.length))}var mR=jP;function UP(o,h,y){(y?Gs(o,h,y):h===void 0)?h=1:h=Hn(h);var A=ze(o)?VP:mR;return A(o,h)}var MS=UP;function zP(o,h,y){return o==null?o:Ld(o,h,y)}var pR=zP;function KP(o,h,y,A){return A=typeof A=="function"?A:void 0,o==null?o:Ld(o,h,y,A)}var vR=KP;function YP(o){return Jw(Cr(o))}var GP=YP;function $P(o){return Jw(Fg(o))}var XP=$P;function ZP(o){var h=ze(o)?GP:XP;return h(o)}var CR=ZP,JP="[object Map]",QP="[object Set]";function qP(o){if(o==null)return 0;if(Ys(o))return pv(o)?Bd(o):o.length;var h=d(o);return h==JP||h==QP?o.size:Ut(o).length}var wR=qP;function ex(o,h,y){var A=o==null?0:o.length;return A?(y&&typeof y!="number"&&Gs(o,h,y)?(h=0,y=A):(h=h==null?0:Hn(h),y=y===void 0?A:Hn(y)),is(o,h,y)):[]}var yR=ex,tx=Ph(function(o,h,y){return o+(y?"_":"")+h.toLowerCase()}),SR=tx;function _R(o,h){var y;return If(o,function(A,G,ge){return y=h(A,G,ge),!y}),!!y}var nx=_R;function rx(o,h,y){var A=ze(o)?$p:nx;return y&&Gs(o,h,y)&&(h=void 0),A(o,Nr(h,3))}var bR=rx,ix=xr(function(o,h){if(o==null)return[];var y=h.length;return y>1&&Gs(o,h[0],h[1])?h=[]:y>2&&Gs(h[0],h[1],h[2])&&(h=[h[0]]),LE(o,fn(h,1),[])}),ER=ix,Qw=4294967295,sx=Qw-1,RR=Math.floor,ox=Math.min;function TR(o,h,y,A){var G=0,ge=o==null?0:o.length;if(ge===0)return 0;h=y(h);for(var Re=h!==h,Ve=h===null,st=Se(h),kt=h===void 0;G<ge;){var Vt=RR((G+ge)/2),Zt=y(o[Vt]),kn=Zt!==void 0,rr=Zt===null,Or=Zt===Zt,ci=Se(Zt);if(Re)var Ir=A||Or;else kt?Ir=Or&&(A||kn):Ve?Ir=Or&&kn&&(A||!rr):st?Ir=Or&&kn&&!rr&&(A||!ci):rr||ci?Ir=!1:Ir=A?Zt<=h:Zt<h;Ir?G=Vt+1:ge=Vt}return ox(ge,sx)}var OS=TR,ax=4294967295,lx=ax>>>1;function ux(o,h,y){var A=0,G=o==null?A:o.length;if(typeof h=="number"&&h===h&&G<=lx){for(;A<G;){var ge=A+G>>>1,Re=o[ge];Re!==null&&!Se(Re)&&(y?Re<=h:Re<h)?A=ge+1:G=ge}return G}return OS(o,h,Ln,y)}var qw=ux;function MR(o,h){return qw(o,h)}var ey=MR;function OR(o,h,y){return OS(o,h,Nr(y,2))}var IR=OR;function IS(o,h){var y=o==null?0:o.length;if(y){var A=qw(o,h);if(A<y&&ha(o[A],h))return A}return-1}var PR=IS;function sh(o,h){return qw(o,h,!0)}var dp=sh;function xR(o,h,y){return OS(o,h,Nr(y,2),!0)}var PS=xR;function Vd(o,h){var y=o==null?0:o.length;if(y){var A=qw(o,h,!0)-1;if(ha(o[A],h))return A}return-1}var Uf=Vd;function xS(o,h){for(var y=-1,A=o.length,G=0,ge=[];++y<A;){var Re=o[y],Ve=h?h(Re):Re;if(!y||!ha(Ve,st)){var st=Ve;ge[G++]=Re===0?0:Re}}return ge}var AR=xS;function AS(o){return o&&o.length?AR(o):[]}var NR=AS;function cx(o,h){return o&&o.length?AR(o,Nr(h,2)):[]}var NS=cx,DR=4294967295;function hx(o,h,y){return y&&typeof y!="number"&&Gs(o,h,y)&&(h=y=void 0),y=y===void 0?DR:y>>>0,y?(o=ri(o),o&&(typeof h=="string"||h!=null&&!Iw(h))&&(h=Ye(h),!h&&Rh(o))?Uc(mo(o),0,y):o.split(h,y)):[]}var DS=hx,HR="Expected a function",dx=Math.max;function fx(o,h){if(typeof o!="function")throw new TypeError(HR);return h=h==null?0:dx(Hn(h),0),xr(function(y){var A=y[h],G=Uc(y,0,h);return A&&We(G,A),Wn(o,this,G)})}var HS=fx,ty=Ph(function(o,h,y){return o+(y?" ":"")+vi(h)}),ny=ty;function gx(o,h,y){return o=ri(o),y=y==null?0:yc(Hn(y),0,o.length),h=Ye(h),o.slice(y,y+h.length)==h}var Sl=gx;function mx(){return{}}var LS=mx;function fp(){return""}var zf=fp;function gp(){return!0}var LR=gp,FR=hn(function(o,h){return o-h},0),Hv=FR;function ry(o){return o&&o.length?pl(o,Ln):0}var iy=ry;function FS(o,h){return o&&o.length?pl(o,Nr(h,2)):0}var WR=FS;function px(o){var h=o==null?0:o.length;return h?is(o,1,h):[]}var WS=px;function vx(o,h,y){return o&&o.length?(h=y||h===void 0?1:Hn(h),is(o,0,h<0?0:h)):[]}var Lv=vx;function Cx(o,h,y){var A=o==null?0:o.length;return A?(h=y||h===void 0?1:Hn(h),h=A-h,is(o,h<0?0:h,A)):[]}var BR=Cx;function BS(o,h){return o&&o.length?aw(o,Nr(h,3),!1,!0):[]}var kR=BS;function Fv(o,h){return o&&o.length?aw(o,Nr(h,3)):[]}var oo=Fv;function VR(o,h){return h(o),o}var oh=VR,Yl=Object.prototype,sm=Yl.hasOwnProperty;function wx(o,h,y,A){return o===void 0||ha(o,Yl[y])&&!sm.call(A,y)?h:o}var mp=wx,yx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Sx(o){return"\\"+yx[o]}var _x=Sx,bx=/<%=([\s\S]+?)%>/g,jR=bx,UR=/<%-([\s\S]+?)%>/g,Ex=UR,Rx=/<%([\s\S]+?)%>/g,Wv=Rx,zR={escape:Ex,evaluate:Wv,interpolate:jR,variable:"",imports:{_:{escape:Ag}}},Mc=zR,wi="Invalid `variable` option passed into `_.template`",wo=/\b__p \+= '';/g,KR=/\b(__p \+=) '' \+/g,Tx=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ds=/[()=,{}\[\]\/\s]/,Kf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Yf=/($^)/,sy=/['\n\r\u2028\u2029\\]/g,oy=Object.prototype,yo=oy.hasOwnProperty;function Mx(o,h,y){var A=Mc.imports._.templateSettings||Mc;y&&Gs(o,h,y)&&(h=void 0),o=ri(o),h=eu({},h,A,mp);var G=eu({},h.imports,A.imports,mp),ge=Ar(G),Re=k0(G,ge),Ve,st,kt=0,Vt=h.interpolate||Yf,Zt="__p += '",kn=RegExp((h.escape||Yf).source+"|"+Vt.source+"|"+(Vt===jR?Kf:Yf).source+"|"+(h.evaluate||Yf).source+"|$","g"),rr=yo.call(h,"sourceURL")?"//# sourceURL="+(h.sourceURL+"").replace(/\s/g," ")+`
`:"";o.replace(kn,function(Ir,yi,Ni,ao,Ba,Yu){return Ni||(Ni=ao),Zt+=o.slice(kt,Yu).replace(sy,_x),yi&&(Ve=!0,Zt+=`' +
__e(`+yi+`) +
'`),Ba&&(st=!0,Zt+=`';
`+Ba+`;
__p += '`),Ni&&(Zt+=`' +
((__t = (`+Ni+`)) == null ? '' : __t) +
'`),kt=Yu+Ir.length,Ir}),Zt+=`';
`;var Or=yo.call(h,"variable")&&h.variable;if(!Or)Zt=`with (obj) {
`+Zt+`
}
`;else if(ds.test(Or))throw new Error(wi);Zt=(st?Zt.replace(wo,""):Zt).replace(KR,"$1").replace(Tx,"$1;"),Zt="function("+(Or||"obj")+`) {
`+(Or?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ve?", __e = _.escape":"")+(st?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Zt+`return __p
}`;var ci=mm(function(){return Function(ge,rr+"return "+Zt).apply(void 0,Re)});if(ci.source=Zt,cf(ci))throw ci;return ci}var Bv=Mx,Ox="Expected a function";function Ix(o,h,y){var A=!0,G=!0;if(typeof o!="function")throw new TypeError(Ox);return Mt(y)&&(A="leading"in y?!!y.leading:A,G="trailing"in y?!!y.trailing:G),S0(o,h,{leading:A,maxWait:h,trailing:G})}var YR=Ix;function Px(o,h){return h(o)}var pp=Px,xx=9007199254740991,kS=4294967295,Ax=Math.min;function Nx(o,h){if(o=Hn(o),o<1||o>xx)return[];var y=kS,A=Ax(o,kS);h=jh(h),o-=kS;for(var G=Qo(A,h);++y<o;)h(y);return G}var GR=Nx;function Dx(){return this}var VS=Dx;function Hx(o,h){var y=o;return y instanceof dr&&(y=y.value()),mf(h,function(A,G){return G.func.apply(G.thisArg,We([A],G.args))},y)}var $R=Hx;function Lx(){return $R(this.__wrapped__,this.__actions__)}var om=Lx;function Fx(o){return ri(o).toLowerCase()}var vp=Fx;function Wx(o){return ze(o)?Oe(o,Aa):Se(o)?[o]:Cr(Tu(ri(o)))}var XR=Wx,ZR=9007199254740991;function Bx(o){return o?yc(Hn(o),-ZR,ZR):o===0?o:0}var jS=Bx;function kx(o){return ri(o).toUpperCase()}var JR=kx;function Vx(o,h,y){var A=ze(o),G=A||(0,Dl.Z)(o)||Ma(o);if(h=Nr(h,4),y==null){var ge=o&&o.constructor;G?y=A?new ge:[]:Mt(o)?y=en(ge)?Er(Zr(o)):{}:y={}}return(G?Fr:kh)(o,function(Re,Ve,st){return h(y,Re,Ve,st)}),y}var ay=Vx;function jd(o,h){for(var y=o.length;y--&&Li(h,o[y],0)>-1;);return y}var US=jd;function jx(o,h){for(var y=-1,A=o.length;++y<A&&Li(h,o[y],0)>-1;);return y}var QR=jx;function Ux(o,h,y){if(o=ri(o),o&&(y||h===void 0))return Qe(o);if(!o||!(h=Ye(h)))return o;var A=mo(o),G=mo(h),ge=QR(A,G),Re=US(A,G)+1;return Uc(A,ge,Re).join("")}var qR=Ux;function zx(o,h,y){if(o=ri(o),o&&(y||h===void 0))return o.slice(0,Ft(o)+1);if(!o||!(h=Ye(h)))return o;var A=mo(o),G=US(A,mo(h))+1;return Uc(A,0,G).join("")}var eT=zx,Kx=/^\s+/;function Yx(o,h,y){if(o=ri(o),o&&(y||h===void 0))return o.replace(Kx,"");if(!o||!(h=Ye(h)))return o;var A=mo(o),G=QR(A,mo(h));return Uc(A,G).join("")}var tT=Yx,nT=30,Gx="...",$x=/\w*$/;function ly(o,h){var y=nT,A=Gx;if(Mt(h)){var G="separator"in h?h.separator:G;y="length"in h?Hn(h.length):y,A="omission"in h?Ye(h.omission):A}o=ri(o);var ge=o.length;if(Rh(o)){var Re=mo(o);ge=Re.length}if(y>=ge)return o;var Ve=y-Bd(A);if(Ve<1)return A;var st=Re?Uc(Re,0,Ve).join(""):o.slice(0,Ve);if(G===void 0)return st+A;if(Re&&(Ve+=st.length-Ve),Iw(G)){if(o.slice(Ve).search(G)){var kt,Vt=st;for(G.global||(G=RegExp(G.source,ri($x.exec(G))+"g")),G.lastIndex=0;kt=G.exec(Vt);)var Zt=kt.index;st=st.slice(0,Zt===void 0?Ve:Zt)}}else if(o.indexOf(Ye(G),Ve)!=Ve){var kn=st.lastIndexOf(G);kn>-1&&(st=st.slice(0,kn))}return st+A}var rT=ly;function Xx(o){return sl(o,1)}var iT=Xx,Zx={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},sT=Au(Zx),oT=sT,uy=/&(?:amp|lt|gt|quot|#39);/g,Jx=RegExp(uy.source);function Qx(o){return o=ri(o),o&&Jx.test(o)?o.replace(uy,oT):o}var kv=Qx,cy=1/0,wa=Rf&&1/kC(new Rf([,-0]))[1]==cy?function(o){return new Rf(o)}:O,hy=wa,qx=200;function aT(o,h,y){var A=-1,G=Tl,ge=o.length,Re=!0,Ve=[],st=Ve;if(y)Re=!1,G=T0;else if(ge>=qx){var kt=h?null:hy(o);if(kt)return kC(kt);Re=!1,G=Xp,st=new FC}else st=h?[]:Ve;e:for(;++A<ge;){var Vt=o[A],Zt=h?h(Vt):Vt;if(Vt=y||Vt!==0?Vt:0,Re&&Zt===Zt){for(var kn=st.length;kn--;)if(st[kn]===Zt)continue e;h&&st.push(Zt),Ve.push(Vt)}else G(st,Zt,y)||(st!==Ve&&st.push(Zt),Ve.push(Vt))}return Ve}var Gf=aT,dy=xr(function(o){return Gf(fn(o,1,Ao,!0))}),am=dy,Wa=xr(function(o){var h=lu(o);return Ao(h)&&(h=void 0),Gf(fn(o,1,Ao,!0),Nr(h,2))}),lT=Wa,eA=xr(function(o){var h=lu(o);return h=typeof h=="function"?h:void 0,Gf(fn(o,1,Ao,!0),void 0,h)}),uT=eA;function tA(o){return o&&o.length?Gf(o):[]}var cT=tA;function nA(o,h){return o&&o.length?Gf(o,Nr(h,2)):[]}var hT=nA;function rA(o,h){return h=typeof h=="function"?h:void 0,o&&o.length?Gf(o,void 0,h):[]}var dT=rA,iA=0;function sA(o){var h=++iA;return ri(o)+h}var fT=sA;function oA(o,h){return o==null?!0:Rc(o,h)}var gT=oA,aA=Math.max;function lA(o){if(!(o&&o.length))return[];var h=0;return o=Dh(o,function(y){if(Ao(y))return h=aA(y.length,h),!0}),Qo(h,function(y){return Oe(o,f0(y))})}var Vv=lA;function zS(o,h){if(!(o&&o.length))return[];var y=Vv(o);return h==null?y:Oe(y,function(A){return Wn(h,void 0,A)})}var KS=zS;function uA(o,h,y,A){return Ld(o,h,y(kl(o,h)),A)}var mT=uA;function cA(o,h,y){return o==null?o:mT(o,h,jh(y))}var pT=cA;function hA(o,h,y,A){return A=typeof A=="function"?A:void 0,o==null?o:mT(o,h,jh(y),A)}var vT=hA,CT=Ph(function(o,h,y){return o+(y?" ":"")+h.toUpperCase()}),wT=CT;function dA(o){return o==null?[]:k0(o,ns(o))}var yT=dA,fA=xr(function(o,h){return Ao(o)?av(o,h):[]}),fy=fA;function gA(o,h){return em(jh(h),o)}var ST=gA,_T=wn(function(o){var h=o.length,y=h?o[0]:0,A=this.__wrapped__,G=function(ge){return Eh(ge,o)};return h>1||this.__actions__.length||!(A instanceof dr)||!Il(y)?this.thru(G):(A=A.slice(y,+y+(h?1:0)),A.__actions__.push({func:pp,args:[G],thisArg:void 0}),new pn(A,this.__chain__).thru(function(ge){return h&&!ge.length&&ge.push(void 0),ge}))}),gy=_T;function mA(){return Dp(this)}var bT=mA;function pA(){var o=this.__wrapped__;if(o instanceof dr){var h=o;return this.__actions__.length&&(h=new dr(this)),h=h.reverse(),h.__actions__.push({func:pp,args:[Zw],thisArg:void 0}),new pn(h,this.__chain__)}return this.thru(Zw)}var ET=pA;function YS(o,h,y){var A=o.length;if(A<2)return A?Gf(o[0]):[];for(var G=-1,ge=Array(A);++G<A;)for(var Re=o[G],Ve=-1;++Ve<A;)Ve!=G&&(ge[G]=av(ge[G]||Re,o[Ve],h,y));return Gf(fn(ge,1),h,y)}var GS=YS,RT=xr(function(o){return GS(Dh(o,Ao))}),jv=RT,vA=xr(function(o){var h=lu(o);return Ao(h)&&(h=void 0),GS(Dh(o,Ao),Nr(h,2))}),TT=vA,MT=xr(function(o){var h=lu(o);return h=typeof h=="function"?h:void 0,GS(Dh(o,Ao),void 0,h)}),OT=MT,IT=xr(Vv),PT=IT;function $S(o,h,y){for(var A=-1,G=o.length,ge=h.length,Re={};++A<G;){var Ve=A<ge?h[A]:void 0;y(Re,o[A],Ve)}return Re}var Uv=$S;function xT(o,h){return Uv(o||[],h||[],ic)}var zv=xT;function Kv(o,h){return Uv(o||[],h||[],Ld)}var AT=Kv,CA=xr(function(o){var h=o.length,y=h>1?o[h-1]:void 0;return y=typeof y=="function"?(o.pop(),y):void 0,KS(o,y)}),Yv=CA,Jn={chunk:_f,compact:u_,concat:s0,difference:M0,differenceBy:ow,differenceWith:K_,drop:Y_,dropRight:Td,dropRightWhile:G_,dropWhile:uw,fill:ab,findIndex:N0,findLastIndex:fw,first:gw,flatten:cn,flattenDeep:H0,flattenDepth:Sb,fromPairs:F0,head:gw,indexOf:Bb,initial:kb,intersection:tp,intersectionBy:hu,intersectionWith:_w,join:mE,last:lu,lastIndexOf:Pw,nth:Gh,pull:QE,pullAll:wS,pullAllBy:Iv,pullAllWith:qE,pullAt:tR,remove:ES,reverse:Zw,slice:yR,sortedIndex:ey,sortedIndexBy:IR,sortedIndexOf:PR,sortedLastIndex:dp,sortedLastIndexBy:PS,sortedLastIndexOf:Uf,sortedUniq:NR,sortedUniqBy:NS,tail:WS,take:Lv,takeRight:BR,takeRightWhile:kR,takeWhile:oo,union:am,unionBy:lT,unionWith:uT,uniq:cT,uniqBy:hT,uniqWith:dT,unzip:Vv,unzipWith:KS,without:fy,xor:jv,xorBy:TT,xorWith:OT,zip:PT,zipObject:zv,zipObjectDeep:AT,zipWith:Yv},Dr={countBy:D_,each:cw,eachRight:hw,every:dw,filter:ub,find:cb,findLast:fb,flatMap:pb,flatMapDeep:D0,flatMapDepth:yb,forEach:cw,forEachRight:hw,groupBy:Mb,includes:j0,invokeMap:Ub,keyBy:vE,map:Dg,orderBy:cS,partition:$E,reduce:rh,reduceRight:Nv,reject:Xw,sample:gR,sampleSize:MS,shuffle:CR,size:wR,some:bR,sortBy:ER},XS={now:tv},Ws={after:Vs,ary:sl,before:Sp,bind:hf,bindKey:nC,curry:y0,curryRight:F_,debounce:S0,defer:iw,delay:sv,flip:_b,memoize:ti,negate:sp,once:DE,overArgs:WE,partial:em,partialRight:GE,rearg:Zi,rest:hR,spread:HS,throttle:YR,unary:iT,wrap:ST},yr={castArray:vg,clone:s_,cloneDeep:o_,cloneDeepWith:a_,cloneWith:l_,conformsTo:R_,eq:ha,gt:GO,gte:yw,isArguments:Ka,isArray:ze,isArrayBuffer:xi,isArrayLike:Ys,isArrayLikeObject:Ao,isBoolean:Kb,isBuffer:Dl.Z,isDate:Yb,isElement:Gb,isEmpty:Zb,isEqual:Qb,isEqualWith:qb,isError:cf,isFinite:eE,isFunction:en,isInteger:Q0,isLength:Su,isMap:Xi,isMatch:tE,isMatchWith:nE,isNaN:rE,isNative:Df,isNil:Ad,isNull:lE,isNumber:q0,isObject:Mt,isObjectLike:ue,isPlainObject:Ou,isRegExp:Iw,isSafeInteger:hE,isSet:oa,isString:pv,isSymbol:Se,isTypedArray:Ma,isUndefined:dE,isWeakMap:tS,isWeakSet:Nd,lt:SE,lte:Sv,toArray:so,toFinite:Mi,toInteger:Hn,toLength:Uh,toNumber:Qn,toPlainObject:b0,toSafeInteger:jS,toString:ri},fs={add:mt,ceil:SC,divide:Ym,floor:gv,max:ME,maxBy:bc,mean:sS,meanBy:Dw,min:_v,minBy:Yg,multiply:IE,round:zu,subtract:Hv,sum:iy,sumBy:WR},$f={clamp:yg,inRange:Hb,random:nR},Wr={assign:Ss,assignIn:ga,assignInWith:eu,assignWith:hc,at:Nn,create:L_,defaults:QC,defaultsDeep:io,entries:Xm,entriesIn:xg,extend:ga,extendWith:eu,findKey:hb,findLastKey:gb,forIn:qm,forInRight:Rb,forOwn:Fu,forOwnRight:Cw,functions:cu,functionsIn:Tb,get:Mu,has:mv,hasIn:YC,invert:Nf,invertBy:Tw,invoke:jb,keys:Ar,keysIn:ns,mapKeys:_E,mapValues:iS,merge:vl,mergeWith:nw,omit:bv,omitBy:NE,pick:XE,pickBy:aS,result:hp,set:pR,setWith:vR,toPairs:Xm,toPairsIn:xg,transform:ay,unset:gT,update:pT,updateWith:vT,values:Fg,valuesIn:yT},Ku={at:gy,chain:Dp,commit:i0,lodash:fe,next:Wu,plant:ZE,reverse:ET,tap:oh,thru:pp,toIterator:VS,toJSON:om,value:om,valueOf:om,wrapperChain:bT},Ai={camelCase:Pm,capitalize:yd,deburr:Op,endsWith:Q_,escape:Ag,escapeRegExp:Yr,kebabCase:pE,lowerCase:wv,lowerFirst:yE,pad:kd,padEnd:Qg,padStart:yl,parseInt:cp,repeat:uR,replace:Dv,snakeCase:SR,split:DS,startCase:ny,startsWith:Sl,template:Bv,templateSettings:Mc,toLower:vp,toUpper:JR,trim:qR,trimEnd:eT,trimStart:tT,truncate:rT,unescape:kv,upperCase:wT,upperFirst:vi,words:xp},gs={attempt:mm,bindAll:eC,cond:Of,conforms:E_,constant:Go,defaultTo:j_,flow:mw,flowRight:pw,identity:Ln,iteratee:nh,matches:EE,matchesProperty:TE,method:Yh,methodOf:Dd,mixin:Gg,noop:O,nthArg:du,over:hS,overEvery:BE,overSome:dS,property:g0,propertyOf:JE,range:sR,rangeRight:oR,stubArray:Hm,stubFalse:eS.Z,stubObject:LS,stubString:zf,stubTrue:LR,times:GR,toPath:XR,uniqueId:fT};function wA(){var o=new dr(this.__wrapped__);return o.__actions__=Cr(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Cr(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Cr(this.__views__),o}var yA=wA;function NT(){if(this.__filtered__){var o=new dr(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}var SA=NT,ZS=Math.max,DT=Math.min;function JS(o,h,y){for(var A=-1,G=y.length;++A<G;){var ge=y[A],Re=ge.size;switch(ge.type){case"drop":o+=Re;break;case"dropRight":h-=Re;break;case"take":h=DT(h,o+Re);break;case"takeRight":o=ZS(o,h-Re);break}}return{start:o,end:h}}var Ud=JS,my=1,_A=2,bA=Math.min;function Cp(){var o=this.__wrapped__.value(),h=this.__dir__,y=ze(o),A=h<0,G=y?o.length:0,ge=Ud(0,G,this.__views__),Re=ge.start,Ve=ge.end,st=Ve-Re,kt=A?Ve:Re-1,Vt=this.__iteratees__,Zt=Vt.length,kn=0,rr=bA(st,this.__takeCount__);if(!y||!A&&G==st&&rr==st)return $R(o,this.__actions__);var Or=[];e:for(;st--&&kn<rr;){kt+=h;for(var ci=-1,Ir=o[kt];++ci<Zt;){var yi=Vt[ci],Ni=yi.iteratee,ao=yi.type,Ba=Ni(Ir);if(ao==_A)Ir=Ba;else if(!Ba){if(ao==my)continue e;break e}}Or[kn++]=Ir}return Or}var py=Cp;var Gv="4.17.21",QS=2,EA=1,RA=3,HT=4294967295,TA=Array.prototype,MA=Object.prototype,$v=MA.hasOwnProperty,LT=B?B.iterator:void 0,OA=Math.max,vy=Math.min,qS=function(o){return function(h,y,A){if(A==null){var G=Mt(y),ge=G&&Ar(y),Re=ge&&ge.length&&ep(y,ge);(Re?Re.length:G)||(A=y,y=h,h=this)}return o(h,y,A)}}(Gg);fe.after=Ws.after,fe.ary=Ws.ary,fe.assign=Wr.assign,fe.assignIn=Wr.assignIn,fe.assignInWith=Wr.assignInWith,fe.assignWith=Wr.assignWith,fe.at=Wr.at,fe.before=Ws.before,fe.bind=Ws.bind,fe.bindAll=gs.bindAll,fe.bindKey=Ws.bindKey,fe.castArray=yr.castArray,fe.chain=Ku.chain,fe.chunk=Jn.chunk,fe.compact=Jn.compact,fe.concat=Jn.concat,fe.cond=gs.cond,fe.conforms=gs.conforms,fe.constant=gs.constant,fe.countBy=Dr.countBy,fe.create=Wr.create,fe.curry=Ws.curry,fe.curryRight=Ws.curryRight,fe.debounce=Ws.debounce,fe.defaults=Wr.defaults,fe.defaultsDeep=Wr.defaultsDeep,fe.defer=Ws.defer,fe.delay=Ws.delay,fe.difference=Jn.difference,fe.differenceBy=Jn.differenceBy,fe.differenceWith=Jn.differenceWith,fe.drop=Jn.drop,fe.dropRight=Jn.dropRight,fe.dropRightWhile=Jn.dropRightWhile,fe.dropWhile=Jn.dropWhile,fe.fill=Jn.fill,fe.filter=Dr.filter,fe.flatMap=Dr.flatMap,fe.flatMapDeep=Dr.flatMapDeep,fe.flatMapDepth=Dr.flatMapDepth,fe.flatten=Jn.flatten,fe.flattenDeep=Jn.flattenDeep,fe.flattenDepth=Jn.flattenDepth,fe.flip=Ws.flip,fe.flow=gs.flow,fe.flowRight=gs.flowRight,fe.fromPairs=Jn.fromPairs,fe.functions=Wr.functions,fe.functionsIn=Wr.functionsIn,fe.groupBy=Dr.groupBy,fe.initial=Jn.initial,fe.intersection=Jn.intersection,fe.intersectionBy=Jn.intersectionBy,fe.intersectionWith=Jn.intersectionWith,fe.invert=Wr.invert,fe.invertBy=Wr.invertBy,fe.invokeMap=Dr.invokeMap,fe.iteratee=gs.iteratee,fe.keyBy=Dr.keyBy,fe.keys=Ar,fe.keysIn=Wr.keysIn,fe.map=Dr.map,fe.mapKeys=Wr.mapKeys,fe.mapValues=Wr.mapValues,fe.matches=gs.matches,fe.matchesProperty=gs.matchesProperty,fe.memoize=Ws.memoize,fe.merge=Wr.merge,fe.mergeWith=Wr.mergeWith,fe.method=gs.method,fe.methodOf=gs.methodOf,fe.mixin=qS,fe.negate=sp,fe.nthArg=gs.nthArg,fe.omit=Wr.omit,fe.omitBy=Wr.omitBy,fe.once=Ws.once,fe.orderBy=Dr.orderBy,fe.over=gs.over,fe.overArgs=Ws.overArgs,fe.overEvery=gs.overEvery,fe.overSome=gs.overSome,fe.partial=Ws.partial,fe.partialRight=Ws.partialRight,fe.partition=Dr.partition,fe.pick=Wr.pick,fe.pickBy=Wr.pickBy,fe.property=gs.property,fe.propertyOf=gs.propertyOf,fe.pull=Jn.pull,fe.pullAll=Jn.pullAll,fe.pullAllBy=Jn.pullAllBy,fe.pullAllWith=Jn.pullAllWith,fe.pullAt=Jn.pullAt,fe.range=gs.range,fe.rangeRight=gs.rangeRight,fe.rearg=Ws.rearg,fe.reject=Dr.reject,fe.remove=Jn.remove,fe.rest=Ws.rest,fe.reverse=Jn.reverse,fe.sampleSize=Dr.sampleSize,fe.set=Wr.set,fe.setWith=Wr.setWith,fe.shuffle=Dr.shuffle,fe.slice=Jn.slice,fe.sortBy=Dr.sortBy,fe.sortedUniq=Jn.sortedUniq,fe.sortedUniqBy=Jn.sortedUniqBy,fe.split=Ai.split,fe.spread=Ws.spread,fe.tail=Jn.tail,fe.take=Jn.take,fe.takeRight=Jn.takeRight,fe.takeRightWhile=Jn.takeRightWhile,fe.takeWhile=Jn.takeWhile,fe.tap=Ku.tap,fe.throttle=Ws.throttle,fe.thru=pp,fe.toArray=yr.toArray,fe.toPairs=Wr.toPairs,fe.toPairsIn=Wr.toPairsIn,fe.toPath=gs.toPath,fe.toPlainObject=yr.toPlainObject,fe.transform=Wr.transform,fe.unary=Ws.unary,fe.union=Jn.union,fe.unionBy=Jn.unionBy,fe.unionWith=Jn.unionWith,fe.uniq=Jn.uniq,fe.uniqBy=Jn.uniqBy,fe.uniqWith=Jn.uniqWith,fe.unset=Wr.unset,fe.unzip=Jn.unzip,fe.unzipWith=Jn.unzipWith,fe.update=Wr.update,fe.updateWith=Wr.updateWith,fe.values=Wr.values,fe.valuesIn=Wr.valuesIn,fe.without=Jn.without,fe.words=Ai.words,fe.wrap=Ws.wrap,fe.xor=Jn.xor,fe.xorBy=Jn.xorBy,fe.xorWith=Jn.xorWith,fe.zip=Jn.zip,fe.zipObject=Jn.zipObject,fe.zipObjectDeep=Jn.zipObjectDeep,fe.zipWith=Jn.zipWith,fe.entries=Wr.toPairs,fe.entriesIn=Wr.toPairsIn,fe.extend=Wr.assignIn,fe.extendWith=Wr.assignInWith,qS(fe,fe),fe.add=fs.add,fe.attempt=gs.attempt,fe.camelCase=Ai.camelCase,fe.capitalize=Ai.capitalize,fe.ceil=fs.ceil,fe.clamp=$f.clamp,fe.clone=yr.clone,fe.cloneDeep=yr.cloneDeep,fe.cloneDeepWith=yr.cloneDeepWith,fe.cloneWith=yr.cloneWith,fe.conformsTo=yr.conformsTo,fe.deburr=Ai.deburr,fe.defaultTo=gs.defaultTo,fe.divide=fs.divide,fe.endsWith=Ai.endsWith,fe.eq=yr.eq,fe.escape=Ai.escape,fe.escapeRegExp=Ai.escapeRegExp,fe.every=Dr.every,fe.find=Dr.find,fe.findIndex=Jn.findIndex,fe.findKey=Wr.findKey,fe.findLast=Dr.findLast,fe.findLastIndex=Jn.findLastIndex,fe.findLastKey=Wr.findLastKey,fe.floor=fs.floor,fe.forEach=Dr.forEach,fe.forEachRight=Dr.forEachRight,fe.forIn=Wr.forIn,fe.forInRight=Wr.forInRight,fe.forOwn=Wr.forOwn,fe.forOwnRight=Wr.forOwnRight,fe.get=Wr.get,fe.gt=yr.gt,fe.gte=yr.gte,fe.has=Wr.has,fe.hasIn=Wr.hasIn,fe.head=Jn.head,fe.identity=Ln,fe.includes=Dr.includes,fe.indexOf=Jn.indexOf,fe.inRange=$f.inRange,fe.invoke=Wr.invoke,fe.isArguments=yr.isArguments,fe.isArray=ze,fe.isArrayBuffer=yr.isArrayBuffer,fe.isArrayLike=yr.isArrayLike,fe.isArrayLikeObject=yr.isArrayLikeObject,fe.isBoolean=yr.isBoolean,fe.isBuffer=yr.isBuffer,fe.isDate=yr.isDate,fe.isElement=yr.isElement,fe.isEmpty=yr.isEmpty,fe.isEqual=yr.isEqual,fe.isEqualWith=yr.isEqualWith,fe.isError=yr.isError,fe.isFinite=yr.isFinite,fe.isFunction=yr.isFunction,fe.isInteger=yr.isInteger,fe.isLength=yr.isLength,fe.isMap=yr.isMap,fe.isMatch=yr.isMatch,fe.isMatchWith=yr.isMatchWith,fe.isNaN=yr.isNaN,fe.isNative=yr.isNative,fe.isNil=yr.isNil,fe.isNull=yr.isNull,fe.isNumber=yr.isNumber,fe.isObject=Mt,fe.isObjectLike=yr.isObjectLike,fe.isPlainObject=yr.isPlainObject,fe.isRegExp=yr.isRegExp,fe.isSafeInteger=yr.isSafeInteger,fe.isSet=yr.isSet,fe.isString=yr.isString,fe.isSymbol=yr.isSymbol,fe.isTypedArray=yr.isTypedArray,fe.isUndefined=yr.isUndefined,fe.isWeakMap=yr.isWeakMap,fe.isWeakSet=yr.isWeakSet,fe.join=Jn.join,fe.kebabCase=Ai.kebabCase,fe.last=lu,fe.lastIndexOf=Jn.lastIndexOf,fe.lowerCase=Ai.lowerCase,fe.lowerFirst=Ai.lowerFirst,fe.lt=yr.lt,fe.lte=yr.lte,fe.max=fs.max,fe.maxBy=fs.maxBy,fe.mean=fs.mean,fe.meanBy=fs.meanBy,fe.min=fs.min,fe.minBy=fs.minBy,fe.stubArray=gs.stubArray,fe.stubFalse=gs.stubFalse,fe.stubObject=gs.stubObject,fe.stubString=gs.stubString,fe.stubTrue=gs.stubTrue,fe.multiply=fs.multiply,fe.nth=Jn.nth,fe.noop=gs.noop,fe.now=XS.now,fe.pad=Ai.pad,fe.padEnd=Ai.padEnd,fe.padStart=Ai.padStart,fe.parseInt=Ai.parseInt,fe.random=$f.random,fe.reduce=Dr.reduce,fe.reduceRight=Dr.reduceRight,fe.repeat=Ai.repeat,fe.replace=Ai.replace,fe.result=Wr.result,fe.round=fs.round,fe.sample=Dr.sample,fe.size=Dr.size,fe.snakeCase=Ai.snakeCase,fe.some=Dr.some,fe.sortedIndex=Jn.sortedIndex,fe.sortedIndexBy=Jn.sortedIndexBy,fe.sortedIndexOf=Jn.sortedIndexOf,fe.sortedLastIndex=Jn.sortedLastIndex,fe.sortedLastIndexBy=Jn.sortedLastIndexBy,fe.sortedLastIndexOf=Jn.sortedLastIndexOf,fe.startCase=Ai.startCase,fe.startsWith=Ai.startsWith,fe.subtract=fs.subtract,fe.sum=fs.sum,fe.sumBy=fs.sumBy,fe.template=Ai.template,fe.times=gs.times,fe.toFinite=yr.toFinite,fe.toInteger=Hn,fe.toLength=yr.toLength,fe.toLower=Ai.toLower,fe.toNumber=yr.toNumber,fe.toSafeInteger=yr.toSafeInteger,fe.toString=yr.toString,fe.toUpper=Ai.toUpper,fe.trim=Ai.trim,fe.trimEnd=Ai.trimEnd,fe.trimStart=Ai.trimStart,fe.truncate=Ai.truncate,fe.unescape=Ai.unescape,fe.uniqueId=gs.uniqueId,fe.upperCase=Ai.upperCase,fe.upperFirst=Ai.upperFirst,fe.each=Dr.forEach,fe.eachRight=Dr.forEachRight,fe.first=Jn.head,qS(fe,function(){var o={};return kh(fe,function(h,y){$v.call(fe.prototype,y)||(o[y]=h)}),o}(),{chain:!1}),fe.VERSION=Gv,(fe.templateSettings=Ai.templateSettings).imports._=fe,Fr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){fe[o].placeholder=fe}),Fr(["drop","take"],function(o,h){dr.prototype[o]=function(y){y=y===void 0?1:OA(Hn(y),0);var A=this.__filtered__&&!h?new dr(this):this.clone();return A.__filtered__?A.__takeCount__=vy(y,A.__takeCount__):A.__views__.push({size:vy(y,HT),type:o+(A.__dir__<0?"Right":"")}),A},dr.prototype[o+"Right"]=function(y){return this.reverse()[o](y).reverse()}}),Fr(["filter","map","takeWhile"],function(o,h){var y=h+1,A=y==EA||y==RA;dr.prototype[o]=function(G){var ge=this.clone();return ge.__iteratees__.push({iteratee:Nr(G,3),type:y}),ge.__filtered__=ge.__filtered__||A,ge}}),Fr(["head","last"],function(o,h){var y="take"+(h?"Right":"");dr.prototype[o]=function(){return this[y](1).value()[0]}}),Fr(["initial","tail"],function(o,h){var y="drop"+(h?"":"Right");dr.prototype[o]=function(){return this.__filtered__?new dr(this):this[y](1)}}),dr.prototype.compact=function(){return this.filter(Ln)},dr.prototype.find=function(o){return this.filter(o).head()},dr.prototype.findLast=function(o){return this.reverse().find(o)},dr.prototype.invokeMap=xr(function(o,h){return typeof o=="function"?new dr(this):this.map(function(y){return vv(y,o,h)})}),dr.prototype.reject=function(o){return this.filter(sp(Nr(o)))},dr.prototype.slice=function(o,h){o=Hn(o);var y=this;return y.__filtered__&&(o>0||h<0)?new dr(y):(o<0?y=y.takeRight(-o):o&&(y=y.drop(o)),h!==void 0&&(h=Hn(h),y=h<0?y.dropRight(-h):y.take(h-o)),y)},dr.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},dr.prototype.toArray=function(){return this.take(HT)},kh(dr.prototype,function(o,h){var y=/^(?:filter|find|map|reject)|While$/.test(h),A=/^(?:head|last)$/.test(h),G=fe[A?"take"+(h=="last"?"Right":""):h],ge=A||/^find/.test(h);G&&(fe.prototype[h]=function(){var Re=this.__wrapped__,Ve=A?[1]:arguments,st=Re instanceof dr,kt=Ve[0],Vt=st||ze(Re),Zt=function(yi){var Ni=G.apply(fe,We([yi],Ve));return A&&kn?Ni[0]:Ni};Vt&&y&&typeof kt=="function"&&kt.length!=1&&(st=Vt=!1);var kn=this.__chain__,rr=!!this.__actions__.length,Or=ge&&!kn,ci=st&&!rr;if(!ge&&Vt){Re=ci?Re:new dr(this);var Ir=o.apply(Re,Ve);return Ir.__actions__.push({func:pp,args:[Zt],thisArg:void 0}),new pn(Ir,kn)}return Or&&ci?o.apply(this,Ve):(Ir=this.thru(Zt),Or?A?Ir.value()[0]:Ir.value():Ir)})}),Fr(["pop","push","shift","sort","splice","unshift"],function(o){var h=TA[o],y=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",A=/^(?:pop|shift)$/.test(o);fe.prototype[o]=function(){var G=arguments;if(A&&!this.__chain__){var ge=this.value();return h.apply(ze(ge)?ge:[],G)}return this[y](function(Re){return h.apply(ze(Re)?Re:[],G)})}}),kh(dr.prototype,function(o,h){var y=fe[h];if(y){var A=y.name+"";$v.call(Me,A)||(Me[A]=[]),Me[A].push({name:h,func:y})}}),Me[Qu(void 0,QS).name]=[{name:"wrapper",func:void 0}],dr.prototype.clone=yA,dr.prototype.reverse=SA,dr.prototype.value=py,fe.prototype.at=Ku.at,fe.prototype.chain=Ku.wrapperChain,fe.prototype.commit=Ku.commit,fe.prototype.next=Ku.next,fe.prototype.plant=Ku.plant,fe.prototype.reverse=Ku.reverse,fe.prototype.toJSON=fe.prototype.valueOf=fe.prototype.value=Ku.value,fe.prototype.first=fe.prototype.head,LT&&(fe.prototype[LT]=Ku.toIterator);var IA=fe;},74371:function($,ie){"use strict";function f(){return!1}ie.Z=f},11333:function($,ie,f){$=f.nmd($);(function(C,_){$.exports=_()})(this,function(){"use strict";var C;function _(){return C.apply(null,arguments)}function B(c){C=c}function K(c){return c instanceof Array||Object.prototype.toString.call(c)==="[object Array]"}function k(c){return c!=null&&Object.prototype.toString.call(c)==="[object Object]"}function Q(c,m){return Object.prototype.hasOwnProperty.call(c,m)}function X(c){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(c).length===0;var m;for(m in c)if(Q(c,m))return!1;return!0}function N(c){return c===void 0}function ce(c){return typeof c=="number"||Object.prototype.toString.call(c)==="[object Number]"}function Y(c){return c instanceof Date||Object.prototype.toString.call(c)==="[object Date]"}function Z(c,m){var E=[],R,L=c.length;for(R=0;R<L;++R)E.push(m(c[R],R));return E}function ee(c,m){for(var E in m)Q(m,E)&&(c[E]=m[E]);return Q(m,"toString")&&(c.toString=m.toString),Q(m,"valueOf")&&(c.valueOf=m.valueOf),c}function le(c,m,E,R){return wu(c,m,E,R,!0).utc()}function J(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function W(c){return c._pf==null&&(c._pf=J()),c._pf}var I;Array.prototype.some?I=Array.prototype.some:I=function(c){var m=Object(this),E=m.length>>>0,R;for(R=0;R<E;R++)if(R in m&&c.call(this,m[R],R,m))return!0;return!1};function V(c){var m=null,E=!1,R=c._d&&!isNaN(c._d.getTime());if(R&&(m=W(c),E=I.call(m.parsedDateParts,function(L){return L!=null}),R=m.overflow<0&&!m.empty&&!m.invalidEra&&!m.invalidMonth&&!m.invalidWeekday&&!m.weekdayMismatch&&!m.nullInput&&!m.invalidFormat&&!m.userInvalidated&&(!m.meridiem||m.meridiem&&E),c._strict&&(R=R&&m.charsLeftOver===0&&m.unusedTokens.length===0&&m.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(c))c._isValid=R;else return R;return c._isValid}function q(c){var m=le(NaN);return c!=null?ee(W(m),c):W(m).userInvalidated=!0,m}var de=_.momentProperties=[],ue=!1;function ve(c,m){var E,R,L,ae=de.length;if(N(m._isAMomentObject)||(c._isAMomentObject=m._isAMomentObject),N(m._i)||(c._i=m._i),N(m._f)||(c._f=m._f),N(m._l)||(c._l=m._l),N(m._strict)||(c._strict=m._strict),N(m._tzm)||(c._tzm=m._tzm),N(m._isUTC)||(c._isUTC=m._isUTC),N(m._offset)||(c._offset=m._offset),N(m._pf)||(c._pf=W(m)),N(m._locale)||(c._locale=m._locale),ae>0)for(E=0;E<ae;E++)R=de[E],L=m[R],N(L)||(c[R]=L);return c}function pe(c){ve(this,c),this._d=new Date(c._d!=null?c._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ue===!1&&(ue=!0,_.updateOffset(this),ue=!1)}function Se(c){return c instanceof pe||c!=null&&c._isAMomentObject!=null}function Ee(c){_.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+c)}function He(c,m){var E=!0;return ee(function(){if(_.deprecationHandler!=null&&_.deprecationHandler(null,c),E){var R=[],L,ae,Ce,_e=arguments.length;for(ae=0;ae<_e;ae++){if(L="",typeof arguments[ae]=="object"){L+=`
[`+ae+"] ";for(Ce in arguments[0])Q(arguments[0],Ce)&&(L+=Ce+": "+arguments[0][Ce]+", ");L=L.slice(0,-2)}else L=arguments[ae];R.push(L)}Ee(c+`
Arguments: `+Array.prototype.slice.call(R).join("")+`
`+new Error().stack),E=!1}return m.apply(this,arguments)},m)}var Fe={};function et(c,m){_.deprecationHandler!=null&&_.deprecationHandler(c,m),Fe[c]||(Ee(m),Fe[c]=!0)}_.suppressDeprecationWarnings=!1,_.deprecationHandler=null;function Oe(c){return typeof Function!="undefined"&&c instanceof Function||Object.prototype.toString.call(c)==="[object Function]"}function ct(c){var m,E;for(E in c)Q(c,E)&&(m=c[E],Oe(m)?this[E]=m:this["_"+E]=m);this._config=c,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ze(c,m){var E=ee({},c),R;for(R in m)Q(m,R)&&(k(c[R])&&k(m[R])?(E[R]={},ee(E[R],c[R]),ee(E[R],m[R])):m[R]!=null?E[R]=m[R]:delete E[R]);for(R in c)Q(c,R)&&!Q(m,R)&&k(c[R])&&(E[R]=ee({},E[R]));return E}function dt(c){c!=null&&this.set(c)}var It;Object.keys?It=Object.keys:It=function(c){var m,E=[];for(m in c)Q(c,m)&&E.push(m);return E};var Sn={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function jt(c,m,E){var R=this._calendar[c]||this._calendar.sameElse;return Oe(R)?R.call(m,E):R}function Ye(c,m,E){var R=""+Math.abs(c),L=m-R.length,ae=c>=0;return(ae?E?"+":"":"-")+Math.pow(10,Math.max(0,L)).toString().substr(1)+R}var Be=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,hn=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Je={},mt={};function Ae(c,m,E,R){var L=R;typeof R=="string"&&(L=function(){return this[R]()}),c&&(mt[c]=L),m&&(mt[m[0]]=function(){return Ye(L.apply(this,arguments),m[1],m[2])}),E&&(mt[E]=function(){return this.localeData().ordinal(L.apply(this,arguments),c)})}function rt(c){return c.match(/\[[\s\S]/)?c.replace(/^\[|\]$/g,""):c.replace(/\\/g,"")}function Ft(c){var m=c.match(Be),E,R;for(E=0,R=m.length;E<R;E++)mt[m[E]]?m[E]=mt[m[E]]:m[E]=rt(m[E]);return function(L){var ae="",Ce;for(Ce=0;Ce<R;Ce++)ae+=Oe(m[Ce])?m[Ce].call(L,c):m[Ce];return ae}}function zt(c,m){return c.isValid()?(m=Et(m,c.localeData()),Je[m]=Je[m]||Ft(m),Je[m](c)):c.localeData().invalidDate()}function Et(c,m){var E=5;function R(L){return m.longDateFormat(L)||L}for(hn.lastIndex=0;E>=0&&hn.test(c);)c=c.replace(hn,R),hn.lastIndex=0,E-=1;return c}var Qe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function an(c){var m=this._longDateFormat[c],E=this._longDateFormat[c.toUpperCase()];return m||!E?m:(this._longDateFormat[c]=E.match(Be).map(function(R){return R==="MMMM"||R==="MM"||R==="DD"||R==="dddd"?R.slice(1):R}).join(""),this._longDateFormat[c])}var Mt="Invalid date";function Cn(){return this._invalidDate}var bn="%d",mr=/\d{1,2}/;function br(c){return this._ordinal.replace("%d",c)}var qr={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ir(c,m,E,R){var L=this._relativeTime[E];return Oe(L)?L(c,m,E,R):L.replace(/%d/i,c)}function Qn(c,m){var E=this._relativeTime[c>0?"future":"past"];return Oe(E)?E(m):E.replace(/%s/i,m)}var kr={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function mn(c){return typeof c=="string"?kr[c]||kr[c.toLowerCase()]:void 0}function Rs(c){var m={},E,R;for(R in c)Q(c,R)&&(E=mn(R),E&&(m[E]=c[R]));return m}var Mi={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function _o(c){var m=[],E;for(E in c)Q(c,E)&&m.push({unit:E,priority:Mi[E]});return m.sort(function(R,L){return R.priority-L.priority}),m}var Hn=/\d/,Oi=/\d\d/,pr=/\d{3}/,Vs=/\d{4}/,Qi=/[+-]?\d{6}/,Ln=/\d\d?/,yn=/\d\d\d\d?/,qi=/\d\d\d\d\d\d?/,In=/\d{1,3}/,un=/\d{1,4}/,Xn=/[+-]?\d{1,6}/,en=/\d+/,Vr=/[+-]?\d+/,di=/Z|[+-]\d\d:?\d\d/gi,Mr=/Z|[+-]\d\d(?::?\d\d)?/gi,js=/[+-]?\d+(\.\d{1,3})?/,as=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Te=/^[1-9]\d?/,tt=/^([1-9]\d|\d)/,St;St={};function Ke(c,m,E){St[c]=Oe(m)?m:function(R,L){return R&&E?E:m}}function Gt(c,m){return Q(St,c)?St[c](m._strict,m._locale):new RegExp(Vn(c))}function Vn(c){return $r(c.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(m,E,R,L,ae){return E||R||L||ae}))}function $r(c){return c.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ur(c){return c<0?Math.ceil(c)||0:Math.floor(c)}function sr(c){var m=+c,E=0;return m!==0&&isFinite(m)&&(E=Ur(m)),E}var Ps={};function ur(c,m){var E,R=m,L;for(typeof c=="string"&&(c=[c]),ce(m)&&(R=function(ae,Ce){Ce[m]=sr(ae)}),L=c.length,E=0;E<L;E++)Ps[c[E]]=R}function Hr(c,m){ur(c,function(E,R,L,ae){L._w=L._w||{},m(E,L._w,L,ae)})}function Rr(c,m,E){m!=null&&Q(Ps,c)&&Ps[c](m,E._a,E,c)}function bo(c){return c%4===0&&c%100!==0||c%400===0}var Kn=0,zi=1,Pr=2,gi=3,Lr=4,ps=5,Ue=6,xt=7,$t=8;Ae("Y",0,0,function(){var c=this.year();return c<=9999?Ye(c,4):"+"+c}),Ae(0,["YY",2],0,function(){return this.year()%100}),Ae(0,["YYYY",4],0,"year"),Ae(0,["YYYYY",5],0,"year"),Ae(0,["YYYYYY",6,!0],0,"year"),Ke("Y",Vr),Ke("YY",Ln,Oi),Ke("YYYY",un,Vs),Ke("YYYYY",Xn,Qi),Ke("YYYYYY",Xn,Qi),ur(["YYYYY","YYYYYY"],Kn),ur("YYYY",function(c,m){m[Kn]=c.length===2?_.parseTwoDigitYear(c):sr(c)}),ur("YY",function(c,m){m[Kn]=_.parseTwoDigitYear(c)}),ur("Y",function(c,m){m[Kn]=parseInt(c,10)});function _n(c){return bo(c)?366:365}_.parseTwoDigitYear=function(c){return sr(c)+(sr(c)>68?1900:2e3)};var Xr=Di("FullYear",!0);function Er(){return bo(this.year())}function Di(c,m){return function(E){return E!=null?(fr(this,c,E),_.updateOffset(this,m),this):fi(this,c)}}function fi(c,m){if(!c.isValid())return NaN;var E=c._d,R=c._isUTC;switch(m){case"Milliseconds":return R?E.getUTCMilliseconds():E.getMilliseconds();case"Seconds":return R?E.getUTCSeconds():E.getSeconds();case"Minutes":return R?E.getUTCMinutes():E.getMinutes();case"Hours":return R?E.getUTCHours():E.getHours();case"Date":return R?E.getUTCDate():E.getDate();case"Day":return R?E.getUTCDay():E.getDay();case"Month":return R?E.getUTCMonth():E.getMonth();case"FullYear":return R?E.getUTCFullYear():E.getFullYear();default:return NaN}}function fr(c,m,E){var R,L,ae,Ce,_e;if(!(!c.isValid()||isNaN(E))){switch(R=c._d,L=c._isUTC,m){case"Milliseconds":return void(L?R.setUTCMilliseconds(E):R.setMilliseconds(E));case"Seconds":return void(L?R.setUTCSeconds(E):R.setSeconds(E));case"Minutes":return void(L?R.setUTCMinutes(E):R.setMinutes(E));case"Hours":return void(L?R.setUTCHours(E):R.setHours(E));case"Date":return void(L?R.setUTCDate(E):R.setDate(E));case"FullYear":break;default:return}ae=E,Ce=c.month(),_e=c.date(),_e=_e===29&&Ce===1&&!bo(ae)?28:_e,L?R.setUTCFullYear(ae,Ce,_e):R.setFullYear(ae,Ce,_e)}}function tl(c){return c=mn(c),Oe(this[c])?this[c]():this}function li(c,m){if(typeof c=="object"){c=Rs(c);var E=_o(c),R,L=E.length;for(R=0;R<L;R++)this[E[R].unit](c[E[R].unit])}else if(c=mn(c),Oe(this[c]))return this[c](m);return this}function Eo(c,m){return(c%m+m)%m}var Wn;Array.prototype.indexOf?Wn=Array.prototype.indexOf:Wn=function(c){var m;for(m=0;m<this.length;++m)if(this[m]===c)return m;return-1};function vs(c,m){if(isNaN(c)||isNaN(m))return NaN;var E=Eo(m,12);return c+=(m-E)/12,E===1?bo(c)?29:28:31-E%7%2}Ae("M",["MM",2],"Mo",function(){return this.month()+1}),Ae("MMM",0,0,function(c){return this.localeData().monthsShort(this,c)}),Ae("MMMM",0,0,function(c){return this.localeData().months(this,c)}),Ke("M",Ln,Te),Ke("MM",Ln,Oi),Ke("MMM",function(c,m){return m.monthsShortRegex(c)}),Ke("MMMM",function(c,m){return m.monthsRegex(c)}),ur(["M","MM"],function(c,m){m[zi]=sr(c)-1}),ur(["MMM","MMMM"],function(c,m,E,R){var L=E._locale.monthsParse(c,R,E._strict);L!=null?m[zi]=L:W(E).invalidMonth=c});var bl="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),xn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tn=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ko=as,nl=as;function lo(c,m){return c?K(this._months)?this._months[c.month()]:this._months[(this._months.isFormat||tn).test(m)?"format":"standalone"][c.month()]:K(this._months)?this._months:this._months.standalone}function xs(c,m){return c?K(this._monthsShort)?this._monthsShort[c.month()]:this._monthsShort[tn.test(m)?"format":"standalone"][c.month()]:K(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Yi(c,m,E){var R,L,ae,Ce=c.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],R=0;R<12;++R)ae=le([2e3,R]),this._shortMonthsParse[R]=this.monthsShort(ae,"").toLocaleLowerCase(),this._longMonthsParse[R]=this.months(ae,"").toLocaleLowerCase();return E?m==="MMM"?(L=Wn.call(this._shortMonthsParse,Ce),L!==-1?L:null):(L=Wn.call(this._longMonthsParse,Ce),L!==-1?L:null):m==="MMM"?(L=Wn.call(this._shortMonthsParse,Ce),L!==-1?L:(L=Wn.call(this._longMonthsParse,Ce),L!==-1?L:null)):(L=Wn.call(this._longMonthsParse,Ce),L!==-1?L:(L=Wn.call(this._shortMonthsParse,Ce),L!==-1?L:null))}function ya(c,m,E){var R,L,ae;if(this._monthsParseExact)return Yi.call(this,c,m,E);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),R=0;R<12;R++){if(L=le([2e3,R]),E&&!this._longMonthsParse[R]&&(this._longMonthsParse[R]=new RegExp("^"+this.months(L,"").replace(".","")+"$","i"),this._shortMonthsParse[R]=new RegExp("^"+this.monthsShort(L,"").replace(".","")+"$","i")),!E&&!this._monthsParse[R]&&(ae="^"+this.months(L,"")+"|^"+this.monthsShort(L,""),this._monthsParse[R]=new RegExp(ae.replace(".",""),"i")),E&&m==="MMMM"&&this._longMonthsParse[R].test(c))return R;if(E&&m==="MMM"&&this._shortMonthsParse[R].test(c))return R;if(!E&&this._monthsParse[R].test(c))return R}}function ka(c,m){if(!c.isValid())return c;if(typeof m=="string"){if(/^\d+$/.test(m))m=sr(m);else if(m=c.localeData().monthsParse(m),!ce(m))return c}var E=m,R=c.date();return R=R<29?R:Math.min(R,vs(c.year(),E)),c._isUTC?c._d.setUTCMonth(E,R):c._d.setMonth(E,R),c}function ls(c){return c!=null?(ka(this,c),_.updateOffset(this,!0),this):fi(this,"Month")}function dr(){return vs(this.year(),this.month())}function se(c){return this._monthsParseExact?(Q(this,"_monthsRegex")||x.call(this),c?this._monthsShortStrictRegex:this._monthsShortRegex):(Q(this,"_monthsShortRegex")||(this._monthsShortRegex=Ko),this._monthsShortStrictRegex&&c?this._monthsShortStrictRegex:this._monthsShortRegex)}function O(c){return this._monthsParseExact?(Q(this,"_monthsRegex")||x.call(this),c?this._monthsStrictRegex:this._monthsRegex):(Q(this,"_monthsRegex")||(this._monthsRegex=nl),this._monthsStrictRegex&&c?this._monthsStrictRegex:this._monthsRegex)}function x(){function c(Ge,ht){return ht.length-Ge.length}var m=[],E=[],R=[],L,ae,Ce,_e;for(L=0;L<12;L++)ae=le([2e3,L]),Ce=$r(this.monthsShort(ae,"")),_e=$r(this.months(ae,"")),m.push(Ce),E.push(_e),R.push(_e),R.push(Ce);m.sort(c),E.sort(c),R.sort(c),this._monthsRegex=new RegExp("^("+R.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+E.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+m.join("|")+")","i")}function re(c,m,E,R,L,ae,Ce){var _e;return c<100&&c>=0?(_e=new Date(c+400,m,E,R,L,ae,Ce),isFinite(_e.getFullYear())&&_e.setFullYear(c)):_e=new Date(c,m,E,R,L,ae,Ce),_e}function he(c){var m,E;return c<100&&c>=0?(E=Array.prototype.slice.call(arguments),E[0]=c+400,m=new Date(Date.UTC.apply(null,E)),isFinite(m.getUTCFullYear())&&m.setUTCFullYear(c)):m=new Date(Date.UTC.apply(null,arguments)),m}function Me(c,m,E){var R=7+m-E,L=(7+he(c,0,R).getUTCDay()-m)%7;return-L+R-1}function Xe(c,m,E,R,L){var ae=(7+E-R)%7,Ce=Me(c,R,L),_e=1+7*(m-1)+ae+Ce,Ge,ht;return _e<=0?(Ge=c-1,ht=_n(Ge)+_e):_e>_n(c)?(Ge=c+1,ht=_e-_n(c)):(Ge=c,ht=_e),{year:Ge,dayOfYear:ht}}function nt(c,m,E){var R=Me(c.year(),m,E),L=Math.floor((c.dayOfYear()-R-1)/7)+1,ae,Ce;return L<1?(Ce=c.year()-1,ae=L+Tt(Ce,m,E)):L>Tt(c.year(),m,E)?(ae=L-Tt(c.year(),m,E),Ce=c.year()+1):(Ce=c.year(),ae=L),{week:ae,year:Ce}}function Tt(c,m,E){var R=Me(c,m,E),L=Me(c+1,m,E);return(_n(c)-R+L)/7}Ae("w",["ww",2],"wo","week"),Ae("W",["WW",2],"Wo","isoWeek"),Ke("w",Ln,Te),Ke("ww",Ln,Oi),Ke("W",Ln,Te),Ke("WW",Ln,Oi),Hr(["w","ww","W","WW"],function(c,m,E,R){m[R.substr(0,1)]=sr(c)});function En(c){return nt(c,this._week.dow,this._week.doy).week}var Tn={dow:0,doy:6};function pn(){return this._week.dow}function vr(){return this._week.doy}function Cr(c){var m=this.localeData().week(this);return c==null?m:this.add((c-m)*7,"d")}function Cs(c){var m=nt(this,1,4).week;return c==null?m:this.add((c-m)*7,"d")}Ae("d",0,"do","day"),Ae("dd",0,0,function(c){return this.localeData().weekdaysMin(this,c)}),Ae("ddd",0,0,function(c){return this.localeData().weekdaysShort(this,c)}),Ae("dddd",0,0,function(c){return this.localeData().weekdays(this,c)}),Ae("e",0,0,"weekday"),Ae("E",0,0,"isoWeekday"),Ke("d",Ln),Ke("e",Ln),Ke("E",Ln),Ke("dd",function(c,m){return m.weekdaysMinRegex(c)}),Ke("ddd",function(c,m){return m.weekdaysShortRegex(c)}),Ke("dddd",function(c,m){return m.weekdaysRegex(c)}),Hr(["dd","ddd","dddd"],function(c,m,E,R){var L=E._locale.weekdaysParse(c,R,E._strict);L!=null?m.d=L:W(E).invalidWeekday=c}),Hr(["d","e","E"],function(c,m,E,R){m[R]=sr(c)});function Gi(c,m){return typeof c!="string"?c:isNaN(c)?(c=m.weekdaysParse(c),typeof c=="number"?c:null):parseInt(c,10)}function As(c,m){return typeof c=="string"?m.weekdaysParse(c)%7||7:isNaN(c)?null:c}function Ro(c,m){return c.slice(m,7).concat(c.slice(0,m))}var Ns="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),fe="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Do="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Yn=as,Us=as,To=as;function qs(c,m){var E=K(this._weekdays)?this._weekdays:this._weekdays[c&&c!==!0&&this._weekdays.isFormat.test(m)?"format":"standalone"];return c===!0?Ro(E,this._week.dow):c?E[c.day()]:E}function Zu(c){return c===!0?Ro(this._weekdaysShort,this._week.dow):c?this._weekdaysShort[c.day()]:this._weekdaysShort}function Si(c){return c===!0?Ro(this._weekdaysMin,this._week.dow):c?this._weekdaysMin[c.day()]:this._weekdaysMin}function Sa(c,m,E){var R,L,ae,Ce=c.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],R=0;R<7;++R)ae=le([2e3,1]).day(R),this._minWeekdaysParse[R]=this.weekdaysMin(ae,"").toLocaleLowerCase(),this._shortWeekdaysParse[R]=this.weekdaysShort(ae,"").toLocaleLowerCase(),this._weekdaysParse[R]=this.weekdays(ae,"").toLocaleLowerCase();return E?m==="dddd"?(L=Wn.call(this._weekdaysParse,Ce),L!==-1?L:null):m==="ddd"?(L=Wn.call(this._shortWeekdaysParse,Ce),L!==-1?L:null):(L=Wn.call(this._minWeekdaysParse,Ce),L!==-1?L:null):m==="dddd"?(L=Wn.call(this._weekdaysParse,Ce),L!==-1||(L=Wn.call(this._shortWeekdaysParse,Ce),L!==-1)?L:(L=Wn.call(this._minWeekdaysParse,Ce),L!==-1?L:null)):m==="ddd"?(L=Wn.call(this._shortWeekdaysParse,Ce),L!==-1||(L=Wn.call(this._weekdaysParse,Ce),L!==-1)?L:(L=Wn.call(this._minWeekdaysParse,Ce),L!==-1?L:null)):(L=Wn.call(this._minWeekdaysParse,Ce),L!==-1||(L=Wn.call(this._weekdaysParse,Ce),L!==-1)?L:(L=Wn.call(this._shortWeekdaysParse,Ce),L!==-1?L:null))}function El(c,m,E){var R,L,ae;if(this._weekdaysParseExact)return Sa.call(this,c,m,E);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),R=0;R<7;R++){if(L=le([2e3,1]).day(R),E&&!this._fullWeekdaysParse[R]&&(this._fullWeekdaysParse[R]=new RegExp("^"+this.weekdays(L,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[R]=new RegExp("^"+this.weekdaysShort(L,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[R]=new RegExp("^"+this.weekdaysMin(L,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[R]||(ae="^"+this.weekdays(L,"")+"|^"+this.weekdaysShort(L,"")+"|^"+this.weekdaysMin(L,""),this._weekdaysParse[R]=new RegExp(ae.replace(".",""),"i")),E&&m==="dddd"&&this._fullWeekdaysParse[R].test(c))return R;if(E&&m==="ddd"&&this._shortWeekdaysParse[R].test(c))return R;if(E&&m==="dd"&&this._minWeekdaysParse[R].test(c))return R;if(!E&&this._weekdaysParse[R].test(c))return R}}function or(c){if(!this.isValid())return c!=null?this:NaN;var m=fi(this,"Day");return c!=null?(c=Gi(c,this.localeData()),this.add(c-m,"d")):m}function Ts(c){if(!this.isValid())return c!=null?this:NaN;var m=(this.day()+7-this.localeData()._week.dow)%7;return c==null?m:this.add(c-m,"d")}function ua(c){if(!this.isValid())return c!=null?this:NaN;if(c!=null){var m=As(c,this.localeData());return this.day(this.day()%7?m:m-7)}else return this.day()||7}function rl(c){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||ws.call(this),c?this._weekdaysStrictRegex:this._weekdaysRegex):(Q(this,"_weekdaysRegex")||(this._weekdaysRegex=Yn),this._weekdaysStrictRegex&&c?this._weekdaysStrictRegex:this._weekdaysRegex)}function mu(c){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||ws.call(this),c?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Q(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Us),this._weekdaysShortStrictRegex&&c?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function zs(c){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||ws.call(this),c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Q(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=To),this._weekdaysMinStrictRegex&&c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ws(){function c(Dt,Ht){return Ht.length-Dt.length}var m=[],E=[],R=[],L=[],ae,Ce,_e,Ge,ht;for(ae=0;ae<7;ae++)Ce=le([2e3,1]).day(ae),_e=$r(this.weekdaysMin(Ce,"")),Ge=$r(this.weekdaysShort(Ce,"")),ht=$r(this.weekdays(Ce,"")),m.push(_e),E.push(Ge),R.push(ht),L.push(_e),L.push(Ge),L.push(ht);m.sort(c),E.sort(c),R.sort(c),L.sort(c),this._weekdaysRegex=new RegExp("^("+L.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+R.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+E.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+m.join("|")+")","i")}function Yo(){return this.hours()%12||12}function Go(){return this.hours()||24}Ae("H",["HH",2],0,"hour"),Ae("h",["hh",2],0,Yo),Ae("k",["kk",2],0,Go),Ae("hmm",0,0,function(){return""+Yo.apply(this)+Ye(this.minutes(),2)}),Ae("hmmss",0,0,function(){return""+Yo.apply(this)+Ye(this.minutes(),2)+Ye(this.seconds(),2)}),Ae("Hmm",0,0,function(){return""+this.hours()+Ye(this.minutes(),2)}),Ae("Hmmss",0,0,function(){return""+this.hours()+Ye(this.minutes(),2)+Ye(this.seconds(),2)});function Mo(c,m){Ae(c,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),m)})}Mo("a",!0),Mo("A",!1);function Rl(c,m){return m._meridiemParse}Ke("a",Rl),Ke("A",Rl),Ke("H",Ln,tt),Ke("h",Ln,Te),Ke("k",Ln,Te),Ke("HH",Ln,Oi),Ke("hh",Ln,Oi),Ke("kk",Ln,Oi),Ke("hmm",yn),Ke("hmmss",qi),Ke("Hmm",yn),Ke("Hmmss",qi),ur(["H","HH"],gi),ur(["k","kk"],function(c,m,E){var R=sr(c);m[gi]=R===24?0:R}),ur(["a","A"],function(c,m,E){E._isPm=E._locale.isPM(c),E._meridiem=c}),ur(["h","hh"],function(c,m,E){m[gi]=sr(c),W(E).bigHour=!0}),ur("hmm",function(c,m,E){var R=c.length-2;m[gi]=sr(c.substr(0,R)),m[Lr]=sr(c.substr(R)),W(E).bigHour=!0}),ur("hmmss",function(c,m,E){var R=c.length-4,L=c.length-2;m[gi]=sr(c.substr(0,R)),m[Lr]=sr(c.substr(R,2)),m[ps]=sr(c.substr(L)),W(E).bigHour=!0}),ur("Hmm",function(c,m,E){var R=c.length-2;m[gi]=sr(c.substr(0,R)),m[Lr]=sr(c.substr(R))}),ur("Hmmss",function(c,m,E){var R=c.length-4,L=c.length-2;m[gi]=sr(c.substr(0,R)),m[Lr]=sr(c.substr(R,2)),m[ps]=sr(c.substr(L))});function Va(c){return(c+"").toLowerCase().charAt(0)==="p"}var Ho=/[ap]\.?m?\.?/i,Ju=Di("Hours",!0);function pu(c,m,E){return c>11?E?"pm":"PM":E?"am":"AM"}var Lo={calendar:Sn,longDateFormat:Qe,invalidDate:Mt,ordinal:bn,dayOfMonthOrdinalParse:mr,relativeTime:qr,months:bl,monthsShort:xn,week:Tn,weekdays:Ns,weekdaysMin:Do,weekdaysShort:fe,meridiemParse:Ho},Fr={},Gn={},je;function Wt(c,m){var E,R=Math.min(c.length,m.length);for(E=0;E<R;E+=1)if(c[E]!==m[E])return E;return R}function Pn(c){return c&&c.toLowerCase().replace("_","-")}function Hi(c){for(var m=0,E,R,L,ae;m<c.length;){for(ae=Pn(c[m]).split("-"),E=ae.length,R=Pn(c[m+1]),R=R?R.split("-"):null;E>0;){if(L=_i(ae.slice(0,E).join("-")),L)return L;if(R&&R.length>=E&&Wt(ae,R)>=E-1)break;E--}m++}return je}function es(c){return!!(c&&c.match("^[^/\\\\]*$"))}function _i(c){var m=null,E;if(Fr[c]===void 0&&$&&$.exports&&es(c))try{m=je._abbr,E=void 0,Object(function(){var L=new Error("Cannot find module 'undefined'");throw L.code="MODULE_NOT_FOUND",L}()),Li(m)}catch(R){Fr[c]=null}return Fr[c]}function Li(c,m){var E;return c&&(N(m)?E=ba(c):E=_a(c,m),E?je=E:typeof console!="undefined"&&console.warn&&console.warn("Locale "+c+" not found. Did you forget to load it?")),je._abbr}function _a(c,m){if(m!==null){var E,R=Lo;if(m.abbr=c,Fr[c]!=null)et("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),R=Fr[c]._config;else if(m.parentLocale!=null)if(Fr[m.parentLocale]!=null)R=Fr[m.parentLocale]._config;else if(E=_i(m.parentLocale),E!=null)R=E._config;else return Gn[m.parentLocale]||(Gn[m.parentLocale]=[]),Gn[m.parentLocale].push({name:c,config:m}),null;return Fr[c]=new dt(ze(R,m)),Gn[c]&&Gn[c].forEach(function(L){_a(L.name,L.config)}),Li(c),Fr[c]}else return delete Fr[c],null}function Tl(c,m){if(m!=null){var E,R,L=Lo;Fr[c]!=null&&Fr[c].parentLocale!=null?Fr[c].set(ze(Fr[c]._config,m)):(R=_i(c),R!=null&&(L=R._config),m=ze(L,m),R==null&&(m.abbr=c),E=new dt(m),E.parentLocale=Fr[c],Fr[c]=E),Li(c)}else Fr[c]!=null&&(Fr[c].parentLocale!=null?(Fr[c]=Fr[c].parentLocale,c===Li()&&Li(c)):Fr[c]!=null&&delete Fr[c]);return Fr[c]}function ba(c){var m;if(c&&c._locale&&c._locale._abbr&&(c=c._locale._abbr),!c)return je;if(!K(c)){if(m=_i(c),m)return m;c=[c]}return Hi(c)}function uo(){return It(Fr)}function Ml(c){var m,E=c._a;return E&&W(c).overflow===-2&&(m=E[zi]<0||E[zi]>11?zi:E[Pr]<1||E[Pr]>vs(E[Kn],E[zi])?Pr:E[gi]<0||E[gi]>24||E[gi]===24&&(E[Lr]!==0||E[ps]!==0||E[Ue]!==0)?gi:E[Lr]<0||E[Lr]>59?Lr:E[ps]<0||E[ps]>59?ps:E[Ue]<0||E[Ue]>999?Ue:-1,W(c)._overflowDayOfYear&&(m<Kn||m>Pr)&&(m=Pr),W(c)._overflowWeeks&&m===-1&&(m=xt),W(c)._overflowWeekday&&m===-1&&(m=$t),W(c).overflow=m),c}var vu=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Oc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Zf=/Z|[+-]\d\d(?::?\d\d)?/,Ic=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ah=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Jf=/^\/?Date\((-?\d+)/i,Kd=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Pc={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function $o(c){var m,E,R=c._i,L=vu.exec(R)||Oc.exec(R),ae,Ce,_e,Ge,ht=Ic.length,Dt=ah.length;if(L){for(W(c).iso=!0,m=0,E=ht;m<E;m++)if(Ic[m][1].exec(L[1])){Ce=Ic[m][0],ae=Ic[m][2]!==!1;break}if(Ce==null){c._isValid=!1;return}if(L[3]){for(m=0,E=Dt;m<E;m++)if(ah[m][1].exec(L[3])){_e=(L[2]||" ")+ah[m][0];break}if(_e==null){c._isValid=!1;return}}if(!ae&&_e!=null){c._isValid=!1;return}if(L[4])if(Zf.exec(L[4]))Ge="Z";else{c._isValid=!1;return}c._f=Ce+(_e||"")+(Ge||""),Ea(c)}else c._isValid=!1}function xc(c,m,E,R,L,ae){var Ce=[Yd(c),xn.indexOf(m),parseInt(E,10),parseInt(R,10),parseInt(L,10)];return ae&&Ce.push(parseInt(ae,10)),Ce}function Yd(c){var m=parseInt(c,10);return m<=49?2e3+m:m<=999?1900+m:m}function rd(c){return c.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Gd(c,m,E){if(c){var R=fe.indexOf(c),L=new Date(m[0],m[1],m[2]).getDay();if(R!==L)return W(E).weekdayMismatch=!0,E._isValid=!1,!1}return!0}function Qf(c,m,E){if(c)return Pc[c];if(m)return 0;var R=parseInt(E,10),L=R%100,ae=(R-L)/100;return ae*60+L}function qf(c){var m=Kd.exec(rd(c._i)),E;if(m){if(E=xc(m[4],m[3],m[2],m[5],m[6],m[7]),!Gd(m[1],E,c))return;c._a=E,c._tzm=Qf(m[8],m[9],m[10]),c._d=he.apply(null,c._a),c._d.setUTCMinutes(c._d.getUTCMinutes()-c._tzm),W(c).rfc2822=!0}else c._isValid=!1}function lh(c){var m=Jf.exec(c._i);if(m!==null){c._d=new Date(+m[1]);return}if($o(c),c._isValid===!1)delete c._isValid;else return;if(qf(c),c._isValid===!1)delete c._isValid;else return;c._strict?c._isValid=!1:_.createFromInputFallback(c)}_.createFromInputFallback=He("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(c){c._d=new Date(c._i+(c._useUTC?" UTC":""))});function Cu(c,m,E){return c!=null?c:m!=null?m:E}function eg(c){var m=new Date(_.now());return c._useUTC?[m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()]:[m.getFullYear(),m.getMonth(),m.getDate()]}function Ol(c){var m,E,R=[],L,ae,Ce;if(!c._d){for(L=eg(c),c._w&&c._a[Pr]==null&&c._a[zi]==null&&ja(c),c._dayOfYear!=null&&(Ce=Cu(c._a[Kn],L[Kn]),(c._dayOfYear>_n(Ce)||c._dayOfYear===0)&&(W(c)._overflowDayOfYear=!0),E=he(Ce,0,c._dayOfYear),c._a[zi]=E.getUTCMonth(),c._a[Pr]=E.getUTCDate()),m=0;m<3&&c._a[m]==null;++m)c._a[m]=R[m]=L[m];for(;m<7;m++)c._a[m]=R[m]=c._a[m]==null?m===2?1:0:c._a[m];c._a[gi]===24&&c._a[Lr]===0&&c._a[ps]===0&&c._a[Ue]===0&&(c._nextDay=!0,c._a[gi]=0),c._d=(c._useUTC?he:re).apply(null,R),ae=c._useUTC?c._d.getUTCDay():c._d.getDay(),c._tzm!=null&&c._d.setUTCMinutes(c._d.getUTCMinutes()-c._tzm),c._nextDay&&(c._a[gi]=24),c._w&&typeof c._w.d!="undefined"&&c._w.d!==ae&&(W(c).weekdayMismatch=!0)}}function ja(c){var m,E,R,L,ae,Ce,_e,Ge,ht;m=c._w,m.GG!=null||m.W!=null||m.E!=null?(ae=1,Ce=4,E=Cu(m.GG,c._a[Kn],nt(Ii(),1,4).year),R=Cu(m.W,1),L=Cu(m.E,1),(L<1||L>7)&&(Ge=!0)):(ae=c._locale._week.dow,Ce=c._locale._week.doy,ht=nt(Ii(),ae,Ce),E=Cu(m.gg,c._a[Kn],ht.year),R=Cu(m.w,ht.week),m.d!=null?(L=m.d,(L<0||L>6)&&(Ge=!0)):m.e!=null?(L=m.e+ae,(m.e<0||m.e>6)&&(Ge=!0)):L=ae),R<1||R>Tt(E,ae,Ce)?W(c)._overflowWeeks=!0:Ge!=null?W(c)._overflowWeekday=!0:(_e=Xe(E,R,L,ae,Ce),c._a[Kn]=_e.year,c._dayOfYear=_e.dayOfYear)}_.ISO_8601=function(){},_.RFC_2822=function(){};function Ea(c){if(c._f===_.ISO_8601){$o(c);return}if(c._f===_.RFC_2822){qf(c);return}c._a=[],W(c).empty=!0;var m=""+c._i,E,R,L,ae,Ce,_e=m.length,Ge=0,ht,Dt;for(L=Et(c._f,c._locale).match(Be)||[],Dt=L.length,E=0;E<Dt;E++)ae=L[E],R=(m.match(Gt(ae,c))||[])[0],R&&(Ce=m.substr(0,m.indexOf(R)),Ce.length>0&&W(c).unusedInput.push(Ce),m=m.slice(m.indexOf(R)+R.length),Ge+=R.length),mt[ae]?(R?W(c).empty=!1:W(c).unusedTokens.push(ae),Rr(ae,R,c)):c._strict&&!R&&W(c).unusedTokens.push(ae);W(c).charsLeftOver=_e-Ge,m.length>0&&W(c).unusedInput.push(m),c._a[gi]<=12&&W(c).bigHour===!0&&c._a[gi]>0&&(W(c).bigHour=void 0),W(c).parsedDateParts=c._a.slice(0),W(c).meridiem=c._meridiem,c._a[gi]=Ra(c._locale,c._a[gi],c._meridiem),ht=W(c).era,ht!==null&&(c._a[Kn]=c._locale.erasConvertYear(ht,c._a[Kn])),Ol(c),Ml(c)}function Ra(c,m,E){var R;return E==null?m:c.meridiemHour!=null?c.meridiemHour(m,E):(c.isPM!=null&&(R=c.isPM(E),R&&m<12&&(m+=12),!R&&m===12&&(m=0)),m)}function tg(c){var m,E,R,L,ae,Ce,_e=!1,Ge=c._f.length;if(Ge===0){W(c).invalidFormat=!0,c._d=new Date(NaN);return}for(L=0;L<Ge;L++)ae=0,Ce=!1,m=ve({},c),c._useUTC!=null&&(m._useUTC=c._useUTC),m._f=c._f[L],Ea(m),V(m)&&(Ce=!0),ae+=W(m).charsLeftOver,ae+=W(m).unusedTokens.length*10,W(m).score=ae,_e?ae<R&&(R=ae,E=m):(R==null||ae<R||Ce)&&(R=ae,E=m,Ce&&(_e=!0));ee(c,E||m)}function id(c){if(!c._d){var m=Rs(c._i),E=m.day===void 0?m.date:m.day;c._a=Z([m.year,m.month,E,m.hour,m.minute,m.second,m.millisecond],function(R){return R&&parseInt(R,10)}),Ol(c)}}function Il(c){var m=new pe(Ml(uh(c)));return m._nextDay&&(m.add(1,"d"),m._nextDay=void 0),m}function uh(c){var m=c._i,E=c._f;return c._locale=c._locale||ba(c._l),m===null||E===void 0&&m===""?q({nullInput:!0}):(typeof m=="string"&&(c._i=m=c._locale.preparse(m)),Se(m)?new pe(Ml(m)):(Y(m)?c._d=m:K(E)?tg(c):E?Ea(c):Oo(c),V(c)||(c._d=null),c))}function Oo(c){var m=c._i;N(m)?c._d=new Date(_.now()):Y(m)?c._d=new Date(m.valueOf()):typeof m=="string"?lh(c):K(m)?(c._a=Z(m.slice(0),function(E){return parseInt(E,10)}),Ol(c)):k(m)?id(c):ce(m)?c._d=new Date(m):_.createFromInputFallback(c)}function wu(c,m,E,R,L){var ae={};return(m===!0||m===!1)&&(R=m,m=void 0),(E===!0||E===!1)&&(R=E,E=void 0),(k(c)&&X(c)||K(c)&&c.length===0)&&(c=void 0),ae._isAMomentObject=!0,ae._useUTC=ae._isUTC=L,ae._l=E,ae._i=c,ae._f=m,ae._strict=R,Il(ae)}function Ii(c,m,E,R){return wu(c,m,E,R,!1)}var ng=He("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=Ii.apply(null,arguments);return this.isValid()&&c.isValid()?c<this?this:c:q()}),eo=He("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=Ii.apply(null,arguments);return this.isValid()&&c.isValid()?c>this?this:c:q()});function $d(c,m){var E,R;if(m.length===1&&K(m[0])&&(m=m[0]),!m.length)return Ii();for(E=m[0],R=1;R<m.length;++R)(!m[R].isValid()||m[R][c](E))&&(E=m[R]);return E}function rg(){var c=[].slice.call(arguments,0);return $d("isBefore",c)}function yu(){var c=[].slice.call(arguments,0);return $d("isAfter",c)}var $l=function(){return Date.now?Date.now():+new Date},Io=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Xd(c){var m,E=!1,R,L=Io.length;for(m in c)if(Q(c,m)&&!(Wn.call(Io,m)!==-1&&(c[m]==null||!isNaN(c[m]))))return!1;for(R=0;R<L;++R)if(c[Io[R]]){if(E)return!1;parseFloat(c[Io[R]])!==sr(c[Io[R]])&&(E=!0)}return!0}function ch(){return this._isValid}function Qu(){return Po(NaN)}function Fi(c){var m=Rs(c),E=m.year||0,R=m.quarter||0,L=m.month||0,ae=m.week||m.isoWeek||0,Ce=m.day||0,_e=m.hour||0,Ge=m.minute||0,ht=m.second||0,Dt=m.millisecond||0;this._isValid=Xd(m),this._milliseconds=+Dt+ht*1e3+Ge*6e4+_e*1e3*60*60,this._days=+Ce+ae*7,this._months=+L+R*3+E*12,this._data={},this._locale=ba(),this._bubble()}function qu(c){return c instanceof Fi}function Xl(c){return c<0?Math.round(-1*c)*-1:Math.round(c)}function Rn(c,m,E){var R=Math.min(c.length,m.length),L=Math.abs(c.length-m.length),ae=0,Ce;for(Ce=0;Ce<R;Ce++)(E&&c[Ce]!==m[Ce]||!E&&sr(c[Ce])!==sr(m[Ce]))&&ae++;return ae+L}function Ac(c,m){Ae(c,0,0,function(){var E=this.utcOffset(),R="+";return E<0&&(E=-E,R="-"),R+Ye(~~(E/60),2)+m+Ye(~~E%60,2)})}Ac("Z",":"),Ac("ZZ",""),Ke("Z",Mr),Ke("ZZ",Mr),ur(["Z","ZZ"],function(c,m,E){E._useUTC=!0,E._tzm=Zl(Mr,c)});var Nc=/([\+\-]|\d\d)/gi;function Zl(c,m){var E=(m||"").match(c),R,L,ae;return E===null?null:(R=E[E.length-1]||[],L=(R+"").match(Nc)||["-",0,0],ae=+(L[1]*60)+sr(L[2]),ae===0?0:L[0]==="+"?ae:-ae)}function hh(c,m){var E,R;return m._isUTC?(E=m.clone(),R=(Se(c)||Y(c)?c.valueOf():Ii(c).valueOf())-E.valueOf(),E._d.setTime(E._d.valueOf()+R),_.updateOffset(E,!1),E):Ii(c).local()}function ec(c){return-Math.round(c._d.getTimezoneOffset())}_.updateOffset=function(){};function Zd(c,m,E){var R=this._offset||0,L;if(!this.isValid())return c!=null?this:NaN;if(c!=null){if(typeof c=="string"){if(c=Zl(Mr,c),c===null)return this}else Math.abs(c)<16&&!E&&(c=c*60);return!this._isUTC&&m&&(L=ec(this)),this._offset=c,this._isUTC=!0,L!=null&&this.add(L,"m"),R!==c&&(!m||this._changeInProgress?sl(this,Po(c-R,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?R:ec(this)}function Jl(c,m){return c!=null?(typeof c!="string"&&(c=-c),this.utcOffset(c,m),this):-this.utcOffset()}function Jd(c){return this.utcOffset(0,c)}function sd(c){return this._isUTC&&(this.utcOffset(0,c),this._isUTC=!1,c&&this.subtract(ec(this),"m")),this}function Xo(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var c=Zl(di,this._i);c!=null?this.utcOffset(c):this.utcOffset(0,!0)}return this}function Qd(c){return this.isValid()?(c=c?Ii(c).utcOffset():0,(this.utcOffset()-c)%60===0):!1}function il(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function tc(){if(!N(this._isDSTShifted))return this._isDSTShifted;var c={},m;return ve(c,this),c=uh(c),c._a?(m=c._isUTC?le(c._a):Ii(c._a),this._isDSTShifted=this.isValid()&&Rn(c._a,m.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function qd(){return this.isValid()?!this._isUTC:!1}function Ua(){return this.isValid()?this._isUTC:!1}function Zo(){return this.isValid()?this._isUTC&&this._offset===0:!1}var nc=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ql=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Po(c,m){var E=c,R=null,L,ae,Ce;return qu(c)?E={ms:c._milliseconds,d:c._days,M:c._months}:ce(c)||!isNaN(+c)?(E={},m?E[m]=+c:E.milliseconds=+c):(R=nc.exec(c))?(L=R[1]==="-"?-1:1,E={y:0,d:sr(R[Pr])*L,h:sr(R[gi])*L,m:sr(R[Lr])*L,s:sr(R[ps])*L,ms:sr(Xl(R[Ue]*1e3))*L}):(R=Ql.exec(c))?(L=R[1]==="-"?-1:1,E={y:Fo(R[2],L),M:Fo(R[3],L),w:Fo(R[4],L),d:Fo(R[5],L),h:Fo(R[6],L),m:Fo(R[7],L),s:Fo(R[8],L)}):E==null?E={}:typeof E=="object"&&("from"in E||"to"in E)&&(Ce=od(Ii(E.from),Ii(E.to)),E={},E.ms=Ce.milliseconds,E.M=Ce.months),ae=new Fi(E),qu(c)&&Q(c,"_locale")&&(ae._locale=c._locale),qu(c)&&Q(c,"_isValid")&&(ae._isValid=c._isValid),ae}Po.fn=Fi.prototype,Po.invalid=Qu;function Fo(c,m){var E=c&&parseFloat(c.replace(",","."));return(isNaN(E)?0:E)*m}function ca(c,m){var E={};return E.months=m.month()-c.month()+(m.year()-c.year())*12,c.clone().add(E.months,"M").isAfter(m)&&--E.months,E.milliseconds=+m-+c.clone().add(E.months,"M"),E}function od(c,m){var E;return c.isValid()&&m.isValid()?(m=hh(m,c),c.isBefore(m)?E=ca(c,m):(E=ca(m,c),E.milliseconds=-E.milliseconds,E.months=-E.months),E):{milliseconds:0,months:0}}function rc(c,m){return function(E,R){var L,ae;return R!==null&&!isNaN(+R)&&(et(m,"moment()."+m+"(period, number) is deprecated. Please use moment()."+m+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ae=E,E=R,R=ae),L=Po(E,R),sl(this,L,c),this}}function sl(c,m,E,R){var L=m._milliseconds,ae=Xl(m._days),Ce=Xl(m._months);c.isValid()&&(R=R==null?!0:R,Ce&&ka(c,fi(c,"Month")+Ce*E),ae&&fr(c,"Date",fi(c,"Date")+ae*E),L&&c._d.setTime(c._d.valueOf()+L*E),R&&_.updateOffset(c,ae||Ce))}var ef=rc(1,"add"),Ta=rc(-1,"subtract");function dh(c){return typeof c=="string"||c instanceof String}function ha(c){return Se(c)||Y(c)||dh(c)||ce(c)||fh(c)||Ks(c)||c===null||c===void 0}function Ks(c){var m=k(c)&&!X(c),E=!1,R=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],L,ae,Ce=R.length;for(L=0;L<Ce;L+=1)ae=R[L],E=E||Q(c,ae);return m&&E}function fh(c){var m=K(c),E=!1;return m&&(E=c.filter(function(R){return!ce(R)&&dh(c)}).length===0),m&&E}function ig(c){var m=k(c)&&!X(c),E=!1,R=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],L,ae;for(L=0;L<R.length;L+=1)ae=R[L],E=E||Q(c,ae);return m&&E}function ic(c,m){var E=c.diff(m,"days",!0);return E<-6?"sameElse":E<-1?"lastWeek":E<0?"lastDay":E<1?"sameDay":E<2?"nextDay":E<7?"nextWeek":"sameElse"}function gh(c,m){arguments.length===1&&(arguments[0]?ha(arguments[0])?(c=arguments[0],m=void 0):ig(arguments[0])&&(m=arguments[0],c=void 0):(c=void 0,m=void 0));var E=c||Ii(),R=hh(E,this).startOf("day"),L=_.calendarFormat(this,R)||"sameElse",ae=m&&(Oe(m[L])?m[L].call(this,E):m[L]);return this.format(ae||this.localeData().calendar(L,this,Ii(E)))}function Jo(){return new pe(this)}function tf(c,m){var E=Se(c)?c:Ii(c);return this.isValid()&&E.isValid()?(m=mn(m)||"millisecond",m==="millisecond"?this.valueOf()>E.valueOf():E.valueOf()<this.clone().startOf(m).valueOf()):!1}function sc(c,m){var E=Se(c)?c:Ii(c);return this.isValid()&&E.isValid()?(m=mn(m)||"millisecond",m==="millisecond"?this.valueOf()<E.valueOf():this.clone().endOf(m).valueOf()<E.valueOf()):!1}function nf(c,m,E,R){var L=Se(c)?c:Ii(c),ae=Se(m)?m:Ii(m);return this.isValid()&&L.isValid()&&ae.isValid()?(R=R||"()",(R[0]==="("?this.isAfter(L,E):!this.isBefore(L,E))&&(R[1]===")"?this.isBefore(ae,E):!this.isAfter(ae,E))):!1}function sg(c,m){var E=Se(c)?c:Ii(c),R;return this.isValid()&&E.isValid()?(m=mn(m)||"millisecond",m==="millisecond"?this.valueOf()===E.valueOf():(R=E.valueOf(),this.clone().startOf(m).valueOf()<=R&&R<=this.clone().endOf(m).valueOf())):!1}function xr(c,m){return this.isSame(c,m)||this.isAfter(c,m)}function rf(c,m){return this.isSame(c,m)||this.isBefore(c,m)}function sf(c,m,E){var R,L,ae;if(!this.isValid())return NaN;if(R=hh(c,this),!R.isValid())return NaN;switch(L=(R.utcOffset()-this.utcOffset())*6e4,m=mn(m),m){case"year":ae=Su(this,R)/12;break;case"month":ae=Su(this,R);break;case"quarter":ae=Su(this,R)/3;break;case"second":ae=(this-R)/1e3;break;case"minute":ae=(this-R)/6e4;break;case"hour":ae=(this-R)/36e5;break;case"day":ae=(this-R-L)/864e5;break;case"week":ae=(this-R-L)/6048e5;break;default:ae=this-R}return E?ae:Ur(ae)}function Su(c,m){if(c.date()<m.date())return-Su(m,c);var E=(m.year()-c.year())*12+(m.month()-c.month()),R=c.clone().add(E,"months"),L,ae;return m-R<0?(L=c.clone().add(E-1,"months"),ae=(m-R)/(R-L)):(L=c.clone().add(E+1,"months"),ae=(m-R)/(L-R)),-(E+ae)||0}_.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",_.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function og(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ys(c){if(!this.isValid())return null;var m=c!==!0,E=m?this.clone().utc():this;return E.year()<0||E.year()>9999?zt(E,m?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Oe(Date.prototype.toISOString)?m?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",zt(E,"Z")):zt(E,m?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Dc(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var c="moment",m="",E,R,L,ae;return this.isLocal()||(c=this.utcOffset()===0?"moment.utc":"moment.parseZone",m="Z"),E="["+c+'("]',R=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",L="-MM-DD[T]HH:mm:ss.SSS",ae=m+'[")]',this.format(E+R+L+ae)}function Gs(c){c||(c=this.isUtc()?_.defaultFormatUtc:_.defaultFormat);var m=zt(this,c);return this.localeData().postformat(m)}function cm(c,m){return this.isValid()&&(Se(c)&&c.isValid()||Ii(c).isValid())?Po({to:this,from:c}).locale(this.locale()).humanize(!m):this.localeData().invalidDate()}function za(c){return this.from(Ii(),c)}function ol(c,m){return this.isValid()&&(Se(c)&&c.isValid()||Ii(c).isValid())?Po({from:this,to:c}).locale(this.locale()).humanize(!m):this.localeData().invalidDate()}function ad(c){return this.to(Ii(),c)}function Hc(c){var m;return c===void 0?this._locale._abbr:(m=ba(c),m!=null&&(this._locale=m),this)}var jr=He("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(c){return c===void 0?this.localeData():this.locale(c)});function Qo(){return this._locale}var Lc=1e3,Pl=60*Lc,xl=60*Pl,of=(365*400+97)*24*xl;function Al(c,m){return(c%m+m)%m}function ld(c,m,E){return c<100&&c>=0?new Date(c+400,m,E)-of:new Date(c,m,E).valueOf()}function Nl(c,m,E){return c<100&&c>=0?Date.UTC(c+400,m,E)-of:Date.UTC(c,m,E)}function Ka(c){var m,E;if(c=mn(c),c===void 0||c==="millisecond"||!this.isValid())return this;switch(E=this._isUTC?Nl:ld,c){case"year":m=E(this.year(),0,1);break;case"quarter":m=E(this.year(),this.month()-this.month()%3,1);break;case"month":m=E(this.year(),this.month(),1);break;case"week":m=E(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":m=E(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":m=E(this.year(),this.month(),this.date());break;case"hour":m=this._d.valueOf(),m-=Al(m+(this._isUTC?0:this.utcOffset()*Pl),xl);break;case"minute":m=this._d.valueOf(),m-=Al(m,Pl);break;case"second":m=this._d.valueOf(),m-=Al(m,Lc);break}return this._d.setTime(m),_.updateOffset(this,!0),this}function Dl(c){var m,E;if(c=mn(c),c===void 0||c==="millisecond"||!this.isValid())return this;switch(E=this._isUTC?Nl:ld,c){case"year":m=E(this.year()+1,0,1)-1;break;case"quarter":m=E(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":m=E(this.year(),this.month()+1,1)-1;break;case"week":m=E(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":m=E(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":m=E(this.year(),this.month(),this.date()+1)-1;break;case"hour":m=this._d.valueOf(),m+=xl-Al(m+(this._isUTC?0:this.utcOffset()*Pl),xl)-1;break;case"minute":m=this._d.valueOf(),m+=Pl-Al(m,Pl)-1;break;case"second":m=this._d.valueOf(),m+=Lc-Al(m,Lc)-1;break}return this._d.setTime(m),_.updateOffset(this,!0),this}function mh(){return this._d.valueOf()-(this._offset||0)*6e4}function Fc(){return Math.floor(this.valueOf()/1e3)}function $s(){return new Date(this.valueOf())}function ud(){var c=this;return[c.year(),c.month(),c.date(),c.hour(),c.minute(),c.second(),c.millisecond()]}function hm(){var c=this;return{years:c.year(),months:c.month(),date:c.date(),hours:c.hours(),minutes:c.minutes(),seconds:c.seconds(),milliseconds:c.milliseconds()}}function ql(){return this.isValid()?this.toISOString():null}function Hl(){return V(this)}function qo(){return ee({},W(this))}function cd(){return W(this).overflow}function yp(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ae("N",0,0,"eraAbbr"),Ae("NN",0,0,"eraAbbr"),Ae("NNN",0,0,"eraAbbr"),Ae("NNNN",0,0,"eraName"),Ae("NNNNN",0,0,"eraNarrow"),Ae("y",["y",1],"yo","eraYear"),Ae("y",["yy",2],0,"eraYear"),Ae("y",["yyy",3],0,"eraYear"),Ae("y",["yyyy",4],0,"eraYear"),Ke("N",Ll),Ke("NN",Ll),Ke("NNN",Ll),Ke("NNNN",oc),Ke("NNNNN",co),ur(["N","NN","NNN","NNNN","NNNNN"],function(c,m,E,R){var L=E._locale.erasParse(c,R,E._strict);L?W(E).era=L:W(E).invalidEra=c}),Ke("y",en),Ke("yy",en),Ke("yyy",en),Ke("yyyy",en),Ke("yo",ac),ur(["y","yy","yyy","yyyy"],Kn),ur(["yo"],function(c,m,E,R){var L;E._locale._eraYearOrdinalRegex&&(L=c.match(E._locale._eraYearOrdinalRegex)),E._locale.eraYearOrdinalParse?m[Kn]=E._locale.eraYearOrdinalParse(c,L):m[Kn]=parseInt(c,10)});function af(c,m){var E,R,L,ae=this._eras||ba("en")._eras;for(E=0,R=ae.length;E<R;++E){switch(typeof ae[E].since){case"string":L=_(ae[E].since).startOf("day"),ae[E].since=L.valueOf();break}switch(typeof ae[E].until){case"undefined":ae[E].until=1/0;break;case"string":L=_(ae[E].until).startOf("day").valueOf(),ae[E].until=L.valueOf();break}}return ae}function ph(c,m,E){var R,L,ae=this.eras(),Ce,_e,Ge;for(c=c.toUpperCase(),R=0,L=ae.length;R<L;++R)if(Ce=ae[R].name.toUpperCase(),_e=ae[R].abbr.toUpperCase(),Ge=ae[R].narrow.toUpperCase(),E)switch(m){case"N":case"NN":case"NNN":if(_e===c)return ae[R];break;case"NNNN":if(Ce===c)return ae[R];break;case"NNNNN":if(Ge===c)return ae[R];break}else if([Ce,_e,Ge].indexOf(c)>=0)return ae[R]}function _u(c,m){var E=c.since<=c.until?1:-1;return m===void 0?_(c.since).year():_(c.since).year()+(m-c.offset)*E}function Pi(){var c,m,E,R=this.localeData().eras();for(c=0,m=R.length;c<m;++c)if(E=this.clone().startOf("day").valueOf(),R[c].since<=E&&E<=R[c].until||R[c].until<=E&&E<=R[c].since)return R[c].name;return""}function Wo(){var c,m,E,R=this.localeData().eras();for(c=0,m=R.length;c<m;++c)if(E=this.clone().startOf("day").valueOf(),R[c].since<=E&&E<=R[c].until||R[c].until<=E&&E<=R[c].since)return R[c].narrow;return""}function ea(){var c,m,E,R=this.localeData().eras();for(c=0,m=R.length;c<m;++c)if(E=this.clone().startOf("day").valueOf(),R[c].since<=E&&E<=R[c].until||R[c].until<=E&&E<=R[c].since)return R[c].abbr;return""}function Ya(){var c,m,E,R,L=this.localeData().eras();for(c=0,m=L.length;c<m;++c)if(E=L[c].since<=L[c].until?1:-1,R=this.clone().startOf("day").valueOf(),L[c].since<=R&&R<=L[c].until||L[c].until<=R&&R<=L[c].since)return(this.year()-_(L[c].since).year())*E+L[c].offset;return this.year()}function ui(c){return Q(this,"_erasNameRegex")||Wi.call(this),c?this._erasNameRegex:this._erasRegex}function da(c){return Q(this,"_erasAbbrRegex")||Wi.call(this),c?this._erasAbbrRegex:this._erasRegex}function ys(c){return Q(this,"_erasNarrowRegex")||Wi.call(this),c?this._erasNarrowRegex:this._erasRegex}function Ll(c,m){return m.erasAbbrRegex(c)}function oc(c,m){return m.erasNameRegex(c)}function co(c,m){return m.erasNarrowRegex(c)}function ac(c,m){return m._eraYearOrdinalRegex||en}function Wi(){var c=[],m=[],E=[],R=[],L,ae,Ce,_e,Ge,ht=this.eras();for(L=0,ae=ht.length;L<ae;++L)Ce=$r(ht[L].name),_e=$r(ht[L].abbr),Ge=$r(ht[L].narrow),m.push(Ce),c.push(_e),E.push(Ge),R.push(Ce),R.push(_e),R.push(Ge);this._erasRegex=new RegExp("^("+R.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+m.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+c.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+E.join("|")+")","i")}Ae(0,["gg",2],0,function(){return this.weekYear()%100}),Ae(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ds(c,m){Ae(0,[c,c.length],0,m)}Ds("gggg","weekYear"),Ds("ggggg","weekYear"),Ds("GGGG","isoWeekYear"),Ds("GGGGG","isoWeekYear"),Ke("G",Vr),Ke("g",Vr),Ke("GG",Ln,Oi),Ke("gg",Ln,Oi),Ke("GGGG",un,Vs),Ke("gggg",un,Vs),Ke("GGGGG",Xn,Qi),Ke("ggggg",Xn,Qi),Hr(["gggg","ggggg","GGGG","GGGGG"],function(c,m,E,R){m[R.substr(0,2)]=sr(c)}),Hr(["gg","GG"],function(c,m,E,R){m[R]=_.parseTwoDigitYear(c)});function vh(c){return Ma.call(this,c,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Br(c){return Ma.call(this,c,this.isoWeek(),this.isoWeekday(),1,4)}function ta(){return Tt(this.year(),1,4)}function ho(){return Tt(this.isoWeekYear(),1,4)}function bi(){var c=this.localeData()._week;return Tt(this.year(),c.dow,c.doy)}function us(){var c=this.localeData()._week;return Tt(this.weekYear(),c.dow,c.doy)}function Ma(c,m,E,R,L){var ae;return c==null?nt(this,R,L).year:(ae=Tt(c,R,L),m>ae&&(m=ae),Fl.call(this,c,m,E,R,L))}function Fl(c,m,E,R,L){var ae=Xe(c,m,E,R,L),Ce=he(ae.year,0,ae.dayOfYear);return this.year(Ce.getUTCFullYear()),this.month(Ce.getUTCMonth()),this.date(Ce.getUTCDate()),this}Ae("Q",0,"Qo","quarter"),Ke("Q",Hn),ur("Q",function(c,m){m[zi]=(sr(c)-1)*3});function hd(c){return c==null?Math.ceil((this.month()+1)/3):this.month((c-1)*3+this.month()%3)}Ae("D",["DD",2],"Do","date"),Ke("D",Ln,Te),Ke("DD",Ln,Oi),Ke("Do",function(c,m){return c?m._dayOfMonthOrdinalParse||m._ordinalParse:m._dayOfMonthOrdinalParseLenient}),ur(["D","DD"],Pr),ur("Do",function(c,m){m[Pr]=sr(c.match(Ln)[0])});var Wl=Di("Date",!0);Ae("DDD",["DDDD",3],"DDDo","dayOfYear"),Ke("DDD",In),Ke("DDDD",pr),ur(["DDD","DDDD"],function(c,m,E){E._dayOfYear=sr(c)});function lc(c){var m=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return c==null?m:this.add(c-m,"d")}Ae("m",["mm",2],0,"minute"),Ke("m",Ln,tt),Ke("mm",Ln,Oi),ur(["m","mm"],Lr);var dd=Di("Minutes",!1);Ae("s",["ss",2],0,"second"),Ke("s",Ln,tt),Ke("ss",Ln,Oi),ur(["s","ss"],ps);var cs=Di("Seconds",!1);Ae("S",0,0,function(){return~~(this.millisecond()/100)}),Ae(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Ae(0,["SSS",3],0,"millisecond"),Ae(0,["SSSS",4],0,function(){return this.millisecond()*10}),Ae(0,["SSSSS",5],0,function(){return this.millisecond()*100}),Ae(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),Ae(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),Ae(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),Ae(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Ke("S",In,Hn),Ke("SS",In,Oi),Ke("SSS",In,pr);var na,Bl;for(na="SSSS";na.length<=9;na+="S")Ke(na,en);function Oa(c,m){m[Ue]=sr(("0."+c)*1e3)}for(na="S";na.length<=9;na+="S")ur(na,Oa);Bl=Di("Milliseconds",!1),Ae("z",0,0,"zoneAbbr"),Ae("zz",0,0,"zoneName");function ts(){return this._isUTC?"UTC":""}function fa(){return this._isUTC?"Coordinated Universal Time":""}var Ut=pe.prototype;Ut.add=ef,Ut.calendar=gh,Ut.clone=Jo,Ut.diff=sf,Ut.endOf=Dl,Ut.format=Gs,Ut.from=cm,Ut.fromNow=za,Ut.to=ol,Ut.toNow=ad,Ut.get=tl,Ut.invalidAt=cd,Ut.isAfter=tf,Ut.isBefore=sc,Ut.isBetween=nf,Ut.isSame=sg,Ut.isSameOrAfter=xr,Ut.isSameOrBefore=rf,Ut.isValid=Hl,Ut.lang=jr,Ut.locale=Hc,Ut.localeData=Qo,Ut.max=eo,Ut.min=ng,Ut.parsingFlags=qo,Ut.set=li,Ut.startOf=Ka,Ut.subtract=Ta,Ut.toArray=ud,Ut.toObject=hm,Ut.toDate=$s,Ut.toISOString=Ys,Ut.inspect=Dc,typeof Symbol!="undefined"&&Symbol.for!=null&&(Ut[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Ut.toJSON=ql,Ut.toString=og,Ut.unix=Fc,Ut.valueOf=mh,Ut.creationData=yp,Ut.eraName=Pi,Ut.eraNarrow=Wo,Ut.eraAbbr=ea,Ut.eraYear=Ya,Ut.year=Xr,Ut.isLeapYear=Er,Ut.weekYear=vh,Ut.isoWeekYear=Br,Ut.quarter=Ut.quarters=hd,Ut.month=ls,Ut.daysInMonth=dr,Ut.week=Ut.weeks=Cr,Ut.isoWeek=Ut.isoWeeks=Cs,Ut.weeksInYear=bi,Ut.weeksInWeekYear=us,Ut.isoWeeksInYear=ta,Ut.isoWeeksInISOWeekYear=ho,Ut.date=Wl,Ut.day=Ut.days=or,Ut.weekday=Ts,Ut.isoWeekday=ua,Ut.dayOfYear=lc,Ut.hour=Ut.hours=Ju,Ut.minute=Ut.minutes=dd,Ut.second=Ut.seconds=cs,Ut.millisecond=Ut.milliseconds=Bl,Ut.utcOffset=Zd,Ut.utc=Jd,Ut.local=sd,Ut.parseZone=Xo,Ut.hasAlignedHourOffset=Qd,Ut.isDST=il,Ut.isLocal=qd,Ut.isUtcOffset=Ua,Ut.isUtc=Zo,Ut.isUTC=Zo,Ut.zoneAbbr=ts,Ut.zoneName=fa,Ut.dates=He("dates accessor is deprecated. Use date instead.",Wl),Ut.months=He("months accessor is deprecated. Use month instead",ls),Ut.years=He("years accessor is deprecated. Use year instead",Xr),Ut.zone=He("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Jl),Ut.isDSTShifted=He("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",tc);function lf(c){return Ii(c*1e3)}function Ar(){return Ii.apply(null,arguments).parseZone()}function to(c){return c}var ei=dt.prototype;ei.calendar=jt,ei.longDateFormat=an,ei.invalidDate=Cn,ei.ordinal=br,ei.preparse=to,ei.postformat=to,ei.relativeTime=ir,ei.pastFuture=Qn,ei.set=ct,ei.eras=af,ei.erasParse=ph,ei.erasConvertYear=_u,ei.erasAbbrRegex=da,ei.erasNameRegex=ui,ei.erasNarrowRegex=ys,ei.months=lo,ei.monthsShort=xs,ei.monthsParse=ya,ei.monthsRegex=O,ei.monthsShortRegex=se,ei.week=En,ei.firstDayOfYear=vr,ei.firstDayOfWeek=pn,ei.weekdays=qs,ei.weekdaysMin=Si,ei.weekdaysShort=Zu,ei.weekdaysParse=El,ei.weekdaysRegex=rl,ei.weekdaysShortRegex=mu,ei.weekdaysMinRegex=zs,ei.isPM=Va,ei.meridiem=pu;function Ia(c,m,E,R){var L=ba(),ae=le().set(R,m);return L[E](ae,c)}function Ss(c,m,E){if(ce(c)&&(m=c,c=void 0),c=c||"",m!=null)return Ia(c,m,E,"month");var R,L=[];for(R=0;R<12;R++)L[R]=Ia(c,R,E,"month");return L}function bu(c,m,E,R){typeof c=="boolean"?(ce(m)&&(E=m,m=void 0),m=m||""):(m=c,E=m,c=!1,ce(m)&&(E=m,m=void 0),m=m||"");var L=ba(),ae=c?L._week.dow:0,Ce,_e=[];if(E!=null)return Ia(m,(E+ae)%7,R,"day");for(Ce=0;Ce<7;Ce++)_e[Ce]=Ia(m,(Ce+ae)%7,R,"day");return _e}function uc(c,m){return Ss(c,m,"months")}function ra(c,m){return Ss(c,m,"monthsShort")}function Bi(c,m,E){return bu(c,m,E,"weekdays")}function al(c,m,E){return bu(c,m,E,"weekdaysShort")}function Ch(c,m,E){return bu(c,m,E,"weekdaysMin")}Li("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(c){var m=c%10,E=sr(c%100/10)===1?"th":m===1?"st":m===2?"nd":m===3?"rd":"th";return c+E}}),_.lang=He("moment.lang is deprecated. Use moment.locale instead.",Li),_.langData=He("moment.langData is deprecated. Use moment.localeData instead.",ba);var Pa=Math.abs;function ns(){var c=this._data;return this._milliseconds=Pa(this._milliseconds),this._days=Pa(this._days),this._months=Pa(this._months),c.milliseconds=Pa(c.milliseconds),c.seconds=Pa(c.seconds),c.minutes=Pa(c.minutes),c.hours=Pa(c.hours),c.months=Pa(c.months),c.years=Pa(c.years),this}function cc(c,m,E,R){var L=Po(m,E);return c._milliseconds+=R*L._milliseconds,c._days+=R*L._days,c._months+=R*L._months,c._bubble()}function ga(c,m){return cc(this,c,m,1)}function wh(c,m){return cc(this,c,m,-1)}function eu(c){return c<0?Math.floor(c):Math.ceil(c)}function tu(){var c=this._milliseconds,m=this._days,E=this._months,R=this._data,L,ae,Ce,_e,Ge;return c>=0&&m>=0&&E>=0||c<=0&&m<=0&&E<=0||(c+=eu(fd(E)+m)*864e5,m=0,E=0),R.milliseconds=c%1e3,L=Ur(c/1e3),R.seconds=L%60,ae=Ur(L/60),R.minutes=ae%60,Ce=Ur(ae/60),R.hours=Ce%24,m+=Ur(Ce/24),Ge=Ur(hc(m)),E+=Ge,m-=eu(fd(Ge)),_e=Ur(E/12),E%=12,R.days=m,R.months=E,R.years=_e,this}function hc(c){return c*4800/146097}function fd(c){return c*146097/4800}function gd(c){if(!this.isValid())return NaN;var m,E,R=this._milliseconds;if(c=mn(c),c==="month"||c==="quarter"||c==="year")switch(m=this._days+R/864e5,E=this._months+hc(m),c){case"month":return E;case"quarter":return E/3;case"year":return E/12}else switch(m=this._days+Math.round(fd(this._months)),c){case"week":return m/7+R/6048e5;case"day":return m+R/864e5;case"hour":return m*24+R/36e5;case"minute":return m*1440+R/6e4;case"second":return m*86400+R/1e3;case"millisecond":return Math.floor(m*864e5)+R;default:throw new Error("Unknown unit "+c)}}function ma(c){return function(){return this.as(c)}}var Eu=ma("ms"),yh=ma("s"),dc=ma("m"),md=ma("h"),Wc=ma("d"),ag=ma("w"),ll=ma("M"),fc=ma("Q"),nu=ma("y"),lg=Eu;function Bc(){return Po(this)}function _s(c){return c=mn(c),this.isValid()?this[c+"s"]():NaN}function Hs(c){return function(){return this.isValid()?this._data[c]:NaN}}var Ru=Hs("milliseconds"),pd=Hs("seconds"),Sh=Hs("minutes"),_h=Hs("hours"),ul=Hs("days"),xa=Hs("months"),ru=Hs("years");function bh(){return Ur(this.days()/7)}var Bo=Math.round,cl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function dm(c,m,E,R,L){return L.relativeTime(m||1,!!E,c,R)}function gc(c,m,E,R){var L=Po(c).abs(),ae=Bo(L.as("s")),Ce=Bo(L.as("m")),_e=Bo(L.as("h")),Ge=Bo(L.as("d")),ht=Bo(L.as("M")),Dt=Bo(L.as("w")),Ht=Bo(L.as("y")),tr=ae<=E.ss&&["s",ae]||ae<E.s&&["ss",ae]||Ce<=1&&["m"]||Ce<E.m&&["mm",Ce]||_e<=1&&["h"]||_e<E.h&&["hh",_e]||Ge<=1&&["d"]||Ge<E.d&&["dd",Ge];return E.w!=null&&(tr=tr||Dt<=1&&["w"]||Dt<E.w&&["ww",Dt]),tr=tr||ht<=1&&["M"]||ht<E.M&&["MM",ht]||Ht<=1&&["y"]||["yy",Ht],tr[2]=m,tr[3]=+c>0,tr[4]=R,dm.apply(null,tr)}function uf(c){return c===void 0?Bo:typeof c=="function"?(Bo=c,!0):!1}function ug(c,m){return cl[c]===void 0?!1:m===void 0?cl[c]:(cl[c]=m,c==="s"&&(cl.ss=m-1),!0)}function cg(c,m){if(!this.isValid())return this.localeData().invalidDate();var E=!1,R=cl,L,ae;return typeof c=="object"&&(m=c,c=!1),typeof c=="boolean"&&(E=c),typeof m=="object"&&(R=Object.assign({},cl,m),m.s!=null&&m.ss==null&&(R.ss=m.s-1)),L=this.localeData(),ae=gc(this,!E,R,L),E&&(ae=L.pastFuture(+this,ae)),L.postformat(ae)}var v=Math.abs;function b(c){return(c>0)-(c<0)||+c}function D(){if(!this.isValid())return this.localeData().invalidDate();var c=v(this._milliseconds)/1e3,m=v(this._days),E=v(this._months),R,L,ae,Ce,_e=this.asSeconds(),Ge,ht,Dt,Ht;return _e?(R=Ur(c/60),L=Ur(R/60),c%=60,R%=60,ae=Ur(E/12),E%=12,Ce=c?c.toFixed(3).replace(/\.?0+$/,""):"",Ge=_e<0?"-":"",ht=b(this._months)!==b(_e)?"-":"",Dt=b(this._days)!==b(_e)?"-":"",Ht=b(this._milliseconds)!==b(_e)?"-":"",Ge+"P"+(ae?ht+ae+"Y":"")+(E?ht+E+"M":"")+(m?Dt+m+"D":"")+(L||R||c?"T":"")+(L?Ht+L+"H":"")+(R?Ht+R+"M":"")+(c?Ht+Ce+"S":"")):"P0D"}var F=Fi.prototype;F.isValid=ch,F.abs=ns,F.add=ga,F.subtract=wh,F.as=gd,F.asMilliseconds=Eu,F.asSeconds=yh,F.asMinutes=dc,F.asHours=md,F.asDays=Wc,F.asWeeks=ag,F.asMonths=ll,F.asQuarters=fc,F.asYears=nu,F.valueOf=lg,F._bubble=tu,F.clone=Bc,F.get=_s,F.milliseconds=Ru,F.seconds=pd,F.minutes=Sh,F.hours=_h,F.days=ul,F.weeks=bh,F.months=xa,F.years=ru,F.humanize=cg,F.toISOString=D,F.toString=D,F.toJSON=D,F.locale=Hc,F.localeData=Qo,F.toIsoString=He("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",D),F.lang=jr,Ae("X",0,0,"unix"),Ae("x",0,0,"valueOf"),Ke("x",Vr),Ke("X",js),ur("X",function(c,m,E){E._d=new Date(parseFloat(c)*1e3)}),ur("x",function(c,m,E){E._d=new Date(sr(c))});return _.version="2.30.1",B(Ii),_.fn=Ut,_.min=rg,_.max=yu,_.now=$l,_.utc=le,_.unix=lf,_.months=uc,_.isDate=Y,_.locale=Li,_.invalid=q,_.duration=Po,_.isMoment=Se,_.weekdays=Bi,_.parseZone=Ar,_.localeData=ba,_.isDuration=qu,_.monthsShort=ra,_.weekdaysMin=Ch,_.defineLocale=_a,_.updateLocale=Tl,_.locales=uo,_.weekdaysShort=al,_.normalizeUnits=mn,_.relativeTimeRounding=uf,_.relativeTimeThreshold=ug,_.calendarFormat=ic,_.prototype=Ut,_.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},_})},92521:function($,ie,f){"use strict";f.r(ie),f.d(ie,{BaseTransition:function(){return C.P$},BaseTransitionPropsValidators:function(){return C.nJ},Comment:function(){return C.sv},DeprecationTypes:function(){return C.RM},EffectScope:function(){return C.Bj},ErrorCodes:function(){return C.SM},ErrorTypeStrings:function(){return C.yg},Fragment:function(){return C.HY},KeepAlive:function(){return C.Ob},ReactiveEffect:function(){return C.qq},Static:function(){return C.qG},Suspense:function(){return C.n4},Teleport:function(){return C.lR},Text:function(){return C.xv},TrackOpTypes:function(){return C.ER},Transition:function(){return C.uT},TransitionGroup:function(){return C.W3},TriggerOpTypes:function(){return C.PQ},VueElement:function(){return C.a2},assertNumber:function(){return C.Wu},callWithAsyncErrorHandling:function(){return C.$d},callWithErrorHandling:function(){return C.KU},camelize:function(){return C._A},capitalize:function(){return C.kC},cloneVNode:function(){return C.Ho},compatUtils:function(){return C.ry},compile:function(){return B},computed:function(){return C.Fl},createApp:function(){return C.ri},createBlock:function(){return C.j4},createCommentVNode:function(){return C.kq},createElementBlock:function(){return C.iD},createElementVNode:function(){return C._},createHydrationRenderer:function(){return C.Eo},createPropsRestProxy:function(){return C.p1},createRenderer:function(){return C.Us},createSSRApp:function(){return C.vr},createSlots:function(){return C.Nv},createStaticVNode:function(){return C.uE},createTextVNode:function(){return C.Uk},createVNode:function(){return C.Wm},customRef:function(){return C.ZM},defineAsyncComponent:function(){return C.RC},defineComponent:function(){return C.aZ},defineCustomElement:function(){return C.MW},defineEmits:function(){return C.Bz},defineExpose:function(){return C.WY},defineModel:function(){return C.Gn},defineOptions:function(){return C.Yu},defineProps:function(){return C.yb},defineSSRCustomElement:function(){return C.Ah},defineSlots:function(){return C.Wl},devtools:function(){return C.mW},effect:function(){return C.cE},effectScope:function(){return C.B},getCurrentInstance:function(){return C.FN},getCurrentScope:function(){return C.nZ},getCurrentWatcher:function(){return C.AH},getTransitionRawChildren:function(){return C.Q6},guardReactiveProps:function(){return C.F4},h:function(){return C.h},handleError:function(){return C.S3},hasInjectionContext:function(){return C.EM},hydrate:function(){return C.ZB},hydrateOnIdle:function(){return C.mI},hydrateOnInteraction:function(){return C.eg},hydrateOnMediaQuery:function(){return C.Fp},hydrateOnVisible:function(){return C.Eq},initCustomFormatter:function(){return C.Mr},initDirectivesForSSR:function(){return C.Nd},inject:function(){return C.f3},isMemoSame:function(){return C.nQ},isProxy:function(){return C.X3},isReactive:function(){return C.PG},isReadonly:function(){return C.$y},isRef:function(){return C.dq},isRuntimeOnly:function(){return C.of},isShallow:function(){return C.yT},isVNode:function(){return C.lA},markRaw:function(){return C.Xl},mergeDefaults:function(){return C.u_},mergeModels:function(){return C.Vf},mergeProps:function(){return C.dG},nextTick:function(){return C.Y3},normalizeClass:function(){return C.C_},normalizeProps:function(){return C.vs},normalizeStyle:function(){return C.j5},onActivated:function(){return C.dl},onBeforeMount:function(){return C.wF},onBeforeUnmount:function(){return C.Jd},onBeforeUpdate:function(){return C.Xn},onDeactivated:function(){return C.se},onErrorCaptured:function(){return C.d1},onMounted:function(){return C.bv},onRenderTracked:function(){return C.bT},onRenderTriggered:function(){return C.Yq},onScopeDispose:function(){return C.EB},onServerPrefetch:function(){return C.vl},onUnmounted:function(){return C.SK},onUpdated:function(){return C.ic},onWatcherCleanup:function(){return C.zF},openBlock:function(){return C.wg},popScopeId:function(){return C.Cn},provide:function(){return C.JJ},proxyRefs:function(){return C.WL},pushScopeId:function(){return C.dD},queuePostFlushCb:function(){return C.qb},reactive:function(){return C.qj},readonly:function(){return C.OT},ref:function(){return C.iH},registerRuntimeCompiler:function(){return C.Y1},render:function(){return C.sY},renderList:function(){return C.Ko},renderSlot:function(){return C.WI},resolveComponent:function(){return C.up},resolveDirective:function(){return C.Q2},resolveDynamicComponent:function(){return C.LL},resolveFilter:function(){return C.eq},resolveTransitionHooks:function(){return C.U2},setBlockTracking:function(){return C.qZ},setDevtoolsHook:function(){return C.ec},setTransitionHooks:function(){return C.nK},shallowReactive:function(){return C.Um},shallowReadonly:function(){return C.YS},shallowRef:function(){return C.XI},ssrContextKey:function(){return C.Uc},ssrUtils:function(){return C.G},stop:function(){return C.sT},toDisplayString:function(){return C.zw},toHandlerKey:function(){return C.hR},toHandlers:function(){return C.mx},toRaw:function(){return C.IU},toRef:function(){return C.Vh},toRefs:function(){return C.BK},toValue:function(){return C.Tn},transformVNodeArgs:function(){return C.C3},triggerRef:function(){return C.oR},unref:function(){return C.SU},useAttrs:function(){return C.l1},useCssModule:function(){return C.fb},useCssVars:function(){return C.sj},useHost:function(){return C.$},useId:function(){return C.Me},useModel:function(){return C.tT},useSSRContext:function(){return C.Zq},useShadowRoot:function(){return C.pR},useSlots:function(){return C.Rr},useTemplateRef:function(){return C.AE},useTransitionState:function(){return C.Y8},vModelCheckbox:function(){return C.e8},vModelDynamic:function(){return C.YZ},vModelRadio:function(){return C.G2},vModelSelect:function(){return C.bM},vModelText:function(){return C.nr},vShow:function(){return C.F8},version:function(){return C.i8},warn:function(){return C.ZK},watch:function(){return C.YP},watchEffect:function(){return C.m0},watchPostEffect:function(){return C.Rh},watchSyncEffect:function(){return C.yX},withAsyncContext:function(){return C.mv},withCtx:function(){return C.w5},withDefaults:function(){return C.b9},withDirectives:function(){return C.wy},withKeys:function(){return C.D2},withMemo:function(){return C.MX},withModifiers:function(){return C.iM},withScopeId:function(){return C.HX}});var C=f(23970);function _(){initCustomFormatter()}const B=()=>{}}}]);
}());